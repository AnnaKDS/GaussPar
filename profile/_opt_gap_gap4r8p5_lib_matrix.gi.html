<!DOCTYPE html><script src="sorttable.js"></script><html><body>
<style>
table { border-collapse: collapse }
tr .linenum { text-align: right; }
tr:nth-child(odd)  { background-color: #EEE; }
tr:nth-child(even)  { background-color: #FFF; }
tr:nth-child(odd).exec  { background-color: #0F0; }
tr:nth-child(even).exec  { background-color: #3F3; }
tr:nth-child(odd).missed  { background-color: #F00; }
tr:nth-child(even).missed  { background-color: #F33; }
td, th {
    border: 1px solid #98bf21;
    padding: 3px 7px 2px 7px;
}
th {
    font-size: 1.1em;
    text-align: left;
    padding-top: 5px;
    padding-bottom: 4px;
    background-color: #A7C942;
    color: #ffffff;
}
table.sortable th:not(.sorttable_sorted):not(.sorttable_sorted_reverse):not(.sorttable_nosort):after {
    content: " \25B4\25BE"
}

/* HSV gradient made using http://www.perbang.dk/rgbgradient/ */
td.coverage00 { background-color: #FF0000; }
td.coverage10 { background-color: #F83100; }
td.coverage20 { background-color: #F25F00; }
td.coverage30 { background-color: #EB8B00; }
td.coverage40 { background-color: #E5B500; }
td.coverage50 { background-color: #DFDC00; }
td.coverage60 { background-color: #B0D800; }
td.coverage70 { background-color: #81D200; }
td.coverage80 { background-color: #55CB00; }
td.coverage90 { background-color: #2CC500; }
td.coverage100 { background-color: #04BF00; }
</style><p>This file was read by GAP before profiling was actived, so lines which were not read but not executed are not marked.</p><table class="sortable">
<thead><tr><th>Line</th><th>Execs</th><th>Time</th><th>Time+Childs</th><th>Code</th><th>Called Functions</th>
</tr></thead>
<tbody>
<tr class='ignore'><td><a name="line1"></a><div class='linenum'>1</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2"></a><div class='linenum'>2</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3"></a><div class='linenum'>3</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;matrix.gi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAP&nbsp;library&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thomas&nbsp;Breuer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4"></a><div class='linenum'>4</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Frank&nbsp;Celler
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5"></a><div class='linenum'>5</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Alexander&nbsp;Hulpke
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line6"></a><div class='linenum'>6</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Heiko&nbsp;Theißen
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line7"></a><div class='linenum'>7</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Martin&nbsp;Schönert
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line8"></a><div class='linenum'>8</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line9"></a><div class='linenum'>9</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line10"></a><div class='linenum'>10</div></td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;&nbsp;1997,&nbsp;&nbsp;Lehrstuhl&nbsp;D&nbsp;für&nbsp;Mathematik,&nbsp;&nbsp;RWTH&nbsp;Aachen,&nbsp;&nbsp;Germany
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line11"></a><div class='linenum'>11</div></td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;(C)&nbsp;1998&nbsp;School&nbsp;Math&nbsp;and&nbsp;Comp.&nbsp;Sci.,&nbsp;University&nbsp;of&nbsp;St&nbsp;Andrews,&nbsp;Scotland
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line12"></a><div class='linenum'>12</div></td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;2002&nbsp;The&nbsp;GAP&nbsp;Group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line13"></a><div class='linenum'>13</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line14"></a><div class='linenum'>14</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;file&nbsp;contains&nbsp;methods&nbsp;for&nbsp;matrices.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line15"></a><div class='linenum'>15</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line16"></a><div class='linenum'>16</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line17"></a><div class='linenum'>17</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line18"></a><div class='linenum'>18</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line19"></a><div class='linenum'>19</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;Kernel&nbsp;method&nbsp;for&nbsp;computing
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line20"></a><div class='linenum'>20</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line21"></a><div class='linenum'>21</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line22"></a><div class='linenum'>22</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(Zero,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line23"></a><div class='linenum'>23</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[IsRectangularTable&nbsp;and&nbsp;IsAdditiveElementWithZeroCollColl&nbsp;and&nbsp;IsInternalRep],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line24"></a><div class='linenum'>24</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZERO_ATTR_MAT);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line25"></a><div class='linenum'>25</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line26"></a><div class='linenum'>26</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line27"></a><div class='linenum'>27</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line28"></a><div class='linenum'>28</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;PrintArray(&nbsp;&lt;array>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;pretty&nbsp;print&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line29"></a><div class='linenum'>29</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line30"></a><div class='linenum'>30</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(PrintArray,function(&nbsp;array&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line31"></a><div class='linenum'>31</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;arr,&nbsp;&nbsp;max,&nbsp;&nbsp;l,&nbsp;&nbsp;k,maxp,compact,bl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line32"></a><div class='linenum'>32</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line33"></a><div class='linenum'>33</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;compact:=ValueOption("compact")=true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line34"></a><div class='linenum'>34</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;compact&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line35"></a><div class='linenum'>35</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxp:=0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line36"></a><div class='linenum'>36</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bl:="";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line37"></a><div class='linenum'>37</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line38"></a><div class='linenum'>38</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxp:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line39"></a><div class='linenum'>39</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bl:="&nbsp;";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line40"></a><div class='linenum'>40</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line41"></a><div class='linenum'>41</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsDenseList(&nbsp;array&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line42"></a><div class='linenum'>42</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;array>&nbsp;must&nbsp;be&nbsp;a&nbsp;dense&nbsp;list"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line43"></a><div class='linenum'>43</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;array&nbsp;)&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line44"></a><div class='linenum'>44</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"[&nbsp;]\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line45"></a><div class='linenum'>45</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;array&nbsp;=&nbsp;[[]]&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line46"></a><div class='linenum'>46</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"[&nbsp;[&nbsp;]&nbsp;]\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line47"></a><div class='linenum'>47</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;ForAll(&nbsp;array,&nbsp;IsList&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line48"></a><div class='linenum'>48</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr&nbsp;:=&nbsp;List(&nbsp;array,&nbsp;String&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line49"></a><div class='linenum'>49</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;:=&nbsp;Maximum(&nbsp;List(&nbsp;arr,&nbsp;Length&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line50"></a><div class='linenum'>50</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"[&nbsp;",&nbsp;String(&nbsp;arr[&nbsp;1&nbsp;],&nbsp;max&nbsp;+&nbsp;maxp&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line51"></a><div class='linenum'>51</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;l&nbsp;&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;Length(&nbsp;arr&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line52"></a><div class='linenum'>52</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;",&nbsp;",&nbsp;String(&nbsp;arr[&nbsp;l&nbsp;],&nbsp;max&nbsp;+&nbsp;1&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line53"></a><div class='linenum'>53</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line54"></a><div class='linenum'>54</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"&nbsp;]\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line55"></a><div class='linenum'>55</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line56"></a><div class='linenum'>56</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr&nbsp;:=&nbsp;List(&nbsp;array,&nbsp;x&nbsp;->&nbsp;List(&nbsp;x,&nbsp;String&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line57"></a><div class='linenum'>57</div></td><td></td><td></td><td></td><td><span><tt>	if&nbsp;compact&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line58"></a><div class='linenum'>58</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;max:=List([1..Length(arr[1])],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line59"></a><div class='linenum'>59</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;x->Maximum(List([1..Length(arr)],y->Length(arr[y][x]))));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line60"></a><div class='linenum'>60</div></td><td></td><td></td><td></td><td><span><tt>	else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line61"></a><div class='linenum'>61</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;max&nbsp;:=&nbsp;Maximum(&nbsp;List(&nbsp;arr,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line62"></a><div class='linenum'>62</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(x)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line63"></a><div class='linenum'>63</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(x)&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line64"></a><div class='linenum'>64</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line65"></a><div class='linenum'>65</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line66"></a><div class='linenum'>66</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Maximum(&nbsp;List(x,Length)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line67"></a><div class='linenum'>67</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line68"></a><div class='linenum'>68</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line69"></a><div class='linenum'>69</div></td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line70"></a><div class='linenum'>70</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line71"></a><div class='linenum'>71</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"[",bl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line72"></a><div class='linenum'>72</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;l&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;arr&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line73"></a><div class='linenum'>73</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;l&nbsp;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line74"></a><div class='linenum'>74</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(bl,"&nbsp;");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line75"></a><div class='linenum'>75</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line76"></a><div class='linenum'>76</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"[",bl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line77"></a><div class='linenum'>77</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(arr[&nbsp;l&nbsp;])&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line78"></a><div class='linenum'>78</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(bl,bl,"]"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line79"></a><div class='linenum'>79</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line80"></a><div class='linenum'>80</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;arr[&nbsp;l&nbsp;]&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line81"></a><div class='linenum'>81</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;if&nbsp;compact&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line82"></a><div class='linenum'>82</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;String(&nbsp;arr[&nbsp;l&nbsp;][&nbsp;k&nbsp;],&nbsp;max[k]&nbsp;+&nbsp;maxp&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line83"></a><div class='linenum'>83</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line84"></a><div class='linenum'>84</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;String(&nbsp;arr[&nbsp;l&nbsp;][&nbsp;k&nbsp;],&nbsp;max&nbsp;+&nbsp;maxp&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line85"></a><div class='linenum'>85</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line86"></a><div class='linenum'>86</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;if&nbsp;k&nbsp;=&nbsp;Length(&nbsp;arr[&nbsp;l&nbsp;]&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line87"></a><div class='linenum'>87</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;bl,"]"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line88"></a><div class='linenum'>88</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line89"></a><div class='linenum'>89</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;",&nbsp;"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line90"></a><div class='linenum'>90</div></td><td></td><td></td><td></td><td><span><tt>		&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line91"></a><div class='linenum'>91</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line92"></a><div class='linenum'>92</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line93"></a><div class='linenum'>93</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;l&nbsp;=&nbsp;Length(&nbsp;arr&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line94"></a><div class='linenum'>94</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;bl,"]\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line95"></a><div class='linenum'>95</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line96"></a><div class='linenum'>96</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;",\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line97"></a><div class='linenum'>97</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line98"></a><div class='linenum'>98</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line99"></a><div class='linenum'>99</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line100"></a><div class='linenum'>100</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line101"></a><div class='linenum'>101</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line102"></a><div class='linenum'>102</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line103"></a><div class='linenum'>103</div></td><td></td><td></td><td></td><td><span><tt>##########################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line104"></a><div class='linenum'>104</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line105"></a><div class='linenum'>105</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Display(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line106"></a><div class='linenum'>106</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line107"></a><div class='linenum'>107</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Display,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line108"></a><div class='linenum'>108</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line109"></a><div class='linenum'>109</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line110"></a><div class='linenum'>110</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;PrintArray&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line111"></a><div class='linenum'>111</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line112"></a><div class='linenum'>112</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line113"></a><div class='linenum'>113</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line114"></a><div class='linenum'>114</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line115"></a><div class='linenum'>115</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsGeneralizedCartanMatrix(&nbsp;&lt;A>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line116"></a><div class='linenum'>116</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line117"></a><div class='linenum'>117</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsGeneralizedCartanMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line118"></a><div class='linenum'>118</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line119"></a><div class='linenum'>119</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line120"></a><div class='linenum'>120</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;A&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line121"></a><div class='linenum'>121</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line122"></a><div class='linenum'>122</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;n,&nbsp;i,&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line123"></a><div class='linenum'>123</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line124"></a><div class='linenum'>124</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;A&nbsp;)&nbsp;&lt;>&nbsp;Length(&nbsp;A[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line125"></a><div class='linenum'>125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;A>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line126"></a><div class='linenum'>126</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line127"></a><div class='linenum'>127</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line128"></a><div class='linenum'>128</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Length(&nbsp;A&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line129"></a><div class='linenum'>129</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line130"></a><div class='linenum'>130</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;A[i][i]&nbsp;&lt;>&nbsp;2&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line131"></a><div class='linenum'>131</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line132"></a><div class='linenum'>132</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line133"></a><div class='linenum'>133</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line134"></a><div class='linenum'>134</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line135"></a><div class='linenum'>135</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;i+1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line136"></a><div class='linenum'>136</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(&nbsp;A[i][j]&nbsp;)&nbsp;or&nbsp;not&nbsp;IsInt(&nbsp;A[j][i]&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line137"></a><div class='linenum'>137</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;0&nbsp;&lt;&nbsp;A[i][j]&nbsp;or&nbsp;0&nbsp;&lt;&nbsp;A[j][i]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line138"></a><div class='linenum'>138</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line139"></a><div class='linenum'>139</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;(&nbsp;A[i][j]&nbsp;=&nbsp;0&nbsp;and&nbsp;A[j][i]&nbsp;&lt;>&nbsp;0&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line140"></a><div class='linenum'>140</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(&nbsp;A[j][i]&nbsp;=&nbsp;0&nbsp;and&nbsp;A[i][j]&nbsp;&lt;>&nbsp;0&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line141"></a><div class='linenum'>141</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line142"></a><div class='linenum'>142</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line143"></a><div class='linenum'>143</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line144"></a><div class='linenum'>144</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line145"></a><div class='linenum'>145</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line146"></a><div class='linenum'>146</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line147"></a><div class='linenum'>147</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line148"></a><div class='linenum'>148</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line149"></a><div class='linenum'>149</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line150"></a><div class='linenum'>150</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line151"></a><div class='linenum'>151</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsDiagonalMat(&lt;mat>)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line152"></a><div class='linenum'>152</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line153"></a><div class='linenum'>153</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsDiagonalMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line154"></a><div class='linenum'>154</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line155"></a><div class='linenum'>155</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line156"></a><div class='linenum'>156</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line157"></a><div class='linenum'>157</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;i,&nbsp;j,z;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line158"></a><div class='linenum'>158</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(mat)&nbsp;then&nbsp;return&nbsp;true;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line159"></a><div class='linenum'>159</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;z:=Zero(mat[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line160"></a><div class='linenum'>160</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;mat&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line161"></a><div class='linenum'>161</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;mat[i]&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line162"></a><div class='linenum'>162</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mat[i][j]&nbsp;&lt;>&nbsp;z&nbsp;and&nbsp;i&nbsp;&lt;>&nbsp;j&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line163"></a><div class='linenum'>163</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line164"></a><div class='linenum'>164</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line165"></a><div class='linenum'>165</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line166"></a><div class='linenum'>166</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line167"></a><div class='linenum'>167</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line168"></a><div class='linenum'>168</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line169"></a><div class='linenum'>169</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line170"></a><div class='linenum'>170</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;IsDiagonalMat,&nbsp;[&nbsp;IsEmpty&nbsp;],&nbsp;ReturnTrue&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line171"></a><div class='linenum'>171</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line172"></a><div class='linenum'>172</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line173"></a><div class='linenum'>173</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line174"></a><div class='linenum'>174</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line175"></a><div class='linenum'>175</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsUpperTriangularMat(&lt;mat>)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line176"></a><div class='linenum'>176</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line177"></a><div class='linenum'>177</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsUpperTriangularMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line178"></a><div class='linenum'>178</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line179"></a><div class='linenum'>179</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line180"></a><div class='linenum'>180</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line181"></a><div class='linenum'>181</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;i,&nbsp;j,z;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line182"></a><div class='linenum'>182</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(mat)&nbsp;then&nbsp;return&nbsp;true;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line183"></a><div class='linenum'>183</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;z:=Zero(mat[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line184"></a><div class='linenum'>184</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;mat&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line185"></a><div class='linenum'>185</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;i-1]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line186"></a><div class='linenum'>186</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mat[i][j]&nbsp;&lt;>&nbsp;z&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line187"></a><div class='linenum'>187</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line188"></a><div class='linenum'>188</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line189"></a><div class='linenum'>189</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line190"></a><div class='linenum'>190</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line191"></a><div class='linenum'>191</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line192"></a><div class='linenum'>192</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line193"></a><div class='linenum'>193</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line194"></a><div class='linenum'>194</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line195"></a><div class='linenum'>195</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line196"></a><div class='linenum'>196</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsLowerTriangularMat(&lt;mat>)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line197"></a><div class='linenum'>197</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line198"></a><div class='linenum'>198</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsLowerTriangularMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line199"></a><div class='linenum'>199</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line200"></a><div class='linenum'>200</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line201"></a><div class='linenum'>201</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line202"></a><div class='linenum'>202</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;i,&nbsp;j,z;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line203"></a><div class='linenum'>203</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(mat)&nbsp;then&nbsp;return&nbsp;true;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line204"></a><div class='linenum'>204</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;z:=Zero(mat[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line205"></a><div class='linenum'>205</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;mat&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line206"></a><div class='linenum'>206</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[&nbsp;i+1&nbsp;..&nbsp;Length(&nbsp;mat[i]&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line207"></a><div class='linenum'>207</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mat[i][j]&nbsp;&lt;>&nbsp;z&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line208"></a><div class='linenum'>208</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line209"></a><div class='linenum'>209</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line210"></a><div class='linenum'>210</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line211"></a><div class='linenum'>211</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line212"></a><div class='linenum'>212</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line213"></a><div class='linenum'>213</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line214"></a><div class='linenum'>214</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line215"></a><div class='linenum'>215</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line216"></a><div class='linenum'>216</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line217"></a><div class='linenum'>217</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DiagonalOfMat(&lt;mat>)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;diagonal&nbsp;of&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line218"></a><div class='linenum'>218</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line219"></a><div class='linenum'>219</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;DiagonalOfMat,&nbsp;function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line220"></a><div class='linenum'>220</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;diag,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line221"></a><div class='linenum'>221</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line222"></a><div class='linenum'>222</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;diag&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line223"></a><div class='linenum'>223</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line224"></a><div class='linenum'>224</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;i&nbsp;&lt;=&nbsp;Length(mat)&nbsp;and&nbsp;i&nbsp;&lt;=&nbsp;Length(mat[1])&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line225"></a><div class='linenum'>225</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diag[i]&nbsp;:=&nbsp;mat[i][i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line226"></a><div class='linenum'>226</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line227"></a><div class='linenum'>227</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line228"></a><div class='linenum'>228</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;1&nbsp;&lt;=&nbsp;Length(mat)&nbsp;and&nbsp;i&nbsp;&lt;=&nbsp;Length(mat[1])&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line229"></a><div class='linenum'>229</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diag[i]&nbsp;:=&nbsp;mat[1][1]&nbsp;-&nbsp;mat[1][1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line230"></a><div class='linenum'>230</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line231"></a><div class='linenum'>231</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line232"></a><div class='linenum'>232</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;diag;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line233"></a><div class='linenum'>233</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line234"></a><div class='linenum'>234</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line235"></a><div class='linenum'>235</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line236"></a><div class='linenum'>236</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line237"></a><div class='linenum'>237</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line238"></a><div class='linenum'>238</div></td><td></td><td></td><td></td><td><span><tt>#R&nbsp;&nbsp;IsNullMapMatrix&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;null&nbsp;map&nbsp;as&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line239"></a><div class='linenum'>239</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line240"></a><div class='linenum'>240</div></td><td></td><td></td><td></td><td><span><tt>DeclareRepresentation(&nbsp;"IsNullMapMatrix",&nbsp;IsMatrix,&nbsp;[&nbsp;&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line241"></a><div class='linenum'>241</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line242"></a><div class='linenum'>242</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal(&nbsp;"NullMapMatrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line243"></a><div class='linenum'>243</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Objectify(&nbsp;NewType(&nbsp;ListsFamily,&nbsp;IsNullMapMatrix&nbsp;),&nbsp;[&nbsp;&nbsp;]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line244"></a><div class='linenum'>244</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line245"></a><div class='linenum'>245</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Length,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line246"></a><div class='linenum'>246</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line247"></a><div class='linenum'>247</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line248"></a><div class='linenum'>248</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;null&nbsp;->&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line249"></a><div class='linenum'>249</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line250"></a><div class='linenum'>250</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsZero,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line251"></a><div class='linenum'>251</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line252"></a><div class='linenum'>252</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line253"></a><div class='linenum'>253</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;true);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line254"></a><div class='linenum'>254</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line255"></a><div class='linenum'>255</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ZERO,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line256"></a><div class='linenum'>256</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line257"></a><div class='linenum'>257</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line258"></a><div class='linenum'>258</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;null&nbsp;->&nbsp;null&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line259"></a><div class='linenum'>259</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line260"></a><div class='linenum'>260</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\+,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line261"></a><div class='linenum'>261</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;null&nbsp;map&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line262"></a><div class='linenum'>262</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix,&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line263"></a><div class='linenum'>263</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(null,null2)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line264"></a><div class='linenum'>264</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line265"></a><div class='linenum'>265</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line266"></a><div class='linenum'>266</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line267"></a><div class='linenum'>267</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AINV,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line268"></a><div class='linenum'>268</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line269"></a><div class='linenum'>269</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line270"></a><div class='linenum'>270</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;null&nbsp;->&nbsp;null&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line271"></a><div class='linenum'>271</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line272"></a><div class='linenum'>272</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AdditiveInverseOp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line273"></a><div class='linenum'>273</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line274"></a><div class='linenum'>274</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line275"></a><div class='linenum'>275</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;null&nbsp;->&nbsp;null&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line276"></a><div class='linenum'>276</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line277"></a><div class='linenum'>277</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line278"></a><div class='linenum'>278</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;null&nbsp;map&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line279"></a><div class='linenum'>279</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix,&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line280"></a><div class='linenum'>280</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(null,null2)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line281"></a><div class='linenum'>281</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line282"></a><div class='linenum'>282</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line283"></a><div class='linenum'>283</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line284"></a><div class='linenum'>284</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line285"></a><div class='linenum'>285</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;scalar&nbsp;and&nbsp;a&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line286"></a><div class='linenum'>286</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsScalar,&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line287"></a><div class='linenum'>287</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(s,null)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line288"></a><div class='linenum'>288</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line289"></a><div class='linenum'>289</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line290"></a><div class='linenum'>290</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line291"></a><div class='linenum'>291</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line292"></a><div class='linenum'>292</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;null&nbsp;map&nbsp;matrix&nbsp;and&nbsp;a&nbsp;scalar",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line293"></a><div class='linenum'>293</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix,&nbsp;IsScalar&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line294"></a><div class='linenum'>294</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(null,s)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line295"></a><div class='linenum'>295</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line296"></a><div class='linenum'>296</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line297"></a><div class='linenum'>297</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line298"></a><div class='linenum'>298</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line299"></a><div class='linenum'>299</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;vector&nbsp;and&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line300"></a><div class='linenum'>300</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsVector,&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line301"></a><div class='linenum'>301</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;v,&nbsp;null&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line302"></a><div class='linenum'>302</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line303"></a><div class='linenum'>303</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line304"></a><div class='linenum'>304</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line305"></a><div class='linenum'>305</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line306"></a><div class='linenum'>306</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;empty&nbsp;list&nbsp;and&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line307"></a><div class='linenum'>307</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;and&nbsp;IsEmpty,&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line308"></a><div class='linenum'>308</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;v,&nbsp;null&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line309"></a><div class='linenum'>309</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line310"></a><div class='linenum'>310</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line311"></a><div class='linenum'>311</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line312"></a><div class='linenum'>312</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line313"></a><div class='linenum'>313</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;matrix&nbsp;and&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line314"></a><div class='linenum'>314</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line315"></a><div class='linenum'>315</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;A,&nbsp;null&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line316"></a><div class='linenum'>316</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;A,&nbsp;row&nbsp;->&nbsp;[&nbsp;&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line317"></a><div class='linenum'>317</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line318"></a><div class='linenum'>318</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line319"></a><div class='linenum'>319</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line320"></a><div class='linenum'>320</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list&nbsp;and&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line321"></a><div class='linenum'>321</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line322"></a><div class='linenum'>322</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;A,&nbsp;null&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line323"></a><div class='linenum'>323</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;A,&nbsp;row&nbsp;->&nbsp;[&nbsp;&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line324"></a><div class='linenum'>324</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line325"></a><div class='linenum'>325</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line326"></a><div class='linenum'>326</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ViewObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line327"></a><div class='linenum'>327</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line328"></a><div class='linenum'>328</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line329"></a><div class='linenum'>329</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;null&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line330"></a><div class='linenum'>330</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"&lt;null&nbsp;map>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line331"></a><div class='linenum'>331</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line332"></a><div class='linenum'>332</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line333"></a><div class='linenum'>333</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PrintObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line334"></a><div class='linenum'>334</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;null&nbsp;map&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line335"></a><div class='linenum'>335</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNullMapMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line336"></a><div class='linenum'>336</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;null&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line337"></a><div class='linenum'>337</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"NullMapMatrix"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line338"></a><div class='linenum'>338</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line339"></a><div class='linenum'>339</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line340"></a><div class='linenum'>340</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line341"></a><div class='linenum'>341</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line342"></a><div class='linenum'>342</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;Matrix_OrderPolynomialInner(&nbsp;&lt;fld>,&nbsp;&lt;mat>,&nbsp;&lt;vec>,&nbsp;&lt;spannedspace>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line343"></a><div class='linenum'>343</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line344"></a><div class='linenum'>344</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Returns&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;the&nbsp;order&nbsp;polynomial&nbsp;of&nbsp;&lt;mat>&nbsp;at&nbsp;&lt;vec>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line345"></a><div class='linenum'>345</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;modulo&nbsp;&lt;spannedspace>.&nbsp;No&nbsp;conversions&nbsp;are&nbsp;attempted&nbsp;on&nbsp;&lt;mat>&nbsp;or
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line346"></a><div class='linenum'>346</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&lt;vec>,&nbsp;which&nbsp;should&nbsp;usually&nbsp;be&nbsp;immutable&nbsp;and&nbsp;compressed&nbsp;for&nbsp;best
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line347"></a><div class='linenum'>347</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;results.&nbsp;&lt;spannedspace>&nbsp;should&nbsp;be&nbsp;a&nbsp;semi-echelonized&nbsp;basis,&nbsp;stored
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line348"></a><div class='linenum'>348</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;as&nbsp;a&nbsp;list&nbsp;with&nbsp;holes&nbsp;with&nbsp;the&nbsp;vector&nbsp;with&nbsp;pivot&nbsp;&lt;i>&nbsp;in&nbsp;position&nbsp;&lt;i>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line349"></a><div class='linenum'>349</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Vectors&nbsp;are&nbsp;added&nbsp;to&nbsp;&lt;spannedspace>&nbsp;so&nbsp;that&nbsp;it&nbsp;also&nbsp;spans&nbsp;all&nbsp;the&nbsp;images
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line350"></a><div class='linenum'>350</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;of&nbsp;&lt;vec>&nbsp;under&nbsp;the&nbsp;algebra&nbsp;generated&nbsp;by&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line351"></a><div class='linenum'>351</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line352"></a><div class='linenum'>352</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;result,&nbsp;and&nbsp;any&nbsp;vectors&nbsp;added&nbsp;to&nbsp;&lt;spannedspace>&nbsp;are&nbsp;compressed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line353"></a><div class='linenum'>353</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;immutable
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line354"></a><div class='linenum'>354</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line355"></a><div class='linenum'>355</div></td><td></td><td></td><td></td><td><span><tt>#N&nbsp;&nbsp;In&nbsp;characteristic&nbsp;zero,&nbsp;or&nbsp;for&nbsp;structured&nbsp;sparse&nbsp;matrices,&nbsp;the&nbsp;naive
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line356"></a><div class='linenum'>356</div></td><td></td><td></td><td></td><td><span><tt>#N&nbsp;&nbsp;Gaussian&nbsp;elimination&nbsp;here&nbsp;may&nbsp;not&nbsp;be&nbsp;optimal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line357"></a><div class='linenum'>357</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line358"></a><div class='linenum'>358</div></td><td></td><td></td><td></td><td><span><tt>#N&nbsp;&nbsp;Shift&nbsp;to&nbsp;using&nbsp;ClearRow&nbsp;once&nbsp;we&nbsp;have&nbsp;kernel&nbsp;methods&nbsp;that&nbsp;give&nbsp;a
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line359"></a><div class='linenum'>359</div></td><td></td><td></td><td></td><td><span><tt>#N&nbsp;&nbsp;performance&nbsp;benefit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line360"></a><div class='linenum'>360</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line361"></a><div class='linenum'>361</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal(&nbsp;"Matrix_OrderPolynomialInner",&nbsp;function(&nbsp;fld,&nbsp;mat,&nbsp;vec,&nbsp;vecs)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line362"></a><div class='linenum'>362</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;d,&nbsp;w,&nbsp;p,&nbsp;one,&nbsp;zero,&nbsp;zeroes,&nbsp;piv,&nbsp;&nbsp;pols,&nbsp;x,&nbsp;t;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line363"></a><div class='linenum'>363</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoMatrix,2,"Order&nbsp;Polynomial&nbsp;Inner&nbsp;on&nbsp;",Length(mat[1]),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line364"></a><div class='linenum'>364</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;x&nbsp;",Length(mat),"&nbsp;matrix&nbsp;over&nbsp;",fld,"&nbsp;with&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line365"></a><div class='linenum'>365</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number(vecs),"&nbsp;basis&nbsp;vectors&nbsp;already&nbsp;given");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line366"></a><div class='linenum'>366</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;Length(vec);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line367"></a><div class='linenum'>367</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pols&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line368"></a><div class='linenum'>368</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;:=&nbsp;One(fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line369"></a><div class='linenum'>369</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line370"></a><div class='linenum'>370</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zeroes&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line371"></a><div class='linenum'>371</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line372"></a><div class='linenum'>372</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;this&nbsp;loop&nbsp;runs&nbsp;images&nbsp;of&nbsp;&lt;vec>&nbsp;under&nbsp;powers&nbsp;of&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line373"></a><div class='linenum'>373</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trying&nbsp;to&nbsp;reduce&nbsp;them&nbsp;with&nbsp;smaller&nbsp;powers&nbsp;(and&nbsp;tracking&nbsp;the&nbsp;polynomial)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line374"></a><div class='linenum'>374</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;or&nbsp;with&nbsp;vectors&nbsp;from&nbsp;&lt;spannedspace>&nbsp;as&nbsp;passed&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line375"></a><div class='linenum'>375</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;when&nbsp;we&nbsp;succeed,&nbsp;we&nbsp;know&nbsp;the&nbsp;order&nbsp;polynomial
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line376"></a><div class='linenum'>376</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line377"></a><div class='linenum'>377</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line378"></a><div class='linenum'>378</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;ShallowCopy(vec);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line379"></a><div class='linenum'>379</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;ShallowCopy(zeroes);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line380"></a><div class='linenum'>380</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(p,one);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line381"></a><div class='linenum'>381</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(p,fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line382"></a><div class='linenum'>382</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;piv&nbsp;:=&nbsp;PositionNot(w,zero,0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line383"></a><div class='linenum'>383</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line384"></a><div class='linenum'>384</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line385"></a><div class='linenum'>385</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Strip&nbsp;as&nbsp;far&nbsp;as&nbsp;we&nbsp;can
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line386"></a><div class='linenum'>386</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line387"></a><div class='linenum'>387</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line388"></a><div class='linenum'>388</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;piv&nbsp;&lt;=&nbsp;d&nbsp;and&nbsp;IsBound(vecs[piv])&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line389"></a><div class='linenum'>389</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;-w[piv];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line390"></a><div class='linenum'>390</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(pols[piv])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line391"></a><div class='linenum'>391</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddCoeffs(p,&nbsp;pols[piv],&nbsp;x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line392"></a><div class='linenum'>392</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line393"></a><div class='linenum'>393</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(w,&nbsp;vecs[piv],&nbsp;&nbsp;x,&nbsp;piv,&nbsp;d);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line394"></a><div class='linenum'>394</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;piv&nbsp;:=&nbsp;PositionNot(w,zero,piv);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line395"></a><div class='linenum'>395</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line396"></a><div class='linenum'>396</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line397"></a><div class='linenum'>397</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line398"></a><div class='linenum'>398</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;something&nbsp;is&nbsp;left&nbsp;then&nbsp;we&nbsp;don't&nbsp;have&nbsp;the&nbsp;order&nbsp;poly&nbsp;yet
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line399"></a><div class='linenum'>399</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;update&nbsp;tables&nbsp;etc.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line400"></a><div class='linenum'>400</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line401"></a><div class='linenum'>401</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line402"></a><div class='linenum'>402</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;piv&nbsp;&lt;=d&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line403"></a><div class='linenum'>403</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;Inverse(w[piv]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line404"></a><div class='linenum'>404</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(p,&nbsp;x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line405"></a><div class='linenum'>405</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MakeImmutable(p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line406"></a><div class='linenum'>406</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pols[piv]&nbsp;:=&nbsp;p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line407"></a><div class='linenum'>407</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(w,&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line408"></a><div class='linenum'>408</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MakeImmutable(w);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line409"></a><div class='linenum'>409</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vecs[piv]&nbsp;:=&nbsp;w;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line410"></a><div class='linenum'>410</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec&nbsp;:=&nbsp;vec*mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line411"></a><div class='linenum'>411</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(zeroes,zero);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line412"></a><div class='linenum'>412</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line413"></a><div class='linenum'>413</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;piv&nbsp;>&nbsp;d;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line414"></a><div class='linenum'>414</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;MakeImmutable(p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line415"></a><div class='linenum'>415</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoMatrix,2,"Order&nbsp;Polynomial&nbsp;returns&nbsp;",p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line416"></a><div class='linenum'>416</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line417"></a><div class='linenum'>417</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line418"></a><div class='linenum'>418</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line419"></a><div class='linenum'>419</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line420"></a><div class='linenum'>420</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line421"></a><div class='linenum'>421</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;Matrix_OrderPolynomialSameField(&nbsp;&lt;fld>,&nbsp;&lt;mat>,&nbsp;&lt;vec>,&nbsp;&lt;ind>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line422"></a><div class='linenum'>422</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line423"></a><div class='linenum'>423</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Compute&nbsp;the&nbsp;order&nbsp;polynomial,&nbsp;all&nbsp;the&nbsp;work&nbsp;is&nbsp;done&nbsp;in&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line424"></a><div class='linenum'>424</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;routine&nbsp;above
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line425"></a><div class='linenum'>425</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line426"></a><div class='linenum'>426</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal(&nbsp;"Matrix_OrderPolynomialSameField",&nbsp;function(&nbsp;fld,&nbsp;mat,&nbsp;vec,&nbsp;ind&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line427"></a><div class='linenum'>427</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;imat,&nbsp;ivec,&nbsp;coeffs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line428"></a><div class='linenum'>428</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;imat:=ImmutableMatrix(fld,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line429"></a><div class='linenum'>429</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ivec&nbsp;:=&nbsp;Immutable(vec);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line430"></a><div class='linenum'>430</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(ivec,&nbsp;fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line431"></a><div class='linenum'>431</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;coeffs&nbsp;:=&nbsp;Matrix_OrderPolynomialInner(&nbsp;fld,&nbsp;imat,&nbsp;ivec,&nbsp;[]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line432"></a><div class='linenum'>432</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;UnivariatePolynomialByCoefficients(ElementsFamily(FamilyObj(fld)),&nbsp;coeffs,&nbsp;ind&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line433"></a><div class='linenum'>433</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line434"></a><div class='linenum'>434</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line435"></a><div class='linenum'>435</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line436"></a><div class='linenum'>436</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line437"></a><div class='linenum'>437</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line438"></a><div class='linenum'>438</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;Matrix_CharacteristicPolynomialSameField(&nbsp;&lt;fld>,&nbsp;&lt;mat>,&nbsp;&lt;ind>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line439"></a><div class='linenum'>439</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line440"></a><div class='linenum'>440</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal(&nbsp;"Matrix_CharacteristicPolynomialSameField",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line441"></a><div class='linenum'>441</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;fld,&nbsp;mat,&nbsp;ind)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line442"></a><div class='linenum'>442</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;n,&nbsp;ords,&nbsp;base,&nbsp;imat,&nbsp;vec,&nbsp;one,cp,op,zero,fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line443"></a><div class='linenum'>443</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoMatrix,1,"Characteristic&nbsp;Polynomial&nbsp;called&nbsp;on&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line444"></a><div class='linenum'>444</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Length(mat[1]),"&nbsp;x&nbsp;",Length(mat),"&nbsp;matrix&nbsp;over&nbsp;",fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line445"></a><div class='linenum'>445</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;imat&nbsp;:=&nbsp;ImmutableMatrix(fld,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line446"></a><div class='linenum'>446</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line447"></a><div class='linenum'>447</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line448"></a><div class='linenum'>448</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;vec&nbsp;:=&nbsp;ZeroOp(mat[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line449"></a><div class='linenum'>449</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;:=&nbsp;One(fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line450"></a><div class='linenum'>450</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line451"></a><div class='linenum'>451</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fam&nbsp;:=&nbsp;ElementsFamily(FamilyObj(fld));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line452"></a><div class='linenum'>452</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;cp:=[one];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line453"></a><div class='linenum'>453</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Is8BitMatrixRep(mat)&nbsp;and&nbsp;Length(mat)>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line454"></a><div class='linenum'>454</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;stay&nbsp;in&nbsp;the&nbsp;same&nbsp;field&nbsp;as&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line455"></a><div class='linenum'>455</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(cp,Q_VEC8BIT(mat[1]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line456"></a><div class='linenum'>456</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line457"></a><div class='linenum'>457</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;cp&nbsp;:=&nbsp;UnivariatePolynomialByCoefficients(fam,cp,ind);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line458"></a><div class='linenum'>458</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line459"></a><div class='linenum'>459</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(base[i])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line460"></a><div class='linenum'>460</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec[i]&nbsp;:=&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line461"></a><div class='linenum'>461</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;:=&nbsp;Matrix_OrderPolynomialInner(&nbsp;fld,&nbsp;imat,&nbsp;vec,&nbsp;base);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line462"></a><div class='linenum'>462</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp&nbsp;:=&nbsp;cp&nbsp;*&nbsp;&nbsp;UnivariatePolynomialByCoefficients(&nbsp;fam,op,ind);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line463"></a><div class='linenum'>463</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec[i]&nbsp;:=&nbsp;zero;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line464"></a><div class='linenum'>464</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line465"></a><div class='linenum'>465</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line466"></a><div class='linenum'>466</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Assert(3,&nbsp;IsZero(Value(cp,imat)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line467"></a><div class='linenum'>467</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Assert(2,&nbsp;Length(CoefficientsOfUnivariatePolynomial(cp))&nbsp;=&nbsp;n+1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line468"></a><div class='linenum'>468</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoMatrix,1,"Characteristic&nbsp;Polynomial&nbsp;returns&nbsp;",&nbsp;cp);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line469"></a><div class='linenum'>469</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line470"></a><div class='linenum'>470</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line471"></a><div class='linenum'>471</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line472"></a><div class='linenum'>472</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line473"></a><div class='linenum'>473</div></td><td></td><td></td><td></td><td><span><tt>##########################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line474"></a><div class='linenum'>474</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line475"></a><div class='linenum'>475</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;Matrix_MinimalPolynomialSameField(&nbsp;&lt;fld>,&nbsp;&lt;mat>,&nbsp;&lt;ind>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line476"></a><div class='linenum'>476</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line477"></a><div class='linenum'>477</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal(&nbsp;"Matrix_MinimalPolynomialSameField",&nbsp;function(&nbsp;fld,&nbsp;mat,&nbsp;ind&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line478"></a><div class='linenum'>478</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;n,&nbsp;ords,&nbsp;base,&nbsp;imat,&nbsp;vec,&nbsp;one,cp,zero,&nbsp;fam,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line479"></a><div class='linenum'>479</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processVec,&nbsp;mp,&nbsp;dim,&nbsp;span,op,w,&nbsp;piv,j,ring;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line480"></a><div class='linenum'>480</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line481"></a><div class='linenum'>481</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoMatrix,1,"Minimal&nbsp;Polynomial&nbsp;called&nbsp;on&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line482"></a><div class='linenum'>482</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Length(mat[1]),"&nbsp;x&nbsp;",Length(mat),"&nbsp;matrix&nbsp;over&nbsp;",fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line483"></a><div class='linenum'>483</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;imat&nbsp;:=&nbsp;ImmutableMatrix(fld,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line484"></a><div class='linenum'>484</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;Length(imat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line485"></a><div class='linenum'>485</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line486"></a><div class='linenum'>486</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;dim&nbsp;:=&nbsp;0;&nbsp;#&nbsp;should&nbsp;be&nbsp;number&nbsp;of&nbsp;bound&nbsp;positions&nbsp;in&nbsp;base
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line487"></a><div class='linenum'>487</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;:=&nbsp;One(fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line488"></a><div class='linenum'>488</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line489"></a><div class='linenum'>489</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fam&nbsp;:=&nbsp;ElementsFamily(FamilyObj(fld));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line490"></a><div class='linenum'>490</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mp:=[one];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line491"></a><div class='linenum'>491</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Is8BitMatrixRep(mat)&nbsp;and&nbsp;Length(mat)>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line492"></a><div class='linenum'>492</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;stay&nbsp;in&nbsp;the&nbsp;same&nbsp;field&nbsp;as&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line493"></a><div class='linenum'>493</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(mp,Q_VEC8BIT(mat[1]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line494"></a><div class='linenum'>494</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line495"></a><div class='linenum'>495</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#keep&nbsp;coeffs
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line496"></a><div class='linenum'>496</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#mp&nbsp;:=&nbsp;UnivariatePolynomialByCoefficients(&nbsp;fam,&nbsp;mp,ind);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line497"></a><div class='linenum'>497</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;dim&nbsp;&lt;&nbsp;n&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line498"></a><div class='linenum'>498</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec&nbsp;:=&nbsp;ShallowCopy(mat[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line499"></a><div class='linenum'>499</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line500"></a><div class='linenum'>500</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Add(vec,Random([one,zero]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line501"></a><div class='linenum'>501</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec[i]:=Random([one,zero]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line502"></a><div class='linenum'>502</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line503"></a><div class='linenum'>503</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec[Random([1..n])]&nbsp;:=&nbsp;one;&nbsp;#&nbsp;make&nbsp;sure&nbsp;it's&nbsp;not&nbsp;zero
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line504"></a><div class='linenum'>504</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ConvertToVectorRepNC(vec,fld);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line505"></a><div class='linenum'>505</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MakeImmutable(vec);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line506"></a><div class='linenum'>506</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;span&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line507"></a><div class='linenum'>507</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;:=&nbsp;Matrix_OrderPolynomialInner(&nbsp;fld,&nbsp;imat,&nbsp;vec,&nbsp;span);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line508"></a><div class='linenum'>508</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#op&nbsp;:=&nbsp;UnivariatePolynomialByCoefficients(fam,&nbsp;op,&nbsp;ind);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line509"></a><div class='linenum'>509</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#mp&nbsp;:=&nbsp;Lcm(mp,&nbsp;op);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line510"></a><div class='linenum'>510</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;this&nbsp;command&nbsp;takes&nbsp;much&nbsp;time&nbsp;since&nbsp;a&nbsp;polynomial&nbsp;ring&nbsp;is&nbsp;created.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line511"></a><div class='linenum'>511</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Instead&nbsp;use&nbsp;the&nbsp;quick&nbsp;gcd-based&nbsp;method&nbsp;(avoiding&nbsp;the&nbsp;dispatcher):
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line512"></a><div class='linenum'>512</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#mp&nbsp;:=&nbsp;(mp*op)/GcdOp(mp,&nbsp;op);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line513"></a><div class='linenum'>513</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#mp:=mp/LeadingCoefficient(mp);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line514"></a><div class='linenum'>514</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp:=QUOTREM_LAURPOLS_LISTS(ProductCoeffs(mp,op),GcdCoeffs(mp,op))[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line515"></a><div class='linenum'>515</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp:=mp/mp[Length(mp)];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line516"></a><div class='linenum'>516</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line517"></a><div class='linenum'>517</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..Length(span)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line518"></a><div class='linenum'>518</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(span[j])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line519"></a><div class='linenum'>519</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;dim&nbsp;&lt;&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line520"></a><div class='linenum'>520</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(base[j])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line521"></a><div class='linenum'>521</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base[j]&nbsp;:=&nbsp;span[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line522"></a><div class='linenum'>522</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim&nbsp;:=&nbsp;dim+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line523"></a><div class='linenum'>523</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line524"></a><div class='linenum'>524</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;ShallowCopy(span[j]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line525"></a><div class='linenum'>525</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;piv&nbsp;:=&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line526"></a><div class='linenum'>526</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line527"></a><div class='linenum'>527</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(w,base[piv],-w[piv],&nbsp;piv,&nbsp;n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line528"></a><div class='linenum'>528</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;piv&nbsp;:=&nbsp;PositionNot(w,&nbsp;zero,&nbsp;piv);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line529"></a><div class='linenum'>529</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;piv&nbsp;>&nbsp;n&nbsp;or&nbsp;not&nbsp;IsBound(base[piv]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line530"></a><div class='linenum'>530</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;piv&nbsp;&lt;=&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line531"></a><div class='linenum'>531</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(w,Inverse(w[piv]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line532"></a><div class='linenum'>532</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MakeImmutable(w);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line533"></a><div class='linenum'>533</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base[piv]&nbsp;:=&nbsp;w;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line534"></a><div class='linenum'>534</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim&nbsp;:=&nbsp;dim+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line535"></a><div class='linenum'>535</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line536"></a><div class='linenum'>536</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line537"></a><div class='linenum'>537</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line538"></a><div class='linenum'>538</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line539"></a><div class='linenum'>539</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line540"></a><div class='linenum'>540</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line541"></a><div class='linenum'>541</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mp&nbsp;:=&nbsp;UnivariatePolynomialByCoefficients(&nbsp;fam,&nbsp;mp,ind);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line542"></a><div class='linenum'>542</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Assert(3,&nbsp;IsZero(Value(mp,imat)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line543"></a><div class='linenum'>543</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoMatrix,1,"Minimal&nbsp;Polynomial&nbsp;returns&nbsp;",&nbsp;mp);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line544"></a><div class='linenum'>544</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line545"></a><div class='linenum'>545</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line546"></a><div class='linenum'>546</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line547"></a><div class='linenum'>547</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line548"></a><div class='linenum'>548</div></td><td></td><td></td><td></td><td><span><tt>##########################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line549"></a><div class='linenum'>549</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line550"></a><div class='linenum'>550</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Display(&nbsp;&lt;ffe-mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line551"></a><div class='linenum'>551</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line552"></a><div class='linenum'>552</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Display,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line553"></a><div class='linenum'>553</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;matrix&nbsp;of&nbsp;FFEs",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line554"></a><div class='linenum'>554</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsFFECollColl&nbsp;and&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line555"></a><div class='linenum'>555</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line556"></a><div class='linenum'>556</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;deg,&nbsp;&nbsp;chr,&nbsp;&nbsp;zero,&nbsp;&nbsp;w,&nbsp;&nbsp;t,&nbsp;&nbsp;x,&nbsp;&nbsp;v,&nbsp;&nbsp;f,&nbsp;&nbsp;z,&nbsp;&nbsp;y;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line557"></a><div class='linenum'>557</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line558"></a><div class='linenum'>558</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(m[1])&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line559"></a><div class='linenum'>559</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line560"></a><div class='linenum'>560</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line561"></a><div class='linenum'>561</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;IsZmodnZObj(m[1][1])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line562"></a><div class='linenum'>562</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;this&nbsp;case&nbsp;mostly&nbsp;applies&nbsp;to&nbsp;large&nbsp;characteristic,&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line563"></a><div class='linenum'>563</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;which&nbsp;the&nbsp;regular&nbsp;code&nbsp;for&nbsp;FFE&nbsp;elements&nbsp;does&nbsp;not&nbsp;work
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line564"></a><div class='linenum'>564</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(e.g.&nbsp;it&nbsp;tries&nbsp;to&nbsp;create&nbsp;the&nbsp;range&nbsp;[2..chr],&nbsp;which
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line565"></a><div class='linenum'>565</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;means&nbsp;chr&nbsp;may&nbsp;be&nbsp;at&nbsp;most&nbsp;2^28&nbsp;resp.&nbsp;2^60).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line566"></a><div class='linenum'>566</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print("ZmodnZ&nbsp;matrix:\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line567"></a><div class='linenum'>567</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:=List(m,i->List(i,i->i![1]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line568"></a><div class='linenum'>568</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Display(t);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line569"></a><div class='linenum'>569</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print("modulo&nbsp;",Characteristic(m[1][1]),"\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line570"></a><div class='linenum'>570</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line571"></a><div class='linenum'>571</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;degree&nbsp;and&nbsp;characteristic
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line572"></a><div class='linenum'>572</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deg&nbsp;&nbsp;:=&nbsp;Lcm(&nbsp;List(&nbsp;m,&nbsp;DegreeFFE&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line573"></a><div class='linenum'>573</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chr&nbsp;&nbsp;:=&nbsp;Characteristic(m[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line574"></a><div class='linenum'>574</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(m[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line575"></a><div class='linenum'>575</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line576"></a><div class='linenum'>576</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;it&nbsp;is&nbsp;a&nbsp;finite&nbsp;prime&nbsp;field,&nbsp;&nbsp;use&nbsp;integers&nbsp;for&nbsp;display
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line577"></a><div class='linenum'>577</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;deg&nbsp;=&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line578"></a><div class='linenum'>578</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line579"></a><div class='linenum'>579</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;maximal&nbsp;width
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line580"></a><div class='linenum'>580</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;LogInt(&nbsp;chr,&nbsp;10&nbsp;)&nbsp;+&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line581"></a><div class='linenum'>581</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line582"></a><div class='linenum'>582</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;create&nbsp;strings
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line583"></a><div class='linenum'>583</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line584"></a><div class='linenum'>584</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;chr&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line585"></a><div class='linenum'>585</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t[x]&nbsp;:=&nbsp;String(&nbsp;x-1,&nbsp;w&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line586"></a><div class='linenum'>586</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line587"></a><div class='linenum'>587</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;useful&nbsp;only&nbsp;for&nbsp;(very)&nbsp;small&nbsp;characteristic,&nbsp;or?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line588"></a><div class='linenum'>588</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t[1]&nbsp;:=&nbsp;String(&nbsp;".",&nbsp;w&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line589"></a><div class='linenum'>589</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line590"></a><div class='linenum'>590</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line591"></a><div class='linenum'>591</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;&nbsp;in&nbsp;m&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line592"></a><div class='linenum'>592</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;&nbsp;in&nbsp;List(&nbsp;v,&nbsp;IntFFE&nbsp;)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line593"></a><div class='linenum'>593</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line594"></a><div class='linenum'>594</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;t[x+1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line595"></a><div class='linenum'>595</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line596"></a><div class='linenum'>596</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line597"></a><div class='linenum'>597</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line598"></a><div class='linenum'>598</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line599"></a><div class='linenum'>599</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;it&nbsp;a&nbsp;finite,&nbsp;&nbsp;use&nbsp;mixed&nbsp;integers/z&nbsp;notation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line600"></a><div class='linenum'>600</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;...
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line601"></a><div class='linenum'>601</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line602"></a><div class='linenum'>602</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"z&nbsp;=&nbsp;Z(",&nbsp;chr^deg,&nbsp;")\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line603"></a><div class='linenum'>603</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line604"></a><div class='linenum'>604</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;maximal&nbsp;width
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line605"></a><div class='linenum'>605</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;LogInt(&nbsp;chr^deg-1,&nbsp;10&nbsp;)&nbsp;+&nbsp;4;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line606"></a><div class='linenum'>606</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line607"></a><div class='linenum'>607</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;create&nbsp;strings
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line608"></a><div class='linenum'>608</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line609"></a><div class='linenum'>609</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;GF(chr^deg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line610"></a><div class='linenum'>610</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;Z(chr^deg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line611"></a><div class='linenum'>611</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;&nbsp;in&nbsp;[&nbsp;0&nbsp;..&nbsp;Size(f)-2&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line612"></a><div class='linenum'>612</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;z^x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line613"></a><div class='linenum'>613</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;DegreeFFE(y)&nbsp;=&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line614"></a><div class='linenum'>614</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t[x+2]&nbsp;:=&nbsp;String(&nbsp;IntFFE(y),&nbsp;w&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line615"></a><div class='linenum'>615</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line616"></a><div class='linenum'>616</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line617"></a><div class='linenum'>617</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t[x+2]&nbsp;:=&nbsp;String(Concatenation("z^",String(x)),w);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line618"></a><div class='linenum'>618</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line619"></a><div class='linenum'>619</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line620"></a><div class='linenum'>620</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t[1]&nbsp;:=&nbsp;String(&nbsp;".",&nbsp;w&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line621"></a><div class='linenum'>621</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line622"></a><div class='linenum'>622</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line623"></a><div class='linenum'>623</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;&nbsp;in&nbsp;m&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line624"></a><div class='linenum'>624</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;&nbsp;in&nbsp;v&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line625"></a><div class='linenum'>625</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;=&nbsp;zero&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line626"></a><div class='linenum'>626</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;t[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line627"></a><div class='linenum'>627</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line628"></a><div class='linenum'>628</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;t[LogFFE(x,z)+2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line629"></a><div class='linenum'>629</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line630"></a><div class='linenum'>630</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line631"></a><div class='linenum'>631</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line632"></a><div class='linenum'>632</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line633"></a><div class='linenum'>633</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line634"></a><div class='linenum'>634</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line635"></a><div class='linenum'>635</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line636"></a><div class='linenum'>636</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line637"></a><div class='linenum'>637</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line638"></a><div class='linenum'>638</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line639"></a><div class='linenum'>639</div></td><td></td><td></td><td></td><td><span><tt>##########################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line640"></a><div class='linenum'>640</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line641"></a><div class='linenum'>641</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Display(&nbsp;&lt;ZmodnZ-mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line642"></a><div class='linenum'>642</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line643"></a><div class='linenum'>643</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Display,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line644"></a><div class='linenum'>644</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;matrix&nbsp;over&nbsp;Integers&nbsp;mod&nbsp;n",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line645"></a><div class='linenum'>645</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsZmodnZObjNonprimeCollColl&nbsp;and&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line646"></a><div class='linenum'>646</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line647"></a><div class='linenum'>647</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"matrix&nbsp;over&nbsp;Integers&nbsp;mod&nbsp;",&nbsp;Characteristic(&nbsp;m[1][1]&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line648"></a><div class='linenum'>648</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;":\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line649"></a><div class='linenum'>649</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Display(&nbsp;List(&nbsp;m,&nbsp;i&nbsp;->&nbsp;List(&nbsp;i,&nbsp;i&nbsp;->&nbsp;i![1]&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line650"></a><div class='linenum'>650</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line651"></a><div class='linenum'>651</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line652"></a><div class='linenum'>652</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line653"></a><div class='linenum'>653</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line654"></a><div class='linenum'>654</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line655"></a><div class='linenum'>655</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CharacteristicPolynomial(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line656"></a><div class='linenum'>656</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line657"></a><div class='linenum'>657</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CharacteristicPolynomial,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line658"></a><div class='linenum'>658</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"supply&nbsp;field&nbsp;and&nbsp;indeterminate&nbsp;1",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line659"></a><div class='linenum'>659</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line660"></a><div class='linenum'>660</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;->&nbsp;CharacteristicPolynomialMatrixNC(&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line661"></a><div class='linenum'>661</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DefaultFieldOfMatrix(&nbsp;mat&nbsp;),&nbsp;mat,&nbsp;1&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line662"></a><div class='linenum'>662</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line663"></a><div class='linenum'>663</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line664"></a><div class='linenum'>664</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line665"></a><div class='linenum'>665</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line666"></a><div class='linenum'>666</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CharacteristicPolynomial(&nbsp;&lt;F>,&nbsp;&lt;E>,&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line667"></a><div class='linenum'>667</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line668"></a><div class='linenum'>668</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CharacteristicPolynomial,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line669"></a><div class='linenum'>669</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"supply&nbsp;indeterminate&nbsp;1",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line670"></a><div class='linenum'>670</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(famF,&nbsp;famE,&nbsp;fammat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line671"></a><div class='linenum'>671</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line672"></a><div class='linenum'>672</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasElementsFamily&nbsp;(fammat)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line673"></a><div class='linenum'>673</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fam&nbsp;:=&nbsp;ElementsFamily&nbsp;(fammat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line674"></a><div class='linenum'>674</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsIdenticalObj&nbsp;(famF,&nbsp;fam)&nbsp;and&nbsp;IsIdenticalObj&nbsp;(famE,&nbsp;fam);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line675"></a><div class='linenum'>675</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line676"></a><div class='linenum'>676</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line677"></a><div class='linenum'>677</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line678"></a><div class='linenum'>678</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsField,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line679"></a><div class='linenum'>679</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;F,&nbsp;E,&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line680"></a><div class='linenum'>680</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;CharacteristicPolynomial(&nbsp;F,&nbsp;E,&nbsp;mat,&nbsp;1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line681"></a><div class='linenum'>681</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line682"></a><div class='linenum'>682</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line683"></a><div class='linenum'>683</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line684"></a><div class='linenum'>684</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line685"></a><div class='linenum'>685</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line686"></a><div class='linenum'>686</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CharacteristicPolynomial(&nbsp;&lt;mat>,&nbsp;&lt;indnum>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line687"></a><div class='linenum'>687</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line688"></a><div class='linenum'>688</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CharacteristicPolynomial,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line689"></a><div class='linenum'>689</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"supply&nbsp;field",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line690"></a><div class='linenum'>690</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line691"></a><div class='linenum'>691</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat,&nbsp;indnum&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line692"></a><div class='linenum'>692</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;F;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line693"></a><div class='linenum'>693</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;:=&nbsp;DefaultFieldOfMatrix(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line694"></a><div class='linenum'>694</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;CharacteristicPolynomial(&nbsp;F,&nbsp;F,&nbsp;mat,&nbsp;indnum&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line695"></a><div class='linenum'>695</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line696"></a><div class='linenum'>696</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line697"></a><div class='linenum'>697</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line698"></a><div class='linenum'>698</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line699"></a><div class='linenum'>699</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line700"></a><div class='linenum'>700</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CharacteristicPolynomial(&nbsp;&lt;subfield>,&nbsp;&lt;field>,&nbsp;&lt;matrix>,&nbsp;&lt;indnum>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line701"></a><div class='linenum'>701</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line702"></a><div class='linenum'>702</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CharacteristicPolynomial,&nbsp;"spinning&nbsp;over&nbsp;field",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line703"></a><div class='linenum'>703</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(famF,&nbsp;famE,&nbsp;fammat,&nbsp;famid)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line704"></a><div class='linenum'>704</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line705"></a><div class='linenum'>705</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasElementsFamily&nbsp;(fammat)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line706"></a><div class='linenum'>706</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fam&nbsp;:=&nbsp;ElementsFamily&nbsp;(fammat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line707"></a><div class='linenum'>707</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsIdenticalObj&nbsp;(famF,&nbsp;fam)&nbsp;and&nbsp;IsIdenticalObj&nbsp;(famE,&nbsp;fam);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line708"></a><div class='linenum'>708</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line709"></a><div class='linenum'>709</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line710"></a><div class='linenum'>710</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line711"></a><div class='linenum'>711</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsField,&nbsp;IsOrdinaryMatrix,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line712"></a><div class='linenum'>712</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;F,&nbsp;E,&nbsp;mat,&nbsp;inum&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line713"></a><div class='linenum'>713</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fld,&nbsp;B;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line714"></a><div class='linenum'>714</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line715"></a><div class='linenum'>715</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsSubset&nbsp;(E,&nbsp;F)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line716"></a><div class='linenum'>716</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error&nbsp;("&lt;F>&nbsp;must&nbsp;be&nbsp;a&nbsp;subfield&nbsp;of&nbsp;&lt;E>.");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line717"></a><div class='linenum'>717</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;F&nbsp;&lt;>&nbsp;E&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line718"></a><div class='linenum'>718</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Replace&nbsp;the&nbsp;matrix&nbsp;by&nbsp;a&nbsp;matrix&nbsp;with&nbsp;the&nbsp;same&nbsp;char.&nbsp;polynomial
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line719"></a><div class='linenum'>719</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;but&nbsp;with&nbsp;entries&nbsp;in&nbsp;`F'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line720"></a><div class='linenum'>720</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B:=&nbsp;Basis(&nbsp;AsVectorSpace(&nbsp;F,&nbsp;E&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line721"></a><div class='linenum'>721</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;BlownUpMat(&nbsp;B,&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line722"></a><div class='linenum'>722</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line723"></a><div class='linenum'>723</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line724"></a><div class='linenum'>724</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;CharacteristicPolynomialMatrixNC(&nbsp;F,&nbsp;mat,&nbsp;inum);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line725"></a><div class='linenum'>725</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line726"></a><div class='linenum'>726</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line727"></a><div class='linenum'>727</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line728"></a><div class='linenum'>728</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CharacteristicPolynomialMatrixNC,&nbsp;"spinning&nbsp;over&nbsp;field",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line729"></a><div class='linenum'>729</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsElmsCollsX,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line730"></a><div class='linenum'>730</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsOrdinaryMatrix,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line731"></a><div class='linenum'>731</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;Matrix_CharacteristicPolynomialSameField);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line732"></a><div class='linenum'>732</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line733"></a><div class='linenum'>733</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line734"></a><div class='linenum'>734</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line735"></a><div class='linenum'>735</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line736"></a><div class='linenum'>736</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;MinimalPolynomial(&nbsp;&lt;field>,&nbsp;&lt;matrix>,&nbsp;&lt;indnum>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line737"></a><div class='linenum'>737</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line738"></a><div class='linenum'>738</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MinimalPolynomial,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line739"></a><div class='linenum'>739</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"spinning&nbsp;over&nbsp;field",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line740"></a><div class='linenum'>740</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsElmsCollsX,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line741"></a><div class='linenum'>741</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsOrdinaryMatrix,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line742"></a><div class='linenum'>742</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;F,&nbsp;mat,inum&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line743"></a><div class='linenum'>743</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fld,&nbsp;B;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line744"></a><div class='linenum'>744</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line745"></a><div class='linenum'>745</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fld:=&nbsp;DefaultFieldOfMatrix(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line746"></a><div class='linenum'>746</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line747"></a><div class='linenum'>747</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fld&nbsp;&lt;>&nbsp;fail&nbsp;and&nbsp;not&nbsp;IsSubset(&nbsp;F,&nbsp;fld&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line748"></a><div class='linenum'>748</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line749"></a><div class='linenum'>749</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Replace&nbsp;the&nbsp;matrix&nbsp;by&nbsp;a&nbsp;matrix&nbsp;with&nbsp;the&nbsp;same&nbsp;minimal&nbsp;polynomial
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line750"></a><div class='linenum'>750</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;but&nbsp;with&nbsp;entries&nbsp;in&nbsp;`F'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line751"></a><div class='linenum'>751</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsSubset(&nbsp;fld,&nbsp;F&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line752"></a><div class='linenum'>752</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fld:=&nbsp;ClosureField(&nbsp;fld,&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line753"></a><div class='linenum'>753</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line754"></a><div class='linenum'>754</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B:=&nbsp;Basis(&nbsp;AsField(&nbsp;F,&nbsp;fld&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line755"></a><div class='linenum'>755</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;BlownUpMat(&nbsp;B,&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line756"></a><div class='linenum'>756</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line757"></a><div class='linenum'>757</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line758"></a><div class='linenum'>758</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line759"></a><div class='linenum'>759</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;MinimalPolynomialMatrixNC(&nbsp;F,&nbsp;mat,inum);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line760"></a><div class='linenum'>760</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line761"></a><div class='linenum'>761</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line762"></a><div class='linenum'>762</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;MinimalPolynomial,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line763"></a><div class='linenum'>763</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"supply&nbsp;field",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line764"></a><div class='linenum'>764</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line765"></a><div class='linenum'>765</div></td><td></td><td></td><td></td><td><span><tt>function(m,n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line766"></a><div class='linenum'>766</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;MinimalPolynomial(&nbsp;DefaultFieldOfMatrix(&nbsp;m&nbsp;),&nbsp;m,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line767"></a><div class='linenum'>767</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line768"></a><div class='linenum'>768</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line769"></a><div class='linenum'>769</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;MinimalPolynomial,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line770"></a><div class='linenum'>770</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"supply&nbsp;field&nbsp;and&nbsp;indeterminate&nbsp;1",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line771"></a><div class='linenum'>771</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line772"></a><div class='linenum'>772</div></td><td></td><td></td><td></td><td><span><tt>function(m)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line773"></a><div class='linenum'>773</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;MinimalPolynomial(&nbsp;DefaultFieldOfMatrix(&nbsp;m&nbsp;),&nbsp;m,&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line774"></a><div class='linenum'>774</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line775"></a><div class='linenum'>775</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line776"></a><div class='linenum'>776</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MinimalPolynomialMatrixNC,&nbsp;"spinning&nbsp;over&nbsp;field",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line777"></a><div class='linenum'>777</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsElmsCollsX,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line778"></a><div class='linenum'>778</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsOrdinaryMatrix,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line779"></a><div class='linenum'>779</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;Matrix_MinimalPolynomialSameField);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line780"></a><div class='linenum'>780</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line781"></a><div class='linenum'>781</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line782"></a><div class='linenum'>782</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line783"></a><div class='linenum'>783</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line784"></a><div class='linenum'>784</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Order(&nbsp;&lt;mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;order&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line785"></a><div class='linenum'>785</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line786"></a><div class='linenum'>786</div></td><td></td><td></td><td></td><td><span><tt>OrderMatLimit&nbsp;:=&nbsp;1000;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line787"></a><div class='linenum'>787</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line788"></a><div class='linenum'>788</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;Order,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line789"></a><div class='linenum'>789</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;ordinary&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line790"></a><div class='linenum'>790</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line791"></a><div class='linenum'>791</div></td><td></td><td></td><td></td><td><span><tt>function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line792"></a><div class='linenum'>792</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;m,&nbsp;rank;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line793"></a><div class='linenum'>793</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line794"></a><div class='linenum'>794</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;that&nbsp;the&nbsp;argument&nbsp;is&nbsp;an&nbsp;invertible&nbsp;square&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line795"></a><div class='linenum'>795</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line796"></a><div class='linenum'>796</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;&lt;>&nbsp;Length(mat[1])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line797"></a><div class='linenum'>797</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"Order:&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line798"></a><div class='linenum'>798</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line799"></a><div class='linenum'>799</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rank:=&nbsp;RankMat(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line800"></a><div class='linenum'>800</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;rank&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line801"></a><div class='linenum'>801</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsUnit(&nbsp;DeterminantMat(&nbsp;mat&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line802"></a><div class='linenum'>802</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"Order:&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;invertible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line803"></a><div class='linenum'>803</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line804"></a><div class='linenum'>804</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;rank&nbsp;&lt;>&nbsp;m&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line805"></a><div class='linenum'>805</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"Order:&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;invertible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line806"></a><div class='linenum'>806</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;also&nbsp;test&nbsp;here&nbsp;that&nbsp;the&nbsp;determinant&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;unit&nbsp;in&nbsp;the&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line807"></a><div class='linenum'>807</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;that&nbsp;is&nbsp;generated&nbsp;by&nbsp;the&nbsp;matrix&nbsp;entries?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line808"></a><div class='linenum'>808</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;(Do&nbsp;we&nbsp;need&nbsp;`IsPossiblyInvertibleMat'&nbsp;and&nbsp;`IsSurelyInvertibleMat',
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line809"></a><div class='linenum'>809</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;the&nbsp;first&nbsp;meaning&nbsp;that&nbsp;the&nbsp;inverse&nbsp;in&nbsp;some&nbsp;ring&nbsp;exists,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line810"></a><div class='linenum'>810</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;the&nbsp;second&nbsp;meaning&nbsp;that&nbsp;the&nbsp;inverse&nbsp;exists&nbsp;in&nbsp;the&nbsp;ring&nbsp;generated&nbsp;by&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line811"></a><div class='linenum'>811</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;matrix&nbsp;entries?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line812"></a><div class='linenum'>812</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;For&nbsp;`Order',&nbsp;it&nbsp;is&nbsp;`IsSurelyInvertibleMat'&nbsp;that&nbsp;one&nbsp;wants&nbsp;to&nbsp;check;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line813"></a><div class='linenum'>813</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;then&nbsp;one&nbsp;can&nbsp;return&nbsp;`infinity'&nbsp;if&nbsp;the&nbsp;determinant&nbsp;is&nbsp;not&nbsp;a&nbsp;unit&nbsp;in&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line814"></a><div class='linenum'>814</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;ring&nbsp;generated&nbsp;by&nbsp;the&nbsp;matrix&nbsp;entries.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line815"></a><div class='linenum'>815</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line816"></a><div class='linenum'>816</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line817"></a><div class='linenum'>817</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;standard&nbsp;basis&nbsp;vectors
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line818"></a><div class='linenum'>818</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;OrderMatTrial(mat,infinity);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line819"></a><div class='linenum'>819</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line820"></a><div class='linenum'>820</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line821"></a><div class='linenum'>821</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line822"></a><div class='linenum'>822</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line823"></a><div class='linenum'>823</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line824"></a><div class='linenum'>824</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OrderMatTrial(&nbsp;&lt;mat>,&lt;lim>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line825"></a><div class='linenum'>825</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line826"></a><div class='linenum'>826</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(OrderMatTrial,function(mat,lim)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line827"></a><div class='linenum'>827</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;ord,i,vec,v,o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line828"></a><div class='linenum'>828</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line829"></a><div class='linenum'>829</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;standard&nbsp;basis&nbsp;vectors
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line830"></a><div class='linenum'>830</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ord&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line831"></a><div class='linenum'>831</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[1..Length(mat)]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line832"></a><div class='linenum'>832</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line833"></a><div class='linenum'>833</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;orbit&nbsp;of&nbsp;the&nbsp;&lt;i>th&nbsp;standard&nbsp;basis&nbsp;vector
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line834"></a><div class='linenum'>834</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(equivalently,&nbsp;of&nbsp;the&nbsp;orbit&nbsp;of&nbsp;`mat[&lt;i>]',
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line835"></a><div class='linenum'>835</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;image&nbsp;of&nbsp;the&nbsp;standard&nbsp;basis&nbsp;vector&nbsp;under&nbsp;`mat')
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line836"></a><div class='linenum'>836</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;vec&nbsp;:=&nbsp;mat[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line837"></a><div class='linenum'>837</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;&nbsp;&nbsp;:=&nbsp;vec&nbsp;*&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line838"></a><div class='linenum'>838</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o&nbsp;&nbsp;&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line839"></a><div class='linenum'>839</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;v&nbsp;&lt;>&nbsp;vec&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line840"></a><div class='linenum'>840</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;:=&nbsp;v&nbsp;*&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line841"></a><div class='linenum'>841</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o&nbsp;:=&nbsp;o&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line842"></a><div class='linenum'>842</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;o>lim&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line843"></a><div class='linenum'>843</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line844"></a><div class='linenum'>844</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;OrderMatLimit&nbsp;=&nbsp;o&nbsp;&nbsp;and&nbsp;Characteristic(v[1])=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line845"></a><div class='linenum'>845</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoWarning,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line846"></a><div class='linenum'>846</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Order:&nbsp;warning,&nbsp;order&nbsp;of&nbsp;&lt;mat>&nbsp;might&nbsp;be&nbsp;infinite"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line847"></a><div class='linenum'>847</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line848"></a><div class='linenum'>848</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line849"></a><div class='linenum'>849</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line850"></a><div class='linenum'>850</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;raise&nbsp;the&nbsp;matrix&nbsp;to&nbsp;this&nbsp;length&nbsp;(new&nbsp;mat&nbsp;will&nbsp;fix&nbsp;basis&nbsp;vector)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line851"></a><div class='linenum'>851</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;o>1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line852"></a><div class='linenum'>852</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;:=&nbsp;mat&nbsp;^&nbsp;o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line853"></a><div class='linenum'>853</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ord&nbsp;:=&nbsp;ord&nbsp;*&nbsp;o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line854"></a><div class='linenum'>854</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line855"></a><div class='linenum'>855</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line856"></a><div class='linenum'>856</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsOne(mat)&nbsp;then&nbsp;return&nbsp;ord;&nbsp;else&nbsp;return&nbsp;fail;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line857"></a><div class='linenum'>857</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line858"></a><div class='linenum'>858</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line859"></a><div class='linenum'>859</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line860"></a><div class='linenum'>860</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line861"></a><div class='linenum'>861</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line862"></a><div class='linenum'>862</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;#M&nbsp;&nbsp;Order(&nbsp;&lt;cycmat>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;order&nbsp;of&nbsp;a&nbsp;matrix&nbsp;of&nbsp;cyclotomics
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line863"></a><div class='linenum'>863</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line864"></a><div class='linenum'>864</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;##&nbsp;&nbsp;The&nbsp;idea&nbsp;is&nbsp;to&nbsp;compute&nbsp;the&nbsp;minimal&nbsp;polynomial&nbsp;of&nbsp;the&nbsp;matrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line865"></a><div class='linenum'>865</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;##&nbsp;&nbsp;and&nbsp;to&nbsp;decompose&nbsp;this&nbsp;polynomial&nbsp;into&nbsp;cyclotomic&nbsp;polynomials.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line866"></a><div class='linenum'>866</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;##&nbsp;&nbsp;This&nbsp;is&nbsp;due&nbsp;to&nbsp;R.&nbsp;Beals,&nbsp;who&nbsp;used&nbsp;it&nbsp;in&nbsp;his&nbsp;`grim'&nbsp;package&nbsp;for&nbsp;{\GAP}~3.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line867"></a><div class='linenum'>867</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line868"></a><div class='linenum'>868</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;InstallMethod(&nbsp;Order,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line869"></a><div class='linenum'>869</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ordinary&nbsp;matrix&nbsp;of&nbsp;cyclotomics",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line870"></a><div class='linenum'>870</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and&nbsp;IsCyclotomicCollColl&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line871"></a><div class='linenum'>871</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;cycmat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line872"></a><div class='linenum'>872</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;m,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;dimension&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line873"></a><div class='linenum'>873</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trace,&nbsp;&nbsp;&nbsp;#&nbsp;trace&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line874"></a><div class='linenum'>874</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minpol,&nbsp;&nbsp;#&nbsp;minimal&nbsp;polynomial&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line875"></a><div class='linenum'>875</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;degree&nbsp;of&nbsp;`minpol'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line876"></a><div class='linenum'>876</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;small&nbsp;primes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line877"></a><div class='linenum'>877</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;product&nbsp;of&nbsp;the&nbsp;primes&nbsp;`p'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line878"></a><div class='linenum'>878</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;product&nbsp;of&nbsp;the&nbsp;values&nbsp;`p-1'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line879"></a><div class='linenum'>879</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ord,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;currently&nbsp;known&nbsp;factor&nbsp;of&nbsp;the&nbsp;order
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line880"></a><div class='linenum'>880</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;indices&nbsp;of&nbsp;cyclotomic&nbsp;polynomials
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line881"></a><div class='linenum'>881</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`Phi(&nbsp;d&nbsp;)'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line882"></a><div class='linenum'>882</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`d'-th&nbsp;cyclotomic&nbsp;polynomial
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line883"></a><div class='linenum'>883</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;quotient&nbsp;and&nbsp;remainder
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line884"></a><div class='linenum'>884</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line885"></a><div class='linenum'>885</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Before&nbsp;we&nbsp;start&nbsp;with&nbsp;expensive&nbsp;calculations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line886"></a><div class='linenum'>886</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;we&nbsp;check&nbsp;whether&nbsp;the&nbsp;matrix&nbsp;has&nbsp;a&nbsp;*small*&nbsp;order.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line887"></a><div class='linenum'>887</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ord:=&nbsp;OrderMatTrial(&nbsp;cycmat,&nbsp;OrderMatLimit&nbsp;-&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line888"></a><div class='linenum'>888</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ord&nbsp;&lt;>&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line889"></a><div class='linenum'>889</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ord;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line890"></a><div class='linenum'>890</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line891"></a><div class='linenum'>891</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line892"></a><div class='linenum'>892</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;that&nbsp;the&nbsp;argument&nbsp;is&nbsp;an&nbsp;invertible&nbsp;square&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line893"></a><div class='linenum'>893</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;Length(&nbsp;cycmat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line894"></a><div class='linenum'>894</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;&lt;>&nbsp;Length(&nbsp;cycmat[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line895"></a><div class='linenum'>895</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"Order:&nbsp;&lt;cycmat>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line896"></a><div class='linenum'>896</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;RankMat(&nbsp;cycmat&nbsp;)&nbsp;&lt;>&nbsp;m&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line897"></a><div class='linenum'>897</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"Order:&nbsp;&lt;cycmat>&nbsp;must&nbsp;be&nbsp;invertible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line898"></a><div class='linenum'>898</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line899"></a><div class='linenum'>899</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;#T&nbsp;Here&nbsp;I&nbsp;could&nbsp;compute&nbsp;the&nbsp;inverse;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line900"></a><div class='linenum'>900</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;#T&nbsp;its&nbsp;trace&nbsp;could&nbsp;be&nbsp;checked,&nbsp;too.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line901"></a><div class='linenum'>901</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;#T&nbsp;Additionally,&nbsp;if&nbsp;`mat'&nbsp;consists&nbsp;of&nbsp;(algebraic)&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line902"></a><div class='linenum'>902</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;#T&nbsp;and&nbsp;the&nbsp;inverse&nbsp;does&nbsp;not&nbsp;then&nbsp;the&nbsp;order&nbsp;of&nbsp;`mat'&nbsp;is&nbsp;infinite.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line903"></a><div class='linenum'>903</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line904"></a><div class='linenum'>904</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;the&nbsp;order&nbsp;is&nbsp;finite&nbsp;then&nbsp;the&nbsp;trace&nbsp;must&nbsp;be&nbsp;an&nbsp;algebraic&nbsp;integer.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line905"></a><div class='linenum'>905</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trace:=&nbsp;TraceMat(&nbsp;cycmat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line906"></a><div class='linenum'>906</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsIntegralCyclotomic(&nbsp;trace&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line907"></a><div class='linenum'>907</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line908"></a><div class='linenum'>908</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line909"></a><div class='linenum'>909</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line910"></a><div class='linenum'>910</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;the&nbsp;order&nbsp;is&nbsp;finite&nbsp;then&nbsp;the&nbsp;absolute&nbsp;value&nbsp;of&nbsp;the&nbsp;trace
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line911"></a><div class='linenum'>911</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;is&nbsp;bounded&nbsp;by&nbsp;the&nbsp;dimension&nbsp;of&nbsp;the&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line912"></a><div class='linenum'>912</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;#T&nbsp;compute&nbsp;this&nbsp;(approximatively)&nbsp;for&nbsp;arbitrary&nbsp;cyclotomics
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line913"></a><div class='linenum'>913</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;#T&nbsp;(by&nbsp;the&nbsp;way:&nbsp;why&nbsp;isn't&nbsp;this&nbsp;function&nbsp;called&nbsp;`AbsRat'?)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line914"></a><div class='linenum'>914</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;trace&nbsp;)&nbsp;and&nbsp;Length(&nbsp;cycmat&nbsp;)&nbsp;&lt;&nbsp;AbsInt(&nbsp;trace&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line915"></a><div class='linenum'>915</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line916"></a><div class='linenum'>916</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line917"></a><div class='linenum'>917</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line918"></a><div class='linenum'>918</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;minimal&nbsp;polynomial&nbsp;of&nbsp;the&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line919"></a><div class='linenum'>919</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minpol:=&nbsp;MinimalPolynomial(&nbsp;Rationals,&nbsp;cycmat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line920"></a><div class='linenum'>920</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;DegreeOfLaurentPolynomial(&nbsp;minpol&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line921"></a><div class='linenum'>921</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line922"></a><div class='linenum'>922</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;order&nbsp;is&nbsp;finite&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;the&nbsp;minimal&nbsp;polynomial
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line923"></a><div class='linenum'>923</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;is&nbsp;a&nbsp;product&nbsp;of&nbsp;cyclotomic&nbsp;polynomials.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line924"></a><div class='linenum'>924</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Note&nbsp;that&nbsp;cyclotomic&nbsp;polynomials&nbsp;over&nbsp;the&nbsp;rationals&nbsp;are&nbsp;irreducible.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line925"></a><div class='linenum'>925</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line926"></a><div class='linenum'>926</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;necessary&nbsp;condition&nbsp;is&nbsp;that&nbsp;the&nbsp;constant&nbsp;term&nbsp;of&nbsp;the&nbsp;polynomial
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line927"></a><div class='linenum'>927</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;is&nbsp;$\pm&nbsp;1$,&nbsp;since&nbsp;this&nbsp;holds&nbsp;for&nbsp;every&nbsp;cyclotomic&nbsp;polynomial.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line928"></a><div class='linenum'>928</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;AbsInt(&nbsp;Value(&nbsp;minpol,&nbsp;0&nbsp;)&nbsp;)&nbsp;&lt;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line929"></a><div class='linenum'>929</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line930"></a><div class='linenum'>930</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line931"></a><div class='linenum'>931</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line932"></a><div class='linenum'>932</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Another&nbsp;necessary&nbsp;condition&nbsp;is&nbsp;that&nbsp;no&nbsp;irreducible&nbsp;factor
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line933"></a><div class='linenum'>933</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;may&nbsp;occur&nbsp;more&nbsp;than&nbsp;once.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line934"></a><div class='linenum'>934</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Note&nbsp;that&nbsp;the&nbsp;minimal&nbsp;polynomial&nbsp;divides&nbsp;$X^{ord}&nbsp;-&nbsp;1$.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line935"></a><div class='linenum'>935</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsOne(&nbsp;Gcd(&nbsp;minpol,&nbsp;Derivative(&nbsp;minpol&nbsp;)&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line936"></a><div class='linenum'>936</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line937"></a><div class='linenum'>937</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line938"></a><div class='linenum'>938</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line939"></a><div class='linenum'>939</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;an&nbsp;upper&nbsp;bound&nbsp;`t'&nbsp;for&nbsp;the&nbsp;numbers&nbsp;$i$&nbsp;with&nbsp;the&nbsp;property
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line940"></a><div class='linenum'>940</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;that&nbsp;$\varphi(i)&nbsp;\leq&nbsp;n$&nbsp;holds.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line941"></a><div class='linenum'>941</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Let&nbsp;$p_k$&nbsp;denote&nbsp;the&nbsp;$k$-th&nbsp;prime&nbsp;divisor&nbsp;of&nbsp;$i$,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line942"></a><div class='linenum'>942</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;$q_k$&nbsp;the&nbsp;$k$-th&nbsp;prime;&nbsp;then&nbsp;clearly&nbsp;$q_k&nbsp;\leq&nbsp;p_k$&nbsp;holds.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line943"></a><div class='linenum'>943</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Now&nbsp;let&nbsp;$h$&nbsp;be&nbsp;the&nbsp;smallest&nbsp;*positive*&nbsp;integer&nbsp;--be&nbsp;careful&nbsp;that&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line944"></a><div class='linenum'>944</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;products&nbsp;considered&nbsp;below&nbsp;are&nbsp;not&nbsp;empty--&nbsp;such&nbsp;that
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line945"></a><div class='linenum'>945</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;$\prod_{k=1}^h&nbsp;(&nbsp;q_k&nbsp;-&nbsp;1&nbsp;)&nbsp;\geq&nbsp;n$,&nbsp;and&nbsp;set&nbsp;$t&nbsp;=&nbsp;\prod_{k=1}^h&nbsp;q_k$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line946"></a><div class='linenum'>946</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;$i$&nbsp;has&nbsp;the&nbsp;property&nbsp;$\varphi(i)&nbsp;\leq&nbsp;n$&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line947"></a><div class='linenum'>947</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;$i&nbsp;\leq&nbsp;n&nbsp;\frac{i}{\varphi(i)}&nbsp;=&nbsp;n&nbsp;\prod_{k}&nbsp;\frac{p_k}{p_k-1}$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line948"></a><div class='linenum'>948</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Replacing&nbsp;$p_k$&nbsp;by&nbsp;$q_k$&nbsp;means&nbsp;to&nbsp;replace&nbsp;the&nbsp;factor
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line949"></a><div class='linenum'>949</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;$\frac{p_k}{p_k-1}$&nbsp;by&nbsp;a&nbsp;larger&nbsp;factor,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line950"></a><div class='linenum'>950</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;if&nbsp;$i$&nbsp;has&nbsp;less&nbsp;than&nbsp;$h$&nbsp;prime&nbsp;divisors&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line951"></a><div class='linenum'>951</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;running&nbsp;over&nbsp;the&nbsp;first&nbsp;$h$&nbsp;primes&nbsp;increases&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;product
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line952"></a><div class='linenum'>952</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;again,&nbsp;so&nbsp;we&nbsp;get&nbsp;$i&nbsp;\leq&nbsp;n&nbsp;\prod_{k=1}^h&nbsp;\frac{q_k}{q_k-1}&nbsp;\leq&nbsp;t$.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line953"></a><div class='linenum'>953</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p:=&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line954"></a><div class='linenum'>954</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:=&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line955"></a><div class='linenum'>955</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line956"></a><div class='linenum'>956</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;l&nbsp;&lt;&nbsp;n&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line957"></a><div class='linenum'>957</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p:=&nbsp;NextPrimeInt(&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line958"></a><div class='linenum'>958</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:=&nbsp;t&nbsp;*&nbsp;p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line959"></a><div class='linenum'>959</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l:=&nbsp;l&nbsp;*&nbsp;(&nbsp;p&nbsp;-&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line960"></a><div class='linenum'>960</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line961"></a><div class='linenum'>961</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line962"></a><div class='linenum'>962</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Divide&nbsp;by&nbsp;each&nbsp;possible&nbsp;cyclotomic&nbsp;polynomial.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line963"></a><div class='linenum'>963</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ord:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line964"></a><div class='linenum'>964</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;d&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;t&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line965"></a><div class='linenum'>965</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line966"></a><div class='linenum'>966</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi:=&nbsp;Phi(&nbsp;d&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line967"></a><div class='linenum'>967</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;phi&nbsp;&lt;=&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line968"></a><div class='linenum'>968</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c:=&nbsp;CyclotomicPolynomial(&nbsp;Rationals,&nbsp;d&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line969"></a><div class='linenum'>969</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q:=&nbsp;QuotientRemainder(&nbsp;minpol,&nbsp;c&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line970"></a><div class='linenum'>970</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsZero(&nbsp;q[2]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line971"></a><div class='linenum'>971</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minpol:=&nbsp;q[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line972"></a><div class='linenum'>972</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;n&nbsp;-&nbsp;phi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line973"></a><div class='linenum'>973</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ord:=&nbsp;Lcm(&nbsp;ord,&nbsp;d&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line974"></a><div class='linenum'>974</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line975"></a><div class='linenum'>975</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line976"></a><div class='linenum'>976</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;minimal&nbsp;polynomial&nbsp;is&nbsp;a&nbsp;product&nbsp;of&nbsp;cyclotomic&nbsp;polynomials.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line977"></a><div class='linenum'>977</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ord;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line978"></a><div class='linenum'>978</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line979"></a><div class='linenum'>979</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line980"></a><div class='linenum'>980</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line981"></a><div class='linenum'>981</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line982"></a><div class='linenum'>982</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line983"></a><div class='linenum'>983</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line984"></a><div class='linenum'>984</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line985"></a><div class='linenum'>985</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;matrix&nbsp;has&nbsp;infinite&nbsp;order.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line986"></a><div class='linenum'>986</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line987"></a><div class='linenum'>987</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line988"></a><div class='linenum'>988</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line989"></a><div class='linenum'>989</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line990"></a><div class='linenum'>990</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line991"></a><div class='linenum'>991</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line992"></a><div class='linenum'>992</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Order(&nbsp;&lt;mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;order&nbsp;of&nbsp;a&nbsp;matrix&nbsp;of&nbsp;cyclotomics
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line993"></a><div class='linenum'>993</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line994"></a><div class='linenum'>994</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Order,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line995"></a><div class='linenum'>995</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix&nbsp;of&nbsp;cyclotomics,&nbsp;with&nbsp;Minkowski&nbsp;kernel",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line996"></a><div class='linenum'>996</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and&nbsp;IsCyclotomicCollColl&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line997"></a><div class='linenum'>997</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line998"></a><div class='linenum'>998</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line999"></a><div class='linenum'>999</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1000"></a><div class='linenum'>1000</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;dim,&nbsp;F,&nbsp;tracemat,&nbsp;lat,&nbsp;red,&nbsp;det,&nbsp;trace,&nbsp;order,&nbsp;orddet,&nbsp;powdet,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1001"></a><div class='linenum'>1001</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ordpowdet,&nbsp;I;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1002"></a><div class='linenum'>1002</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1003"></a><div class='linenum'>1003</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;that&nbsp;the&nbsp;argument&nbsp;is&nbsp;an&nbsp;invertible&nbsp;square&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1004"></a><div class='linenum'>1004</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;dim:=&nbsp;Length(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1005"></a><div class='linenum'>1005</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;dim&nbsp;&lt;>&nbsp;Length(&nbsp;mat[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1006"></a><div class='linenum'>1006</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"Order:&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1007"></a><div class='linenum'>1007</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1008"></a><div class='linenum'>1008</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1009"></a><div class='linenum'>1009</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Before&nbsp;we&nbsp;start&nbsp;with&nbsp;expensive&nbsp;calculations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1010"></a><div class='linenum'>1010</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;we&nbsp;check&nbsp;whether&nbsp;the&nbsp;matrix&nbsp;has&nbsp;a&nbsp;*very&nbsp;small*&nbsp;order.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1011"></a><div class='linenum'>1011</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;order:=&nbsp;OrderMatTrial(&nbsp;mat,&nbsp;6&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1012"></a><div class='linenum'>1012</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;order&nbsp;&lt;>&nbsp;fail&nbsp;then&nbsp;return&nbsp;order;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1013"></a><div class='linenum'>1013</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1014"></a><div class='linenum'>1014</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;compute&nbsp;the&nbsp;determinant&nbsp;&lt;det>,&nbsp;issue&nbsp;an&nbsp;error&nbsp;message&nbsp;in&nbsp;case&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1015"></a><div class='linenum'>1015</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;is&nbsp;not&nbsp;invertible,&nbsp;compute&nbsp;the&nbsp;order&nbsp;&lt;orddet>&nbsp;of&nbsp;&lt;det>&nbsp;and&nbsp;check
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1016"></a><div class='linenum'>1016</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;whether&nbsp;&lt;mat>^&lt;orddet>&nbsp;has&nbsp;small&nbsp;order.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1017"></a><div class='linenum'>1017</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;det&nbsp;:=&nbsp;DeterminantMat(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1018"></a><div class='linenum'>1018</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;det&nbsp;=&nbsp;0&nbsp;then&nbsp;Error(&nbsp;"Order:&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;invertible"&nbsp;);&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1019"></a><div class='linenum'>1019</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orddet&nbsp;:=&nbsp;Order(det);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1020"></a><div class='linenum'>1020</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;orddet&nbsp;=&nbsp;infinity&nbsp;then&nbsp;return&nbsp;infinity;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1021"></a><div class='linenum'>1021</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;powdet&nbsp;:=&nbsp;mat^orddet;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1022"></a><div class='linenum'>1022</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ordpowdet&nbsp;:=&nbsp;OrderMatTrial(&nbsp;powdet,&nbsp;12&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1023"></a><div class='linenum'>1023</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ordpowdet&nbsp;&lt;>&nbsp;fail&nbsp;then&nbsp;return&nbsp;orddet&nbsp;*&nbsp;ordpowdet;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1024"></a><div class='linenum'>1024</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1025"></a><div class='linenum'>1025</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;the&nbsp;order&nbsp;is&nbsp;finite&nbsp;then&nbsp;the&nbsp;trace&nbsp;must&nbsp;be&nbsp;an&nbsp;algebraic&nbsp;integer.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1026"></a><div class='linenum'>1026</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;trace&nbsp;:=&nbsp;TraceMat(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1027"></a><div class='linenum'>1027</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsIntegralCyclotomic(&nbsp;trace&nbsp;)&nbsp;then&nbsp;return&nbsp;infinity;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1028"></a><div class='linenum'>1028</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1029"></a><div class='linenum'>1029</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;the&nbsp;order&nbsp;is&nbsp;finite&nbsp;then&nbsp;the&nbsp;absolute&nbsp;value&nbsp;of&nbsp;the&nbsp;trace
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1030"></a><div class='linenum'>1030</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;is&nbsp;bounded&nbsp;by&nbsp;the&nbsp;dimension&nbsp;of&nbsp;the&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1031"></a><div class='linenum'>1031</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;trace&nbsp;)&nbsp;and&nbsp;Length(&nbsp;mat&nbsp;)&nbsp;&lt;&nbsp;AbsInt(&nbsp;trace&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1032"></a><div class='linenum'>1032</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1033"></a><div class='linenum'>1033</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1034"></a><div class='linenum'>1034</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1035"></a><div class='linenum'>1035</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;F:=&nbsp;DefaultFieldOfMatrix(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1036"></a><div class='linenum'>1036</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1037"></a><div class='linenum'>1037</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;to&nbsp;a&nbsp;rational&nbsp;matrix&nbsp;if&nbsp;necessary.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1038"></a><div class='linenum'>1038</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;1&nbsp;&lt;&nbsp;Conductor(&nbsp;F&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1039"></a><div class='linenum'>1039</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1040"></a><div class='linenum'>1040</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;whether&nbsp;the&nbsp;trace&nbsp;is&nbsp;larger&nbsp;than&nbsp;the&nbsp;dimension.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1041"></a><div class='linenum'>1041</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tracemat&nbsp;:=&nbsp;BlownUpMat(&nbsp;Basis(F),&nbsp;[[&nbsp;trace&nbsp;]]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1042"></a><div class='linenum'>1042</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;AbsInt(Trace(tracemat))&nbsp;>&nbsp;Length(mat)&nbsp;*&nbsp;Length(tracemat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1043"></a><div class='linenum'>1043</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;return&nbsp;infinity;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1044"></a><div class='linenum'>1044</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1045"></a><div class='linenum'>1045</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;BlownUpMat(&nbsp;Basis(&nbsp;F&nbsp;),&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1046"></a><div class='linenum'>1046</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim:=&nbsp;Length(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1047"></a><div class='linenum'>1047</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1048"></a><div class='linenum'>1048</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1049"></a><div class='linenum'>1049</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;to&nbsp;an&nbsp;integer&nbsp;matrix&nbsp;if&nbsp;necessary.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1050"></a><div class='linenum'>1050</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;ForAll(&nbsp;mat,&nbsp;row&nbsp;->&nbsp;ForAll(&nbsp;row,&nbsp;IsInt&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1051"></a><div class='linenum'>1051</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1052"></a><div class='linenum'>1052</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;following&nbsp;checks&nbsp;trace&nbsp;and&nbsp;determinant.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1053"></a><div class='linenum'>1053</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lat:=&nbsp;InvariantLattice(&nbsp;GroupWithGenerators(&nbsp;[&nbsp;mat&nbsp;]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1054"></a><div class='linenum'>1054</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lat&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1055"></a><div class='linenum'>1055</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1056"></a><div class='linenum'>1056</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1057"></a><div class='linenum'>1057</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;lat&nbsp;*&nbsp;mat&nbsp;*&nbsp;Inverse(&nbsp;lat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1058"></a><div class='linenum'>1058</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1059"></a><div class='linenum'>1059</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1060"></a><div class='linenum'>1060</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1061"></a><div class='linenum'>1061</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;reduction&nbsp;modulo&nbsp;$2$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1062"></a><div class='linenum'>1062</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;red:=&nbsp;mat&nbsp;*&nbsp;Z(2);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1063"></a><div class='linenum'>1063</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToMatrixRep(red,2);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1064"></a><div class='linenum'>1064</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;order:=&nbsp;Order(&nbsp;red&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1065"></a><div class='linenum'>1065</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;if&nbsp;OrderMatTrial&nbsp;was&nbsp;used&nbsp;above&nbsp;then&nbsp;call&nbsp;`ProjectiveOrder'&nbsp;directly?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1066"></a><div class='linenum'>1066</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1067"></a><div class='linenum'>1067</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Now&nbsp;use&nbsp;the&nbsp;theorem&nbsp;(see&nbsp;Morris&nbsp;Newman,&nbsp;Integral&nbsp;Matrices)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1068"></a><div class='linenum'>1068</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;that&nbsp;`mat'&nbsp;has&nbsp;infinite&nbsp;order&nbsp;if&nbsp;the&nbsp;`2&nbsp;*&nbsp;order'-th
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1069"></a><div class='linenum'>1069</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;power&nbsp;is&nbsp;not&nbsp;equal&nbsp;to&nbsp;the&nbsp;identity&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1070"></a><div class='linenum'>1070</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;I:=&nbsp;IdentityMat(&nbsp;dim&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1071"></a><div class='linenum'>1071</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;supply&nbsp;better&nbsp;`IsOne'&nbsp;method&nbsp;for&nbsp;matrices,&nbsp;without&nbsp;constructing&nbsp;an&nbsp;object!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1072"></a><div class='linenum'>1072</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;mat&nbsp;^&nbsp;order;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1073"></a><div class='linenum'>1073</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mat&nbsp;=&nbsp;I&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1074"></a><div class='linenum'>1074</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;order;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1075"></a><div class='linenum'>1075</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;mat&nbsp;^&nbsp;2&nbsp;=&nbsp;I&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1076"></a><div class='linenum'>1076</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;2&nbsp;*&nbsp;order;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1077"></a><div class='linenum'>1077</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1078"></a><div class='linenum'>1078</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1079"></a><div class='linenum'>1079</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1080"></a><div class='linenum'>1080</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1081"></a><div class='linenum'>1081</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1082"></a><div class='linenum'>1082</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1083"></a><div class='linenum'>1083</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1084"></a><div class='linenum'>1084</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Order(&nbsp;&lt;ffe-mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;order&nbsp;of&nbsp;a&nbsp;matrix&nbsp;of&nbsp;finite&nbsp;field&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1085"></a><div class='linenum'>1085</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1086"></a><div class='linenum'>1086</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Order,&nbsp;"ordinary&nbsp;matrix&nbsp;of&nbsp;finite&nbsp;field&nbsp;elements",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1087"></a><div class='linenum'>1087</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and&nbsp;IsFFECollColl&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1088"></a><div class='linenum'>1088</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1089"></a><div class='linenum'>1089</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1090"></a><div class='linenum'>1090</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;catch&nbsp;the&nbsp;(unlikely&nbsp;in&nbsp;GL&nbsp;but&nbsp;likely&nbsp;in&nbsp;group&nbsp;theory...)&nbsp;case&nbsp;that&nbsp;mat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1091"></a><div class='linenum'>1091</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;has&nbsp;a&nbsp;small&nbsp;order
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1092"></a><div class='linenum'>1092</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1093"></a><div class='linenum'>1093</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;following&nbsp;limit&nbsp;is&nbsp;very&nbsp;crude&nbsp;but&nbsp;seems&nbsp;to&nbsp;work&nbsp;OK.&nbsp;It&nbsp;picks&nbsp;small
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1094"></a><div class='linenum'>1094</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;orders&nbsp;but&nbsp;still&nbsp;does&nbsp;not&nbsp;cost&nbsp;too&nbsp;much&nbsp;if&nbsp;the&nbsp;order&nbsp;gets&nbsp;larger.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1095"></a><div class='linenum'>1095</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(mat)&nbsp;&lt;>&nbsp;Length(mat[1])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1096"></a><div class='linenum'>1096</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("Order&nbsp;of&nbsp;non-square&nbsp;matrix&nbsp;is&nbsp;not&nbsp;defined");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1097"></a><div class='linenum'>1097</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1098"></a><div class='linenum'>1098</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o:=Characteristic(mat[1][1])^DegreeFFE(mat[1][1]);&nbsp;#&nbsp;size&nbsp;of&nbsp;field&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1099"></a><div class='linenum'>1099</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;first&nbsp;entry
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1100"></a><div class='linenum'>1100</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o:=QuoInt(Length(mat),o)*5;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1101"></a><div class='linenum'>1101</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1102"></a><div class='linenum'>1102</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o:=OrderMatTrial(mat,o);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1103"></a><div class='linenum'>1103</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;o&lt;>fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1104"></a><div class='linenum'>1104</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1105"></a><div class='linenum'>1105</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1106"></a><div class='linenum'>1106</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1107"></a><div class='linenum'>1107</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o&nbsp;:=&nbsp;ProjectiveOrder(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1108"></a><div class='linenum'>1108</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;o[1]&nbsp;*&nbsp;Order(&nbsp;o[2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1109"></a><div class='linenum'>1109</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1110"></a><div class='linenum'>1110</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1111"></a><div class='linenum'>1111</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1112"></a><div class='linenum'>1112</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1113"></a><div class='linenum'>1113</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1114"></a><div class='linenum'>1114</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsZero(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1115"></a><div class='linenum'>1115</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1116"></a><div class='linenum'>1116</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsZero,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1117"></a><div class='linenum'>1117</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"method&nbsp;for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1118"></a><div class='linenum'>1118</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1119"></a><div class='linenum'>1119</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1120"></a><div class='linenum'>1120</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;ncols,&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;columns
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1121"></a><div class='linenum'>1121</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero,&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;coefficient
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1122"></a><div class='linenum'>1122</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;rows&nbsp;in&nbsp;'obj'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1123"></a><div class='linenum'>1123</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1124"></a><div class='linenum'>1124</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ncols:=&nbsp;DimensionsMat(&nbsp;mat&nbsp;)[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1125"></a><div class='linenum'>1125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero:=&nbsp;Zero(&nbsp;mat[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1126"></a><div class='linenum'>1126</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;mat&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1127"></a><div class='linenum'>1127</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;PositionNot(&nbsp;row,&nbsp;zero&nbsp;)&nbsp;&lt;=&nbsp;ncols&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1128"></a><div class='linenum'>1128</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1129"></a><div class='linenum'>1129</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1130"></a><div class='linenum'>1130</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1131"></a><div class='linenum'>1131</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1132"></a><div class='linenum'>1132</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1133"></a><div class='linenum'>1133</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1134"></a><div class='linenum'>1134</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1135"></a><div class='linenum'>1135</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1136"></a><div class='linenum'>1136</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;BaseMat(&nbsp;&lt;mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;base&nbsp;for&nbsp;the&nbsp;row&nbsp;space&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1137"></a><div class='linenum'>1137</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1138"></a><div class='linenum'>1138</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;BaseMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1139"></a><div class='linenum'>1139</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1140"></a><div class='linenum'>1140</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1141"></a><div class='linenum'>1141</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;->&nbsp;SemiEchelonMatDestructive(&nbsp;mat&nbsp;).vectors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1142"></a><div class='linenum'>1142</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1143"></a><div class='linenum'>1143</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;BaseMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1144"></a><div class='linenum'>1144</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1145"></a><div class='linenum'>1145</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1146"></a><div class='linenum'>1146</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1147"></a><div class='linenum'>1147</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;BaseMatDestructive(&nbsp;MutableCopyMat(&nbsp;mat&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1148"></a><div class='linenum'>1148</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1149"></a><div class='linenum'>1149</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1150"></a><div class='linenum'>1150</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1151"></a><div class='linenum'>1151</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1152"></a><div class='linenum'>1152</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1153"></a><div class='linenum'>1153</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DefaultFieldOfMatrix(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1154"></a><div class='linenum'>1154</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1155"></a><div class='linenum'>1155</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DefaultFieldOfMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1156"></a><div class='linenum'>1156</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"default&nbsp;method&nbsp;for&nbsp;a&nbsp;matrix&nbsp;(return&nbsp;`fail')",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1157"></a><div class='linenum'>1157</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1158"></a><div class='linenum'>1158</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ReturnFail&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1159"></a><div class='linenum'>1159</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1160"></a><div class='linenum'>1160</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1161"></a><div class='linenum'>1161</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1162"></a><div class='linenum'>1162</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1163"></a><div class='linenum'>1163</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DefaultFieldOfMatrix(&nbsp;&lt;ffe-mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1164"></a><div class='linenum'>1164</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1165"></a><div class='linenum'>1165</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DefaultFieldOfMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1166"></a><div class='linenum'>1166</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"method&nbsp;for&nbsp;a&nbsp;matrix&nbsp;over&nbsp;a&nbsp;finite&nbsp;field",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1167"></a><div class='linenum'>1167</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;and&nbsp;IsFFECollColl&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1168"></a><div class='linenum'>1168</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1169"></a><div class='linenum'>1169</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;deg,&nbsp;&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1170"></a><div class='linenum'>1170</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1171"></a><div class='linenum'>1171</div></td><td>243</td><td>129</td><td>129</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;deg&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1172"></a><div class='linenum'>1172</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;mat&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1173"></a><div class='linenum'>1173</div></td><td>12900</td><td>19892</td><td>3707189</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deg&nbsp;:=&nbsp;LcmInt(&nbsp;deg,&nbsp;DegreeFFE(j)&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_ffe.gi.html#line112">/opt/gap/gap4r8p5/lib/ffe.gi:112</a> <a href="_opt_gap_gap4r8p5_lib_vec8bit.gi.html#line265">/opt/gap/gap4r8p5/lib/vec8bit.gi:265</a> <a href="_opt_gap_gap4r8p5_lib_integer.gi.html#line1079">LcmInt</a> </span></td></tr>
<tr class='exec'><td><a name="line1174"></a><div class='linenum'>1174</div></td><td>243</td><td>101</td><td>101</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1175"></a><div class='linenum'>1175</div></td><td>243</td><td>1001</td><td>7945</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;GF(&nbsp;Characteristic(mat[1]),&nbsp;deg&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_ffe.gi.html#line322">GaloisField</a> <a href="_opt_gap_gap4r8p5_lib_arith.gi.html#line631">/opt/gap/gap4r8p5/lib/arith.gi:631</a> </span></td></tr>
<tr class='ignore'><td><a name="line1176"></a><div class='linenum'>1176</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1177"></a><div class='linenum'>1177</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1178"></a><div class='linenum'>1178</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1179"></a><div class='linenum'>1179</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1180"></a><div class='linenum'>1180</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1181"></a><div class='linenum'>1181</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DefaultFieldOfMatrix(&nbsp;&lt;cyc-mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1182"></a><div class='linenum'>1182</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1183"></a><div class='linenum'>1183</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DefaultFieldOfMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1184"></a><div class='linenum'>1184</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"method&nbsp;for&nbsp;a&nbsp;matrix&nbsp;over&nbsp;the&nbsp;cyclotomics",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1185"></a><div class='linenum'>1185</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;and&nbsp;IsCyclotomicCollColl&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1186"></a><div class='linenum'>1186</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1187"></a><div class='linenum'>1187</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;deg,&nbsp;&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1188"></a><div class='linenum'>1188</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1189"></a><div class='linenum'>1189</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;deg&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1190"></a><div class='linenum'>1190</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;mat&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1191"></a><div class='linenum'>1191</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deg&nbsp;:=&nbsp;LcmInt(&nbsp;deg,&nbsp;Conductor(j)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1192"></a><div class='linenum'>1192</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1193"></a><div class='linenum'>1193</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;CF(&nbsp;deg&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1194"></a><div class='linenum'>1194</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1195"></a><div class='linenum'>1195</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1196"></a><div class='linenum'>1196</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1197"></a><div class='linenum'>1197</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1198"></a><div class='linenum'>1198</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1199"></a><div class='linenum'>1199</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DepthOfUpperTriangularMatrix(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1200"></a><div class='linenum'>1200</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1201"></a><div class='linenum'>1201</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DepthOfUpperTriangularMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1202"></a><div class='linenum'>1202</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1203"></a><div class='linenum'>1203</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1204"></a><div class='linenum'>1204</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;dim,&nbsp;&nbsp;zero,&nbsp;&nbsp;i,&nbsp;&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1205"></a><div class='linenum'>1205</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1206"></a><div class='linenum'>1206</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;the&nbsp;correct&nbsp;layer&nbsp;of&nbsp;&lt;m>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1207"></a><div class='linenum'>1207</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;dim&nbsp;&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1208"></a><div class='linenum'>1208</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(mat[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1209"></a><div class='linenum'>1209</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;dim-1&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1210"></a><div class='linenum'>1210</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;dim-i&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1211"></a><div class='linenum'>1211</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mat[j][i+j]&nbsp;&lt;>&nbsp;zero&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1212"></a><div class='linenum'>1212</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1213"></a><div class='linenum'>1213</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1214"></a><div class='linenum'>1214</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1215"></a><div class='linenum'>1215</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1216"></a><div class='linenum'>1216</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;dim;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1217"></a><div class='linenum'>1217</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1218"></a><div class='linenum'>1218</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1219"></a><div class='linenum'>1219</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1220"></a><div class='linenum'>1220</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;SumIntersectionMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1221"></a><div class='linenum'>1221</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsEmpty,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1222"></a><div class='linenum'>1222</div></td><td></td><td></td><td></td><td><span><tt>function(a,b)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1223"></a><div class='linenum'>1223</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;b:=MutableCopyMat(b);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1224"></a><div class='linenum'>1224</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;TriangulizeMat(b);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1225"></a><div class='linenum'>1225</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;b:=Filtered(b,i->not&nbsp;IsZero(i));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1226"></a><div class='linenum'>1226</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;[b,a];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1227"></a><div class='linenum'>1227</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1228"></a><div class='linenum'>1228</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1229"></a><div class='linenum'>1229</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;SumIntersectionMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1230"></a><div class='linenum'>1230</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,&nbsp;IsEmpty&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1231"></a><div class='linenum'>1231</div></td><td></td><td></td><td></td><td><span><tt>function(a,b)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1232"></a><div class='linenum'>1232</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;a:=MutableCopyMat(a);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1233"></a><div class='linenum'>1233</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;TriangulizeMat(a);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1234"></a><div class='linenum'>1234</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;a:=Filtered(a,i->not&nbsp;IsZero(i));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1235"></a><div class='linenum'>1235</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;[a,b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1236"></a><div class='linenum'>1236</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1237"></a><div class='linenum'>1237</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1238"></a><div class='linenum'>1238</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;SumIntersectionMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1239"></a><div class='linenum'>1239</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1240"></a><div class='linenum'>1240</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsEmpty,&nbsp;IsEmpty&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1241"></a><div class='linenum'>1241</div></td><td></td><td></td><td></td><td><span><tt>function(a,b)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1242"></a><div class='linenum'>1242</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;[a,b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1243"></a><div class='linenum'>1243</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1244"></a><div class='linenum'>1244</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1245"></a><div class='linenum'>1245</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1246"></a><div class='linenum'>1246</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1247"></a><div class='linenum'>1247</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1248"></a><div class='linenum'>1248</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DeterminantMat(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1249"></a><div class='linenum'>1249</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1250"></a><div class='linenum'>1250</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;Fractions&nbsp;free&nbsp;method,&nbsp;will&nbsp;never&nbsp;introduce&nbsp;denominators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1251"></a><div class='linenum'>1251</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1252"></a><div class='linenum'>1252</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;This&nbsp;method&nbsp;is&nbsp;better&nbsp;for&nbsp;cyclotomics,&nbsp;but&nbsp;pivotting&nbsp;is&nbsp;really&nbsp;needed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1253"></a><div class='linenum'>1253</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1254"></a><div class='linenum'>1254</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DeterminantMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1255"></a><div class='linenum'>1255</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"fraction-free&nbsp;method",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1256"></a><div class='linenum'>1256</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and&nbsp;IsMutable],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1257"></a><div class='linenum'>1257</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1258"></a><div class='linenum'>1258</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;det,&nbsp;sgn,&nbsp;row,&nbsp;zero,&nbsp;m,&nbsp;i,&nbsp;j,&nbsp;k,&nbsp;mult,&nbsp;row2,&nbsp;piv;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1259"></a><div class='linenum'>1259</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1260"></a><div class='linenum'>1260</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;that&nbsp;the&nbsp;argument&nbsp;is&nbsp;a&nbsp;square&nbsp;matrix&nbsp;and&nbsp;get&nbsp;the&nbsp;size
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1261"></a><div class='linenum'>1261</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1262"></a><div class='linenum'>1262</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(mat[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1263"></a><div class='linenum'>1263</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;&lt;>&nbsp;Length(mat[1])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1264"></a><div class='linenum'>1264</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("DeterminantMat:&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1265"></a><div class='linenum'>1265</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1266"></a><div class='linenum'>1266</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1267"></a><div class='linenum'>1267</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;run&nbsp;through&nbsp;all&nbsp;columns&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1268"></a><div class='linenum'>1268</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;0;&nbsp;&nbsp;det&nbsp;:=&nbsp;1;&nbsp;&nbsp;sgn&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1269"></a><div class='linenum'>1269</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1270"></a><div class='linenum'>1270</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1271"></a><div class='linenum'>1271</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;a&nbsp;nonzero&nbsp;entry&nbsp;in&nbsp;this&nbsp;column
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1272"></a><div class='linenum'>1272</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#N&nbsp;&nbsp;26-Oct-91&nbsp;martin&nbsp;if&nbsp;&lt;mat>&nbsp;is&nbsp;an&nbsp;rational&nbsp;matrix&nbsp;look&nbsp;for&nbsp;a&nbsp;pivot
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1273"></a><div class='linenum'>1273</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1274"></a><div class='linenum'>1274</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j&nbsp;&lt;=&nbsp;m&nbsp;and&nbsp;mat[j][k]&nbsp;=&nbsp;zero&nbsp;&nbsp;do&nbsp;j&nbsp;:=&nbsp;j+1;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1275"></a><div class='linenum'>1275</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1276"></a><div class='linenum'>1276</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;nonzero&nbsp;entry
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1277"></a><div class='linenum'>1277</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j&nbsp;&lt;=&nbsp;m&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1278"></a><div class='linenum'>1278</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1279"></a><div class='linenum'>1279</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;increment&nbsp;the&nbsp;rank
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1280"></a><div class='linenum'>1280</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1281"></a><div class='linenum'>1281</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1282"></a><div class='linenum'>1282</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;its&nbsp;row&nbsp;the&nbsp;current&nbsp;row
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1283"></a><div class='linenum'>1283</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&lt;>&nbsp;j&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1284"></a><div class='linenum'>1284</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;mat[j];&nbsp;&nbsp;mat[j]&nbsp;:=&nbsp;mat[i];&nbsp;&nbsp;mat[i]&nbsp;:=&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1285"></a><div class='linenum'>1285</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgn&nbsp;:=&nbsp;-sgn;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1286"></a><div class='linenum'>1286</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1287"></a><div class='linenum'>1287</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;mat[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1288"></a><div class='linenum'>1288</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1289"></a><div class='linenum'>1289</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;piv&nbsp;:=&nbsp;row[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1290"></a><div class='linenum'>1290</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1291"></a><div class='linenum'>1291</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;clear&nbsp;all&nbsp;entries&nbsp;in&nbsp;this&nbsp;column
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1292"></a><div class='linenum'>1292</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Then&nbsp;divide&nbsp;through&nbsp;by&nbsp;det,&nbsp;this,&nbsp;amazingly,&nbsp;works,&nbsp;due
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1293"></a><div class='linenum'>1293</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;to&nbsp;a&nbsp;theorem&nbsp;about&nbsp;3x3&nbsp;determinants
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1294"></a><div class='linenum'>1294</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[i+1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1295"></a><div class='linenum'>1295</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row2&nbsp;:=&nbsp;mat[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1296"></a><div class='linenum'>1296</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mult&nbsp;:=&nbsp;-row2[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1297"></a><div class='linenum'>1297</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;mult&nbsp;&lt;>&nbsp;zero&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1298"></a><div class='linenum'>1298</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(&nbsp;row2,&nbsp;piv&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1299"></a><div class='linenum'>1299</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(&nbsp;row2,&nbsp;row,&nbsp;mult,&nbsp;k,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1300"></a><div class='linenum'>1300</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(&nbsp;row2,&nbsp;Inverse(det)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1301"></a><div class='linenum'>1301</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1302"></a><div class='linenum'>1302</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(&nbsp;row2,&nbsp;piv/det);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1303"></a><div class='linenum'>1303</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1304"></a><div class='linenum'>1304</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1305"></a><div class='linenum'>1305</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1306"></a><div class='linenum'>1306</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;det&nbsp;:=&nbsp;piv;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1307"></a><div class='linenum'>1307</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1308"></a><div class='linenum'>1308</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;zero;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1309"></a><div class='linenum'>1309</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1310"></a><div class='linenum'>1310</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1311"></a><div class='linenum'>1311</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1312"></a><div class='linenum'>1312</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1313"></a><div class='linenum'>1313</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;determinant
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1314"></a><div class='linenum'>1314</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sgn&nbsp;*&nbsp;det;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1315"></a><div class='linenum'>1315</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1316"></a><div class='linenum'>1316</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1317"></a><div class='linenum'>1317</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1318"></a><div class='linenum'>1318</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1319"></a><div class='linenum'>1319</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1320"></a><div class='linenum'>1320</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DeterminantMat(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1321"></a><div class='linenum'>1321</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1322"></a><div class='linenum'>1322</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;direct&nbsp;Gaussian&nbsp;elimination,&nbsp;not&nbsp;avoiding&nbsp;denominators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1323"></a><div class='linenum'>1323</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;This&nbsp;method&nbsp;at&nbsp;the&nbsp;moment&nbsp;is&nbsp;&nbsp;better&nbsp;for&nbsp;finite&nbsp;fields
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1324"></a><div class='linenum'>1324</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;another&nbsp;method&nbsp;is&nbsp;installed&nbsp;for&nbsp;cyclotomics.&nbsp;Anything&nbsp;else&nbsp;falls
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1325"></a><div class='linenum'>1325</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;through&nbsp;here&nbsp;also.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1326"></a><div class='linenum'>1326</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1327"></a><div class='linenum'>1327</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DeterminantMatDestructive,"non&nbsp;fraction&nbsp;free",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1328"></a><div class='linenum'>1328</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and&nbsp;IsFFECollColl&nbsp;and&nbsp;IsMutable],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1329"></a><div class='linenum'>1329</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1330"></a><div class='linenum'>1330</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;m,&nbsp;&nbsp;zero,&nbsp;&nbsp;det,&nbsp;&nbsp;sgn,&nbsp;&nbsp;k,&nbsp;&nbsp;j,&nbsp;&nbsp;row,&nbsp;&nbsp;l,&nbsp;&nbsp;norm,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1331"></a><div class='linenum'>1331</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row2,&nbsp;x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1332"></a><div class='linenum'>1332</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1333"></a><div class='linenum'>1333</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;1,&nbsp;"DeterminantMat&nbsp;called"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1334"></a><div class='linenum'>1334</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1335"></a><div class='linenum'>1335</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;that&nbsp;the&nbsp;argument&nbsp;is&nbsp;a&nbsp;square&nbsp;matrix,&nbsp;and&nbsp;get&nbsp;the&nbsp;size
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1336"></a><div class='linenum'>1336</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1337"></a><div class='linenum'>1337</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;=&nbsp;0&nbsp;or&nbsp;m&nbsp;&lt;>&nbsp;Length(mat[1])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1338"></a><div class='linenum'>1338</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;mat>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix&nbsp;at&nbsp;least&nbsp;1x1"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1339"></a><div class='linenum'>1339</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1340"></a><div class='linenum'>1340</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(mat[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1341"></a><div class='linenum'>1341</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1342"></a><div class='linenum'>1342</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;normalize&nbsp;rows&nbsp;using&nbsp;the&nbsp;inverse
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1343"></a><div class='linenum'>1343</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsFFECollColl(mat)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1344"></a><div class='linenum'>1344</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norm&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1345"></a><div class='linenum'>1345</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1346"></a><div class='linenum'>1346</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norm&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1347"></a><div class='linenum'>1347</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1348"></a><div class='linenum'>1348</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1349"></a><div class='linenum'>1349</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;det&nbsp;:=&nbsp;One(zero);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1350"></a><div class='linenum'>1350</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sgn&nbsp;:=&nbsp;det;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1351"></a><div class='linenum'>1351</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1352"></a><div class='linenum'>1352</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;run&nbsp;through&nbsp;all&nbsp;columns&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1353"></a><div class='linenum'>1353</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;m&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1354"></a><div class='linenum'>1354</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1355"></a><div class='linenum'>1355</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;look&nbsp;for&nbsp;a&nbsp;nonzero&nbsp;entry&nbsp;in&nbsp;this&nbsp;column
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1356"></a><div class='linenum'>1356</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;:=&nbsp;k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1357"></a><div class='linenum'>1357</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j&nbsp;&lt;=&nbsp;m&nbsp;and&nbsp;mat[j][k]&nbsp;=&nbsp;zero&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1358"></a><div class='linenum'>1358</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;:=&nbsp;j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1359"></a><div class='linenum'>1359</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1360"></a><div class='linenum'>1360</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1361"></a><div class='linenum'>1361</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;nonzero&nbsp;entry
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1362"></a><div class='linenum'>1362</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j&nbsp;&lt;=&nbsp;m&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1363"></a><div class='linenum'>1363</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1364"></a><div class='linenum'>1364</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;increment&nbsp;the&nbsp;rank,&nbsp;...
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1365"></a><div class='linenum'>1365</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;2,&nbsp;"&nbsp;&nbsp;nonzero&nbsp;columns:&nbsp;",&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1366"></a><div class='linenum'>1366</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1367"></a><div class='linenum'>1367</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;...&nbsp;make&nbsp;its&nbsp;row&nbsp;the&nbsp;current&nbsp;row,&nbsp;...
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1368"></a><div class='linenum'>1368</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;&lt;>&nbsp;j&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1369"></a><div class='linenum'>1369</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;mat[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1370"></a><div class='linenum'>1370</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[j]&nbsp;:=&nbsp;mat[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1371"></a><div class='linenum'>1371</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[k]&nbsp;:=&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1372"></a><div class='linenum'>1372</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sgn&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;-sgn;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1373"></a><div class='linenum'>1373</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1374"></a><div class='linenum'>1374</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;mat[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1375"></a><div class='linenum'>1375</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1376"></a><div class='linenum'>1376</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1377"></a><div class='linenum'>1377</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;...&nbsp;and&nbsp;normalize&nbsp;the&nbsp;row.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1378"></a><div class='linenum'>1378</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;row[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1379"></a><div class='linenum'>1379</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;det&nbsp;:=&nbsp;det&nbsp;*&nbsp;x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1380"></a><div class='linenum'>1380</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(&nbsp;mat[k],&nbsp;Inverse(x)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1381"></a><div class='linenum'>1381</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1382"></a><div class='linenum'>1382</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;clear&nbsp;all&nbsp;entries&nbsp;in&nbsp;this&nbsp;column,&nbsp;adjust&nbsp;only&nbsp;columns&nbsp;>&nbsp;k
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1383"></a><div class='linenum'>1383</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Note&nbsp;that&nbsp;we&nbsp;need&nbsp;not&nbsp;clear&nbsp;the&nbsp;rows&nbsp;from&nbsp;'k+1'&nbsp;to&nbsp;'j'.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1384"></a><div class='linenum'>1384</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;l&nbsp;&nbsp;in&nbsp;[&nbsp;j+1&nbsp;..&nbsp;m&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1385"></a><div class='linenum'>1385</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row2&nbsp;:=&nbsp;mat[l];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1386"></a><div class='linenum'>1386</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;row2[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1387"></a><div class='linenum'>1387</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;>&nbsp;zero&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1388"></a><div class='linenum'>1388</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(&nbsp;row2,&nbsp;row,&nbsp;-x,&nbsp;k+1,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1389"></a><div class='linenum'>1389</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1390"></a><div class='linenum'>1390</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1391"></a><div class='linenum'>1391</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1392"></a><div class='linenum'>1392</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;determinant&nbsp;is&nbsp;zero
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1393"></a><div class='linenum'>1393</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1394"></a><div class='linenum'>1394</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;1,&nbsp;"DeterminantMat&nbsp;returns&nbsp;",&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1395"></a><div class='linenum'>1395</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;zero;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1396"></a><div class='linenum'>1396</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1397"></a><div class='linenum'>1397</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1398"></a><div class='linenum'>1398</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;det&nbsp;:=&nbsp;sgn&nbsp;*&nbsp;det;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1399"></a><div class='linenum'>1399</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;1,&nbsp;"DeterminantMat&nbsp;returns&nbsp;",&nbsp;det&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1400"></a><div class='linenum'>1400</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1401"></a><div class='linenum'>1401</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;determinant
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1402"></a><div class='linenum'>1402</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;det;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1403"></a><div class='linenum'>1403</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1404"></a><div class='linenum'>1404</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1405"></a><div class='linenum'>1405</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1406"></a><div class='linenum'>1406</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DeterminantMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1407"></a><div class='linenum'>1407</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1408"></a><div class='linenum'>1408</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1409"></a><div class='linenum'>1409</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1410"></a><div class='linenum'>1410</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;DeterminantMatDestructive(&nbsp;MutableCopyMat(&nbsp;mat&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1411"></a><div class='linenum'>1411</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1412"></a><div class='linenum'>1412</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1413"></a><div class='linenum'>1413</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DeterminantMatDestructive,"nonprime&nbsp;residue&nbsp;rings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1414"></a><div class='linenum'>1414</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1415"></a><div class='linenum'>1415</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;CategoryCollections(CategoryCollections(IsZmodnZObjNonprime))&nbsp;and&nbsp;IsMutable],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1416"></a><div class='linenum'>1416</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;DeterminantMatDivFree);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1417"></a><div class='linenum'>1417</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1418"></a><div class='linenum'>1418</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1419"></a><div class='linenum'>1419</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1420"></a><div class='linenum'>1420</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DeterminantMatDivFree(&nbsp;&lt;M>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1421"></a><div class='linenum'>1421</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1422"></a><div class='linenum'>1422</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Division&nbsp;free&nbsp;method.&nbsp;This&nbsp;is&nbsp;an&nbsp;alternative&nbsp;to&nbsp;the&nbsp;fraction&nbsp;free&nbsp;method
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1423"></a><div class='linenum'>1423</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;when&nbsp;division&nbsp;of&nbsp;matrix&nbsp;entries&nbsp;is&nbsp;expensive&nbsp;or&nbsp;not&nbsp;possible.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1424"></a><div class='linenum'>1424</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1425"></a><div class='linenum'>1425</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;method&nbsp;implements&nbsp;a&nbsp;division&nbsp;free&nbsp;algorithm&nbsp;found&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1426"></a><div class='linenum'>1426</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Mahajan&nbsp;and&nbsp;Vinay&nbsp;\cite{MV97}.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1427"></a><div class='linenum'>1427</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1428"></a><div class='linenum'>1428</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;run&nbsp;time&nbsp;is&nbsp;$O(n^4)$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1429"></a><div class='linenum'>1429</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Auxillary&nbsp;storage&nbsp;size&nbsp;$n^2+n&nbsp;+&nbsp;C$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1430"></a><div class='linenum'>1430</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1431"></a><div class='linenum'>1431</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Our&nbsp;implementation&nbsp;has&nbsp;two&nbsp;runtime&nbsp;optimizations&nbsp;(both&nbsp;noted
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1432"></a><div class='linenum'>1432</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;by&nbsp;Mahajan&nbsp;and&nbsp;Vinay)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1433"></a><div class='linenum'>1433</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;Partial&nbsp;monomial&nbsp;sums,&nbsp;subtractions,&nbsp;and&nbsp;products&nbsp;are&nbsp;done&nbsp;at
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1434"></a><div class='linenum'>1434</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each&nbsp;level.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1435"></a><div class='linenum'>1435</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Prefix&nbsp;property&nbsp;is&nbsp;maintained&nbsp;allowing&nbsp;for&nbsp;a&nbsp;pruning&nbsp;of&nbsp;many
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1436"></a><div class='linenum'>1436</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vertices&nbsp;at&nbsp;each&nbsp;level
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1437"></a><div class='linenum'>1437</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1438"></a><div class='linenum'>1438</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;two&nbsp;auxillary&nbsp;storage&nbsp;size&nbsp;optimizations
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1439"></a><div class='linenum'>1439</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;only&nbsp;the&nbsp;upper&nbsp;triangular&nbsp;and&nbsp;diagonal&nbsp;portion&nbsp;of&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1440"></a><div class='linenum'>1440</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auxillary&nbsp;storage&nbsp;is&nbsp;used.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1441"></a><div class='linenum'>1441</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Level&nbsp;information&nbsp;storage&nbsp;is&nbsp;reused&nbsp;(2&nbsp;levels).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1442"></a><div class='linenum'>1442</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1443"></a><div class='linenum'>1443</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;code&nbsp;was&nbsp;implemented&nbsp;by:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1444"></a><div class='linenum'>1444</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;Timothy&nbsp;DeBaillie
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1445"></a><div class='linenum'>1445</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;Robert&nbsp;Morse
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1446"></a><div class='linenum'>1446</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;Marcus&nbsp;Wassmer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1447"></a><div class='linenum'>1447</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1448"></a><div class='linenum'>1448</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DeterminantMatDivFree,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1449"></a><div class='linenum'>1449</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"Division-free&nbsp;method",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1450"></a><div class='linenum'>1450</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1451"></a><div class='linenum'>1451</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;M&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1452"></a><div class='linenum'>1452</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;u,v,w,i,&nbsp;&nbsp;&nbsp;##&nbsp;indices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1453"></a><div class='linenum'>1453</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a,b,c,x,y,&nbsp;##&nbsp;temp&nbsp;indices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1454"></a><div class='linenum'>1454</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;temp&nbsp;variable
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1455"></a><div class='linenum'>1455</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nlevel,&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;next&nbsp;level
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1456"></a><div class='linenum'>1456</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clevel,&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;current&nbsp;level
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1457"></a><div class='linenum'>1457</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pmone,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;plus&nbsp;or&nbsp;minus&nbsp;one
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1458"></a><div class='linenum'>1458</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;zero&nbsp;of&nbsp;the&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1459"></a><div class='linenum'>1459</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;size&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1460"></a><div class='linenum'>1460</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vs,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;final&nbsp;sum
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1461"></a><div class='linenum'>1461</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;graph
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1462"></a><div class='linenum'>1462</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1463"></a><div class='linenum'>1463</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;that&nbsp;the&nbsp;argument&nbsp;is&nbsp;a&nbsp;square&nbsp;matrix&nbsp;and&nbsp;set&nbsp;the&nbsp;size
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1464"></a><div class='linenum'>1464</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;Length(M);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1465"></a><div class='linenum'>1465</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;n&nbsp;=&nbsp;Length(M[1])&nbsp;or&nbsp;not&nbsp;IsRectangularTable(M)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1466"></a><div class='linenum'>1466</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("DeterminantMatDivFree:&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1467"></a><div class='linenum'>1467</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1468"></a><div class='linenum'>1468</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1469"></a><div class='linenum'>1469</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;initialze&nbsp;the&nbsp;final&nbsp;sum,&nbsp;the&nbsp;vertex&nbsp;set,&nbsp;initial&nbsp;parity
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1470"></a><div class='linenum'>1470</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;and&nbsp;level&nbsp;indexes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1471"></a><div class='linenum'>1471</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1472"></a><div class='linenum'>1472</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(M[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1473"></a><div class='linenum'>1473</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vs&nbsp;:=&nbsp;zero;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1474"></a><div class='linenum'>1474</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1475"></a><div class='linenum'>1475</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pmone&nbsp;:=&nbsp;(-One(M[1][1]))^((n&nbsp;mod&nbsp;2)+1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1476"></a><div class='linenum'>1476</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clevel&nbsp;:=&nbsp;1;&nbsp;nlevel&nbsp;:=&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1477"></a><div class='linenum'>1477</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1478"></a><div class='linenum'>1478</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;Vertices&nbsp;are&nbsp;indexed&nbsp;[u,v,i]&nbsp;holding&nbsp;the&nbsp;(partial)&nbsp;monomials
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1479"></a><div class='linenum'>1479</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;whose&nbsp;sums&nbsp;will&nbsp;form&nbsp;the&nbsp;determinant
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1480"></a><div class='linenum'>1480</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;i&nbsp;=&nbsp;depth&nbsp;in&nbsp;the&nbsp;tree&nbsp;(current&nbsp;and&nbsp;next&nbsp;reusing
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1481"></a><div class='linenum'>1481</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;level&nbsp;storage)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1482"></a><div class='linenum'>1482</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u,v&nbsp;indices&nbsp;in&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1483"></a><div class='linenum'>1483</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1484"></a><div class='linenum'>1484</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;Only&nbsp;the&nbsp;upper&nbsp;triangular&nbsp;portion&nbsp;of&nbsp;the&nbsp;storage&nbsp;space&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1485"></a><div class='linenum'>1485</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;needed.&nbsp;It&nbsp;is&nbsp;easier&nbsp;to&nbsp;create&nbsp;lower&nbsp;triangular&nbsp;data&nbsp;type
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1486"></a><div class='linenum'>1486</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;which&nbsp;we&nbsp;do&nbsp;here&nbsp;and&nbsp;index&nbsp;via&nbsp;index&nbsp;arithmetic.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1487"></a><div class='linenum'>1487</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1488"></a><div class='linenum'>1488</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;u&nbsp;in&nbsp;[1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1489"></a><div class='linenum'>1489</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(V,[]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1490"></a><div class='linenum'>1490</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;in&nbsp;[1..u]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1491"></a><div class='linenum'>1491</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(V[u],[zero,zero]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1492"></a><div class='linenum'>1492</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1493"></a><div class='linenum'>1493</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;Initialize&nbsp;the&nbsp;level&nbsp;0&nbsp;nodes&nbsp;with&nbsp;+/-&nbsp;one,&nbsp;depending&nbsp;on
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1494"></a><div class='linenum'>1494</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;the&nbsp;initial&nbsp;parity&nbsp;determined&nbsp;by&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1495"></a><div class='linenum'>1495</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1496"></a><div class='linenum'>1496</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V[u][u][clevel]&nbsp;:=&nbsp;pmone;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1497"></a><div class='linenum'>1497</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1498"></a><div class='linenum'>1498</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1499"></a><div class='linenum'>1499</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;Here&nbsp;are&nbsp;the&nbsp;$O(n^4)$&nbsp;edges&nbsp;labeled&nbsp;by&nbsp;the&nbsp;elements&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1500"></a><div class='linenum'>1500</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;the&nbsp;matrix&nbsp;$M$.&nbsp;We&nbsp;build&nbsp;up&nbsp;products&nbsp;of&nbsp;the&nbsp;labels&nbsp;which&nbsp;form
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1501"></a><div class='linenum'>1501</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;the&nbsp;monomials&nbsp;which&nbsp;make&nbsp;up&nbsp;the&nbsp;determinant.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1502"></a><div class='linenum'>1502</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1503"></a><div class='linenum'>1503</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;1.&nbsp;Parity&nbsp;of&nbsp;monomials&nbsp;are&nbsp;maintained&nbsp;implicitly.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1504"></a><div class='linenum'>1504</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;2.&nbsp;Partial&nbsp;sums&nbsp;for&nbsp;some&nbsp;vertices&nbsp;are&nbsp;not&nbsp;part&nbsp;of&nbsp;the&nbsp;final
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1505"></a><div class='linenum'>1505</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer&nbsp;and&nbsp;can&nbsp;be&nbsp;pruned.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1506"></a><div class='linenum'>1506</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1507"></a><div class='linenum'>1507</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[0..n-2]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1508"></a><div class='linenum'>1508</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;u&nbsp;in&nbsp;[1..i+2]&nbsp;do&nbsp;&nbsp;##&nbsp;&lt;----&nbsp;pruning&nbsp;of&nbsp;vertices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1509"></a><div class='linenum'>1509</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;in&nbsp;[u..n]&nbsp;do&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;(maintains&nbsp;the&nbsp;prefix&nbsp;property)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1510"></a><div class='linenum'>1510</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;w&nbsp;in&nbsp;[u+1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1511"></a><div class='linenum'>1511</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1512"></a><div class='linenum'>1512</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;translate&nbsp;indices&nbsp;to&nbsp;lower&nbsp;triangluar&nbsp;coordinates
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1513"></a><div class='linenum'>1513</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1514"></a><div class='linenum'>1514</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;:=&nbsp;n-u+1;&nbsp;b&nbsp;:=&nbsp;n-w+1;&nbsp;c&nbsp;:=&nbsp;n-v+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1515"></a><div class='linenum'>1515</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V[a][b][nlevel]:=&nbsp;V[a][b][nlevel]+
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1516"></a><div class='linenum'>1516</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V[a][c][clevel]*M[v][w];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1517"></a><div class='linenum'>1517</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V[b][b][nlevel]:=&nbsp;V[b][b][nlevel]-
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1518"></a><div class='linenum'>1518</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V[a][c][clevel]*M[v][u];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1519"></a><div class='linenum'>1519</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1520"></a><div class='linenum'>1520</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1521"></a><div class='linenum'>1521</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1522"></a><div class='linenum'>1522</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1523"></a><div class='linenum'>1523</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;set&nbsp;the&nbsp;new&nbsp;current&nbsp;and&nbsp;next&nbsp;level.&nbsp;The&nbsp;new&nbsp;next&nbsp;level
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1524"></a><div class='linenum'>1524</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;is&nbsp;intialized&nbsp;to&nbsp;zero
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1525"></a><div class='linenum'>1525</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1526"></a><div class='linenum'>1526</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;&nbsp;&nbsp;:=&nbsp;nlevel;&nbsp;nlevel&nbsp;:=&nbsp;clevel;&nbsp;clevel&nbsp;:=&nbsp;temp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1527"></a><div class='linenum'>1527</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;in&nbsp;[1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1528"></a><div class='linenum'>1528</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;y&nbsp;in&nbsp;[1..x]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1529"></a><div class='linenum'>1529</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V[x][y][nlevel]&nbsp;:=&nbsp;zero;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1530"></a><div class='linenum'>1530</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1531"></a><div class='linenum'>1531</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1532"></a><div class='linenum'>1532</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1533"></a><div class='linenum'>1533</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1534"></a><div class='linenum'>1534</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;with&nbsp;the&nbsp;final&nbsp;level,&nbsp;we&nbsp;form&nbsp;the&nbsp;last&nbsp;monomial&nbsp;product&nbsp;and&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1535"></a><div class='linenum'>1535</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;sum&nbsp;these&nbsp;monomials&nbsp;(parity&nbsp;has&nbsp;been&nbsp;accounted&nbsp;for)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1536"></a><div class='linenum'>1536</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;to&nbsp;find&nbsp;the&nbsp;determinant.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1537"></a><div class='linenum'>1537</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1538"></a><div class='linenum'>1538</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;u&nbsp;in&nbsp;[1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1539"></a><div class='linenum'>1539</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;in&nbsp;[u..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1540"></a><div class='linenum'>1540</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vs&nbsp;:=&nbsp;Vs&nbsp;+&nbsp;V[n-u+1][n-v+1][clevel]*M[v][u];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1541"></a><div class='linenum'>1541</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1542"></a><div class='linenum'>1542</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1543"></a><div class='linenum'>1543</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1544"></a><div class='linenum'>1544</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;Return&nbsp;the&nbsp;final&nbsp;sum
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1545"></a><div class='linenum'>1545</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1546"></a><div class='linenum'>1546</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Vs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1547"></a><div class='linenum'>1547</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1548"></a><div class='linenum'>1548</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1549"></a><div class='linenum'>1549</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1550"></a><div class='linenum'>1550</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1551"></a><div class='linenum'>1551</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1552"></a><div class='linenum'>1552</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DimensionsMat(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1553"></a><div class='linenum'>1553</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1554"></a><div class='linenum'>1554</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DimensionsMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1555"></a><div class='linenum'>1555</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1556"></a><div class='linenum'>1556</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;A&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1557"></a><div class='linenum'>1557</div></td><td>48416</td><td>24568</td><td>24568</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsRectangularTable(A)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1558"></a><div class='linenum'>1558</div></td><td>24208</td><td>25411</td><td>25411</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;Length(A),&nbsp;Length(A[1])&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1559"></a><div class='linenum'>1559</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1560"></a><div class='linenum'>1560</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1561"></a><div class='linenum'>1561</div></td><td>24208</td><td>6822</td><td>6822</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1562"></a><div class='linenum'>1562</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1563"></a><div class='linenum'>1563</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1564"></a><div class='linenum'>1564</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("DoDiagonalizeMat",function(R,M,transform,divide)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1565"></a><div class='linenum'>1565</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;swaprow,&nbsp;swapcol,&nbsp;addcol,&nbsp;addrow,&nbsp;multcol,&nbsp;multrow,&nbsp;l,&nbsp;n,&nbsp;start,&nbsp;d,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1566"></a><div class='linenum'>1566</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typ,&nbsp;ed,&nbsp;posi,posj,&nbsp;a,&nbsp;b,&nbsp;qr,&nbsp;c,&nbsp;i,j,left,right,cleanout,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1567"></a><div class='linenum'>1567</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alldivide;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1568"></a><div class='linenum'>1568</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1569"></a><div class='linenum'>1569</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;swaprow:=function(a,b)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1570"></a><div class='linenum'>1570</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1571"></a><div class='linenum'>1571</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=M[a];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1572"></a><div class='linenum'>1572</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;M[a]:=M[b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1573"></a><div class='linenum'>1573</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;M[b]:=r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1574"></a><div class='linenum'>1574</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1575"></a><div class='linenum'>1575</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r:=left[a];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1576"></a><div class='linenum'>1576</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left[a]:=left[b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1577"></a><div class='linenum'>1577</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left[b]:=r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1578"></a><div class='linenum'>1578</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1579"></a><div class='linenum'>1579</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1580"></a><div class='linenum'>1580</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1581"></a><div class='linenum'>1581</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;swapcol:=function(a,b)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1582"></a><div class='linenum'>1582</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1583"></a><div class='linenum'>1583</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;c:=M{[1..l]}[a];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1584"></a><div class='linenum'>1584</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;M{[1..l]}[a]:=M{[1..l]}[b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1585"></a><div class='linenum'>1585</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;M{[1..l]}[b]:=c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1586"></a><div class='linenum'>1586</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1587"></a><div class='linenum'>1587</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c:=right{[1..n]}[a];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1588"></a><div class='linenum'>1588</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right{[1..n]}[a]:=right{[1..n]}[b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1589"></a><div class='linenum'>1589</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right{[1..n]}[b]:=c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1590"></a><div class='linenum'>1590</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1591"></a><div class='linenum'>1591</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1592"></a><div class='linenum'>1592</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1593"></a><div class='linenum'>1593</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;addcol:=function(a,b,m)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1594"></a><div class='linenum'>1594</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1595"></a><div class='linenum'>1595</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..l]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1596"></a><div class='linenum'>1596</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M[i][a]:=M[i][a]+m*M[i][b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1597"></a><div class='linenum'>1597</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1598"></a><div class='linenum'>1598</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1599"></a><div class='linenum'>1599</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1600"></a><div class='linenum'>1600</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right[i][a]:=right[i][a]+m*right[i][b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1601"></a><div class='linenum'>1601</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1602"></a><div class='linenum'>1602</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1603"></a><div class='linenum'>1603</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1604"></a><div class='linenum'>1604</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1605"></a><div class='linenum'>1605</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;addrow:=function(a,b,m)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1606"></a><div class='linenum'>1606</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;AddCoeffs(M[a],M[b],m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1607"></a><div class='linenum'>1607</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1608"></a><div class='linenum'>1608</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddCoeffs(left[a],left[b],m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1609"></a><div class='linenum'>1609</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1610"></a><div class='linenum'>1610</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1611"></a><div class='linenum'>1611</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1612"></a><div class='linenum'>1612</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;multcol:=function(a,m)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1613"></a><div class='linenum'>1613</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1614"></a><div class='linenum'>1614</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..l]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1615"></a><div class='linenum'>1615</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M[i][a]:=M[i][a]*m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1616"></a><div class='linenum'>1616</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1617"></a><div class='linenum'>1617</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1618"></a><div class='linenum'>1618</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1619"></a><div class='linenum'>1619</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right[i][a]:=right[i][a]*m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1620"></a><div class='linenum'>1620</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1621"></a><div class='linenum'>1621</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1622"></a><div class='linenum'>1622</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1623"></a><div class='linenum'>1623</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1624"></a><div class='linenum'>1624</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;multrow:=function(a,m)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1625"></a><div class='linenum'>1625</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(M[a],m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1626"></a><div class='linenum'>1626</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;transform&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1627"></a><div class='linenum'>1627</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(left[a],m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1628"></a><div class='linenum'>1628</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1629"></a><div class='linenum'>1629</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1630"></a><div class='linenum'>1630</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1631"></a><div class='linenum'>1631</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;clean&nbsp;out&nbsp;row&nbsp;and&nbsp;column
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1632"></a><div class='linenum'>1632</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;cleanout:=function()
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1633"></a><div class='linenum'>1633</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;a,i,b,c,qr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1634"></a><div class='linenum'>1634</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1635"></a><div class='linenum'>1635</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now&nbsp;do&nbsp;the&nbsp;GCD&nbsp;calculations&nbsp;only&nbsp;in&nbsp;row/column
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1636"></a><div class='linenum'>1636</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[start+1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1637"></a><div class='linenum'>1637</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a:=i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1638"></a><div class='linenum'>1638</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b:=start;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1639"></a><div class='linenum'>1639</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsZero(M[start][b])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1640"></a><div class='linenum'>1640</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1641"></a><div class='linenum'>1641</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qr:=QuotientRemainder(R,M[start][a],M[start][b]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1642"></a><div class='linenum'>1642</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addcol(a,b,-qr[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1643"></a><div class='linenum'>1643</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c:=a;a:=b;b:=c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1644"></a><div class='linenum'>1644</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;IsZero(qr[2]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1645"></a><div class='linenum'>1645</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;b=start&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1646"></a><div class='linenum'>1646</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swapcol(start,i);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1647"></a><div class='linenum'>1647</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1648"></a><div class='linenum'>1648</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1649"></a><div class='linenum'>1649</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1650"></a><div class='linenum'>1650</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;normalize
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1651"></a><div class='linenum'>1651</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qr:=StandardAssociateUnit(R,M[start][start]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1652"></a><div class='linenum'>1652</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multcol(start,qr);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1653"></a><div class='linenum'>1653</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1654"></a><div class='linenum'>1654</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1655"></a><div class='linenum'>1655</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1656"></a><div class='linenum'>1656</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[start+1..l]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1657"></a><div class='linenum'>1657</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a:=i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1658"></a><div class='linenum'>1658</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b:=start;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1659"></a><div class='linenum'>1659</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsZero(M[b][start])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1660"></a><div class='linenum'>1660</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1661"></a><div class='linenum'>1661</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qr:=QuotientRemainder(R,M[a][start],M[b][start]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1662"></a><div class='linenum'>1662</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addrow(a,b,-qr[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1663"></a><div class='linenum'>1663</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c:=a;a:=b;b:=c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1664"></a><div class='linenum'>1664</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;IsZero(qr[2]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1665"></a><div class='linenum'>1665</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;b=start&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1666"></a><div class='linenum'>1666</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swaprow(start,i);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1667"></a><div class='linenum'>1667</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1668"></a><div class='linenum'>1668</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1669"></a><div class='linenum'>1669</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1670"></a><div class='linenum'>1670</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qr:=StandardAssociateUnit(R,M[start][start]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1671"></a><div class='linenum'>1671</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multrow(start,qr);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1672"></a><div class='linenum'>1672</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1673"></a><div class='linenum'>1673</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1674"></a><div class='linenum'>1674</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;ForAll([start+1..n],i->IsZero(M[start][i]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1675"></a><div class='linenum'>1675</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1676"></a><div class='linenum'>1676</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1677"></a><div class='linenum'>1677</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;l:=Length(M);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1678"></a><div class='linenum'>1678</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;n:=Length(M[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1679"></a><div class='linenum'>1679</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1680"></a><div class='linenum'>1680</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;transform&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1681"></a><div class='linenum'>1681</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;left:=IdentityMat(l,R);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1682"></a><div class='linenum'>1682</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;right:=IdentityMat(n,R);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1683"></a><div class='linenum'>1683</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1684"></a><div class='linenum'>1684</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1685"></a><div class='linenum'>1685</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;start:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1686"></a><div class='linenum'>1686</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;start&lt;=Length(M)&nbsp;and&nbsp;start&lt;=n&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1687"></a><div class='linenum'>1687</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1688"></a><div class='linenum'>1688</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;element&nbsp;of&nbsp;lowest&nbsp;degree&nbsp;and&nbsp;move&nbsp;it&nbsp;into&nbsp;pivot
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1689"></a><div class='linenum'>1689</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;hope&nbsp;is&nbsp;this&nbsp;will&nbsp;reduce&nbsp;the&nbsp;total&nbsp;number&nbsp;of&nbsp;iterations&nbsp;by&nbsp;making
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1690"></a><div class='linenum'>1690</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;it&nbsp;small&nbsp;in&nbsp;the&nbsp;first&nbsp;place
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1691"></a><div class='linenum'>1691</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;d:=infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1692"></a><div class='linenum'>1692</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1693"></a><div class='linenum'>1693</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[start..l]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1694"></a><div class='linenum'>1694</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[start..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1695"></a><div class='linenum'>1695</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsZero(M[i][j])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1696"></a><div class='linenum'>1696</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ed:=EuclideanDegree(R,M[i][j]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1697"></a><div class='linenum'>1697</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ed&lt;d&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1698"></a><div class='linenum'>1698</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d:=ed;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1699"></a><div class='linenum'>1699</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posi:=i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1700"></a><div class='linenum'>1700</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posj:=j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1701"></a><div class='linenum'>1701</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1702"></a><div class='linenum'>1702</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1703"></a><div class='linenum'>1703</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1704"></a><div class='linenum'>1704</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1705"></a><div class='linenum'>1705</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1706"></a><div class='linenum'>1706</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;d&lt;>infinity&nbsp;then&nbsp;#&nbsp;there&nbsp;is&nbsp;at&nbsp;least&nbsp;one&nbsp;nonzero&nbsp;entry
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1707"></a><div class='linenum'>1707</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1708"></a><div class='linenum'>1708</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;posi&lt;>start&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1709"></a><div class='linenum'>1709</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swaprow(start,posi);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1710"></a><div class='linenum'>1710</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1711"></a><div class='linenum'>1711</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;posj&lt;>start&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1712"></a><div class='linenum'>1712</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swapcol(start,posj);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1713"></a><div class='linenum'>1713</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1714"></a><div class='linenum'>1714</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleanout();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1715"></a><div class='linenum'>1715</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1716"></a><div class='linenum'>1716</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;divide&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1717"></a><div class='linenum'>1717</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1718"></a><div class='linenum'>1718</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alldivide:=true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1719"></a><div class='linenum'>1719</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#make&nbsp;sure&nbsp;the&nbsp;pivot&nbsp;also&nbsp;divides&nbsp;the&nbsp;rest
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1720"></a><div class='linenum'>1720</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[start+1..l]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1721"></a><div class='linenum'>1721</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[start+1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1722"></a><div class='linenum'>1722</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Quotient(M[i][j],M[start][start])=fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1723"></a><div class='linenum'>1723</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alldivide:=false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1724"></a><div class='linenum'>1724</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;gcd
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1725"></a><div class='linenum'>1725</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addrow(start,i,1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1726"></a><div class='linenum'>1726</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleanout();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1727"></a><div class='linenum'>1727</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1728"></a><div class='linenum'>1728</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1729"></a><div class='linenum'>1729</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1730"></a><div class='linenum'>1730</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;alldivide;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1731"></a><div class='linenum'>1731</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1732"></a><div class='linenum'>1732</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1733"></a><div class='linenum'>1733</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1734"></a><div class='linenum'>1734</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;normalize
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1735"></a><div class='linenum'>1735</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qr:=StandardAssociateUnit(R,M[start][start]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1736"></a><div class='linenum'>1736</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multcol(start,qr);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1737"></a><div class='linenum'>1737</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1738"></a><div class='linenum'>1738</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1739"></a><div class='linenum'>1739</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;start:=start+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1740"></a><div class='linenum'>1740</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1741"></a><div class='linenum'>1741</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1742"></a><div class='linenum'>1742</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;transform&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1743"></a><div class='linenum'>1743</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;return&nbsp;rec(rowtrans:=left,coltrans:=right,normal:=M);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1744"></a><div class='linenum'>1744</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1745"></a><div class='linenum'>1745</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;M;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1746"></a><div class='linenum'>1746</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1747"></a><div class='linenum'>1747</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1748"></a><div class='linenum'>1748</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1749"></a><div class='linenum'>1749</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1750"></a><div class='linenum'>1750</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1751"></a><div class='linenum'>1751</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DiagonalizeMat(&lt;euclring>,&lt;mat>)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1752"></a><div class='linenum'>1752</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1753"></a><div class='linenum'>1753</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;this&nbsp;is&nbsp;a&nbsp;very&nbsp;naive&nbsp;implementation&nbsp;but&nbsp;it&nbsp;should&nbsp;work&nbsp;for&nbsp;any&nbsp;euclidean
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1754"></a><div class='linenum'>1754</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;ring.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1755"></a><div class='linenum'>1755</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DiagonalizeMat,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1756"></a><div class='linenum'>1756</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;"method&nbsp;for&nbsp;general&nbsp;Euclidean&nbsp;Ring",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1757"></a><div class='linenum'>1757</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;true,&nbsp;[&nbsp;IsEuclideanRing,IsMatrix&nbsp;and&nbsp;IsMutable],&nbsp;0,function(R,M)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1758"></a><div class='linenum'>1758</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;DoDiagonalizeMat(R,M,false,false);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1759"></a><div class='linenum'>1759</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1760"></a><div class='linenum'>1760</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1761"></a><div class='linenum'>1761</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1762"></a><div class='linenum'>1762</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1763"></a><div class='linenum'>1763</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1764"></a><div class='linenum'>1764</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ElementaryDivisorsMat(&lt;mat>)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;elementary&nbsp;divisors&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1765"></a><div class='linenum'>1765</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1766"></a><div class='linenum'>1766</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'ElementaryDivisors'&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;the&nbsp;elementary&nbsp;divisors,&nbsp;i.e.,&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1767"></a><div class='linenum'>1767</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;unique&nbsp;&lt;d>&nbsp;with&nbsp;'&lt;d>[&lt;i>]'&nbsp;divides&nbsp;'&lt;d>[&lt;i>+1]'&nbsp;and&nbsp;&lt;mat>&nbsp;&nbsp;is&nbsp;&nbsp;equivalent
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1768"></a><div class='linenum'>1768</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;to&nbsp;a&nbsp;diagonal&nbsp;matrix&nbsp;with&nbsp;the&nbsp;elements&nbsp;'&lt;d>[&lt;i>]'&nbsp;on&nbsp;the&nbsp;diagonal.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1769"></a><div class='linenum'>1769</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1770"></a><div class='linenum'>1770</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1771"></a><div class='linenum'>1771</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(ElementaryDivisorsMatDestructive,function(ring,mat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1772"></a><div class='linenum'>1772</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;diagonalize&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1773"></a><div class='linenum'>1773</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;DoDiagonalizeMat(ring,&nbsp;mat,false,true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1774"></a><div class='linenum'>1774</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1775"></a><div class='linenum'>1775</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;diagonal&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1776"></a><div class='linenum'>1776</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;DiagonalOfMat(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1777"></a><div class='linenum'>1777</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1778"></a><div class='linenum'>1778</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1779"></a><div class='linenum'>1779</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ElementaryDivisorsMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1780"></a><div class='linenum'>1780</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;euclidean&nbsp;rings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1781"></a><div class='linenum'>1781</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsEuclideanRing,IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1782"></a><div class='linenum'>1782</div></td><td></td><td></td><td></td><td><span><tt>function&nbsp;(&nbsp;ring,mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1783"></a><div class='linenum'>1783</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;make&nbsp;a&nbsp;copy&nbsp;to&nbsp;avoid&nbsp;changing&nbsp;the&nbsp;original&nbsp;argument
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1784"></a><div class='linenum'>1784</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;mat&nbsp;:=&nbsp;MutableCopyMat(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1785"></a><div class='linenum'>1785</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsIdenticalObj(ring,Integers)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1786"></a><div class='linenum'>1786</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;DiagonalizeMat(Integers,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1787"></a><div class='linenum'>1787</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;DiagonalOfMat(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1788"></a><div class='linenum'>1788</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1789"></a><div class='linenum'>1789</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;ElementaryDivisorsMatDestructive(ring,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1790"></a><div class='linenum'>1790</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1791"></a><div class='linenum'>1791</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1792"></a><div class='linenum'>1792</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ElementaryDivisorsMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1793"></a><div class='linenum'>1793</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"compatibility&nbsp;method&nbsp;--&nbsp;supply&nbsp;ring",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1794"></a><div class='linenum'>1794</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1795"></a><div class='linenum'>1795</div></td><td></td><td></td><td></td><td><span><tt>function(mat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1796"></a><div class='linenum'>1796</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;ring;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1797"></a><div class='linenum'>1797</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;ForAll(mat,row->ForAll(row,IsInt))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1798"></a><div class='linenum'>1798</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ElementaryDivisorsMat(Integers,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1799"></a><div class='linenum'>1799</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1800"></a><div class='linenum'>1800</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ring:=DefaultRing(Flat(mat));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1801"></a><div class='linenum'>1801</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;ElementaryDivisorsMat(ring,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1802"></a><div class='linenum'>1802</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1803"></a><div class='linenum'>1803</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1804"></a><div class='linenum'>1804</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1805"></a><div class='linenum'>1805</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1806"></a><div class='linenum'>1806</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ElementaryDivisorsTransformationsMat(&lt;mat>)&nbsp;elem.&nbsp;divisors&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1807"></a><div class='linenum'>1807</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1808"></a><div class='linenum'>1808</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'ElementaryDivisorsTransformationsMat'&nbsp;does&nbsp;not&nbsp;only&nbsp;compute&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1809"></a><div class='linenum'>1809</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;elementary&nbsp;divisors,&nbsp;but&nbsp;also&nbsp;transforming&nbsp;matrices.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1810"></a><div class='linenum'>1810</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1811"></a><div class='linenum'>1811</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(ElementaryDivisorsTransformationsMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1812"></a><div class='linenum'>1812</div></td><td></td><td></td><td></td><td><span><tt>function(ring,mat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1813"></a><div class='linenum'>1813</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1814"></a><div class='linenum'>1814</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;diagonalize&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1815"></a><div class='linenum'>1815</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;DoDiagonalizeMat(ring,&nbsp;mat,true,true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1816"></a><div class='linenum'>1816</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1817"></a><div class='linenum'>1817</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1818"></a><div class='linenum'>1818</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1819"></a><div class='linenum'>1819</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ElementaryDivisorsTransformationsMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1820"></a><div class='linenum'>1820</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;euclidean&nbsp;rings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1821"></a><div class='linenum'>1821</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsEuclideanRing,IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1822"></a><div class='linenum'>1822</div></td><td></td><td></td><td></td><td><span><tt>function&nbsp;(&nbsp;ring,mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1823"></a><div class='linenum'>1823</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;make&nbsp;a&nbsp;copy&nbsp;to&nbsp;avoid&nbsp;changing&nbsp;the&nbsp;original&nbsp;argument
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1824"></a><div class='linenum'>1824</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;mat&nbsp;:=&nbsp;MutableCopyMat(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1825"></a><div class='linenum'>1825</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;ElementaryDivisorsTransformationsMatDestructive(ring,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1826"></a><div class='linenum'>1826</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1827"></a><div class='linenum'>1827</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1828"></a><div class='linenum'>1828</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ElementaryDivisorsTransformationsMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1829"></a><div class='linenum'>1829</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"compatibility&nbsp;method&nbsp;--&nbsp;supply&nbsp;ring",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1830"></a><div class='linenum'>1830</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1831"></a><div class='linenum'>1831</div></td><td></td><td></td><td></td><td><span><tt>function(mat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1832"></a><div class='linenum'>1832</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;ring;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1833"></a><div class='linenum'>1833</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;ForAll(mat,row->ForAll(row,IsInt))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1834"></a><div class='linenum'>1834</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ElementaryDivisorsTransformationsMat(Integers,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1835"></a><div class='linenum'>1835</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1836"></a><div class='linenum'>1836</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ring:=DefaultRing(Flat(mat));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1837"></a><div class='linenum'>1837</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;ElementaryDivisorsTransformationsMat(ring,mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1838"></a><div class='linenum'>1838</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1839"></a><div class='linenum'>1839</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1840"></a><div class='linenum'>1840</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1841"></a><div class='linenum'>1841</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1842"></a><div class='linenum'>1842</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;MutableCopyMat(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1843"></a><div class='linenum'>1843</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1844"></a><div class='linenum'>1844</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MutableCopyMat,&nbsp;"generic&nbsp;method",&nbsp;[IsList],
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1845"></a><div class='linenum'>1845</div></td><td>429</td><td>511</td><td>5826</td><td><span><tt>&nbsp;&nbsp;mat&nbsp;->&nbsp;List(&nbsp;mat,&nbsp;ShallowCopy&nbsp;)&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_coll.gi.html#line727">List</a> </span></td></tr>
<tr class='ignore'><td><a name="line1846"></a><div class='linenum'>1846</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1847"></a><div class='linenum'>1847</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1848"></a><div class='linenum'>1848</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1849"></a><div class='linenum'>1849</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1850"></a><div class='linenum'>1850</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;MutableTransposedMat(&nbsp;&lt;mat>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;transposed&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1851"></a><div class='linenum'>1851</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1852"></a><div class='linenum'>1852</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MutableTransposedMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1853"></a><div class='linenum'>1853</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1854"></a><div class='linenum'>1854</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsRectangularTable&nbsp;and&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1855"></a><div class='linenum'>1855</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1856"></a><div class='linenum'>1856</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;trn,&nbsp;n,&nbsp;m,&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1857"></a><div class='linenum'>1857</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1858"></a><div class='linenum'>1858</div></td><td>30655</td><td>12407</td><td>12407</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;Length(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1859"></a><div class='linenum'>1859</div></td><td>30655</td><td>9973</td><td>9973</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;=&nbsp;0&nbsp;then&nbsp;return&nbsp;[];&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1860"></a><div class='linenum'>1860</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1861"></a><div class='linenum'>1861</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;initialize&nbsp;the&nbsp;transposed
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1862"></a><div class='linenum'>1862</div></td><td>30655</td><td>11101</td><td>11101</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;[&nbsp;1&nbsp;..&nbsp;m&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1863"></a><div class='linenum'>1863</div></td><td>30655</td><td>12883</td><td>12883</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;mat[1]&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1864"></a><div class='linenum'>1864</div></td><td>30655</td><td>10331</td><td>10331</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;trn:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1865"></a><div class='linenum'>1865</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1866"></a><div class='linenum'>1866</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;copy&nbsp;the&nbsp;entries
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1867"></a><div class='linenum'>1867</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;n&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1868"></a><div class='linenum'>1868</div></td><td>30655</td><td>912901</td><td>912901</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trn[j]:=&nbsp;mat{&nbsp;m&nbsp;}[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1869"></a><div class='linenum'>1869</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;trn[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1870"></a><div class='linenum'>1870</div></td><td>30655</td><td>10893</td><td>10893</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1871"></a><div class='linenum'>1871</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1872"></a><div class='linenum'>1872</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;transposed
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1873"></a><div class='linenum'>1873</div></td><td>30655</td><td>910666</td><td>910666</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;trn;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1874"></a><div class='linenum'>1874</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1875"></a><div class='linenum'>1875</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1876"></a><div class='linenum'>1876</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1877"></a><div class='linenum'>1877</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1878"></a><div class='linenum'>1878</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;MutableTransposedMat(&nbsp;&lt;mat>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;transposed&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1879"></a><div class='linenum'>1879</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1880"></a><div class='linenum'>1880</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;MutableTransposedMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1881"></a><div class='linenum'>1881</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;arbitrary&nbsp;lists&nbsp;of&nbsp;lists",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1882"></a><div class='linenum'>1882</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1883"></a><div class='linenum'>1883</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;t&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1884"></a><div class='linenum'>1884</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;res,&nbsp;&nbsp;m,&nbsp;&nbsp;i,&nbsp;&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1885"></a><div class='linenum'>1885</div></td><td>9307</td><td>3518</td><td>3518</td><td><span><tt>&nbsp;&nbsp;res&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1886"></a><div class='linenum'>1886</div></td><td>9307</td><td>5250</td><td>17012</td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(t)>0&nbsp;and&nbsp;IsDenseList(t)&nbsp;and&nbsp;ForAll(t,&nbsp;IsDenseList)&nbsp;then
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_coll.gi.html#line1608">ForAll</a> </span></td></tr>
<tr class='ignore'><td><a name="line1887"></a><div class='linenum'>1887</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;special&nbsp;case&nbsp;with&nbsp;dense&nbsp;list&nbsp;of&nbsp;dense&nbsp;lists
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1888"></a><div class='linenum'>1888</div></td><td>387</td><td>642</td><td>18313</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;Maximum(List(t,&nbsp;Length));
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_coll.gi.html#line727">List</a> <a href="_opt_gap_gap4r8p5_lib_list.gi.html#line2363">Maximum</a> </span></td></tr>
<tr class='exec'><td><a name="line1889"></a><div class='linenum'>1889</div></td><td>387</td><td>189</td><td>189</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[m,m-1..1]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1890"></a><div class='linenum'>1890</div></td><td>386</td><td>1151</td><td>1151</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[i]&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1891"></a><div class='linenum'>1891</div></td><td>387</td><td>122</td><td>122</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1892"></a><div class='linenum'>1892</div></td><td>387</td><td>149</td><td>149</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(t)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1893"></a><div class='linenum'>1893</div></td><td>387</td><td>148416</td><td>148416</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res{[1..Length(t[i])]}[i]&nbsp;:=&nbsp;t[i];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1894"></a><div class='linenum'>1894</div></td><td>387</td><td>108</td><td>108</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1895"></a><div class='linenum'>1895</div></td><td>387</td><td>92</td><td>92</td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1896"></a><div class='linenum'>1896</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;general&nbsp;case,&nbsp;non&nbsp;dense&nbsp;lists&nbsp;allowed
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1897"></a><div class='linenum'>1897</div></td><td>8920</td><td>3337</td><td>3337</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(t)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1898"></a><div class='linenum'>1898</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(t[i])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1899"></a><div class='linenum'>1899</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsList(t[i])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1900"></a><div class='linenum'>1900</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..Length(t[i])]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1901"></a><div class='linenum'>1901</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(t[i][j])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1902"></a><div class='linenum'>1902</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(res[j])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1903"></a><div class='linenum'>1903</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[j]&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1904"></a><div class='linenum'>1904</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1905"></a><div class='linenum'>1905</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[j][i]&nbsp;:=&nbsp;t[i][j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1906"></a><div class='linenum'>1906</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1907"></a><div class='linenum'>1907</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1908"></a><div class='linenum'>1908</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1909"></a><div class='linenum'>1909</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("bound&nbsp;entries&nbsp;must&nbsp;be&nbsp;lists");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1910"></a><div class='linenum'>1910</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1911"></a><div class='linenum'>1911</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1912"></a><div class='linenum'>1912</div></td><td>8920</td><td>3086</td><td>3086</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1913"></a><div class='linenum'>1913</div></td><td>9307</td><td>2625</td><td>2625</td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1914"></a><div class='linenum'>1914</div></td><td>9307</td><td>42873</td><td>42873</td><td><span><tt>&nbsp;&nbsp;return&nbsp;res;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1915"></a><div class='linenum'>1915</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1916"></a><div class='linenum'>1916</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1917"></a><div class='linenum'>1917</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1918"></a><div class='linenum'>1918</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1919"></a><div class='linenum'>1919</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1920"></a><div class='linenum'>1920</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1921"></a><div class='linenum'>1921</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1922"></a><div class='linenum'>1922</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;MutableTransposedMatDestructive(&nbsp;&lt;mat>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;transposed&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1923"></a><div class='linenum'>1923</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;destroy&nbsp;`mat'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1924"></a><div class='linenum'>1924</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1925"></a><div class='linenum'>1925</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MutableTransposedMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1926"></a><div class='linenum'>1926</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1927"></a><div class='linenum'>1927</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[IsMatrix&nbsp;and&nbsp;IsMutable],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1928"></a><div class='linenum'>1928</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1929"></a><div class='linenum'>1929</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1930"></a><div class='linenum'>1930</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;m,&nbsp;&nbsp;n,&nbsp;&nbsp;min,&nbsp;&nbsp;i,&nbsp;&nbsp;j,&nbsp;&nbsp;store;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1931"></a><div class='linenum'>1931</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1932"></a><div class='linenum'>1932</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1933"></a><div class='linenum'>1933</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;Length(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1934"></a><div class='linenum'>1934</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;=&nbsp;0&nbsp;then&nbsp;return&nbsp;[];&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1935"></a><div class='linenum'>1935</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1936"></a><div class='linenum'>1936</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Length(&nbsp;mat[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1937"></a><div class='linenum'>1937</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;min:=&nbsp;Minimum(&nbsp;m,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1938"></a><div class='linenum'>1938</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1939"></a><div class='linenum'>1939</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;swap&nbsp;the&nbsp;entries&nbsp;in&nbsp;the&nbsp;"square&nbsp;part"&nbsp;of&nbsp;the&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1940"></a><div class='linenum'>1940</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..min]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1941"></a><div class='linenum'>1941</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[i+1..min]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1942"></a><div class='linenum'>1942</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store:=&nbsp;mat[i][j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1943"></a><div class='linenum'>1943</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i][j]:=&nbsp;mat[j][i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1944"></a><div class='linenum'>1944</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[j][i]:=&nbsp;store;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1945"></a><div class='linenum'>1945</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1946"></a><div class='linenum'>1946</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1947"></a><div class='linenum'>1947</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1948"></a><div class='linenum'>1948</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;the&nbsp;matrix&nbsp;is&nbsp;not&nbsp;square,&nbsp;then&nbsp;we&nbsp;have&nbsp;to&nbsp;adjust&nbsp;some&nbsp;rows&nbsp;or
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1949"></a><div class='linenum'>1949</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;columns.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1950"></a><div class='linenum'>1950</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;&lt;&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1951"></a><div class='linenum'>1951</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..n-m]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1952"></a><div class='linenum'>1952</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store:=&nbsp;[&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1953"></a><div class='linenum'>1953</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..m]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1954"></a><div class='linenum'>1954</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store[j]:=&nbsp;mat[j][m+i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1955"></a><div class='linenum'>1955</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unbind(&nbsp;mat[j][m+i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1956"></a><div class='linenum'>1956</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1957"></a><div class='linenum'>1957</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;mat,&nbsp;store&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1958"></a><div class='linenum'>1958</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1959"></a><div class='linenum'>1959</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..m]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1960"></a><div class='linenum'>1960</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i]:=&nbsp;Filtered(&nbsp;mat[i],&nbsp;x&nbsp;->&nbsp;IsBound(x)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1961"></a><div class='linenum'>1961</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1962"></a><div class='linenum'>1962</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1963"></a><div class='linenum'>1963</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1964"></a><div class='linenum'>1964</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;>&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1965"></a><div class='linenum'>1965</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[n+1..m]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1966"></a><div class='linenum'>1966</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..n]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1967"></a><div class='linenum'>1967</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[j][i]:=&nbsp;mat[i][j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1968"></a><div class='linenum'>1968</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1969"></a><div class='linenum'>1969</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unbind(&nbsp;mat[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1970"></a><div class='linenum'>1970</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1971"></a><div class='linenum'>1971</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;Filtered(&nbsp;mat,&nbsp;x&nbsp;->&nbsp;IsBound(&nbsp;x&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1972"></a><div class='linenum'>1972</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1973"></a><div class='linenum'>1973</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1974"></a><div class='linenum'>1974</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;transposed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1975"></a><div class='linenum'>1975</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1976"></a><div class='linenum'>1976</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1977"></a><div class='linenum'>1977</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1978"></a><div class='linenum'>1978</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1979"></a><div class='linenum'>1979</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1980"></a><div class='linenum'>1980</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1981"></a><div class='linenum'>1981</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;NullspaceMat(&nbsp;&lt;mat>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;basis&nbsp;of&nbsp;solutions&nbsp;of&nbsp;&lt;vec>&nbsp;*&nbsp;&lt;mat>&nbsp;=&nbsp;0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1982"></a><div class='linenum'>1982</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1983"></a><div class='linenum'>1983</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NullspaceMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1984"></a><div class='linenum'>1984</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;ordinary&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1985"></a><div class='linenum'>1985</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1986"></a><div class='linenum'>1986</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;->&nbsp;SemiEchelonMatTransformation(mat).relations&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1987"></a><div class='linenum'>1987</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1988"></a><div class='linenum'>1988</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NullspaceMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1989"></a><div class='linenum'>1989</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;ordinary&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1990"></a><div class='linenum'>1990</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;&nbsp;and&nbsp;IsMutable],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1991"></a><div class='linenum'>1991</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;->&nbsp;SemiEchelonMatTransformationDestructive(mat).relations&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1992"></a><div class='linenum'>1992</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1993"></a><div class='linenum'>1993</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TriangulizedNullspaceMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1994"></a><div class='linenum'>1994</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;ordinary&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1995"></a><div class='linenum'>1995</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1996"></a><div class='linenum'>1996</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;->&nbsp;TriangulizedNullspaceMatDestructive(&nbsp;MutableCopyMat(&nbsp;mat&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1997"></a><div class='linenum'>1997</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1998"></a><div class='linenum'>1998</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TriangulizedNullspaceMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1999"></a><div class='linenum'>1999</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;ordinary&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2000"></a><div class='linenum'>2000</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and&nbsp;IsMutable],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2001"></a><div class='linenum'>2001</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2002"></a><div class='linenum'>2002</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;ns;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2003"></a><div class='linenum'>2003</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ns&nbsp;:=&nbsp;SemiEchelonMatTransformationDestructive(mat).relations;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2004"></a><div class='linenum'>2004</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TriangulizeMat(ns);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2005"></a><div class='linenum'>2005</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ns;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2006"></a><div class='linenum'>2006</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2007"></a><div class='linenum'>2007</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2008"></a><div class='linenum'>2008</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TriangulizedNullspaceMatNT,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2009"></a><div class='linenum'>2009</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2010"></a><div class='linenum'>2010</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2011"></a><div class='linenum'>2011</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2012"></a><div class='linenum'>2012</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;nullspace,&nbsp;m,&nbsp;n,&nbsp;min,&nbsp;empty,&nbsp;i,&nbsp;k,&nbsp;row,&nbsp;zero,&nbsp;one;#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2013"></a><div class='linenum'>2013</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2014"></a><div class='linenum'>2014</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TriangulizeMat(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2015"></a><div class='linenum'>2015</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2016"></a><div class='linenum'>2016</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;Length(mat[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2017"></a><div class='linenum'>2017</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(&nbsp;mat[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2018"></a><div class='linenum'>2018</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;&nbsp;:=&nbsp;One(&nbsp;mat[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2019"></a><div class='linenum'>2019</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;:=&nbsp;Minimum(&nbsp;m,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2020"></a><div class='linenum'>2020</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2021"></a><div class='linenum'>2021</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;insert&nbsp;empty&nbsp;rows&nbsp;to&nbsp;bring&nbsp;the&nbsp;leading&nbsp;term&nbsp;of&nbsp;each&nbsp;row&nbsp;on&nbsp;the&nbsp;diagonal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2022"></a><div class='linenum'>2022</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;empty&nbsp;:=&nbsp;0*mat[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2023"></a><div class='linenum'>2023</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2024"></a><div class='linenum'>2024</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;i&nbsp;&lt;=&nbsp;Length(mat)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2025"></a><div class='linenum'>2025</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&lt;&nbsp;n&nbsp;&nbsp;and&nbsp;mat[i][i]&nbsp;=&nbsp;zero&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2026"></a><div class='linenum'>2026</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;Reversed([i..Minimum(Length(mat),n-1)])&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2027"></a><div class='linenum'>2027</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[k+1]&nbsp;:=&nbsp;mat[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2028"></a><div class='linenum'>2028</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2029"></a><div class='linenum'>2029</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i]&nbsp;:=&nbsp;empty;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2030"></a><div class='linenum'>2030</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2031"></a><div class='linenum'>2031</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2032"></a><div class='linenum'>2032</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2033"></a><div class='linenum'>2033</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;Length(mat)+1&nbsp;..&nbsp;n&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2034"></a><div class='linenum'>2034</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i]&nbsp;:=&nbsp;empty;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2035"></a><div class='linenum'>2035</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2036"></a><div class='linenum'>2036</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2037"></a><div class='linenum'>2037</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;'mat'&nbsp;now&nbsp;&nbsp;looks&nbsp;&nbsp;like&nbsp;&nbsp;[&nbsp;[1,2,0,2],&nbsp;[0,0,0,0],&nbsp;[0,0,1,3],&nbsp;[0,0,0,0]&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2038"></a><div class='linenum'>2038</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;the&nbsp;solutions&nbsp;can&nbsp;be&nbsp;read&nbsp;in&nbsp;those&nbsp;columns&nbsp;with&nbsp;a&nbsp;0&nbsp;on&nbsp;the&nbsp;diagonal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2039"></a><div class='linenum'>2039</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;by&nbsp;replacing&nbsp;this&nbsp;0&nbsp;by&nbsp;a&nbsp;-1,&nbsp;in&nbsp;&nbsp;this&nbsp;&nbsp;example&nbsp;&nbsp;[2,-1,0,0],&nbsp;[2,0,3,-1].
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2040"></a><div class='linenum'>2040</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nullspace&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2041"></a><div class='linenum'>2041</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;Reversed([1..n])&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2042"></a><div class='linenum'>2042</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mat[k][k]&nbsp;=&nbsp;zero&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2043"></a><div class='linenum'>2043</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2044"></a><div class='linenum'>2044</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[1..k-1]&nbsp;&nbsp;do&nbsp;row[n-i+1]&nbsp;:=&nbsp;-mat[i][k];&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2045"></a><div class='linenum'>2045</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row[n-k+1]&nbsp;:=&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2046"></a><div class='linenum'>2046</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[k+1..n]&nbsp;&nbsp;do&nbsp;row[n-i+1]&nbsp;:=&nbsp;zero;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2047"></a><div class='linenum'>2047</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2048"></a><div class='linenum'>2048</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;nullspace,&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2049"></a><div class='linenum'>2049</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2050"></a><div class='linenum'>2050</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2051"></a><div class='linenum'>2051</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2052"></a><div class='linenum'>2052</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nullspace;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2053"></a><div class='linenum'>2053</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2054"></a><div class='linenum'>2054</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2055"></a><div class='linenum'>2055</div></td><td></td><td></td><td></td><td><span><tt>#InstallMethod(TriangulizedNullspaceMat,"generic&nbsp;method",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2056"></a><div class='linenum'>2056</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;[IsOrdinaryMatrix],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2057"></a><div class='linenum'>2057</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2058"></a><div class='linenum'>2058</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;triangulize&nbsp;the&nbsp;transposed&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2059"></a><div class='linenum'>2059</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;TriangulizedNullspaceMatNT(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2060"></a><div class='linenum'>2060</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableTransposedMat(&nbsp;Reversed(&nbsp;mat&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2061"></a><div class='linenum'>2061</div></td><td></td><td></td><td></td><td><span><tt>#end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2062"></a><div class='linenum'>2062</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2063"></a><div class='linenum'>2063</div></td><td></td><td></td><td></td><td><span><tt>#InstallMethod(TriangulizedNullspaceMatDestructive,"generic&nbsp;method",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2064"></a><div class='linenum'>2064</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;[IsOrdinaryMatrix],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2065"></a><div class='linenum'>2065</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2066"></a><div class='linenum'>2066</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;triangulize&nbsp;the&nbsp;transposed&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2067"></a><div class='linenum'>2067</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;TriangulizedNullspaceMatNT(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2068"></a><div class='linenum'>2068</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableTransposedMatDestructive(&nbsp;Reversed(&nbsp;mat&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2069"></a><div class='linenum'>2069</div></td><td></td><td></td><td></td><td><span><tt>#end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2070"></a><div class='linenum'>2070</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2071"></a><div class='linenum'>2071</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2072"></a><div class='linenum'>2072</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2073"></a><div class='linenum'>2073</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2074"></a><div class='linenum'>2074</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;GeneralisedEigenvalues(&nbsp;&lt;F>,&nbsp;&lt;A>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2075"></a><div class='linenum'>2075</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2076"></a><div class='linenum'>2076</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;GeneralisedEigenvalues,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2077"></a><div class='linenum'>2077</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2078"></a><div class='linenum'>2078</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2079"></a><div class='linenum'>2079</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;F,&nbsp;A&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2080"></a><div class='linenum'>2080</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Set(&nbsp;Factors(&nbsp;UnivariatePolynomialRing(F),&nbsp;MinimalPolynomial(F,&nbsp;A,1)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2081"></a><div class='linenum'>2081</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2082"></a><div class='linenum'>2082</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2083"></a><div class='linenum'>2083</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2084"></a><div class='linenum'>2084</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2085"></a><div class='linenum'>2085</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;GeneralisedEigenspaces(&nbsp;&lt;F>,&nbsp;&lt;A>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2086"></a><div class='linenum'>2086</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2087"></a><div class='linenum'>2087</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;GeneralisedEigenspaces,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2088"></a><div class='linenum'>2088</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2089"></a><div class='linenum'>2089</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2090"></a><div class='linenum'>2090</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;F,&nbsp;A&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2091"></a><div class='linenum'>2091</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;GeneralisedEigenvalues(&nbsp;F,&nbsp;A&nbsp;),&nbsp;eval&nbsp;->
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2092"></a><div class='linenum'>2092</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VectorSpace(&nbsp;F,&nbsp;TriangulizedNullspaceMat(&nbsp;Value(&nbsp;eval,&nbsp;A&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2093"></a><div class='linenum'>2093</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2094"></a><div class='linenum'>2094</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2095"></a><div class='linenum'>2095</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2096"></a><div class='linenum'>2096</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2097"></a><div class='linenum'>2097</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Eigenvalues(&nbsp;&lt;F>,&nbsp;&lt;A>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2098"></a><div class='linenum'>2098</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2099"></a><div class='linenum'>2099</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Eigenvalues,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2100"></a><div class='linenum'>2100</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2101"></a><div class='linenum'>2101</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2102"></a><div class='linenum'>2102</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;F,&nbsp;A&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2103"></a><div class='linenum'>2103</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;Filtered(&nbsp;GeneralisedEigenvalues(F,A),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2104"></a><div class='linenum'>2104</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval&nbsp;->&nbsp;DegreeOfLaurentPolynomial(eval)&nbsp;=&nbsp;1&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2105"></a><div class='linenum'>2105</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval&nbsp;->&nbsp;-1&nbsp;*&nbsp;Value(eval,0)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2106"></a><div class='linenum'>2106</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2107"></a><div class='linenum'>2107</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2108"></a><div class='linenum'>2108</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2109"></a><div class='linenum'>2109</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2110"></a><div class='linenum'>2110</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Eigenspaces(&nbsp;&lt;F>,&nbsp;&lt;A>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2111"></a><div class='linenum'>2111</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2112"></a><div class='linenum'>2112</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Eigenspaces,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2113"></a><div class='linenum'>2113</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2114"></a><div class='linenum'>2114</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2115"></a><div class='linenum'>2115</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;F,&nbsp;A&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2116"></a><div class='linenum'>2116</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;Eigenvalues(F,A),&nbsp;eval&nbsp;->
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2117"></a><div class='linenum'>2117</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VectorSpace(&nbsp;F,&nbsp;TriangulizedNullspaceMat(A&nbsp;-&nbsp;eval*One(A))&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2118"></a><div class='linenum'>2118</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2119"></a><div class='linenum'>2119</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2120"></a><div class='linenum'>2120</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2121"></a><div class='linenum'>2121</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2122"></a><div class='linenum'>2122</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Eigenvectors(&nbsp;&lt;F>,&nbsp;&lt;A>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2123"></a><div class='linenum'>2123</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2124"></a><div class='linenum'>2124</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Eigenvectors,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2125"></a><div class='linenum'>2125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2126"></a><div class='linenum'>2126</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsField,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2127"></a><div class='linenum'>2127</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;F,&nbsp;A&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2128"></a><div class='linenum'>2128</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Concatenation(&nbsp;List(&nbsp;Eigenspaces(F,A),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2129"></a><div class='linenum'>2129</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;esp&nbsp;->&nbsp;AsList(Basis(esp))&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2130"></a><div class='linenum'>2130</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2131"></a><div class='linenum'>2131</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2132"></a><div class='linenum'>2132</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2133"></a><div class='linenum'>2133</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2134"></a><div class='linenum'>2134</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2135"></a><div class='linenum'>2135</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2136"></a><div class='linenum'>2136</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ProjectiveOrder(&nbsp;&lt;mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;order&nbsp;mod&nbsp;scalars
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2137"></a><div class='linenum'>2137</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2138"></a><div class='linenum'>2138</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ProjectiveOrder,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2139"></a><div class='linenum'>2139</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"ordinary&nbsp;matrix&nbsp;of&nbsp;finite&nbsp;field&nbsp;elements",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2140"></a><div class='linenum'>2140</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and&nbsp;IsFFECollColl&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2141"></a><div class='linenum'>2141</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2142"></a><div class='linenum'>2142</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;p,&nbsp;&nbsp;c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2143"></a><div class='linenum'>2143</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2144"></a><div class='linenum'>2144</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;construct&nbsp;the&nbsp;minimal&nbsp;polynomial&nbsp;of&nbsp;&lt;A>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2145"></a><div class='linenum'>2145</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;MinimalPolynomialMatrixNC(&nbsp;DefaultFieldOfMatrix(mat),&nbsp;mat,1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2146"></a><div class='linenum'>2146</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2147"></a><div class='linenum'>2147</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;if&nbsp;&lt;A>&nbsp;is&nbsp;invertible
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2148"></a><div class='linenum'>2148</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;CoefficientsOfUnivariatePolynomial(p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2149"></a><div class='linenum'>2149</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;c[1]&nbsp;=&nbsp;Zero(c[1])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2150"></a><div class='linenum'>2150</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"matrix&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;invertible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2151"></a><div class='linenum'>2151</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2152"></a><div class='linenum'>2152</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2153"></a><div class='linenum'>2153</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;the&nbsp;order&nbsp;of&nbsp;&lt;p>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2154"></a><div class='linenum'>2154</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ProjectiveOrder(p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2155"></a><div class='linenum'>2155</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2156"></a><div class='linenum'>2156</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2157"></a><div class='linenum'>2157</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2158"></a><div class='linenum'>2158</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2159"></a><div class='linenum'>2159</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2160"></a><div class='linenum'>2160</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RankMat(&nbsp;&lt;mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;rank&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2161"></a><div class='linenum'>2161</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2162"></a><div class='linenum'>2162</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RankMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2163"></a><div class='linenum'>2163</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;mutable&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2164"></a><div class='linenum'>2164</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;and&nbsp;IsMutable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2165"></a><div class='linenum'>2165</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2166"></a><div class='linenum'>2166</div></td><td>27</td><td>138</td><td>84516</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;SemiEchelonMatDestructive(&nbsp;mat&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_matrix.gi.html#line2186">/opt/gap/gap4r8p5/lib/matrix.gi:2186</a> </span></td></tr>
<tr class='exec'><td><a name="line2167"></a><div class='linenum'>2167</div></td><td>27</td><td>63</td><td>63</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mat&nbsp;&lt;>&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2168"></a><div class='linenum'>2168</div></td><td>27</td><td>13</td><td>13</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;Length(&nbsp;mat.vectors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2169"></a><div class='linenum'>2169</div></td><td>27</td><td>9</td><td>9</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2170"></a><div class='linenum'>2170</div></td><td>27</td><td>38</td><td>38</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2171"></a><div class='linenum'>2171</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2172"></a><div class='linenum'>2172</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2173"></a><div class='linenum'>2173</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RankMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2174"></a><div class='linenum'>2174</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2175"></a><div class='linenum'>2175</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2176"></a><div class='linenum'>2176</div></td><td>28</td><td>99</td><td>85472</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;->&nbsp;RankMatDestructive(&nbsp;MutableCopyMat(&nbsp;mat&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_matrix.gi.html#line1845">/opt/gap/gap4r8p5/lib/matrix.gi:1845</a> <a href="_opt_gap_gap4r8p5_lib_matrix.gi.html#line2165">/opt/gap/gap4r8p5/lib/matrix.gi:2165</a> </span></td></tr>
<tr class='ignore'><td><a name="line2177"></a><div class='linenum'>2177</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2178"></a><div class='linenum'>2178</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2179"></a><div class='linenum'>2179</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2180"></a><div class='linenum'>2180</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2181"></a><div class='linenum'>2181</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SemiEchelonMat(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2182"></a><div class='linenum'>2182</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2183"></a><div class='linenum'>2183</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SemiEchelonMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2184"></a><div class='linenum'>2184</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2185"></a><div class='linenum'>2185</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;and&nbsp;IsMutable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2186"></a><div class='linenum'>2186</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2187"></a><div class='linenum'>2187</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;zero,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;of&nbsp;the&nbsp;field&nbsp;of&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2188"></a><div class='linenum'>2188</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrows,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;rows&nbsp;in&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2189"></a><div class='linenum'>2189</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ncols,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;columns&nbsp;in&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2190"></a><div class='linenum'>2190</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors,&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;basis&nbsp;vectors
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2191"></a><div class='linenum'>2191</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;pivot&nbsp;positions&nbsp;in&nbsp;`vectors'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2192"></a><div class='linenum'>2192</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;rows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2193"></a><div class='linenum'>2193</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;columns
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2194"></a><div class='linenum'>2194</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;a&nbsp;current&nbsp;element
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2195"></a><div class='linenum'>2195</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nzheads,&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;non-zero&nbsp;heads
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2196"></a><div class='linenum'>2196</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;row&nbsp;of&nbsp;current&nbsp;interest
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2197"></a><div class='linenum'>2197</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;inverse&nbsp;of&nbsp;a&nbsp;matrix&nbsp;entry
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2198"></a><div class='linenum'>2198</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2199"></a><div class='linenum'>2199</div></td><td>27</td><td>17</td><td>17</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nrows:=&nbsp;Length(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2200"></a><div class='linenum'>2200</div></td><td>27</td><td>8</td><td>8</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ncols:=&nbsp;Length(&nbsp;mat[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2201"></a><div class='linenum'>2201</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2202"></a><div class='linenum'>2202</div></td><td>27</td><td>119</td><td>319</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero:=&nbsp;Zero(&nbsp;mat[1][1]&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_arith.gi.html#line78">/opt/gap/gap4r8p5/lib/arith.gi:78</a> <a href="_opt_gap_gap4r8p5_lib_arith.gi.html#line136">/opt/gap/gap4r8p5/lib/arith.gi:136</a> </span></td></tr>
<tr class='ignore'><td><a name="line2203"></a><div class='linenum'>2203</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2204"></a><div class='linenum'>2204</div></td><td>27</td><td>26</td><td>156</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;heads:=&nbsp;ListWithIdenticalEntries(&nbsp;ncols,&nbsp;0&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_list.gi.html#line3530">ListWithIdenticalEntries</a> </span></td></tr>
<tr class='exec'><td><a name="line2205"></a><div class='linenum'>2205</div></td><td>27</td><td>9</td><td>9</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nzheads&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2206"></a><div class='linenum'>2206</div></td><td>27</td><td>16</td><td>16</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;vectors&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2207"></a><div class='linenum'>2207</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2208"></a><div class='linenum'>2208</div></td><td>27</td><td>12</td><td>12</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nrows&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2209"></a><div class='linenum'>2209</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2210"></a><div class='linenum'>2210</div></td><td>1150</td><td>340</td><td>340</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;mat[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2211"></a><div class='linenum'>2211</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reduce&nbsp;the&nbsp;row&nbsp;with&nbsp;the&nbsp;known&nbsp;basis&nbsp;vectors.
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2212"></a><div class='linenum'>2212</div></td><td>1150</td><td>338</td><td>338</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(nzheads)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2213"></a><div class='linenum'>2213</div></td><td>23274</td><td>6879</td><td>6879</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;row[nzheads[j]];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2214"></a><div class='linenum'>2214</div></td><td>23274</td><td>5794</td><td>5794</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;>&nbsp;zero&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2215"></a><div class='linenum'>2215</div></td><td>19959</td><td>39838</td><td>39838</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(&nbsp;row,&nbsp;vectors[&nbsp;j&nbsp;],&nbsp;-&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2216"></a><div class='linenum'>2216</div></td><td>23274</td><td>5937</td><td>5937</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2217"></a><div class='linenum'>2217</div></td><td>1150</td><td>294</td><td>294</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2218"></a><div class='linenum'>2218</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2219"></a><div class='linenum'>2219</div></td><td>1150</td><td>924</td><td>17266</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;:=&nbsp;PositionNot(&nbsp;row,&nbsp;zero&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_list.gi.html#line3660">/opt/gap/gap4r8p5/lib/list.gi:3660</a> </span></td></tr>
<tr class='exec'><td><a name="line2220"></a><div class='linenum'>2220</div></td><td>1150</td><td>311</td><td>311</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j&nbsp;&lt;=&nbsp;ncols&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2221"></a><div class='linenum'>2221</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2222"></a><div class='linenum'>2222</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;found&nbsp;a&nbsp;new&nbsp;basis&nbsp;vector.
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2223"></a><div class='linenum'>2223</div></td><td>950</td><td>729</td><td>1412</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv:=&nbsp;Inverse(&nbsp;row[j]&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_arith.gi.html#line377">/opt/gap/gap4r8p5/lib/arith.gi:377</a> </span></td></tr>
<tr class='exec'><td><a name="line2224"></a><div class='linenum'>2224</div></td><td>950</td><td>284</td><td>284</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;inv&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2225"></a><div class='linenum'>2225</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2226"></a><div class='linenum'>2226</div></td><td>950</td><td>242</td><td>242</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2227"></a><div class='linenum'>2227</div></td><td>950</td><td>1106</td><td>1106</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(&nbsp;row,&nbsp;inv&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2228"></a><div class='linenum'>2228</div></td><td>950</td><td>380</td><td>380</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;vectors,&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2229"></a><div class='linenum'>2229</div></td><td>950</td><td>310</td><td>310</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;nzheads,&nbsp;j&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2230"></a><div class='linenum'>2230</div></td><td>950</td><td>339</td><td>339</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads[j]:=&nbsp;Length(&nbsp;vectors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2231"></a><div class='linenum'>2231</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2232"></a><div class='linenum'>2232</div></td><td>2100</td><td>588</td><td>588</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2233"></a><div class='linenum'>2233</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2234"></a><div class='linenum'>2234</div></td><td>1177</td><td>310</td><td>310</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2235"></a><div class='linenum'>2235</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2236"></a><div class='linenum'>2236</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;heads&nbsp;&nbsp;&nbsp;:=&nbsp;heads,
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2237"></a><div class='linenum'>2237</div></td><td>27</td><td>174</td><td>174</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors&nbsp;:=&nbsp;vectors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line2238"></a><div class='linenum'>2238</div></td><td>27</td><td>14</td><td>14</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2239"></a><div class='linenum'>2239</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2240"></a><div class='linenum'>2240</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SemiEchelonMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2241"></a><div class='linenum'>2241</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2242"></a><div class='linenum'>2242</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2243"></a><div class='linenum'>2243</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2244"></a><div class='linenum'>2244</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;copymat,&nbsp;v,&nbsp;vc,&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2245"></a><div class='linenum'>2245</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;copymat&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2246"></a><div class='linenum'>2246</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;DefaultFieldOfMatrix(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2247"></a><div class='linenum'>2247</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;in&nbsp;mat&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2248"></a><div class='linenum'>2248</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vc&nbsp;:=&nbsp;ShallowCopy(v);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2249"></a><div class='linenum'>2249</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(vc,f);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2250"></a><div class='linenum'>2250</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(copymat,&nbsp;vc);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2251"></a><div class='linenum'>2251</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2252"></a><div class='linenum'>2252</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SemiEchelonMatDestructive(&nbsp;copymat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2253"></a><div class='linenum'>2253</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2254"></a><div class='linenum'>2254</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2255"></a><div class='linenum'>2255</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2256"></a><div class='linenum'>2256</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2257"></a><div class='linenum'>2257</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2258"></a><div class='linenum'>2258</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SemiEchelonMatTransformation(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2259"></a><div class='linenum'>2259</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2260"></a><div class='linenum'>2260</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SemiEchelonMatTransformation,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2261"></a><div class='linenum'>2261</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2262"></a><div class='linenum'>2262</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2263"></a><div class='linenum'>2263</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2264"></a><div class='linenum'>2264</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;copymat,&nbsp;v,&nbsp;vc,&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2265"></a><div class='linenum'>2265</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;copymat&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2266"></a><div class='linenum'>2266</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;DefaultFieldOfMatrix(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2267"></a><div class='linenum'>2267</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;in&nbsp;mat&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2268"></a><div class='linenum'>2268</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vc&nbsp;:=&nbsp;ShallowCopy(v);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2269"></a><div class='linenum'>2269</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(vc,f);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2270"></a><div class='linenum'>2270</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(copymat,&nbsp;vc);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2271"></a><div class='linenum'>2271</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2272"></a><div class='linenum'>2272</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SemiEchelonMatTransformationDestructive(&nbsp;copymat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2273"></a><div class='linenum'>2273</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2274"></a><div class='linenum'>2274</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2275"></a><div class='linenum'>2275</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SemiEchelonMatTransformationDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2276"></a><div class='linenum'>2276</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2277"></a><div class='linenum'>2277</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;and&nbsp;IsMutable],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2278"></a><div class='linenum'>2278</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2279"></a><div class='linenum'>2279</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;zero,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;of&nbsp;the&nbsp;field&nbsp;of&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2280"></a><div class='linenum'>2280</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrows,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;rows&nbsp;in&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2281"></a><div class='linenum'>2281</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ncols,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;columns&nbsp;in&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2282"></a><div class='linenum'>2282</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors,&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;basis&nbsp;vectors
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2283"></a><div class='linenum'>2283</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;pivot&nbsp;positions&nbsp;in&nbsp;'vectors'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2284"></a><div class='linenum'>2284</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;rows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2285"></a><div class='linenum'>2285</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;columns
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2286"></a><div class='linenum'>2286</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transformation&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2287"></a><div class='linenum'>2287</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coeffs,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;coefficient&nbsp;vectors&nbsp;for&nbsp;'vectors'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2288"></a><div class='linenum'>2288</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relations,&nbsp;#&nbsp;basis&nbsp;vectors&nbsp;of&nbsp;the&nbsp;null&nbsp;space&nbsp;of&nbsp;'mat'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2289"></a><div class='linenum'>2289</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row,&nbsp;head,&nbsp;x,&nbsp;row2,f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2290"></a><div class='linenum'>2290</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2291"></a><div class='linenum'>2291</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nrows&nbsp;:=&nbsp;Length(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2292"></a><div class='linenum'>2292</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ncols&nbsp;:=&nbsp;Length(&nbsp;mat[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2293"></a><div class='linenum'>2293</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2294"></a><div class='linenum'>2294</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;DefaultFieldOfMatrix(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2295"></a><div class='linenum'>2295</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;f&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2296"></a><div class='linenum'>2296</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;mat[1][1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2297"></a><div class='linenum'>2297</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2298"></a><div class='linenum'>2298</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(f);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2299"></a><div class='linenum'>2299</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2300"></a><div class='linenum'>2300</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;heads&nbsp;&nbsp;&nbsp;:=&nbsp;ListWithIdenticalEntries(&nbsp;ncols,&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2301"></a><div class='linenum'>2301</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;vectors&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2302"></a><div class='linenum'>2302</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2303"></a><div class='linenum'>2303</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;IdentityMat(&nbsp;nrows,&nbsp;f&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2304"></a><div class='linenum'>2304</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;coeffs&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2305"></a><div class='linenum'>2305</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;relations&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2306"></a><div class='linenum'>2306</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2307"></a><div class='linenum'>2307</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nrows&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2308"></a><div class='linenum'>2308</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2309"></a><div class='linenum'>2309</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;mat[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2310"></a><div class='linenum'>2310</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row2&nbsp;:=&nbsp;T[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2311"></a><div class='linenum'>2311</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2312"></a><div class='linenum'>2312</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reduce&nbsp;the&nbsp;row&nbsp;with&nbsp;the&nbsp;known&nbsp;basis&nbsp;vectors.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2313"></a><div class='linenum'>2313</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;ncols&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2314"></a><div class='linenum'>2314</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;head&nbsp;:=&nbsp;heads[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2315"></a><div class='linenum'>2315</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;head&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2316"></a><div class='linenum'>2316</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;-&nbsp;row[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2317"></a><div class='linenum'>2317</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;>&nbsp;zero&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2318"></a><div class='linenum'>2318</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(&nbsp;row2,&nbsp;coeffs[&nbsp;head&nbsp;],&nbsp;&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2319"></a><div class='linenum'>2319</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(&nbsp;row,&nbsp;&nbsp;vectors[&nbsp;head&nbsp;],&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2320"></a><div class='linenum'>2320</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2321"></a><div class='linenum'>2321</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2322"></a><div class='linenum'>2322</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2323"></a><div class='linenum'>2323</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2324"></a><div class='linenum'>2324</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;PositionNot(&nbsp;row,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2325"></a><div class='linenum'>2325</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j&nbsp;&lt;=&nbsp;ncols&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2326"></a><div class='linenum'>2326</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2327"></a><div class='linenum'>2327</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;found&nbsp;a&nbsp;new&nbsp;basis&nbsp;vector.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2328"></a><div class='linenum'>2328</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=&nbsp;Inverse(&nbsp;row[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2329"></a><div class='linenum'>2329</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2330"></a><div class='linenum'>2330</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2331"></a><div class='linenum'>2331</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2332"></a><div class='linenum'>2332</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;coeffs,&nbsp;&nbsp;row2&nbsp;*&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2333"></a><div class='linenum'>2333</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;vectors,&nbsp;row&nbsp;&nbsp;*&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2334"></a><div class='linenum'>2334</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads[j]:=&nbsp;Length(&nbsp;vectors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2335"></a><div class='linenum'>2335</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2336"></a><div class='linenum'>2336</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2337"></a><div class='linenum'>2337</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;relations,&nbsp;row2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2338"></a><div class='linenum'>2338</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2339"></a><div class='linenum'>2339</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2340"></a><div class='linenum'>2340</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2341"></a><div class='linenum'>2341</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2342"></a><div class='linenum'>2342</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;heads&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;heads,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2343"></a><div class='linenum'>2343</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors&nbsp;&nbsp;&nbsp;:=&nbsp;vectors,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2344"></a><div class='linenum'>2344</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coeffs&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;coeffs,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2345"></a><div class='linenum'>2345</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;relations&nbsp;:=&nbsp;relations&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2346"></a><div class='linenum'>2346</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2347"></a><div class='linenum'>2347</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2348"></a><div class='linenum'>2348</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2349"></a><div class='linenum'>2349</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2350"></a><div class='linenum'>2350</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2351"></a><div class='linenum'>2351</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2352"></a><div class='linenum'>2352</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2353"></a><div class='linenum'>2353</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SemiEchelonMats(&nbsp;&lt;mats>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2354"></a><div class='linenum'>2354</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2355"></a><div class='linenum'>2355</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;SemiEchelonMatsNoCo,&nbsp;function(&nbsp;mats&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2356"></a><div class='linenum'>2356</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;zero,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;coefficient
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2357"></a><div class='linenum'>2357</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;rows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2358"></a><div class='linenum'>2358</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;columns
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2359"></a><div class='linenum'>2359</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2360"></a><div class='linenum'>2360</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors,&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;matrices&nbsp;in&nbsp;the&nbsp;echelonized&nbsp;basis
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2361"></a><div class='linenum'>2361</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;with&nbsp;info&nbsp;about&nbsp;leading&nbsp;entries
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2362"></a><div class='linenum'>2362</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;generators&nbsp;of&nbsp;'V'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2363"></a><div class='linenum'>2363</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;j,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;rows&nbsp;and&nbsp;columns&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2364"></a><div class='linenum'>2364</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k,&nbsp;l,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2365"></a><div class='linenum'>2365</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mij,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2366"></a><div class='linenum'>2366</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scalar,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2367"></a><div class='linenum'>2367</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2368"></a><div class='linenum'>2368</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2369"></a><div class='linenum'>2369</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero:=&nbsp;Zero(&nbsp;mats[1][1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2370"></a><div class='linenum'>2370</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;Length(&nbsp;mats[1]&nbsp;&nbsp;&nbsp;&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2371"></a><div class='linenum'>2371</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Length(&nbsp;mats[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2372"></a><div class='linenum'>2372</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2373"></a><div class='linenum'>2373</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;an&nbsp;echelonized&nbsp;basis.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2374"></a><div class='linenum'>2374</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;vectors&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2375"></a><div class='linenum'>2375</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;heads&nbsp;&nbsp;&nbsp;:=&nbsp;ListWithIdenticalEntries(&nbsp;n,&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2376"></a><div class='linenum'>2376</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;heads&nbsp;&nbsp;&nbsp;:=&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;m&nbsp;],&nbsp;x&nbsp;->&nbsp;ShallowCopy(&nbsp;heads&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2377"></a><div class='linenum'>2377</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2378"></a><div class='linenum'>2378</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mat&nbsp;in&nbsp;mats&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2379"></a><div class='linenum'>2379</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2380"></a><div class='linenum'>2380</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reduce&nbsp;the&nbsp;matrix&nbsp;modulo&nbsp;'ech'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2381"></a><div class='linenum'>2381</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;m&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2382"></a><div class='linenum'>2382</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2383"></a><div class='linenum'>2383</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;heads[i][j]&nbsp;&lt;>&nbsp;0&nbsp;and&nbsp;mat[i][j]&nbsp;&lt;>&nbsp;zero&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2384"></a><div class='linenum'>2384</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2385"></a><div class='linenum'>2385</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;'mat:=&nbsp;mat&nbsp;-&nbsp;mat[i][j]&nbsp;*&nbsp;vectors[&nbsp;heads[i][j]&nbsp;];'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2386"></a><div class='linenum'>2386</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scalar:=&nbsp;-&nbsp;mat[i][j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2387"></a><div class='linenum'>2387</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=&nbsp;vectors[&nbsp;heads[i][j]&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2388"></a><div class='linenum'>2388</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;m&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2389"></a><div class='linenum'>2389</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(&nbsp;mat[k],&nbsp;v[k],&nbsp;scalar&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2390"></a><div class='linenum'>2390</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2391"></a><div class='linenum'>2391</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2392"></a><div class='linenum'>2392</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2393"></a><div class='linenum'>2393</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2394"></a><div class='linenum'>2394</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2395"></a><div class='linenum'>2395</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2396"></a><div class='linenum'>2396</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Get&nbsp;the&nbsp;first&nbsp;nonzero&nbsp;column.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2397"></a><div class='linenum'>2397</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2398"></a><div class='linenum'>2398</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;PositionNot(&nbsp;mat[1],&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2399"></a><div class='linenum'>2399</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;&lt;&nbsp;j&nbsp;and&nbsp;i&nbsp;&lt;&nbsp;m&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2400"></a><div class='linenum'>2400</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2401"></a><div class='linenum'>2401</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;PositionNot(&nbsp;mat[i],&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2402"></a><div class='linenum'>2402</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2403"></a><div class='linenum'>2403</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2404"></a><div class='linenum'>2404</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j&nbsp;&lt;=&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2405"></a><div class='linenum'>2405</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2406"></a><div class='linenum'>2406</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;found&nbsp;a&nbsp;new&nbsp;basis&nbsp;vector.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2407"></a><div class='linenum'>2407</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mij:=&nbsp;mat[i][j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2408"></a><div class='linenum'>2408</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;m&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2409"></a><div class='linenum'>2409</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;l&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2410"></a><div class='linenum'>2410</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=&nbsp;Inverse(&nbsp;mij&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2411"></a><div class='linenum'>2411</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2412"></a><div class='linenum'>2412</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2413"></a><div class='linenum'>2413</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2414"></a><div class='linenum'>2414</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[k][l]:=&nbsp;mat[k][l]&nbsp;*&nbsp;x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2415"></a><div class='linenum'>2415</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2416"></a><div class='linenum'>2416</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2417"></a><div class='linenum'>2417</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2418"></a><div class='linenum'>2418</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;vectors,&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2419"></a><div class='linenum'>2419</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads[i][j]:=&nbsp;Length(&nbsp;vectors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2420"></a><div class='linenum'>2420</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2421"></a><div class='linenum'>2421</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2422"></a><div class='linenum'>2422</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2423"></a><div class='linenum'>2423</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2424"></a><div class='linenum'>2424</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2425"></a><div class='linenum'>2425</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;result.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2426"></a><div class='linenum'>2426</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2427"></a><div class='linenum'>2427</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors&nbsp;:=&nbsp;vectors,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2428"></a><div class='linenum'>2428</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads&nbsp;&nbsp;&nbsp;:=&nbsp;heads
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2429"></a><div class='linenum'>2429</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2430"></a><div class='linenum'>2430</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2431"></a><div class='linenum'>2431</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2432"></a><div class='linenum'>2432</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SemiEchelonMats,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2433"></a><div class='linenum'>2433</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list&nbsp;of&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2434"></a><div class='linenum'>2434</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2435"></a><div class='linenum'>2435</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mats&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2436"></a><div class='linenum'>2436</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SemiEchelonMatsNoCo(&nbsp;List(&nbsp;mats,&nbsp;x&nbsp;->&nbsp;MutableCopyMat(x)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2437"></a><div class='linenum'>2437</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2438"></a><div class='linenum'>2438</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2439"></a><div class='linenum'>2439</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SemiEchelonMatsDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2440"></a><div class='linenum'>2440</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list&nbsp;of&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2441"></a><div class='linenum'>2441</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2442"></a><div class='linenum'>2442</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mats&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2443"></a><div class='linenum'>2443</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SemiEchelonMatsNoCo(&nbsp;mats&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2444"></a><div class='linenum'>2444</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2445"></a><div class='linenum'>2445</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2446"></a><div class='linenum'>2446</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2447"></a><div class='linenum'>2447</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2448"></a><div class='linenum'>2448</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2449"></a><div class='linenum'>2449</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2450"></a><div class='linenum'>2450</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;TransposedMat(&nbsp;&lt;mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;transposed&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2451"></a><div class='linenum'>2451</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2452"></a><div class='linenum'>2452</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;TransposedMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2453"></a><div class='linenum'>2453</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices&nbsp;and&nbsp;lists",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2454"></a><div class='linenum'>2454</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2455"></a><div class='linenum'>2455</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;MutableTransposedMat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2456"></a><div class='linenum'>2456</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2457"></a><div class='linenum'>2457</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2458"></a><div class='linenum'>2458</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2459"></a><div class='linenum'>2459</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;TransposedMatDestructive(&nbsp;&lt;mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;transposed&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2460"></a><div class='linenum'>2460</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2461"></a><div class='linenum'>2461</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TransposedMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2462"></a><div class='linenum'>2462</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2463"></a><div class='linenum'>2463</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2464"></a><div class='linenum'>2464</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;MutableTransposedMatDestructive&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2465"></a><div class='linenum'>2465</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2466"></a><div class='linenum'>2466</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(TransposedMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2467"></a><div class='linenum'>2467</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;"method&nbsp;for&nbsp;empty&nbsp;matrices",[IsList],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2468"></a><div class='linenum'>2468</div></td><td></td><td></td><td></td><td><span><tt>function(mat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2469"></a><div class='linenum'>2469</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;mat&lt;>[]&nbsp;and&nbsp;mat&lt;>[[]]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2470"></a><div class='linenum'>2470</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2471"></a><div class='linenum'>2471</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2472"></a><div class='linenum'>2472</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2473"></a><div class='linenum'>2473</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2474"></a><div class='linenum'>2474</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2475"></a><div class='linenum'>2475</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2476"></a><div class='linenum'>2476</div></td><td></td><td></td><td></td><td><span><tt>############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2477"></a><div class='linenum'>2477</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2478"></a><div class='linenum'>2478</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2479"></a><div class='linenum'>2479</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsMonomialMatrix(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2480"></a><div class='linenum'>2480</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2481"></a><div class='linenum'>2481</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsMonomialMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2482"></a><div class='linenum'>2482</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2483"></a><div class='linenum'>2483</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2484"></a><div class='linenum'>2484</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;M&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2485"></a><div class='linenum'>2485</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;zero,&nbsp;&nbsp;#&nbsp;zero&nbsp;of&nbsp;the&nbsp;base&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2486"></a><div class='linenum'>2486</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len,&nbsp;&nbsp;&nbsp;#&nbsp;length&nbsp;of&nbsp;rows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2487"></a><div class='linenum'>2487</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found,&nbsp;#&nbsp;store&nbsp;positions&nbsp;of&nbsp;nonzero&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2488"></a><div class='linenum'>2488</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row,&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;rows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2489"></a><div class='linenum'>2489</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;position&nbsp;of&nbsp;first&nbsp;non-zero&nbsp;element
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2490"></a><div class='linenum'>2490</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2491"></a><div class='linenum'>2491</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero:=&nbsp;Zero(M[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2492"></a><div class='linenum'>2492</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;len:=&nbsp;Length(&nbsp;M[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2493"></a><div class='linenum'>2493</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;M&nbsp;)&nbsp;&lt;>&nbsp;len&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2494"></a><div class='linenum'>2494</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2495"></a><div class='linenum'>2495</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2496"></a><div class='linenum'>2496</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;BlistList(&nbsp;M,&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2497"></a><div class='linenum'>2497</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;&nbsp;in&nbsp;M&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2498"></a><div class='linenum'>2498</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;:=&nbsp;PositionNot(&nbsp;row,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2499"></a><div class='linenum'>2499</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;&lt;&nbsp;j&nbsp;or&nbsp;found[j]&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2500"></a><div class='linenum'>2500</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2501"></a><div class='linenum'>2501</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2502"></a><div class='linenum'>2502</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;PositionNot(&nbsp;row,&nbsp;zero,&nbsp;j&nbsp;)&nbsp;&lt;=&nbsp;len&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2503"></a><div class='linenum'>2503</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2504"></a><div class='linenum'>2504</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2505"></a><div class='linenum'>2505</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found[j]&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2506"></a><div class='linenum'>2506</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2507"></a><div class='linenum'>2507</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2508"></a><div class='linenum'>2508</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2509"></a><div class='linenum'>2509</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2510"></a><div class='linenum'>2510</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2511"></a><div class='linenum'>2511</div></td><td></td><td></td><td></td><td><span><tt>##########################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2512"></a><div class='linenum'>2512</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2513"></a><div class='linenum'>2513</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InverseMatMod(&nbsp;&lt;cyc-mat>,&nbsp;&lt;integer>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2514"></a><div class='linenum'>2514</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2515"></a><div class='linenum'>2515</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InverseMatMod,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2516"></a><div class='linenum'>2516</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrix&nbsp;and&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2517"></a><div class='linenum'>2517</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsCollCollsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2518"></a><div class='linenum'>2518</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,&nbsp;IsInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2519"></a><div class='linenum'>2519</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;mat,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2520"></a><div class='linenum'>2520</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;n,&nbsp;&nbsp;MM,&nbsp;inv,&nbsp;&nbsp;perm,&nbsp;&nbsp;i,&nbsp;&nbsp;pj,&nbsp;&nbsp;elem,&nbsp;&nbsp;liste,&nbsp;&nbsp;l;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2521"></a><div class='linenum'>2521</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2522"></a><div class='linenum'>2522</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(mat)&nbsp;&lt;>&nbsp;Length(mat[1])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2523"></a><div class='linenum'>2523</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;mat>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2524"></a><div class='linenum'>2524</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2525"></a><div class='linenum'>2525</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2526"></a><div class='linenum'>2526</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;MM&nbsp;:=&nbsp;List(&nbsp;mat,&nbsp;x&nbsp;->&nbsp;List(&nbsp;x,&nbsp;y&nbsp;->&nbsp;y&nbsp;mod&nbsp;m&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2527"></a><div class='linenum'>2527</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;:=&nbsp;Length(MM);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2528"></a><div class='linenum'>2528</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2529"></a><div class='linenum'>2529</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;construct&nbsp;the&nbsp;identity&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2530"></a><div class='linenum'>2530</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;inv&nbsp;:=&nbsp;IdentityMat(&nbsp;n,&nbsp;Cyclotomics&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2531"></a><div class='linenum'>2531</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;perm&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2532"></a><div class='linenum'>2532</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2533"></a><div class='linenum'>2533</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;rows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2534"></a><div class='linenum'>2534</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2535"></a><div class='linenum'>2535</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2536"></a><div class='linenum'>2536</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pj&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2537"></a><div class='linenum'>2537</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;MM[i][pj]&nbsp;=&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2538"></a><div class='linenum'>2538</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pj&nbsp;:=&nbsp;pj&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2539"></a><div class='linenum'>2539</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pj&nbsp;>&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2540"></a><div class='linenum'>2540</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;mat>&nbsp;is&nbsp;not&nbsp;invertible&nbsp;mod&nbsp;&lt;m>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2541"></a><div class='linenum'>2541</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2542"></a><div class='linenum'>2542</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2543"></a><div class='linenum'>2543</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2544"></a><div class='linenum'>2544</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perm[pj]&nbsp;:=&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2545"></a><div class='linenum'>2545</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elem&nbsp;&nbsp;&nbsp;:=&nbsp;MM[i][pj];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2546"></a><div class='linenum'>2546</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MM[i]&nbsp;&nbsp;:=&nbsp;List(&nbsp;MM[i],&nbsp;&nbsp;x&nbsp;->&nbsp;(x/elem)&nbsp;mod&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2547"></a><div class='linenum'>2547</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv[i]&nbsp;:=&nbsp;List(&nbsp;inv[i],&nbsp;x&nbsp;->&nbsp;(x/elem)&nbsp;mod&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2548"></a><div class='linenum'>2548</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2549"></a><div class='linenum'>2549</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;liste&nbsp;&nbsp;:=&nbsp;[&nbsp;1&nbsp;..&nbsp;i-1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2550"></a><div class='linenum'>2550</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;liste,&nbsp;[i+1..n]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2551"></a><div class='linenum'>2551</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;l&nbsp;in&nbsp;liste&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2552"></a><div class='linenum'>2552</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elem&nbsp;&nbsp;&nbsp;:=&nbsp;MM[l][pj];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2553"></a><div class='linenum'>2553</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MM[l]&nbsp;&nbsp;:=&nbsp;MM[l]&nbsp;-&nbsp;MM[i]&nbsp;*&nbsp;elem;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2554"></a><div class='linenum'>2554</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MM[l]&nbsp;&nbsp;:=&nbsp;List(&nbsp;MM[l],&nbsp;x&nbsp;->&nbsp;x&nbsp;mod&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2555"></a><div class='linenum'>2555</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv[l]&nbsp;:=&nbsp;inv[l]&nbsp;-&nbsp;inv[i]&nbsp;*&nbsp;elem;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2556"></a><div class='linenum'>2556</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv[l]&nbsp;:=&nbsp;List(&nbsp;inv[l],&nbsp;x&nbsp;->&nbsp;x&nbsp;mod&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2557"></a><div class='linenum'>2557</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2558"></a><div class='linenum'>2558</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2559"></a><div class='linenum'>2559</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;perm,&nbsp;i->inv[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2560"></a><div class='linenum'>2560</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2561"></a><div class='linenum'>2561</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2562"></a><div class='linenum'>2562</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2563"></a><div class='linenum'>2563</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2564"></a><div class='linenum'>2564</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2565"></a><div class='linenum'>2565</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;KroneckerProduct(&nbsp;&lt;mat1>,&nbsp;&lt;mat2>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2566"></a><div class='linenum'>2566</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2567"></a><div class='linenum'>2567</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;KroneckerProduct,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2568"></a><div class='linenum'>2568</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2569"></a><div class='linenum'>2569</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2570"></a><div class='linenum'>2570</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2571"></a><div class='linenum'>2571</div></td><td></td><td></td><td></td><td><span><tt>function&nbsp;(&nbsp;mat1,&nbsp;mat2&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2572"></a><div class='linenum'>2572</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;row1,&nbsp;row2,&nbsp;row,&nbsp;kroneckerproduct;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2573"></a><div class='linenum'>2573</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;kroneckerproduct&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2574"></a><div class='linenum'>2574</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row1&nbsp;&nbsp;in&nbsp;mat1&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2575"></a><div class='linenum'>2575</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row2&nbsp;&nbsp;in&nbsp;mat2&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2576"></a><div class='linenum'>2576</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2577"></a><div class='linenum'>2577</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;row1&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2578"></a><div class='linenum'>2578</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;row,&nbsp;i&nbsp;*&nbsp;row2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2579"></a><div class='linenum'>2579</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2580"></a><div class='linenum'>2580</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;application&nbsp;of&nbsp;the&nbsp;new&nbsp;'AddRowVector'&nbsp;function?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2581"></a><div class='linenum'>2581</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2582"></a><div class='linenum'>2582</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;kroneckerproduct,&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2583"></a><div class='linenum'>2583</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2584"></a><div class='linenum'>2584</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2585"></a><div class='linenum'>2585</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;kroneckerproduct;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2586"></a><div class='linenum'>2586</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2587"></a><div class='linenum'>2587</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2588"></a><div class='linenum'>2588</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;symmetric&nbsp;and&nbsp;alternating&nbsp;parts&nbsp;of&nbsp;the&nbsp;kronecker&nbsp;product
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2589"></a><div class='linenum'>2589</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;code&nbsp;is&nbsp;due&nbsp;to&nbsp;Jean&nbsp;Michel
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2590"></a><div class='linenum'>2590</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2591"></a><div class='linenum'>2591</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2592"></a><div class='linenum'>2592</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2593"></a><div class='linenum'>2593</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ExteriorPower(&nbsp;&lt;mat1>,&nbsp;&lt;mat2>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2594"></a><div class='linenum'>2594</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2595"></a><div class='linenum'>2595</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(ExteriorPower,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2596"></a><div class='linenum'>2596</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;"for&nbsp;matrices",&nbsp;true,[IsMatrix,IsPosInt],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2597"></a><div class='linenum'>2597</div></td><td></td><td></td><td></td><td><span><tt>function&nbsp;(&nbsp;A,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2598"></a><div class='linenum'>2598</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;&nbsp;basis;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2599"></a><div class='linenum'>2599</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;basis&nbsp;:=&nbsp;Combinations(&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;A&nbsp;)&nbsp;],&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2600"></a><div class='linenum'>2600</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;List(&nbsp;basis,&nbsp;i->List(&nbsp;basis,&nbsp;j->DeterminantMat(&nbsp;A{i}{j}&nbsp;)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2601"></a><div class='linenum'>2601</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2602"></a><div class='linenum'>2602</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2603"></a><div class='linenum'>2603</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2604"></a><div class='linenum'>2604</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2605"></a><div class='linenum'>2605</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SymmetricPower(&nbsp;&lt;mat1>,&nbsp;&lt;mat2>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2606"></a><div class='linenum'>2606</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2607"></a><div class='linenum'>2607</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(SymmetricPower,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2608"></a><div class='linenum'>2608</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;"for&nbsp;matrices",&nbsp;true,[IsMatrix,IsPosInt],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2609"></a><div class='linenum'>2609</div></td><td></td><td></td><td></td><td><span><tt>function&nbsp;(&nbsp;A,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2610"></a><div class='linenum'>2610</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;&nbsp;basis,&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2611"></a><div class='linenum'>2611</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;f&nbsp;:=&nbsp;j->Product(&nbsp;List(&nbsp;Collected(&nbsp;j&nbsp;),&nbsp;x->x[2]),&nbsp;Factorial&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2612"></a><div class='linenum'>2612</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;basis&nbsp;:=&nbsp;UnorderedTuples(&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;A&nbsp;)&nbsp;],&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2613"></a><div class='linenum'>2613</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;List(&nbsp;basis,&nbsp;i->&nbsp;List(&nbsp;basis,&nbsp;j->Permanent(&nbsp;A{i}{j})&nbsp;/&nbsp;f(&nbsp;i&nbsp;)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2614"></a><div class='linenum'>2614</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2615"></a><div class='linenum'>2615</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2616"></a><div class='linenum'>2616</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2617"></a><div class='linenum'>2617</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2618"></a><div class='linenum'>2618</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2619"></a><div class='linenum'>2619</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2620"></a><div class='linenum'>2620</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SolutionMat(&nbsp;&lt;mat>,&nbsp;&lt;vec>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;one&nbsp;solution&nbsp;of&nbsp;equation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2621"></a><div class='linenum'>2621</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2622"></a><div class='linenum'>2622</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;One&nbsp;solution&nbsp;&lt;x>&nbsp;of&nbsp;&lt;x>&nbsp;*&nbsp;&lt;mat>&nbsp;=&nbsp;&lt;vec>&nbsp;or&nbsp;`fail'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2623"></a><div class='linenum'>2623</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2624"></a><div class='linenum'>2624</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SolutionMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2625"></a><div class='linenum'>2625</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2626"></a><div class='linenum'>2626</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsCollsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2627"></a><div class='linenum'>2627</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix&nbsp;and&nbsp;IsMutable,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2628"></a><div class='linenum'>2628</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsRowVector&nbsp;and&nbsp;IsMutable],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2629"></a><div class='linenum'>2629</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat,&nbsp;vec&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2630"></a><div class='linenum'>2630</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,ncols,sem,&nbsp;vno,&nbsp;z,x,&nbsp;row,&nbsp;sol;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2631"></a><div class='linenum'>2631</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ncols&nbsp;:=&nbsp;Length(vec);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2632"></a><div class='linenum'>2632</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;Zero(mat[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2633"></a><div class='linenum'>2633</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sol&nbsp;:=&nbsp;ListWithIdenticalEntries(Length(mat),z);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2634"></a><div class='linenum'>2634</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(sol);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2635"></a><div class='linenum'>2635</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ncols&nbsp;&lt;>&nbsp;Length(mat[1])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2636"></a><div class='linenum'>2636</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("SolutionMat:&nbsp;matrix&nbsp;and&nbsp;vector&nbsp;incompatible");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2637"></a><div class='linenum'>2637</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2638"></a><div class='linenum'>2638</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sem&nbsp;:=&nbsp;SemiEchelonMatTransformationDestructive(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2639"></a><div class='linenum'>2639</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..ncols]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2640"></a><div class='linenum'>2640</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vno&nbsp;:=&nbsp;sem.heads[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2641"></a><div class='linenum'>2641</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;vno&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2642"></a><div class='linenum'>2642</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;vec[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2643"></a><div class='linenum'>2643</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;>&nbsp;z&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2644"></a><div class='linenum'>2644</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(vec,&nbsp;sem.vectors[vno],&nbsp;-x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2645"></a><div class='linenum'>2645</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(sol,&nbsp;sem.coeffs[vno],&nbsp;x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2646"></a><div class='linenum'>2646</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2647"></a><div class='linenum'>2647</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2648"></a><div class='linenum'>2648</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2649"></a><div class='linenum'>2649</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsZero(vec)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2650"></a><div class='linenum'>2650</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sol;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2651"></a><div class='linenum'>2651</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2652"></a><div class='linenum'>2652</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2653"></a><div class='linenum'>2653</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2654"></a><div class='linenum'>2654</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2655"></a><div class='linenum'>2655</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2656"></a><div class='linenum'>2656</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2657"></a><div class='linenum'>2657</div></td><td></td><td></td><td></td><td><span><tt>#InstallMethod(&nbsp;SolutionMatNoCo,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2658"></a><div class='linenum'>2658</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;ordinary&nbsp;matrix&nbsp;and&nbsp;vector",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2659"></a><div class='linenum'>2659</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;IsCollsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2660"></a><div class='linenum'>2660</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2661"></a><div class='linenum'>2661</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsRowVector&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2662"></a><div class='linenum'>2662</div></td><td></td><td></td><td></td><td><span><tt>#function&nbsp;(&nbsp;mat,&nbsp;vec&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2663"></a><div class='linenum'>2663</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;h,&nbsp;v,&nbsp;tmp,&nbsp;i,&nbsp;l,&nbsp;r,&nbsp;s,&nbsp;c,&nbsp;zero;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2664"></a><div class='linenum'>2664</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2665"></a><div class='linenum'>2665</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;solve&nbsp;&lt;mat>&nbsp;*&nbsp;x&nbsp;=&nbsp;&lt;vec>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2666"></a><div class='linenum'>2666</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;vec&nbsp;&nbsp;:=&nbsp;ShallowCopy(&nbsp;vec&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2667"></a><div class='linenum'>2667</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;Length(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2668"></a><div class='linenum'>2668</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2669"></a><div class='linenum'>2669</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(&nbsp;mat[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2670"></a><div class='linenum'>2670</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;1,&nbsp;"SolutionMat&nbsp;called"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2671"></a><div class='linenum'>2671</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2672"></a><div class='linenum'>2672</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Run&nbsp;through&nbsp;all&nbsp;columns&nbsp;of&nbsp;the&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2673"></a><div class='linenum'>2673</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2674"></a><div class='linenum'>2674</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;c&nbsp;&lt;=&nbsp;Length(&nbsp;mat[&nbsp;1&nbsp;]&nbsp;)&nbsp;and&nbsp;r&nbsp;&lt;&nbsp;l&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2675"></a><div class='linenum'>2675</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2676"></a><div class='linenum'>2676</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Find&nbsp;a&nbsp;nonzero&nbsp;entry&nbsp;in&nbsp;this&nbsp;column.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2677"></a><div class='linenum'>2677</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;r&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2678"></a><div class='linenum'>2678</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;s&nbsp;&lt;=&nbsp;l&nbsp;and&nbsp;mat[&nbsp;s&nbsp;][&nbsp;c&nbsp;]&nbsp;=&nbsp;zero&nbsp;&nbsp;do&nbsp;s&nbsp;:=&nbsp;s&nbsp;+&nbsp;1;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2679"></a><div class='linenum'>2679</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2680"></a><div class='linenum'>2680</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;nonzero&nbsp;entry,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2681"></a><div class='linenum'>2681</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s&nbsp;&lt;=&nbsp;l&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2682"></a><div class='linenum'>2682</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2683"></a><div class='linenum'>2683</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;increment&nbsp;the&nbsp;rank.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2684"></a><div class='linenum'>2684</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;2,&nbsp;"&nbsp;&nbsp;nonzero&nbsp;columns&nbsp;",&nbsp;c&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2685"></a><div class='linenum'>2685</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;r&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2686"></a><div class='linenum'>2686</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2687"></a><div class='linenum'>2687</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Make&nbsp;its&nbsp;row&nbsp;the&nbsp;current&nbsp;row&nbsp;and&nbsp;normalize&nbsp;it.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2688"></a><div class='linenum'>2688</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;:=&nbsp;mat[&nbsp;s&nbsp;][&nbsp;c&nbsp;]&nbsp;^&nbsp;-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2689"></a><div class='linenum'>2689</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;:=&nbsp;mat[&nbsp;s&nbsp;];&nbsp;&nbsp;mat[&nbsp;s&nbsp;]&nbsp;:=&nbsp;mat[&nbsp;r&nbsp;];&nbsp;&nbsp;mat[&nbsp;r&nbsp;]&nbsp;:=&nbsp;tmp&nbsp;*&nbsp;v;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2690"></a><div class='linenum'>2690</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;:=&nbsp;vec[&nbsp;s&nbsp;];&nbsp;&nbsp;vec[&nbsp;s&nbsp;]&nbsp;:=&nbsp;vec[&nbsp;r&nbsp;];&nbsp;&nbsp;vec[&nbsp;r&nbsp;]&nbsp;:=&nbsp;tmp&nbsp;*&nbsp;v;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2691"></a><div class='linenum'>2691</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2692"></a><div class='linenum'>2692</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Clear&nbsp;all&nbsp;entries&nbsp;in&nbsp;this&nbsp;column.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2693"></a><div class='linenum'>2693</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;s&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;mat&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2694"></a><div class='linenum'>2694</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s&nbsp;&lt;>&nbsp;r&nbsp;and&nbsp;mat[&nbsp;s&nbsp;][&nbsp;c&nbsp;]&nbsp;&lt;>&nbsp;zero&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2695"></a><div class='linenum'>2695</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;:=&nbsp;mat[&nbsp;s&nbsp;][&nbsp;c&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2696"></a><div class='linenum'>2696</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[&nbsp;s&nbsp;]&nbsp;:=&nbsp;mat[&nbsp;s&nbsp;]&nbsp;-&nbsp;tmp&nbsp;*&nbsp;mat[&nbsp;r&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2697"></a><div class='linenum'>2697</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec[&nbsp;s&nbsp;]&nbsp;:=&nbsp;vec[&nbsp;s&nbsp;]&nbsp;-&nbsp;tmp&nbsp;*&nbsp;vec[&nbsp;r&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2698"></a><div class='linenum'>2698</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2699"></a><div class='linenum'>2699</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2700"></a><div class='linenum'>2700</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2701"></a><div class='linenum'>2701</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;c&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2702"></a><div class='linenum'>2702</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2703"></a><div class='linenum'>2703</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2704"></a><div class='linenum'>2704</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Find&nbsp;a&nbsp;solution.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2705"></a><div class='linenum'>2705</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;r&nbsp;+&nbsp;1&nbsp;..&nbsp;l&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2706"></a><div class='linenum'>2706</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;vec[&nbsp;i&nbsp;]&nbsp;&lt;>&nbsp;zero&nbsp;&nbsp;then&nbsp;return&nbsp;fail;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2707"></a><div class='linenum'>2707</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2708"></a><div class='linenum'>2708</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2709"></a><div class='linenum'>2709</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;Length(&nbsp;mat[&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2710"></a><div class='linenum'>2710</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;:=&nbsp;Zero(&nbsp;mat[&nbsp;1&nbsp;][&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2711"></a><div class='linenum'>2711</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2712"></a><div class='linenum'>2712</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2713"></a><div class='linenum'>2713</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;c&nbsp;&lt;=&nbsp;s&nbsp;and&nbsp;r&nbsp;&lt;=&nbsp;l&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2714"></a><div class='linenum'>2714</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;c&nbsp;&lt;=&nbsp;s&nbsp;and&nbsp;mat[&nbsp;r&nbsp;][&nbsp;c&nbsp;]&nbsp;=&nbsp;zero&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2715"></a><div class='linenum'>2715</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;c&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2716"></a><div class='linenum'>2716</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;h,&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2717"></a><div class='linenum'>2717</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2718"></a><div class='linenum'>2718</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;c&nbsp;&lt;=&nbsp;s&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2719"></a><div class='linenum'>2719</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;h,&nbsp;vec[&nbsp;r&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2720"></a><div class='linenum'>2720</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;r&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2721"></a><div class='linenum'>2721</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;c&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2722"></a><div class='linenum'>2722</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2723"></a><div class='linenum'>2723</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2724"></a><div class='linenum'>2724</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;c&nbsp;&lt;=&nbsp;s&nbsp;&nbsp;do&nbsp;Add(&nbsp;h,&nbsp;v&nbsp;);&nbsp;&nbsp;c&nbsp;:=&nbsp;c&nbsp;+&nbsp;1;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2725"></a><div class='linenum'>2725</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2726"></a><div class='linenum'>2726</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;1,&nbsp;"SolutionMat&nbsp;returns"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2727"></a><div class='linenum'>2727</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;h;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2728"></a><div class='linenum'>2728</div></td><td></td><td></td><td></td><td><span><tt>#end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2729"></a><div class='linenum'>2729</div></td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2730"></a><div class='linenum'>2730</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2731"></a><div class='linenum'>2731</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SolutionMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2732"></a><div class='linenum'>2732</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;ordinary&nbsp;matrix&nbsp;and&nbsp;vector",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2733"></a><div class='linenum'>2733</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsCollsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2734"></a><div class='linenum'>2734</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2735"></a><div class='linenum'>2735</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsRowVector&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2736"></a><div class='linenum'>2736</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;mat,&nbsp;vec&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2737"></a><div class='linenum'>2737</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SolutionMatDestructive(&nbsp;MutableCopyMat(&nbsp;mat&nbsp;),&nbsp;ShallowCopy(vec)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2738"></a><div class='linenum'>2738</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2739"></a><div class='linenum'>2739</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2740"></a><div class='linenum'>2740</div></td><td></td><td></td><td></td><td><span><tt>#InstallMethod(&nbsp;SolutionMatDestructive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2741"></a><div class='linenum'>2741</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;ordinary&nbsp;matrix&nbsp;and&nbsp;vector",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2742"></a><div class='linenum'>2742</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;IsCollsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2743"></a><div class='linenum'>2743</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2744"></a><div class='linenum'>2744</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsRowVector&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2745"></a><div class='linenum'>2745</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;mat,&nbsp;vec&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2746"></a><div class='linenum'>2746</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SolutionMatNoCo(&nbsp;MutableTransposedMatDestructive(&nbsp;mat&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2747"></a><div class='linenum'>2747</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2748"></a><div class='linenum'>2748</div></td><td></td><td></td><td></td><td><span><tt>#end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2749"></a><div class='linenum'>2749</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2750"></a><div class='linenum'>2750</div></td><td></td><td></td><td></td><td><span><tt>############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2751"></a><div class='linenum'>2751</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2752"></a><div class='linenum'>2752</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SumIntersectionMat(&nbsp;&lt;M1>,&nbsp;&lt;M2>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;&nbsp;sum&nbsp;and&nbsp;intersection&nbsp;of&nbsp;two&nbsp;spaces
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2753"></a><div class='linenum'>2753</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2754"></a><div class='linenum'>2754</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;performs&nbsp;&nbsp;Zassenhaus'&nbsp;algorithm&nbsp;to&nbsp;&nbsp;compute&nbsp;bases&nbsp;&nbsp;&nbsp;for&nbsp;the&nbsp;&nbsp;sum&nbsp;and&nbsp;&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2755"></a><div class='linenum'>2755</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;intersection&nbsp;of&nbsp;spaces&nbsp;generated&nbsp;by&nbsp;the&nbsp;rows&nbsp;of&nbsp;the&nbsp;matrices&nbsp;&lt;M1>,&nbsp;&lt;M2>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2756"></a><div class='linenum'>2756</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2757"></a><div class='linenum'>2757</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;returns&nbsp;a&nbsp;&nbsp;&nbsp;list&nbsp;of&nbsp;length&nbsp;2,&nbsp;&nbsp;&nbsp;at&nbsp;first&nbsp;position&nbsp;&nbsp;a&nbsp;base&nbsp;&nbsp;of&nbsp;the&nbsp;sum,&nbsp;at
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2758"></a><div class='linenum'>2758</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;second&nbsp;position&nbsp;&nbsp;&nbsp;a&nbsp;base&nbsp;&nbsp;of&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;intersection.&nbsp;&nbsp;&nbsp;Both&nbsp;bases&nbsp;&nbsp;&nbsp;&nbsp;are&nbsp;&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2759"></a><div class='linenum'>2759</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;semi-echelon&nbsp;form.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2760"></a><div class='linenum'>2760</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2761"></a><div class='linenum'>2761</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SumIntersectionMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2762"></a><div class='linenum'>2762</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2763"></a><div class='linenum'>2763</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2764"></a><div class='linenum'>2764</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;M1,&nbsp;M2&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2765"></a><div class='linenum'>2765</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;columns
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2766"></a><div class='linenum'>2766</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;matrix&nbsp;for&nbsp;Zassenhaus&nbsp;algorithm
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2767"></a><div class='linenum'>2767</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero,&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;vector
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2768"></a><div class='linenum'>2768</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;'M1'&nbsp;and&nbsp;'M2'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2769"></a><div class='linenum'>2769</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads,&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;leading&nbsp;positions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2770"></a><div class='linenum'>2770</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;base&nbsp;of&nbsp;the&nbsp;sum
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2771"></a><div class='linenum'>2771</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;rows&nbsp;of&nbsp;'mat'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2772"></a><div class='linenum'>2772</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;base&nbsp;of&nbsp;the&nbsp;intersection
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2773"></a><div class='linenum'>2773</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2774"></a><div class='linenum'>2774</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;Length(&nbsp;M1&nbsp;)&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2775"></a><div class='linenum'>2775</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;M2,&nbsp;M1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2776"></a><div class='linenum'>2776</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;M2&nbsp;)&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2777"></a><div class='linenum'>2777</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;M1,&nbsp;M2&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2778"></a><div class='linenum'>2778</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;M1[1]&nbsp;)&nbsp;&lt;>&nbsp;Length(&nbsp;M2[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2779"></a><div class='linenum'>2779</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"dimensions&nbsp;of&nbsp;matrices&nbsp;are&nbsp;not&nbsp;compatible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2780"></a><div class='linenum'>2780</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Zero(&nbsp;M1[1][1]&nbsp;)&nbsp;&lt;>&nbsp;Zero(&nbsp;M2[1][1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2781"></a><div class='linenum'>2781</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"fields&nbsp;of&nbsp;matrices&nbsp;are&nbsp;not&nbsp;compatible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2782"></a><div class='linenum'>2782</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2783"></a><div class='linenum'>2783</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2784"></a><div class='linenum'>2784</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Length(&nbsp;M1[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2785"></a><div class='linenum'>2785</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2786"></a><div class='linenum'>2786</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero:=&nbsp;Zero(&nbsp;M1[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2787"></a><div class='linenum'>2787</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2788"></a><div class='linenum'>2788</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Set&nbsp;up&nbsp;the&nbsp;matrix&nbsp;for&nbsp;Zassenhaus'&nbsp;algorithm.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2789"></a><div class='linenum'>2789</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2790"></a><div class='linenum'>2790</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;in&nbsp;M1&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2791"></a><div class='linenum'>2791</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=&nbsp;ShallowCopy(&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2792"></a><div class='linenum'>2792</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;v,&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2793"></a><div class='linenum'>2793</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2794"></a><div class='linenum'>2794</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;mat,&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2795"></a><div class='linenum'>2795</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2796"></a><div class='linenum'>2796</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;in&nbsp;M2&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2797"></a><div class='linenum'>2797</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=&nbsp;ShallowCopy(&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2798"></a><div class='linenum'>2798</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;v,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2799"></a><div class='linenum'>2799</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2800"></a><div class='linenum'>2800</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;mat,&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2801"></a><div class='linenum'>2801</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2802"></a><div class='linenum'>2802</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2803"></a><div class='linenum'>2803</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Transform&nbsp;`mat'&nbsp;into&nbsp;semi-echelon&nbsp;form.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2804"></a><div class='linenum'>2804</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;&nbsp;&nbsp;:=&nbsp;SemiEchelonMatDestructive(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2805"></a><div class='linenum'>2805</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;heads&nbsp;:=&nbsp;mat.heads;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2806"></a><div class='linenum'>2806</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;&nbsp;&nbsp;:=&nbsp;mat.vectors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2807"></a><div class='linenum'>2807</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2808"></a><div class='linenum'>2808</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Extract&nbsp;the&nbsp;bases&nbsp;for&nbsp;the&nbsp;sum&nbsp;\ldots
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2809"></a><div class='linenum'>2809</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2810"></a><div class='linenum'>2810</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2811"></a><div class='linenum'>2811</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;heads[i]&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2812"></a><div class='linenum'>2812</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;sum,&nbsp;mat[&nbsp;heads[i]&nbsp;]{&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2813"></a><div class='linenum'>2813</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2814"></a><div class='linenum'>2814</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2815"></a><div class='linenum'>2815</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2816"></a><div class='linenum'>2816</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;\ldots&nbsp;and&nbsp;the&nbsp;intersection.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2817"></a><div class='linenum'>2817</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;int:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2818"></a><div class='linenum'>2818</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;n+1&nbsp;..&nbsp;Length(&nbsp;heads&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2819"></a><div class='linenum'>2819</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;heads[i]&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2820"></a><div class='linenum'>2820</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;int,&nbsp;mat[&nbsp;heads[i]&nbsp;]{&nbsp;[&nbsp;n+1&nbsp;..&nbsp;2*n&nbsp;]&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2821"></a><div class='linenum'>2821</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2822"></a><div class='linenum'>2822</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2823"></a><div class='linenum'>2823</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2824"></a><div class='linenum'>2824</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2825"></a><div class='linenum'>2825</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;sum,&nbsp;int&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2826"></a><div class='linenum'>2826</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2827"></a><div class='linenum'>2827</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2828"></a><div class='linenum'>2828</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2829"></a><div class='linenum'>2829</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2830"></a><div class='linenum'>2830</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2831"></a><div class='linenum'>2831</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;TriangulizeMat(&nbsp;&lt;mat>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;bring&nbsp;a&nbsp;matrix&nbsp;in&nbsp;upper&nbsp;triangular&nbsp;form
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2832"></a><div class='linenum'>2832</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2833"></a><div class='linenum'>2833</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TriangulizeMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2834"></a><div class='linenum'>2834</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;mutable&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2835"></a><div class='linenum'>2835</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;and&nbsp;IsMutable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2836"></a><div class='linenum'>2836</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2837"></a><div class='linenum'>2837</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;m,&nbsp;n,&nbsp;i,&nbsp;j,&nbsp;k,&nbsp;row,&nbsp;zero,&nbsp;x,&nbsp;row2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2838"></a><div class='linenum'>2838</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2839"></a><div class='linenum'>2839</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;1,&nbsp;"TriangulizeMat&nbsp;called"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2840"></a><div class='linenum'>2840</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2841"></a><div class='linenum'>2841</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsEmpty(&nbsp;mat&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2842"></a><div class='linenum'>2842</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2843"></a><div class='linenum'>2843</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2844"></a><div class='linenum'>2844</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2845"></a><div class='linenum'>2845</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;Length(mat[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2846"></a><div class='linenum'>2846</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(&nbsp;mat[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2847"></a><div class='linenum'>2847</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2848"></a><div class='linenum'>2848</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;rows&nbsp;are&nbsp;mutable
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2849"></a><div class='linenum'>2849</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;m&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2850"></a><div class='linenum'>2850</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsMutable(&nbsp;mat[i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2851"></a><div class='linenum'>2851</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i]:=&nbsp;ShallowCopy(&nbsp;mat[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2852"></a><div class='linenum'>2852</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2853"></a><div class='linenum'>2853</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2854"></a><div class='linenum'>2854</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2855"></a><div class='linenum'>2855</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;run&nbsp;through&nbsp;all&nbsp;columns&nbsp;of&nbsp;the&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2856"></a><div class='linenum'>2856</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2857"></a><div class='linenum'>2857</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[1..n]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2858"></a><div class='linenum'>2858</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2859"></a><div class='linenum'>2859</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;a&nbsp;nonzero&nbsp;entry&nbsp;in&nbsp;this&nbsp;column
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2860"></a><div class='linenum'>2860</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2861"></a><div class='linenum'>2861</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j&nbsp;&lt;=&nbsp;m&nbsp;and&nbsp;mat[j][k]&nbsp;=&nbsp;zero&nbsp;&nbsp;do&nbsp;j&nbsp;:=&nbsp;j&nbsp;+&nbsp;1;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2862"></a><div class='linenum'>2862</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2863"></a><div class='linenum'>2863</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;nonzero&nbsp;entry
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2864"></a><div class='linenum'>2864</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j&nbsp;&lt;=&nbsp;m&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2865"></a><div class='linenum'>2865</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2866"></a><div class='linenum'>2866</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;increment&nbsp;the&nbsp;rank
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2867"></a><div class='linenum'>2867</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;2,&nbsp;"&nbsp;&nbsp;nonzero&nbsp;columns:&nbsp;",&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2868"></a><div class='linenum'>2868</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2869"></a><div class='linenum'>2869</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2870"></a><div class='linenum'>2870</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;its&nbsp;row&nbsp;the&nbsp;current&nbsp;row&nbsp;and&nbsp;normalize&nbsp;it
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2871"></a><div class='linenum'>2871</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;mat[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2872"></a><div class='linenum'>2872</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[j]&nbsp;:=&nbsp;mat[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2873"></a><div class='linenum'>2873</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=&nbsp;Inverse(&nbsp;row[k]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2874"></a><div class='linenum'>2874</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2875"></a><div class='linenum'>2875</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2876"></a><div class='linenum'>2876</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2877"></a><div class='linenum'>2877</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MultRowVector(&nbsp;row,&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2878"></a><div class='linenum'>2878</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i]&nbsp;:=&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2879"></a><div class='linenum'>2879</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2880"></a><div class='linenum'>2880</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;clear&nbsp;all&nbsp;entries&nbsp;in&nbsp;this&nbsp;column
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2881"></a><div class='linenum'>2881</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[1..i-1]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2882"></a><div class='linenum'>2882</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row2&nbsp;:=&nbsp;mat[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2883"></a><div class='linenum'>2883</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;row2[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2884"></a><div class='linenum'>2884</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;x&nbsp;&lt;>&nbsp;zero&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2885"></a><div class='linenum'>2885</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(&nbsp;row2,&nbsp;row,&nbsp;-&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2886"></a><div class='linenum'>2886</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2887"></a><div class='linenum'>2887</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2888"></a><div class='linenum'>2888</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[i+1..m]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2889"></a><div class='linenum'>2889</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row2&nbsp;:=&nbsp;mat[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2890"></a><div class='linenum'>2890</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;row2[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2891"></a><div class='linenum'>2891</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;x&nbsp;&lt;>&nbsp;zero&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2892"></a><div class='linenum'>2892</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(&nbsp;row2,&nbsp;row,&nbsp;-&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2893"></a><div class='linenum'>2893</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2894"></a><div class='linenum'>2894</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2895"></a><div class='linenum'>2895</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2896"></a><div class='linenum'>2896</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2897"></a><div class='linenum'>2897</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2898"></a><div class='linenum'>2898</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2899"></a><div class='linenum'>2899</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2900"></a><div class='linenum'>2900</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2901"></a><div class='linenum'>2901</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2902"></a><div class='linenum'>2902</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoMatrix,&nbsp;1,&nbsp;"TriangulizeMat&nbsp;returns"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2903"></a><div class='linenum'>2903</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2904"></a><div class='linenum'>2904</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2905"></a><div class='linenum'>2905</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2906"></a><div class='linenum'>2906</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;TriangulizeMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2907"></a><div class='linenum'>2907</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;empty&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2908"></a><div class='linenum'>2908</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;and&nbsp;IsEmpty],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2909"></a><div class='linenum'>2909</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;m&nbsp;)&nbsp;return;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2910"></a><div class='linenum'>2910</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2911"></a><div class='linenum'>2911</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TriangulizedMat,&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2912"></a><div class='linenum'>2912</div></td><td></td><td></td><td></td><td><span><tt>function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2913"></a><div class='linenum'>2913</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2914"></a><div class='linenum'>2914</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;m:=List(mat,ShallowCopy);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2915"></a><div class='linenum'>2915</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;TriangulizeMat(m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2916"></a><div class='linenum'>2916</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2917"></a><div class='linenum'>2917</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2918"></a><div class='linenum'>2918</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2919"></a><div class='linenum'>2919</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2920"></a><div class='linenum'>2920</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2921"></a><div class='linenum'>2921</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;UpperSubdiagonal(&nbsp;&lt;mat>,&nbsp;&lt;pos>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2922"></a><div class='linenum'>2922</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2923"></a><div class='linenum'>2923</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;UpperSubdiagonal,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2924"></a><div class='linenum'>2924</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2925"></a><div class='linenum'>2925</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2926"></a><div class='linenum'>2926</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;mat,&nbsp;l&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2927"></a><div class='linenum'>2927</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;dim,&nbsp;&nbsp;exp,&nbsp;&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2928"></a><div class='linenum'>2928</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2929"></a><div class='linenum'>2929</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;collect&nbsp;exponents&nbsp;in&nbsp;&lt;e>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2930"></a><div class='linenum'>2930</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;dim&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2931"></a><div class='linenum'>2931</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;exp&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2932"></a><div class='linenum'>2932</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2933"></a><div class='linenum'>2933</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;run&nbsp;through&nbsp;the&nbsp;diagonal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2934"></a><div class='linenum'>2934</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;dim-l&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2935"></a><div class='linenum'>2935</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;exp,&nbsp;mat[i][l+i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2936"></a><div class='linenum'>2936</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2937"></a><div class='linenum'>2937</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2938"></a><div class='linenum'>2938</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;return
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2939"></a><div class='linenum'>2939</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;exp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2940"></a><div class='linenum'>2940</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2941"></a><div class='linenum'>2941</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2942"></a><div class='linenum'>2942</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2943"></a><div class='linenum'>2943</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2944"></a><div class='linenum'>2944</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2945"></a><div class='linenum'>2945</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;BaseFixedSpace(&nbsp;&lt;mats>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;calculate&nbsp;fixed&nbsp;points
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2946"></a><div class='linenum'>2946</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2947"></a><div class='linenum'>2947</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'BaseFixedSpace'&nbsp;returns&nbsp;a&nbsp;base&nbsp;of&nbsp;the&nbsp;vector&nbsp;space&nbsp;$V$&nbsp;such&nbsp;that
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2948"></a><div class='linenum'>2948</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$M&nbsp;v&nbsp;=&nbsp;v$&nbsp;for&nbsp;all&nbsp;$v$&nbsp;in&nbsp;$V$&nbsp;and&nbsp;all&nbsp;matrices&nbsp;$M$&nbsp;in&nbsp;the&nbsp;list&nbsp;&lt;mats>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2949"></a><div class='linenum'>2949</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2950"></a><div class='linenum'>2950</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;BaseFixedSpace,&nbsp;function(&nbsp;matrices&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2951"></a><div class='linenum'>2951</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;I,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;identity&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2952"></a><div class='linenum'>2952</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;dimension&nbsp;of&nbsp;vector&nbsp;space
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2953"></a><div class='linenum'>2953</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;linear&nbsp;system
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2954"></a><div class='linenum'>2954</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;matrix&nbsp;of&nbsp;'matrices'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2955"></a><div class='linenum'>2955</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;M&nbsp;-&nbsp;I
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2956"></a><div class='linenum'>2956</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2957"></a><div class='linenum'>2957</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2958"></a><div class='linenum'>2958</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;:=&nbsp;matrices[1]^0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2959"></a><div class='linenum'>2959</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;size&nbsp;:=&nbsp;Length(I);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2960"></a><div class='linenum'>2960</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;:=&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;size&nbsp;],&nbsp;x&nbsp;->&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2961"></a><div class='linenum'>2961</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;M&nbsp;&nbsp;in&nbsp;matrices&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2962"></a><div class='linenum'>2962</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;:=&nbsp;M&nbsp;-&nbsp;I;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2963"></a><div class='linenum'>2963</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[&nbsp;1..size&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2964"></a><div class='linenum'>2964</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;E[&nbsp;j&nbsp;],&nbsp;N[&nbsp;j&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2965"></a><div class='linenum'>2965</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2966"></a><div class='linenum'>2966</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2967"></a><div class='linenum'>2967</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NullspaceMatDestructive(&nbsp;E&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2968"></a><div class='linenum'>2968</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2969"></a><div class='linenum'>2969</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2970"></a><div class='linenum'>2970</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2971"></a><div class='linenum'>2971</div></td><td></td><td></td><td></td><td><span><tt>##########################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2972"></a><div class='linenum'>2972</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2973"></a><div class='linenum'>2973</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;BaseSteinitzVectors(&nbsp;&lt;bas>,&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2974"></a><div class='linenum'>2974</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2975"></a><div class='linenum'>2975</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;find&nbsp;vectors&nbsp;extending&nbsp;mat&nbsp;to&nbsp;a&nbsp;basis&nbsp;spanning&nbsp;the&nbsp;span&nbsp;of&nbsp;&lt;bas>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2976"></a><div class='linenum'>2976</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'BaseSteinitz'&nbsp;&nbsp;returns&nbsp;a
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2977"></a><div class='linenum'>2977</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;record&nbsp;&nbsp;describing&nbsp;&nbsp;a&nbsp;base&nbsp;&nbsp;for&nbsp;the&nbsp;factorspace&nbsp;&nbsp;&nbsp;and&nbsp;ways&nbsp;&nbsp;&nbsp;to&nbsp;decompose
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2978"></a><div class='linenum'>2978</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;vectors:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2979"></a><div class='linenum'>2979</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2980"></a><div class='linenum'>2980</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;zero:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;of&nbsp;&lt;V>&nbsp;and&nbsp;&lt;U>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2981"></a><div class='linenum'>2981</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;factorzero:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;of&nbsp;complement
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2982"></a><div class='linenum'>2982</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;subspace:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;triangulized&nbsp;basis&nbsp;of&nbsp;&lt;mat>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2983"></a><div class='linenum'>2983</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;factorspace:&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;of&nbsp;a&nbsp;complement&nbsp;of&nbsp;&lt;U>&nbsp;in&nbsp;&lt;V>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2984"></a><div class='linenum'>2984</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;heads:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;list&nbsp;of&nbsp;integers&nbsp;i_j,&nbsp;such&nbsp;that&nbsp;&nbsp;if&nbsp;i_j>0&nbsp;then&nbsp;a&nbsp;vector
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2985"></a><div class='linenum'>2985</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;head&nbsp;j&nbsp;is&nbsp;at&nbsp;position&nbsp;i_j&nbsp;&nbsp;in&nbsp;factorspace.&nbsp;&nbsp;If&nbsp;i_j&lt;0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2986"></a><div class='linenum'>2986</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;vector&nbsp;is&nbsp;in&nbsp;subspace.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2987"></a><div class='linenum'>2987</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2988"></a><div class='linenum'>2988</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;BaseSteinitzVectors,&nbsp;function(bas,mat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2989"></a><div class='linenum'>2989</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;z,l,b,i,j,k,stop,v,dim,h,zv;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2990"></a><div class='linenum'>2990</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2991"></a><div class='linenum'>2991</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;catch&nbsp;trivial&nbsp;case
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2992"></a><div class='linenum'>2992</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(bas)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2993"></a><div class='linenum'>2993</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(subspace:=[],factorspace:=[]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2994"></a><div class='linenum'>2994</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2995"></a><div class='linenum'>2995</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2996"></a><div class='linenum'>2996</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;z:=Zero(bas[1][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2997"></a><div class='linenum'>2997</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;zv:=Zero(bas[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2998"></a><div class='linenum'>2998</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(mat)>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2999"></a><div class='linenum'>2999</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat:=MutableCopyMat(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3000"></a><div class='linenum'>3000</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TriangulizeMat(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3001"></a><div class='linenum'>3001</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3002"></a><div class='linenum'>3002</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;bas:=MutableCopyMat(bas);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3003"></a><div class='linenum'>3003</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;dim:=Length(bas[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3004"></a><div class='linenum'>3004</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;l:=Length(bas)-Length(mat);&nbsp;#&nbsp;missing&nbsp;dimension
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3005"></a><div class='linenum'>3005</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;b:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3006"></a><div class='linenum'>3006</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;h:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3007"></a><div class='linenum'>3007</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;i:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3008"></a><div class='linenum'>3008</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;j:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3009"></a><div class='linenum'>3009</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;Length(b)&lt;l&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3010"></a><div class='linenum'>3010</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;stop:=false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3011"></a><div class='linenum'>3011</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3012"></a><div class='linenum'>3012</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j&lt;=dim&nbsp;and&nbsp;(Length(mat)&lt;i&nbsp;or&nbsp;mat[i][j]=z)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3013"></a><div class='linenum'>3013</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add&nbsp;vector&nbsp;from&nbsp;bas&nbsp;with&nbsp;j-th&nbsp;component&nbsp;not&nbsp;zero&nbsp;(if&nbsp;any&nbsp;exists)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3014"></a><div class='linenum'>3014</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=PositionProperty(bas,k->k[j]&lt;>z);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3015"></a><div class='linenum'>3015</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v&lt;>fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3016"></a><div class='linenum'>3016</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;add&nbsp;the&nbsp;vector
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3017"></a><div class='linenum'>3017</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=bas[v];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3018"></a><div class='linenum'>3018</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=1/v[j]*v;&nbsp;#&nbsp;normed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3019"></a><div class='linenum'>3019</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(b,v);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3020"></a><div class='linenum'>3020</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h[j]:=Length(b);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3021"></a><div class='linenum'>3021</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;fail,&nbsp;then&nbsp;this&nbsp;dimension&nbsp;is&nbsp;only&nbsp;dependent&nbsp;(and&nbsp;not&nbsp;needed)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3022"></a><div class='linenum'>3022</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3023"></a><div class='linenum'>3023</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3024"></a><div class='linenum'>3024</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop:=true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3025"></a><div class='linenum'>3025</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;whether&nbsp;we&nbsp;are&nbsp;running&nbsp;to&nbsp;fake&nbsp;zero&nbsp;columns
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3026"></a><div class='linenum'>3026</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&lt;=Length(mat)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3027"></a><div class='linenum'>3027</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;has&nbsp;a&nbsp;step,&nbsp;clean&nbsp;with&nbsp;basis&nbsp;vector
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3028"></a><div class='linenum'>3028</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=mat[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3029"></a><div class='linenum'>3029</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=1/v[j]*v;&nbsp;#&nbsp;normed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3030"></a><div class='linenum'>3030</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h[j]:=-i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3031"></a><div class='linenum'>3031</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3032"></a><div class='linenum'>3032</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3033"></a><div class='linenum'>3033</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3034"></a><div class='linenum'>3034</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3035"></a><div class='linenum'>3035</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v&lt;>fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3036"></a><div class='linenum'>3036</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;clean&nbsp;j-th&nbsp;component&nbsp;from&nbsp;bas&nbsp;with&nbsp;v
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3037"></a><div class='linenum'>3037</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[1..Length(bas)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3038"></a><div class='linenum'>3038</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;not&nbsp;IsZero(bas[k][j])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3039"></a><div class='linenum'>3039</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;bas[k]:=bas[k]-bas[k][j]/v[j]*v;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3040"></a><div class='linenum'>3040</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3041"></a><div class='linenum'>3041</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3042"></a><div class='linenum'>3042</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=Zero(v);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3043"></a><div class='linenum'>3043</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bas:=Filtered(bas,k->k&lt;>v);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3044"></a><div class='linenum'>3044</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3045"></a><div class='linenum'>3045</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3046"></a><div class='linenum'>3046</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;stop;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3047"></a><div class='linenum'>3047</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3048"></a><div class='linenum'>3048</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3049"></a><div class='linenum'>3049</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;add&nbsp;subspace&nbsp;indices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3050"></a><div class='linenum'>3050</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;i&lt;=Length(mat)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3051"></a><div class='linenum'>3051</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;mat[i][j]&lt;>z&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3052"></a><div class='linenum'>3052</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h[j]:=-i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3053"></a><div class='linenum'>3053</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3054"></a><div class='linenum'>3054</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3055"></a><div class='linenum'>3055</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;j:=j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3056"></a><div class='linenum'>3056</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3057"></a><div class='linenum'>3057</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;rec(factorspace:=b,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3058"></a><div class='linenum'>3058</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factorzero:=zv,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3059"></a><div class='linenum'>3059</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subspace:=mat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3060"></a><div class='linenum'>3060</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heads:=h);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3061"></a><div class='linenum'>3061</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3062"></a><div class='linenum'>3062</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3063"></a><div class='linenum'>3063</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3064"></a><div class='linenum'>3064</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3065"></a><div class='linenum'>3065</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3066"></a><div class='linenum'>3066</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;BlownUpMat(&nbsp;&lt;B>,&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3067"></a><div class='linenum'>3067</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3068"></a><div class='linenum'>3068</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;BlownUpMat,&nbsp;function&nbsp;(&nbsp;B,&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3069"></a><div class='linenum'>3069</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;result,&nbsp;&nbsp;#&nbsp;blown&nbsp;up&nbsp;matrix,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3070"></a><div class='linenum'>3070</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vectors,&nbsp;#&nbsp;basis&nbsp;vectors&nbsp;of&nbsp;'B'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3071"></a><div class='linenum'>3071</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;rows&nbsp;of&nbsp;'mat'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3072"></a><div class='linenum'>3072</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;'vectors'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3073"></a><div class='linenum'>3073</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resrow,&nbsp;&nbsp;#&nbsp;one&nbsp;row&nbsp;of&nbsp;'result'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3074"></a><div class='linenum'>3074</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;'row'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3075"></a><div class='linenum'>3075</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3076"></a><div class='linenum'>3076</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;vectors:=&nbsp;BasisVectors(&nbsp;B&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3077"></a><div class='linenum'>3077</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;result:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3078"></a><div class='linenum'>3078</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;mat&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3079"></a><div class='linenum'>3079</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;b&nbsp;in&nbsp;vectors&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3080"></a><div class='linenum'>3080</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resrow:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3081"></a><div class='linenum'>3081</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;row&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3082"></a><div class='linenum'>3082</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;resrow,&nbsp;Coefficients(&nbsp;B,&nbsp;entry&nbsp;*&nbsp;b&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3083"></a><div class='linenum'>3083</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3084"></a><div class='linenum'>3084</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;resrow&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3085"></a><div class='linenum'>3085</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;result,&nbsp;resrow&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3086"></a><div class='linenum'>3086</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3087"></a><div class='linenum'>3087</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3088"></a><div class='linenum'>3088</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3089"></a><div class='linenum'>3089</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;result.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3090"></a><div class='linenum'>3090</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3091"></a><div class='linenum'>3091</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3092"></a><div class='linenum'>3092</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3093"></a><div class='linenum'>3093</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3094"></a><div class='linenum'>3094</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3095"></a><div class='linenum'>3095</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3096"></a><div class='linenum'>3096</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;BlownUpVector(&nbsp;&lt;B>,&nbsp;&lt;vector>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3097"></a><div class='linenum'>3097</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3098"></a><div class='linenum'>3098</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;BlownUpVector,&nbsp;function&nbsp;(&nbsp;B,&nbsp;vector&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3099"></a><div class='linenum'>3099</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;result,&nbsp;&nbsp;#&nbsp;blown&nbsp;up&nbsp;vector,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3100"></a><div class='linenum'>3100</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;'vector'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3101"></a><div class='linenum'>3101</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3102"></a><div class='linenum'>3102</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;result:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3103"></a><div class='linenum'>3103</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;vector&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3104"></a><div class='linenum'>3104</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;result,&nbsp;Coefficients(&nbsp;B,&nbsp;entry&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3105"></a><div class='linenum'>3105</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3106"></a><div class='linenum'>3106</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;result&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3107"></a><div class='linenum'>3107</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3108"></a><div class='linenum'>3108</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;result.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3109"></a><div class='linenum'>3109</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3110"></a><div class='linenum'>3110</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3111"></a><div class='linenum'>3111</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3112"></a><div class='linenum'>3112</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3113"></a><div class='linenum'>3113</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3114"></a><div class='linenum'>3114</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3115"></a><div class='linenum'>3115</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3116"></a><div class='linenum'>3116</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IdentityMat(&nbsp;&lt;m>[,&nbsp;&lt;F>]&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;identity&nbsp;matrix&nbsp;of&nbsp;a&nbsp;given&nbsp;size
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3117"></a><div class='linenum'>3117</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3118"></a><div class='linenum'>3118</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;IdentityMat,&nbsp;function&nbsp;(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3119"></a><div class='linenum'>3119</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;id,&nbsp;m,&nbsp;zero,&nbsp;one,&nbsp;row,&nbsp;i,&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3120"></a><div class='linenum'>3120</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3121"></a><div class='linenum'>3121</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;the&nbsp;arguments&nbsp;and&nbsp;get&nbsp;dimension,&nbsp;zero&nbsp;and&nbsp;one
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3122"></a><div class='linenum'>3122</div></td><td>702</td><td>332</td><td>332</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(arg)&nbsp;=&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3123"></a><div class='linenum'>3123</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3124"></a><div class='linenum'>3124</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3125"></a><div class='linenum'>3125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3126"></a><div class='linenum'>3126</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;Rationals;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3127"></a><div class='linenum'>3127</div></td><td>351</td><td>1504</td><td>1504</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(arg)&nbsp;=&nbsp;2&nbsp;&nbsp;and&nbsp;IsRing(arg[2])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3128"></a><div class='linenum'>3128</div></td><td>351</td><td>121</td><td>121</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3129"></a><div class='linenum'>3129</div></td><td>351</td><td>662</td><td>1369</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(&nbsp;arg[2]&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_addmagma.gi.html#line581">/opt/gap/gap4r8p5/lib/addmagma.gi:581</a> <a href="_opt_gap_gap4r8p5_lib_addmagma.gi.html#line605">/opt/gap/gap4r8p5/lib/addmagma.gi:605</a> </span></td></tr>
<tr class='exec'><td><a name="line3130"></a><div class='linenum'>3130</div></td><td>351</td><td>481</td><td>1143</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;&nbsp;:=&nbsp;One(&nbsp;arg[2]&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_ringsc.gi.html#line858">/opt/gap/gap4r8p5/lib/ringsc.gi:858</a> <a href="_opt_gap_gap4r8p5_lib_ringsc.gi.html#line869">/opt/gap/gap4r8p5/lib/ringsc.gi:869</a> <a href="_opt_gap_gap4r8p5_lib_magma.gi.html#line965">/opt/gap/gap4r8p5/lib/magma.gi:965</a> <a href="_opt_gap_gap4r8p5_lib_magma.gi.html#line989">/opt/gap/gap4r8p5/lib/magma.gi:989</a> </span></td></tr>
<tr class='exec'><td><a name="line3131"></a><div class='linenum'>3131</div></td><td>351</td><td>137</td><td>137</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3132"></a><div class='linenum'>3132</div></td><td>351</td><td>311</td><td>311</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;one&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3133"></a><div class='linenum'>3133</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"ring&nbsp;must&nbsp;be&nbsp;a&nbsp;ring-with-one"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3134"></a><div class='linenum'>3134</div></td><td>351</td><td>101</td><td>101</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3135"></a><div class='linenum'>3135</div></td><td>351</td><td>128</td><td>128</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(arg)&nbsp;=&nbsp;2&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3136"></a><div class='linenum'>3136</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3137"></a><div class='linenum'>3137</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(&nbsp;arg[2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3138"></a><div class='linenum'>3138</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;&nbsp;:=&nbsp;One(&nbsp;arg[2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3139"></a><div class='linenum'>3139</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;Ring(&nbsp;one,&nbsp;arg[2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3140"></a><div class='linenum'>3140</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3141"></a><div class='linenum'>3141</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("usage:&nbsp;IdentityMat(&nbsp;&lt;m>[,&nbsp;&lt;R>]&nbsp;)");
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3142"></a><div class='linenum'>3142</div></td><td>351</td><td>113</td><td>113</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3143"></a><div class='linenum'>3143</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3144"></a><div class='linenum'>3144</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;special&nbsp;treatment&nbsp;for&nbsp;0-dimensional&nbsp;spaces
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3145"></a><div class='linenum'>3145</div></td><td>351</td><td>161</td><td>161</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3146"></a><div class='linenum'>3146</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NullMapMatrix;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3147"></a><div class='linenum'>3147</div></td><td>351</td><td>99</td><td>99</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3148"></a><div class='linenum'>3148</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3149"></a><div class='linenum'>3149</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;an&nbsp;empty&nbsp;row
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3150"></a><div class='linenum'>3150</div></td><td>351</td><td>601</td><td>2507</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;ListWithIdenticalEntries(m,zero);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_list.gi.html#line3530">ListWithIdenticalEntries</a> </span></td></tr>
<tr class='exec'><td><a name="line3151"></a><div class='linenum'>3151</div></td><td>351</td><td>909</td><td>12134</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(row,f);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_vecmat.gi.html#line1199">ConvertToVectorRepNC</a> </span></td></tr>
<tr class='ignore'><td><a name="line3152"></a><div class='linenum'>3152</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3153"></a><div class='linenum'>3153</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;the&nbsp;identity&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3154"></a><div class='linenum'>3154</div></td><td>351</td><td>134</td><td>134</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3155"></a><div class='linenum'>3155</div></td><td>351</td><td>124</td><td>124</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3156"></a><div class='linenum'>3156</div></td><td>17696</td><td>8360</td><td>8360</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id[i]&nbsp;:=&nbsp;ShallowCopy(&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3157"></a><div class='linenum'>3157</div></td><td>17696</td><td>7181</td><td>7181</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id[i][i]&nbsp;:=&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3158"></a><div class='linenum'>3158</div></td><td>351</td><td>107</td><td>107</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3159"></a><div class='linenum'>3159</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3160"></a><div class='linenum'>3160</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;do&nbsp;*not*&nbsp;call&nbsp;ConvertToMatrixRep&nbsp;here,&nbsp;as&nbsp;that&nbsp;can&nbsp;cause
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3161"></a><div class='linenum'>3161</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;unexpected&nbsp;problems&nbsp;for&nbsp;the&nbsp;user&nbsp;(e.g.&nbsp;if&nbsp;a&nbsp;matrix&nbsp;over&nbsp;GF(2)&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3162"></a><div class='linenum'>3162</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;created,&nbsp;and&nbsp;the&nbsp;user&nbsp;then&nbsp;tries&nbsp;to&nbsp;change&nbsp;an&nbsp;entry&nbsp;to&nbsp;Z(4),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3163"></a><div class='linenum'>3163</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3164"></a><div class='linenum'>3164</div></td><td>351</td><td>750</td><td>750</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;id;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3165"></a><div class='linenum'>3165</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3166"></a><div class='linenum'>3166</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3167"></a><div class='linenum'>3167</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3168"></a><div class='linenum'>3168</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3169"></a><div class='linenum'>3169</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3170"></a><div class='linenum'>3170</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;NullMat(&nbsp;&lt;m>,&nbsp;&lt;n>&nbsp;[,&nbsp;&lt;F>]&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;null&nbsp;matrix&nbsp;of&nbsp;a&nbsp;given&nbsp;size
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3171"></a><div class='linenum'>3171</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3172"></a><div class='linenum'>3172</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;NullMat,&nbsp;function&nbsp;(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3173"></a><div class='linenum'>3173</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;null,&nbsp;m,&nbsp;n,&nbsp;zero,&nbsp;row,&nbsp;i,&nbsp;k,&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3174"></a><div class='linenum'>3174</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3175"></a><div class='linenum'>3175</div></td><td>1232</td><td>613</td><td>613</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(arg)&nbsp;=&nbsp;2&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3176"></a><div class='linenum'>3176</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3177"></a><div class='linenum'>3177</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3178"></a><div class='linenum'>3178</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;Rationals;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3179"></a><div class='linenum'>3179</div></td><td>616</td><td>1064</td><td>1064</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(arg)&nbsp;=&nbsp;3&nbsp;&nbsp;and&nbsp;IsRing(arg[3])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3180"></a><div class='linenum'>3180</div></td><td>616</td><td>188</td><td>188</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3181"></a><div class='linenum'>3181</div></td><td>616</td><td>183</td><td>183</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3182"></a><div class='linenum'>3182</div></td><td>616</td><td>197</td><td>197</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[3];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3183"></a><div class='linenum'>3183</div></td><td>616</td><td>182</td><td>182</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(arg)&nbsp;=&nbsp;3&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3184"></a><div class='linenum'>3184</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3185"></a><div class='linenum'>3185</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3186"></a><div class='linenum'>3186</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;Ring(One(arg[3]),&nbsp;arg[3]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3187"></a><div class='linenum'>3187</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3188"></a><div class='linenum'>3188</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("usage:&nbsp;NullMat(&nbsp;&lt;m>,&nbsp;&lt;n>&nbsp;[,&nbsp;&lt;R>]&nbsp;)");
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3189"></a><div class='linenum'>3189</div></td><td>616</td><td>173</td><td>173</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3190"></a><div class='linenum'>3190</div></td><td>616</td><td>554</td><td>554</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;:=&nbsp;Zero(f);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3191"></a><div class='linenum'>3191</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3192"></a><div class='linenum'>3192</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;an&nbsp;empty&nbsp;row
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3193"></a><div class='linenum'>3193</div></td><td>616</td><td>749</td><td>4010</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;ListWithIdenticalEntries(n,zero);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_list.gi.html#line3530">ListWithIdenticalEntries</a> </span></td></tr>
<tr class='exec'><td><a name="line3194"></a><div class='linenum'>3194</div></td><td>616</td><td>847</td><td>13370</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;row,&nbsp;f&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_vecmat.gi.html#line1199">ConvertToVectorRepNC</a> </span></td></tr>
<tr class='ignore'><td><a name="line3195"></a><div class='linenum'>3195</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3196"></a><div class='linenum'>3196</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;the&nbsp;null&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3197"></a><div class='linenum'>3197</div></td><td>616</td><td>218</td><td>218</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;null&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3198"></a><div class='linenum'>3198</div></td><td>616</td><td>162</td><td>162</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3199"></a><div class='linenum'>3199</div></td><td>216</td><td>2139</td><td>2139</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null[i]&nbsp;:=&nbsp;ShallowCopy(&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3200"></a><div class='linenum'>3200</div></td><td>616</td><td>176</td><td>176</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3201"></a><div class='linenum'>3201</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3202"></a><div class='linenum'>3202</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;do&nbsp;*not*&nbsp;call&nbsp;ConvertToMatrixRep&nbsp;here,&nbsp;as&nbsp;that&nbsp;can&nbsp;cause
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3203"></a><div class='linenum'>3203</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;unexpected&nbsp;problems&nbsp;for&nbsp;the&nbsp;user&nbsp;(e.g.&nbsp;if&nbsp;a&nbsp;matrix&nbsp;over&nbsp;GF(2)&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3204"></a><div class='linenum'>3204</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;created,&nbsp;and&nbsp;the&nbsp;user&nbsp;then&nbsp;tries&nbsp;to&nbsp;change&nbsp;an&nbsp;entry&nbsp;to&nbsp;Z(4),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3205"></a><div class='linenum'>3205</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line3206"></a><div class='linenum'>3206</div></td><td>616</td><td>681</td><td>681</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3207"></a><div class='linenum'>3207</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3208"></a><div class='linenum'>3208</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3209"></a><div class='linenum'>3209</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3210"></a><div class='linenum'>3210</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3211"></a><div class='linenum'>3211</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3212"></a><div class='linenum'>3212</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;NullspaceModQ(&nbsp;&lt;E>,&nbsp;&lt;q>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;nullspace&nbsp;of&nbsp;&lt;E>&nbsp;mod&nbsp;&lt;q>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3213"></a><div class='linenum'>3213</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3214"></a><div class='linenum'>3214</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&lt;E>&nbsp;must&nbsp;be&nbsp;a&nbsp;matrix&nbsp;of&nbsp;integers&nbsp;modulo&nbsp;&lt;q>&nbsp;and&nbsp;&lt;q>&nbsp;&nbsp;a&nbsp;prime&nbsp;power.&nbsp;&nbsp;Then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3215"></a><div class='linenum'>3215</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'NullspaceModQ'&nbsp;returns&nbsp;&nbsp;the&nbsp;set&nbsp;of&nbsp;&nbsp;all&nbsp;vectors&nbsp;of&nbsp;&nbsp;integers&nbsp;modulo&nbsp;&lt;q>,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3216"></a><div class='linenum'>3216</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;which&nbsp;solve&nbsp;the&nbsp;homogeneous&nbsp;equation&nbsp;system&nbsp;given&nbsp;by&nbsp;&lt;E>&nbsp;modulo&nbsp;&lt;q>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3217"></a><div class='linenum'>3217</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3218"></a><div class='linenum'>3218</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;NullspaceModQ,&nbsp;function(&nbsp;E,&nbsp;q&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3219"></a><div class='linenum'>3219</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;facs,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;factors&nbsp;of&nbsp;&lt;q>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3220"></a><div class='linenum'>3220</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;prime&nbsp;of&nbsp;facs
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3221"></a><div class='linenum'>3221</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pex,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;p-power
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3222"></a><div class='linenum'>3222</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;q>&nbsp;=&nbsp;p^n
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3223"></a><div class='linenum'>3223</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;field&nbsp;with&nbsp;p&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3224"></a><div class='linenum'>3224</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;E&nbsp;over&nbsp;GF(p)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3225"></a><div class='linenum'>3225</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;basis&nbsp;of&nbsp;nullspace&nbsp;of&nbsp;B
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3226"></a><div class='linenum'>3226</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elem,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;all&nbsp;elements&nbsp;solving&nbsp;E&nbsp;mod&nbsp;p^i-1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3227"></a><div class='linenum'>3227</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;elem
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3228"></a><div class='linenum'>3228</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;inhomogenous&nbsp;part&nbsp;mod&nbsp;p^i-1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3229"></a><div class='linenum'>3229</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newelem,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;all&nbsp;elements&nbsp;solving&nbsp;E&nbsp;mod&nbsp;p^i
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3230"></a><div class='linenum'>3230</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sol,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;solution&nbsp;of&nbsp;E&nbsp;*&nbsp;x&nbsp;=&nbsp;r&nbsp;mod&nbsp;p^i
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3231"></a><div class='linenum'>3231</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ran,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3232"></a><div class='linenum'>3232</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new,&nbsp;o,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3233"></a><div class='linenum'>3233</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,&nbsp;i,k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3234"></a><div class='linenum'>3234</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3235"></a><div class='linenum'>3235</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;factorize&nbsp;q
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3236"></a><div class='linenum'>3236</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;facs&nbsp;&nbsp;:=&nbsp;FactorsInt(&nbsp;q&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3237"></a><div class='linenum'>3237</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;facs[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3238"></a><div class='linenum'>3238</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;Length(&nbsp;facs&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3239"></a><div class='linenum'>3239</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;:=&nbsp;GF(p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3240"></a><div class='linenum'>3240</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3241"></a><div class='linenum'>3241</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;solve&nbsp;homogeneous&nbsp;system&nbsp;mod&nbsp;p
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3242"></a><div class='linenum'>3242</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;One(&nbsp;field&nbsp;)&nbsp;*&nbsp;E;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3243"></a><div class='linenum'>3243</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;null&nbsp;:=&nbsp;NullspaceMat(&nbsp;B&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3244"></a><div class='linenum'>3244</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;null&nbsp;=&nbsp;[]&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3245"></a><div class='linenum'>3245</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[ListWithIdenticalEntries&nbsp;(Length(E),0)];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3246"></a><div class='linenum'>3246</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3247"></a><div class='linenum'>3247</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3248"></a><div class='linenum'>3248</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;set&nbsp;up
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3249"></a><div class='linenum'>3249</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elem&nbsp;:=&nbsp;List(&nbsp;AsList(&nbsp;FreeLeftModule(field,null,"basis")&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3250"></a><div class='linenum'>3250</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;List(&nbsp;x,&nbsp;IntFFE&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3251"></a><div class='linenum'>3251</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3252"></a><div class='linenum'>3252</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;newelem&nbsp;:=&nbsp;[&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3253"></a><div class='linenum'>3253</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o&nbsp;:=&nbsp;One(&nbsp;field&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3254"></a><div class='linenum'>3254</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3255"></a><div class='linenum'>3255</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ran:=[1..Length(null[1])];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3256"></a><div class='linenum'>3256</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;run&nbsp;trough&nbsp;powers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3257"></a><div class='linenum'>3257</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;2..n&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3258"></a><div class='linenum'>3258</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pex:=p^(i-1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3259"></a><div class='linenum'>3259</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;e&nbsp;&nbsp;in&nbsp;elem&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3260"></a><div class='linenum'>3260</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#r&nbsp;&nbsp;&nbsp;:=&nbsp;o&nbsp;*&nbsp;(&nbsp;-&nbsp;(e&nbsp;*&nbsp;E)&nbsp;/&nbsp;(p&nbsp;^&nbsp;(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3261"></a><div class='linenum'>3261</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;&nbsp;&nbsp;:=&nbsp;o&nbsp;*&nbsp;(&nbsp;-&nbsp;(e&nbsp;*&nbsp;E)&nbsp;/&nbsp;pex&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3262"></a><div class='linenum'>3262</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sol&nbsp;:=&nbsp;SolutionMat(&nbsp;B,&nbsp;r&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3263"></a><div class='linenum'>3263</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sol&nbsp;&lt;>&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3264"></a><div class='linenum'>3264</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3265"></a><div class='linenum'>3265</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;accessing&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;compact&nbsp;vector&nbsp;`sol'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3266"></a><div class='linenum'>3266</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;frequently&nbsp;would&nbsp;be&nbsp;very&nbsp;expensive
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3267"></a><div class='linenum'>3267</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sol:=List(sol,IntFFE);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3268"></a><div class='linenum'>3268</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3269"></a><div class='linenum'>3269</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[&nbsp;1..Length(&nbsp;elem&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3270"></a><div class='linenum'>3270</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#new&nbsp;:=&nbsp;e&nbsp;+&nbsp;(&nbsp;p^(i-1)&nbsp;*&nbsp;List(&nbsp;o&nbsp;*&nbsp;elem[j]&nbsp;+&nbsp;sol,&nbsp;IntFFE&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3271"></a><div class='linenum'>3271</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new:=ShallowCopy(e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3272"></a><div class='linenum'>3272</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;ran&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3273"></a><div class='linenum'>3273</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#new[k]:=new[k]+pex&nbsp;*&nbsp;IntFFE(o*elem[j][k]+&nbsp;sol[k]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3274"></a><div class='linenum'>3274</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new[k]:=new[k]+pex&nbsp;*&nbsp;((elem[j][k]+&nbsp;sol[k])&nbsp;mod&nbsp;p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3275"></a><div class='linenum'>3275</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3276"></a><div class='linenum'>3276</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3277"></a><div class='linenum'>3277</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MakeImmutable(new);&nbsp;#&nbsp;otherwise&nbsp;newelem&nbsp;does&nbsp;not&nbsp;remember
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3278"></a><div class='linenum'>3278</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;it&nbsp;is&nbsp;sorted!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3279"></a><div class='linenum'>3279</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;newelem,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3280"></a><div class='linenum'>3280</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3281"></a><div class='linenum'>3281</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3282"></a><div class='linenum'>3282</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3283"></a><div class='linenum'>3283</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;newelem&nbsp;)&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3284"></a><div class='linenum'>3284</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3285"></a><div class='linenum'>3285</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3286"></a><div class='linenum'>3286</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elem&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;newelem;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3287"></a><div class='linenum'>3287</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newelem&nbsp;:=&nbsp;[&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3288"></a><div class='linenum'>3288</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3289"></a><div class='linenum'>3289</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;elem;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3290"></a><div class='linenum'>3290</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3291"></a><div class='linenum'>3291</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3292"></a><div class='linenum'>3292</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3293"></a><div class='linenum'>3293</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3294"></a><div class='linenum'>3294</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3295"></a><div class='linenum'>3295</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;BasisNullspaceModN(&nbsp;&lt;M>,&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;nullspace&nbsp;of&nbsp;&lt;E>&nbsp;mod&nbsp;&lt;n>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3296"></a><div class='linenum'>3296</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3297"></a><div class='linenum'>3297</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&lt;M>&nbsp;must&nbsp;be&nbsp;a&nbsp;matrix&nbsp;of&nbsp;integers&nbsp;modulo&nbsp;&lt;n>&nbsp;and&nbsp;&lt;n>&nbsp;a&nbsp;positive&nbsp;integer.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3298"></a><div class='linenum'>3298</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Then&nbsp;'NullspaceModQ'&nbsp;returns&nbsp;a&nbsp;set&nbsp;&lt;B>&nbsp;of&nbsp;vectors&nbsp;such&nbsp;that&nbsp;every&nbsp;&lt;v>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3299"></a><div class='linenum'>3299</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;such&nbsp;that&nbsp;&lt;v>&nbsp;&lt;M>&nbsp;=&nbsp;0&nbsp;modulo&nbsp;&lt;n>&nbsp;can&nbsp;be&nbsp;expressed&nbsp;by&nbsp;a&nbsp;Z-linear&nbsp;combination
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3300"></a><div class='linenum'>3300</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;of&nbsp;elements&nbsp;of&nbsp;&lt;M>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3301"></a><div class='linenum'>3301</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3302"></a><div class='linenum'>3302</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction&nbsp;(BasisNullspaceModN,&nbsp;function&nbsp;(M,&nbsp;n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3303"></a><div class='linenum'>3303</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;snf,&nbsp;null,&nbsp;nullM,&nbsp;i,&nbsp;gcdex;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3304"></a><div class='linenum'>3304</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3305"></a><div class='linenum'>3305</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;n&nbsp;is&nbsp;a&nbsp;&nbsp;prime,&nbsp;Gaussian&nbsp;elimination&nbsp;is&nbsp;fastest
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3306"></a><div class='linenum'>3306</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsPrimeInt&nbsp;(n)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3307"></a><div class='linenum'>3307</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List&nbsp;(NullspaceMat&nbsp;(M*One(GF(n))),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3308"></a><div class='linenum'>3308</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;->&nbsp;List&nbsp;(v,&nbsp;IntFFE));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3309"></a><div class='linenum'>3309</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3310"></a><div class='linenum'>3310</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3311"></a><div class='linenum'>3311</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;the&nbsp;Smith&nbsp;normal&nbsp;form&nbsp;S&nbsp;for&nbsp;M,&nbsp;i.e.,&nbsp;S&nbsp;=&nbsp;R&nbsp;M&nbsp;C
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3312"></a><div class='linenum'>3312</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;snf&nbsp;:=&nbsp;NormalFormIntMat&nbsp;(M,&nbsp;1+4);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3313"></a><div class='linenum'>3313</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3314"></a><div class='linenum'>3314</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;the&nbsp;nullspace&nbsp;of&nbsp;S&nbsp;mod&nbsp;n
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3315"></a><div class='linenum'>3315</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;null&nbsp;:=&nbsp;IdentityMat&nbsp;(Length&nbsp;(M));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3316"></a><div class='linenum'>3316</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3317"></a><div class='linenum'>3317</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..snf.rank]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3318"></a><div class='linenum'>3318</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null[i][i]&nbsp;:=&nbsp;n/GcdInt&nbsp;(n,&nbsp;snf.normal[i][i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3319"></a><div class='linenum'>3319</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3320"></a><div class='linenum'>3320</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3321"></a><div class='linenum'>3321</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;nullM&nbsp;=&nbsp;null*R&nbsp;is&nbsp;the&nbsp;nullspace&nbsp;of&nbsp;M&nbsp;C&nbsp;mod&nbsp;n
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3322"></a><div class='linenum'>3322</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;since&nbsp;solutions&nbsp;do&nbsp;not&nbsp;change&nbsp;under&nbsp;elementary&nbsp;matrices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3323"></a><div class='linenum'>3323</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;nullM&nbsp;is&nbsp;also&nbsp;the&nbsp;nullspace&nbsp;for&nbsp;M
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3324"></a><div class='linenum'>3324</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3325"></a><div class='linenum'>3325</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nullM&nbsp;:=&nbsp;null*snf.rowtrans&nbsp;mod&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3326"></a><div class='linenum'>3326</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Assert&nbsp;(1,&nbsp;ForAll&nbsp;(nullM,&nbsp;v&nbsp;->&nbsp;v*M&nbsp;mod&nbsp;n&nbsp;=0*M[1]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3327"></a><div class='linenum'>3327</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nullM;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3328"></a><div class='linenum'>3328</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3329"></a><div class='linenum'>3329</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3330"></a><div class='linenum'>3330</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3331"></a><div class='linenum'>3331</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3332"></a><div class='linenum'>3332</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3333"></a><div class='linenum'>3333</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;PermutationMat(&nbsp;&lt;perm>,&nbsp;&lt;dim>&nbsp;[,&nbsp;&lt;F>&nbsp;]&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;permutation&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3334"></a><div class='linenum'>3334</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3335"></a><div class='linenum'>3335</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;PermutationMat,&nbsp;function(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3336"></a><div class='linenum'>3336</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;variable
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3337"></a><div class='linenum'>3337</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perm,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;permutation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3338"></a><div class='linenum'>3338</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;desired&nbsp;dimension&nbsp;of&nbsp;the&nbsp;permutation&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3339"></a><div class='linenum'>3339</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;field&nbsp;of&nbsp;the&nbsp;matrix&nbsp;entries&nbsp;(defauled&nbsp;to&nbsp;'Rationals')
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3340"></a><div class='linenum'>3340</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;matrix&nbsp;corresponding&nbsp;to&nbsp;'perm',&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3341"></a><div class='linenum'>3341</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3342"></a><div class='linenum'>3342</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(&nbsp;(&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;2&nbsp;or&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;3&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3343"></a><div class='linenum'>3343</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsPerm(&nbsp;arg[1]&nbsp;)&nbsp;and&nbsp;IsInt(&nbsp;arg[2]&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3344"></a><div class='linenum'>3344</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"usage:&nbsp;PermutationMat(&nbsp;&lt;perm>,&nbsp;&lt;dim>&nbsp;[,&nbsp;&lt;F>&nbsp;]&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3345"></a><div class='linenum'>3345</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3346"></a><div class='linenum'>3346</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3347"></a><div class='linenum'>3347</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;perm:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3348"></a><div class='linenum'>3348</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;dim:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3349"></a><div class='linenum'>3349</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;2&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3350"></a><div class='linenum'>3350</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F:=&nbsp;Rationals;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3351"></a><div class='linenum'>3351</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3352"></a><div class='linenum'>3352</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F:=&nbsp;arg[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3353"></a><div class='linenum'>3353</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3354"></a><div class='linenum'>3354</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3355"></a><div class='linenum'>3355</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat:=&nbsp;NullMat(&nbsp;dim,&nbsp;dim,&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3356"></a><div class='linenum'>3356</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3357"></a><div class='linenum'>3357</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;dim&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3358"></a><div class='linenum'>3358</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i][&nbsp;i^perm&nbsp;]:=&nbsp;One(&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3359"></a><div class='linenum'>3359</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3360"></a><div class='linenum'>3360</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3361"></a><div class='linenum'>3361</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3362"></a><div class='linenum'>3362</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3363"></a><div class='linenum'>3363</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3364"></a><div class='linenum'>3364</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3365"></a><div class='linenum'>3365</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3366"></a><div class='linenum'>3366</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3367"></a><div class='linenum'>3367</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;DiagonalMat(&nbsp;&lt;vector>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3368"></a><div class='linenum'>3368</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3369"></a><div class='linenum'>3369</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;DiagonalMat,&nbsp;function(&nbsp;vector&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3370"></a><div class='linenum'>3370</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;zerovec,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3371"></a><div class='linenum'>3371</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3372"></a><div class='linenum'>3372</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3373"></a><div class='linenum'>3373</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3374"></a><div class='linenum'>3374</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;M:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3375"></a><div class='linenum'>3375</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zerovec:=&nbsp;Zero(&nbsp;vector[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3376"></a><div class='linenum'>3376</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zerovec:=&nbsp;List(&nbsp;vector,&nbsp;x&nbsp;->&nbsp;zerovec&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3377"></a><div class='linenum'>3377</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3378"></a><div class='linenum'>3378</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;vector&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3379"></a><div class='linenum'>3379</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M[i]:=&nbsp;ShallowCopy(&nbsp;zerovec&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3380"></a><div class='linenum'>3380</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M[i][i]:=&nbsp;vector[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3381"></a><div class='linenum'>3381</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(M[i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3382"></a><div class='linenum'>3382</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3383"></a><div class='linenum'>3383</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3384"></a><div class='linenum'>3384</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;do&nbsp;*not*&nbsp;call&nbsp;ConvertToMatrixRep&nbsp;here,&nbsp;as&nbsp;that&nbsp;can&nbsp;cause
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3385"></a><div class='linenum'>3385</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;unexpected&nbsp;problems&nbsp;for&nbsp;the&nbsp;user&nbsp;(e.g.&nbsp;if&nbsp;a&nbsp;matrix&nbsp;over&nbsp;GF(2)&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3386"></a><div class='linenum'>3386</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;created,&nbsp;and&nbsp;the&nbsp;user&nbsp;then&nbsp;tries&nbsp;to&nbsp;change&nbsp;an&nbsp;entry&nbsp;to&nbsp;Z(4),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3387"></a><div class='linenum'>3387</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3388"></a><div class='linenum'>3388</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;M;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3389"></a><div class='linenum'>3389</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3390"></a><div class='linenum'>3390</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3391"></a><div class='linenum'>3391</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3392"></a><div class='linenum'>3392</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3393"></a><div class='linenum'>3393</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3394"></a><div class='linenum'>3394</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ReflectionMat(&nbsp;&lt;coeffs>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3395"></a><div class='linenum'>3395</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ReflectionMat(&nbsp;&lt;coeffs>,&nbsp;&lt;root>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3396"></a><div class='linenum'>3396</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ReflectionMat(&nbsp;&lt;coeffs>,&nbsp;&lt;conj>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3397"></a><div class='linenum'>3397</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ReflectionMat(&nbsp;&lt;coeffs>,&nbsp;&lt;conj>,&nbsp;&lt;root>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3398"></a><div class='linenum'>3398</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3399"></a><div class='linenum'>3399</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;ReflectionMat,&nbsp;function(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3400"></a><div class='linenum'>3400</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;coeffs,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;coefficients&nbsp;vector,&nbsp;first&nbsp;argument
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3401"></a><div class='linenum'>3401</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;root&nbsp;of&nbsp;unity,&nbsp;second&nbsp;argument&nbsp;(optional)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3402"></a><div class='linenum'>3402</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conj,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;conjugation&nbsp;function,&nbsp;third&nbsp;argument&nbsp;(optional)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3403"></a><div class='linenum'>3403</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;matrix&nbsp;of&nbsp;the&nbsp;reflection,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3404"></a><div class='linenum'>3404</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;length&nbsp;of&nbsp;'coeffs'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3405"></a><div class='linenum'>3405</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;identity&nbsp;of&nbsp;the&nbsp;ring&nbsp;over&nbsp;that&nbsp;'coeffs'&nbsp;is&nbsp;written
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3406"></a><div class='linenum'>3406</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;coefficient&nbsp;of&nbsp;'M'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3407"></a><div class='linenum'>3407</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;rows&nbsp;of&nbsp;'M'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3408"></a><div class='linenum'>3408</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;columns&nbsp;of&nbsp;'M'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3409"></a><div class='linenum'>3409</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;row&nbsp;of&nbsp;'M'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3410"></a><div class='linenum'>3410</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3411"></a><div class='linenum'>3411</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Get&nbsp;and&nbsp;check&nbsp;the&nbsp;arguments.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3412"></a><div class='linenum'>3412</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;&lt;&nbsp;1&nbsp;or&nbsp;3&nbsp;&lt;&nbsp;Length(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3413"></a><div class='linenum'>3413</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;not&nbsp;IsList(&nbsp;arg[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3414"></a><div class='linenum'>3414</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"usage:&nbsp;ReflectionMat(&nbsp;&lt;coeffs>&nbsp;[,&nbsp;&lt;conj>&nbsp;]&nbsp;[,&nbsp;&lt;k>&nbsp;]&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3415"></a><div class='linenum'>3415</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3416"></a><div class='linenum'>3416</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;coeffs:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3417"></a><div class='linenum'>3417</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3418"></a><div class='linenum'>3418</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w:=&nbsp;-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3419"></a><div class='linenum'>3419</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conj:=&nbsp;List(&nbsp;coeffs,&nbsp;ComplexConjugate&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3420"></a><div class='linenum'>3420</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;2&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3421"></a><div class='linenum'>3421</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsFunction(&nbsp;arg[2]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3422"></a><div class='linenum'>3422</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3423"></a><div class='linenum'>3423</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conj:=&nbsp;List(&nbsp;coeffs,&nbsp;ComplexConjugate&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3424"></a><div class='linenum'>3424</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3425"></a><div class='linenum'>3425</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w:=&nbsp;-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3426"></a><div class='linenum'>3426</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conj:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3427"></a><div class='linenum'>3427</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsFunction(&nbsp;conj&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3428"></a><div class='linenum'>3428</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;conj>&nbsp;must&nbsp;be&nbsp;a&nbsp;function"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3429"></a><div class='linenum'>3429</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3430"></a><div class='linenum'>3430</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conj:=&nbsp;List(&nbsp;coeffs,&nbsp;conj&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3431"></a><div class='linenum'>3431</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3432"></a><div class='linenum'>3432</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;3&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3433"></a><div class='linenum'>3433</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conj:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3434"></a><div class='linenum'>3434</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsFunction(&nbsp;conj&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3435"></a><div class='linenum'>3435</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;conj>&nbsp;must&nbsp;be&nbsp;a&nbsp;function"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3436"></a><div class='linenum'>3436</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3437"></a><div class='linenum'>3437</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conj:=&nbsp;List(&nbsp;coeffs,&nbsp;conj&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3438"></a><div class='linenum'>3438</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w:=&nbsp;arg[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3439"></a><div class='linenum'>3439</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3440"></a><div class='linenum'>3440</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3441"></a><div class='linenum'>3441</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Construct&nbsp;the&nbsp;matrix.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3442"></a><div class='linenum'>3442</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;M:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3443"></a><div class='linenum'>3443</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;coeffs[1]&nbsp;^&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3444"></a><div class='linenum'>3444</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;w:=&nbsp;w&nbsp;*&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3445"></a><div class='linenum'>3445</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Length(&nbsp;coeffs&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3446"></a><div class='linenum'>3446</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;c:=&nbsp;(&nbsp;w&nbsp;-&nbsp;one&nbsp;)&nbsp;/&nbsp;(&nbsp;coeffs&nbsp;*&nbsp;conj&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3447"></a><div class='linenum'>3447</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3448"></a><div class='linenum'>3448</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3449"></a><div class='linenum'>3449</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3450"></a><div class='linenum'>3450</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row[j]:=&nbsp;conj[i]&nbsp;*&nbsp;c&nbsp;*&nbsp;coeffs[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3451"></a><div class='linenum'>3451</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3452"></a><div class='linenum'>3452</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row[i]:=&nbsp;row[i]&nbsp;+&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3453"></a><div class='linenum'>3453</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3454"></a><div class='linenum'>3454</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M[i]:=&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3455"></a><div class='linenum'>3455</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3456"></a><div class='linenum'>3456</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3457"></a><div class='linenum'>3457</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;do&nbsp;*not*&nbsp;call&nbsp;ConvertToMatrixRep&nbsp;here,&nbsp;as&nbsp;that&nbsp;can&nbsp;cause
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3458"></a><div class='linenum'>3458</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;unexpected&nbsp;problems&nbsp;for&nbsp;the&nbsp;user&nbsp;(e.g.&nbsp;if&nbsp;a&nbsp;matrix&nbsp;over&nbsp;GF(2)&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3459"></a><div class='linenum'>3459</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;created,&nbsp;and&nbsp;the&nbsp;user&nbsp;then&nbsp;tries&nbsp;to&nbsp;change&nbsp;an&nbsp;entry&nbsp;to&nbsp;Z(4),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3460"></a><div class='linenum'>3460</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3461"></a><div class='linenum'>3461</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;M;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3462"></a><div class='linenum'>3462</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3463"></a><div class='linenum'>3463</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3464"></a><div class='linenum'>3464</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3465"></a><div class='linenum'>3465</div></td><td></td><td></td><td></td><td><span><tt>#########################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3466"></a><div class='linenum'>3466</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3467"></a><div class='linenum'>3467</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RandomInvertibleMat(&nbsp;&lt;m>&nbsp;[,&nbsp;&lt;R>]&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;make&nbsp;a&nbsp;random&nbsp;invertible&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3468"></a><div class='linenum'>3468</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3469"></a><div class='linenum'>3469</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'RandomInvertibleMat'&nbsp;returns&nbsp;a&nbsp;invertible&nbsp;&nbsp;&nbsp;random&nbsp;matrix&nbsp;with&nbsp;&nbsp;&lt;m>&nbsp;rows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3470"></a><div class='linenum'>3470</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;columns&nbsp;&nbsp;with&nbsp;elements&nbsp;&nbsp;taken&nbsp;from&nbsp;&nbsp;the&nbsp;&nbsp;ring&nbsp;&lt;R>,&nbsp;which&nbsp;defaults&nbsp;&nbsp;to
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3471"></a><div class='linenum'>3471</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'Integers'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3472"></a><div class='linenum'>3472</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3473"></a><div class='linenum'>3473</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;RandomInvertibleMat,&nbsp;function&nbsp;(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3474"></a><div class='linenum'>3474</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;mat,&nbsp;m,&nbsp;R,&nbsp;i,&nbsp;row,&nbsp;k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3475"></a><div class='linenum'>3475</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3476"></a><div class='linenum'>3476</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;the&nbsp;arguments&nbsp;and&nbsp;get&nbsp;the&nbsp;list&nbsp;of&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3477"></a><div class='linenum'>3477</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(arg)&nbsp;=&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3478"></a><div class='linenum'>3478</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3479"></a><div class='linenum'>3479</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;:=&nbsp;Integers;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3480"></a><div class='linenum'>3480</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(arg)&nbsp;=&nbsp;2&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3481"></a><div class='linenum'>3481</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3482"></a><div class='linenum'>3482</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3483"></a><div class='linenum'>3483</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3484"></a><div class='linenum'>3484</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("usage:&nbsp;RandomInvertibleMat(&nbsp;&lt;m>&nbsp;[,&nbsp;&lt;R>]&nbsp;)");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3485"></a><div class='linenum'>3485</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3486"></a><div class='linenum'>3486</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3487"></a><div class='linenum'>3487</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now&nbsp;construct&nbsp;the&nbsp;random&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3488"></a><div class='linenum'>3488</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3489"></a><div class='linenum'>3489</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3490"></a><div class='linenum'>3490</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3491"></a><div class='linenum'>3491</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3492"></a><div class='linenum'>3492</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3493"></a><div class='linenum'>3493</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row[k]&nbsp;:=&nbsp;Random(&nbsp;R&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3494"></a><div class='linenum'>3494</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3495"></a><div class='linenum'>3495</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;row,&nbsp;R&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3496"></a><div class='linenum'>3496</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i]&nbsp;:=&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3497"></a><div class='linenum'>3497</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;NullspaceMat(&nbsp;mat&nbsp;)&nbsp;=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3498"></a><div class='linenum'>3498</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3499"></a><div class='linenum'>3499</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3500"></a><div class='linenum'>3500</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;do&nbsp;*not*&nbsp;call&nbsp;ConvertToMatrixRep&nbsp;here,&nbsp;as&nbsp;that&nbsp;can&nbsp;cause
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3501"></a><div class='linenum'>3501</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;unexpected&nbsp;problems&nbsp;for&nbsp;the&nbsp;user&nbsp;(e.g.&nbsp;if&nbsp;a&nbsp;matrix&nbsp;over&nbsp;GF(2)&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3502"></a><div class='linenum'>3502</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;created,&nbsp;and&nbsp;the&nbsp;user&nbsp;then&nbsp;tries&nbsp;to&nbsp;change&nbsp;an&nbsp;entry&nbsp;to&nbsp;Z(4),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3503"></a><div class='linenum'>3503</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3504"></a><div class='linenum'>3504</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3505"></a><div class='linenum'>3505</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3506"></a><div class='linenum'>3506</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3507"></a><div class='linenum'>3507</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3508"></a><div class='linenum'>3508</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3509"></a><div class='linenum'>3509</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3510"></a><div class='linenum'>3510</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RandomMat(&nbsp;&lt;m>,&nbsp;&lt;n>&nbsp;[,&nbsp;&lt;R>]&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;make&nbsp;a&nbsp;random&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3511"></a><div class='linenum'>3511</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3512"></a><div class='linenum'>3512</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'RandomMat'&nbsp;returns&nbsp;a&nbsp;random&nbsp;matrix&nbsp;with&nbsp;&lt;m>&nbsp;rows&nbsp;and&nbsp;&nbsp;&lt;n>&nbsp;&nbsp;columns&nbsp;&nbsp;with
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3513"></a><div class='linenum'>3513</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;elements&nbsp;taken&nbsp;from&nbsp;the&nbsp;ring&nbsp;&lt;R>,&nbsp;which&nbsp;defaults&nbsp;to&nbsp;'Integers'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3514"></a><div class='linenum'>3514</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3515"></a><div class='linenum'>3515</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;RandomMat,&nbsp;function&nbsp;(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3516"></a><div class='linenum'>3516</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;mat,&nbsp;m,&nbsp;n,&nbsp;R,&nbsp;i,&nbsp;row,&nbsp;k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3517"></a><div class='linenum'>3517</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3518"></a><div class='linenum'>3518</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;the&nbsp;arguments&nbsp;and&nbsp;get&nbsp;the&nbsp;list&nbsp;of&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3519"></a><div class='linenum'>3519</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(arg)&nbsp;=&nbsp;2&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3520"></a><div class='linenum'>3520</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3521"></a><div class='linenum'>3521</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3522"></a><div class='linenum'>3522</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;:=&nbsp;Integers;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3523"></a><div class='linenum'>3523</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(arg)&nbsp;=&nbsp;3&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3524"></a><div class='linenum'>3524</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3525"></a><div class='linenum'>3525</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3526"></a><div class='linenum'>3526</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;:=&nbsp;arg[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3527"></a><div class='linenum'>3527</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3528"></a><div class='linenum'>3528</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("usage:&nbsp;RandomMat(&nbsp;&lt;m>,&nbsp;&lt;n>&nbsp;[,&nbsp;&lt;F>]&nbsp;)");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3529"></a><div class='linenum'>3529</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3530"></a><div class='linenum'>3530</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3531"></a><div class='linenum'>3531</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now&nbsp;construct&nbsp;the&nbsp;random&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3532"></a><div class='linenum'>3532</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3533"></a><div class='linenum'>3533</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3534"></a><div class='linenum'>3534</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3535"></a><div class='linenum'>3535</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[1..n]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3536"></a><div class='linenum'>3536</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row[k]&nbsp;:=&nbsp;Random(&nbsp;R&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3537"></a><div class='linenum'>3537</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3538"></a><div class='linenum'>3538</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;row,&nbsp;R&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3539"></a><div class='linenum'>3539</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i]&nbsp;:=&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3540"></a><div class='linenum'>3540</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3541"></a><div class='linenum'>3541</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3542"></a><div class='linenum'>3542</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;do&nbsp;*not*&nbsp;call&nbsp;ConvertToMatrixRep&nbsp;here,&nbsp;as&nbsp;that&nbsp;can&nbsp;cause
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3543"></a><div class='linenum'>3543</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;unexpected&nbsp;problems&nbsp;for&nbsp;the&nbsp;user&nbsp;(e.g.&nbsp;if&nbsp;a&nbsp;matrix&nbsp;over&nbsp;GF(2)&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3544"></a><div class='linenum'>3544</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;created,&nbsp;and&nbsp;the&nbsp;user&nbsp;then&nbsp;tries&nbsp;to&nbsp;change&nbsp;an&nbsp;entry&nbsp;to&nbsp;Z(4),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3545"></a><div class='linenum'>3545</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3546"></a><div class='linenum'>3546</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3547"></a><div class='linenum'>3547</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3548"></a><div class='linenum'>3548</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3549"></a><div class='linenum'>3549</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3550"></a><div class='linenum'>3550</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3551"></a><div class='linenum'>3551</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3552"></a><div class='linenum'>3552</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RandomUnimodularMat(&nbsp;&lt;m>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;random&nbsp;unimodular&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3553"></a><div class='linenum'>3553</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3554"></a><div class='linenum'>3554</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;RandomUnimodularMat,&nbsp;function&nbsp;(&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3555"></a><div class='linenum'>3555</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;mat,&nbsp;c,&nbsp;i,&nbsp;j,&nbsp;k,&nbsp;l,&nbsp;a,&nbsp;b,&nbsp;v,&nbsp;w,&nbsp;gcd;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3556"></a><div class='linenum'>3556</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3557"></a><div class='linenum'>3557</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;start&nbsp;with&nbsp;the&nbsp;identity&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3558"></a><div class='linenum'>3558</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;:=&nbsp;IdentityMat(&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3559"></a><div class='linenum'>3559</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3560"></a><div class='linenum'>3560</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;c&nbsp;&nbsp;in&nbsp;[1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3561"></a><div class='linenum'>3561</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3562"></a><div class='linenum'>3562</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiply&nbsp;two&nbsp;random&nbsp;rows&nbsp;with&nbsp;a&nbsp;random?&nbsp;unimodular&nbsp;2x2&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3563"></a><div class='linenum'>3563</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;Random([1..m]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3564"></a><div class='linenum'>3564</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3565"></a><div class='linenum'>3565</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;:=&nbsp;Random([1..m]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3566"></a><div class='linenum'>3566</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;j&nbsp;&lt;>&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3567"></a><div class='linenum'>3567</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3568"></a><div class='linenum'>3568</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;:=&nbsp;Random(&nbsp;Integers&nbsp;);&nbsp;&nbsp;b&nbsp;:=&nbsp;Random(&nbsp;Integers&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3569"></a><div class='linenum'>3569</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gcd&nbsp;:=&nbsp;Gcdex(&nbsp;a,&nbsp;b&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3570"></a><div class='linenum'>3570</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;gcd.gcd&nbsp;=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3571"></a><div class='linenum'>3571</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;:=&nbsp;mat[i];&nbsp;&nbsp;w&nbsp;:=&nbsp;mat[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3572"></a><div class='linenum'>3572</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i]&nbsp;:=&nbsp;ShallowCopy(gcd.coeff1&nbsp;*&nbsp;v&nbsp;+&nbsp;gcd.coeff2&nbsp;*&nbsp;w);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3573"></a><div class='linenum'>3573</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[j]&nbsp;:=&nbsp;ShallowCopy(gcd.coeff3&nbsp;*&nbsp;v&nbsp;+&nbsp;gcd.coeff4&nbsp;*&nbsp;w);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3574"></a><div class='linenum'>3574</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3575"></a><div class='linenum'>3575</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;multiply&nbsp;two&nbsp;random&nbsp;cols&nbsp;with&nbsp;a&nbsp;random?&nbsp;unimodular&nbsp;2x2&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3576"></a><div class='linenum'>3576</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;Random([1..m]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3577"></a><div class='linenum'>3577</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3578"></a><div class='linenum'>3578</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;Random([1..m]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3579"></a><div class='linenum'>3579</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;l&nbsp;&lt;>&nbsp;k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3580"></a><div class='linenum'>3580</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3581"></a><div class='linenum'>3581</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;:=&nbsp;Random(&nbsp;Integers&nbsp;);&nbsp;&nbsp;b&nbsp;:=&nbsp;Random(&nbsp;Integers&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3582"></a><div class='linenum'>3582</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gcd&nbsp;:=&nbsp;Gcdex(&nbsp;a,&nbsp;b&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3583"></a><div class='linenum'>3583</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;gcd.gcd&nbsp;=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3584"></a><div class='linenum'>3584</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[1..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3585"></a><div class='linenum'>3585</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;:=&nbsp;mat[i][k];&nbsp;&nbsp;w&nbsp;:=&nbsp;mat[i][l];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3586"></a><div class='linenum'>3586</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i][k]&nbsp;:=&nbsp;gcd.coeff1&nbsp;*&nbsp;v&nbsp;+&nbsp;gcd.coeff2&nbsp;*&nbsp;w;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3587"></a><div class='linenum'>3587</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[i][l]&nbsp;:=&nbsp;gcd.coeff3&nbsp;*&nbsp;v&nbsp;+&nbsp;gcd.coeff4&nbsp;*&nbsp;w;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3588"></a><div class='linenum'>3588</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;mat[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3589"></a><div class='linenum'>3589</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3590"></a><div class='linenum'>3590</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3591"></a><div class='linenum'>3591</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3592"></a><div class='linenum'>3592</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3593"></a><div class='linenum'>3593</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3594"></a><div class='linenum'>3594</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3595"></a><div class='linenum'>3595</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3596"></a><div class='linenum'>3596</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3597"></a><div class='linenum'>3597</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3598"></a><div class='linenum'>3598</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3599"></a><div class='linenum'>3599</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;SimultaneousEigenvalues(&nbsp;&lt;matlist>,&nbsp;&lt;expo>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.eigenvalues
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3600"></a><div class='linenum'>3600</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3601"></a><div class='linenum'>3601</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;matgroup&nbsp;&nbsp;generated&nbsp;&nbsp;by&nbsp;&nbsp;&lt;matlist>&nbsp;&nbsp;must&nbsp;be&nbsp;&nbsp;an&nbsp;&nbsp;&nbsp;abelian&nbsp;p-group&nbsp;&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3602"></a><div class='linenum'>3602</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;exponent&nbsp;&lt;expo>.&nbsp;&nbsp;The&nbsp;matrices&nbsp;in&nbsp;&nbsp;matlist&nbsp;must&nbsp;be&nbsp;&nbsp;matrices&nbsp;over&nbsp;GF(&lt;q>)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3603"></a><div class='linenum'>3603</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;for&nbsp;some&nbsp;prime&nbsp;&lt;q>.&nbsp;Then&nbsp;the&nbsp;eigenvalues&nbsp;of&nbsp;&lt;mat>&nbsp;&nbsp;in&nbsp;the&nbsp;splitting&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3604"></a><div class='linenum'>3604</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;GF(&lt;q>^r)&nbsp;for&nbsp;some&nbsp;r&nbsp;are&nbsp;powers&nbsp;of&nbsp;an&nbsp;element&nbsp;ksi&nbsp;in&nbsp;the&nbsp;splitting&nbsp;field,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3605"></a><div class='linenum'>3605</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;which&nbsp;is&nbsp;of&nbsp;order&nbsp;&lt;expo>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3606"></a><div class='linenum'>3606</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3607"></a><div class='linenum'>3607</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;'SimultaneousEigenspaces'&nbsp;&nbsp;returns&nbsp;a&nbsp;matrix&nbsp;&nbsp;of&nbsp;intergers&nbsp;mod&nbsp;&lt;expo>,&nbsp;say
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3608"></a><div class='linenum'>3608</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;(a_{i,j}),&nbsp;such&nbsp;that&nbsp;the&nbsp;&nbsp;power&nbsp;ksi^a_{i,j}&nbsp;is&nbsp;an&nbsp;&nbsp;eigenvalue&nbsp;of&nbsp;the&nbsp;i-th
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3609"></a><div class='linenum'>3609</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;matrix&nbsp;in&nbsp;&lt;matlist>&nbsp;and&nbsp;the&nbsp;eigenspaces&nbsp;of&nbsp;&nbsp;the&nbsp;different&nbsp;matrices&nbsp;to&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3610"></a><div class='linenum'>3610</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;eigenvalues&nbsp;ksi^a_{i,j}&nbsp;for&nbsp;fixed&nbsp;j&nbsp;are&nbsp;equal.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3611"></a><div class='linenum'>3611</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3612"></a><div class='linenum'>3612</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;SimultaneousEigenvalues,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3613"></a><div class='linenum'>3613</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3614"></a><div class='linenum'>3614</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;matlist,&nbsp;expo,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3615"></a><div class='linenum'>3615</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;characteristic&nbsp;of&nbsp;field&nbsp;of&nbsp;matrices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3616"></a><div class='linenum'>3616</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;such&nbsp;that&nbsp;&lt;q>^r&nbsp;is&nbsp;splitting&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3617"></a><div class='linenum'>3617</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field,&nbsp;&nbsp;&nbsp;#&nbsp;GF(&lt;q>^r)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3618"></a><div class='linenum'>3618</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ksi,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;expo>-root&nbsp;of&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3619"></a><div class='linenum'>3619</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eival,&nbsp;&nbsp;&nbsp;#&nbsp;exponents&nbsp;of&nbsp;eigenvalues&nbsp;of&nbsp;the&nbsp;matrices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3620"></a><div class='linenum'>3620</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eispa,&nbsp;&nbsp;&nbsp;#&nbsp;eigenspaces&nbsp;of&nbsp;the&nbsp;matrices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3621"></a><div class='linenum'>3621</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eigen,&nbsp;&nbsp;&nbsp;#&nbsp;exponents&nbsp;of&nbsp;simultaneous&nbsp;eigenvalues
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3622"></a><div class='linenum'>3622</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;identity&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3623"></a><div class='linenum'>3623</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ksi^w&nbsp;is&nbsp;candidate&nbsp;for&nbsp;a&nbsp;eigenvalue
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3624"></a><div class='linenum'>3624</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;basis&nbsp;of&nbsp;nullspace
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3625"></a><div class='linenum'>3625</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;Split;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3626"></a><div class='linenum'>3626</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3627"></a><div class='linenum'>3627</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Split&nbsp;:=&nbsp;function(&nbsp;space,&nbsp;i&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3628"></a><div class='linenum'>3628</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;int,&nbsp;&nbsp;&nbsp;#&nbsp;intersection&nbsp;of&nbsp;two&nbsp;row&nbsp;spaces
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3629"></a><div class='linenum'>3629</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3630"></a><div class='linenum'>3630</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3631"></a><div class='linenum'>3631</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[1..Length(eival[i])]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3632"></a><div class='linenum'>3632</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;&nbsp;Length(&nbsp;eispa[i][j]&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3633"></a><div class='linenum'>3633</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;:=&nbsp;SumIntersectionMat(&nbsp;space,&nbsp;eispa[i][j]&nbsp;)[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3634"></a><div class='linenum'>3634</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;&nbsp;Length(&nbsp;int&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3635"></a><div class='linenum'>3635</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;eigen[i],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3636"></a><div class='linenum'>3636</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;int,&nbsp;x&nbsp;->&nbsp;eival[i][j]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3637"></a><div class='linenum'>3637</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&lt;&nbsp;Length(&nbsp;matlist&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3638"></a><div class='linenum'>3638</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Split(&nbsp;int,&nbsp;i+1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3639"></a><div class='linenum'>3639</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3640"></a><div class='linenum'>3640</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3641"></a><div class='linenum'>3641</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3642"></a><div class='linenum'>3642</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3643"></a><div class='linenum'>3643</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3644"></a><div class='linenum'>3644</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3645"></a><div class='linenum'>3645</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;matlist&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3646"></a><div class='linenum'>3646</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;expo&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3647"></a><div class='linenum'>3647</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3648"></a><div class='linenum'>3648</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;ksi
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3649"></a><div class='linenum'>3649</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;2&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3650"></a><div class='linenum'>3650</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;:=&nbsp;Characteristic(&nbsp;matlist[1][1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3651"></a><div class='linenum'>3651</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3652"></a><div class='linenum'>3652</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;splitting&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3653"></a><div class='linenum'>3653</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3654"></a><div class='linenum'>3654</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;EuclideanRemainder(&nbsp;q^r&nbsp;-&nbsp;1,&nbsp;expo&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3655"></a><div class='linenum'>3655</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;r+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3656"></a><div class='linenum'>3656</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3657"></a><div class='linenum'>3657</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;:=&nbsp;GF(q^r);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3658"></a><div class='linenum'>3658</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ksi&nbsp;&nbsp;&nbsp;:=&nbsp;GeneratorsOfField(field)[1]^((q^r&nbsp;-&nbsp;1)&nbsp;/&nbsp;expo);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3659"></a><div class='linenum'>3659</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3660"></a><div class='linenum'>3660</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ksi&nbsp;:=&nbsp;arg[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3661"></a><div class='linenum'>3661</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3662"></a><div class='linenum'>3662</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3663"></a><div class='linenum'>3663</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;set&nbsp;up&nbsp;eigenvalues&nbsp;and&nbsp;spaces&nbsp;and&nbsp;Idmat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3664"></a><div class='linenum'>3664</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;eival&nbsp;&nbsp;:=&nbsp;List(&nbsp;matlist,&nbsp;x&nbsp;->&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3665"></a><div class='linenum'>3665</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;eispa&nbsp;&nbsp;:=&nbsp;List(&nbsp;matlist,&nbsp;x&nbsp;->&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3666"></a><div class='linenum'>3666</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;matlist[1]^0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3667"></a><div class='linenum'>3667</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3668"></a><div class='linenum'>3668</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;calculate&nbsp;eigenvalues&nbsp;and&nbsp;spaces&nbsp;for&nbsp;each&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3669"></a><div class='linenum'>3669</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(matlist)]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3670"></a><div class='linenum'>3670</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;w&nbsp;in&nbsp;[0..expo-1]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3671"></a><div class='linenum'>3671</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null&nbsp;:=&nbsp;NullspaceMat(&nbsp;matlist[i]&nbsp;-&nbsp;(ksi^w&nbsp;*&nbsp;I)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3672"></a><div class='linenum'>3672</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;&nbsp;Length(null)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3673"></a><div class='linenum'>3673</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;eival[i],&nbsp;w&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3674"></a><div class='linenum'>3674</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;eispa[i],&nbsp;null&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3675"></a><div class='linenum'>3675</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3676"></a><div class='linenum'>3676</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3677"></a><div class='linenum'>3677</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3678"></a><div class='linenum'>3678</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3679"></a><div class='linenum'>3679</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now&nbsp;make&nbsp;the&nbsp;eigenvalues&nbsp;simultaneous
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3680"></a><div class='linenum'>3680</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;eigen&nbsp;:=&nbsp;List(&nbsp;matlist,&nbsp;x&nbsp;->&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3681"></a><div class='linenum'>3681</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[1..Length(eival[1])]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3682"></a><div class='linenum'>3682</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;eigen[1],&nbsp;List(&nbsp;eispa[1][i],&nbsp;x&nbsp;->&nbsp;eival[1][i]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3683"></a><div class='linenum'>3683</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;matlist&nbsp;)&nbsp;>&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3684"></a><div class='linenum'>3684</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Split(&nbsp;eispa[1][i],&nbsp;2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3685"></a><div class='linenum'>3685</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3686"></a><div class='linenum'>3686</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3687"></a><div class='linenum'>3687</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3688"></a><div class='linenum'>3688</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3689"></a><div class='linenum'>3689</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;eigen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3690"></a><div class='linenum'>3690</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3691"></a><div class='linenum'>3691</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3692"></a><div class='linenum'>3692</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3693"></a><div class='linenum'>3693</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3694"></a><div class='linenum'>3694</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;FlatBlockMat(&nbsp;&lt;blockmat>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;convert&nbsp;block&nbsp;mat&nbsp;to&nbsp;mat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3695"></a><div class='linenum'>3695</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3696"></a><div class='linenum'>3696</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;FlatBlockMat,&nbsp;function(&nbsp;block&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3697"></a><div class='linenum'>3697</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;d,&nbsp;l,&nbsp;mat,&nbsp;i,&nbsp;j,&nbsp;h,&nbsp;k,&nbsp;a,&nbsp;b;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3698"></a><div class='linenum'>3698</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3699"></a><div class='linenum'>3699</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;Length(&nbsp;block&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3700"></a><div class='linenum'>3700</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;Length(&nbsp;block[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3701"></a><div class='linenum'>3701</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;:=&nbsp;List(&nbsp;[1..d*l],&nbsp;x&nbsp;->&nbsp;List(&nbsp;[1..d*l],&nbsp;y&nbsp;->&nbsp;false&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3702"></a><div class='linenum'>3702</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..d]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3703"></a><div class='linenum'>3703</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..d]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3704"></a><div class='linenum'>3704</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;h&nbsp;in&nbsp;[1..l]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3705"></a><div class='linenum'>3705</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[1..l]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3706"></a><div class='linenum'>3706</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;:=&nbsp;(i-1)*l&nbsp;+&nbsp;h;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3707"></a><div class='linenum'>3707</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;:=&nbsp;(j-1)*l&nbsp;+&nbsp;k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3708"></a><div class='linenum'>3708</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[a][b]&nbsp;:=&nbsp;block[i][j][h][k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3709"></a><div class='linenum'>3709</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3710"></a><div class='linenum'>3710</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3711"></a><div class='linenum'>3711</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3712"></a><div class='linenum'>3712</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3713"></a><div class='linenum'>3713</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3714"></a><div class='linenum'>3714</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3715"></a><div class='linenum'>3715</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3716"></a><div class='linenum'>3716</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3717"></a><div class='linenum'>3717</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3718"></a><div class='linenum'>3718</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;DirectSumMat(&nbsp;&lt;matlist>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;create&nbsp;block&nbsp;diagonal&nbsp;mat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3719"></a><div class='linenum'>3719</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;DirectSumMat(&nbsp;mat1,..,matn&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;create&nbsp;block&nbsp;diagonal&nbsp;mat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3720"></a><div class='linenum'>3720</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3721"></a><div class='linenum'>3721</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;DirectSumMat,&nbsp;function&nbsp;(arg)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3722"></a><div class='linenum'>3722</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;c,&nbsp;r,&nbsp;res,&nbsp;m,&nbsp;f,&nbsp;F;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3723"></a><div class='linenum'>3723</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(arg)=1&nbsp;and&nbsp;not&nbsp;IsMatrix(arg[1])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3724"></a><div class='linenum'>3724</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arg:=arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3725"></a><div class='linenum'>3725</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3726"></a><div class='linenum'>3726</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f:=function(m)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3727"></a><div class='linenum'>3727</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(m)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3728"></a><div class='linenum'>3728</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3729"></a><div class='linenum'>3729</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3730"></a><div class='linenum'>3730</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Length(m[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3731"></a><div class='linenum'>3731</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3732"></a><div class='linenum'>3732</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3733"></a><div class='linenum'>3733</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=1;&nbsp;m:=[&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3734"></a><div class='linenum'>3734</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;m&nbsp;=&nbsp;[&nbsp;]&nbsp;and&nbsp;r&nbsp;&lt;=&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3735"></a><div class='linenum'>3735</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;arg[r];&nbsp;r:=r+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3736"></a><div class='linenum'>3736</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3737"></a><div class='linenum'>3737</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;&lt;>&nbsp;[&nbsp;]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3738"></a><div class='linenum'>3738</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F:=&nbsp;DefaultField(&nbsp;m[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3739"></a><div class='linenum'>3739</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3740"></a><div class='linenum'>3740</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F:=&nbsp;Rationals;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3741"></a><div class='linenum'>3741</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3742"></a><div class='linenum'>3742</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;res:=List(NullMat(Sum(arg,Length),Sum(arg,f),F),ShallowCopy);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3743"></a><div class='linenum'>3743</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3744"></a><div class='linenum'>3744</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;c:=0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3745"></a><div class='linenum'>3745</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;m&nbsp;in&nbsp;arg&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3746"></a><div class='linenum'>3746</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res{r+[1..Length(m)]}{c+[1..f(m)]}:=m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3747"></a><div class='linenum'>3747</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r:=r+Length(m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3748"></a><div class='linenum'>3748</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c:=c+f(m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3749"></a><div class='linenum'>3749</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3750"></a><div class='linenum'>3750</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;res;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3751"></a><div class='linenum'>3751</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3752"></a><div class='linenum'>3752</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3753"></a><div class='linenum'>3753</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3754"></a><div class='linenum'>3754</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3755"></a><div class='linenum'>3755</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3756"></a><div class='linenum'>3756</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;TraceMat(&nbsp;&lt;mat>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;trace&nbsp;of&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3757"></a><div class='linenum'>3757</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3758"></a><div class='linenum'>3758</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TraceMat,&nbsp;"method&nbsp;for&nbsp;lists",&nbsp;[&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3759"></a><div class='linenum'>3759</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3760"></a><div class='linenum'>3760</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;trc,&nbsp;m,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3761"></a><div class='linenum'>3761</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3762"></a><div class='linenum'>3762</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;that&nbsp;the&nbsp;element&nbsp;is&nbsp;a&nbsp;square&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3763"></a><div class='linenum'>3763</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3764"></a><div class='linenum'>3764</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;&lt;>&nbsp;Length(mat[1])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3765"></a><div class='linenum'>3765</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("TraceMat:&nbsp;&lt;mat>&nbsp;must&nbsp;be&nbsp;a&nbsp;square&nbsp;matrix");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3766"></a><div class='linenum'>3766</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3767"></a><div class='linenum'>3767</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3768"></a><div class='linenum'>3768</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;sum&nbsp;all&nbsp;the&nbsp;diagonal&nbsp;entries
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3769"></a><div class='linenum'>3769</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;trc&nbsp;:=&nbsp;mat[1][1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3770"></a><div class='linenum'>3770</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[2..m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3771"></a><div class='linenum'>3771</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trc&nbsp;:=&nbsp;trc&nbsp;+&nbsp;mat[i][i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3772"></a><div class='linenum'>3772</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3773"></a><div class='linenum'>3773</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3774"></a><div class='linenum'>3774</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;trace
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3775"></a><div class='linenum'>3775</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;trc;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3776"></a><div class='linenum'>3776</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3777"></a><div class='linenum'>3777</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3778"></a><div class='linenum'>3778</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3779"></a><div class='linenum'>3779</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3780"></a><div class='linenum'>3780</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3781"></a><div class='linenum'>3781</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Trace(&nbsp;&lt;mat>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3782"></a><div class='linenum'>3782</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3783"></a><div class='linenum'>3783</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;Trace,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3784"></a><div class='linenum'>3784</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3785"></a><div class='linenum'>3785</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3786"></a><div class='linenum'>3786</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TraceMat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3787"></a><div class='linenum'>3787</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3788"></a><div class='linenum'>3788</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3789"></a><div class='linenum'>3789</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3790"></a><div class='linenum'>3790</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3791"></a><div class='linenum'>3791</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;JordanDecomposition(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3792"></a><div class='linenum'>3792</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3793"></a><div class='linenum'>3793</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;JordanDecomposition,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3794"></a><div class='linenum'>3794</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"method&nbsp;for&nbsp;matrices",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3795"></a><div class='linenum'>3795</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[IsMatrix],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3796"></a><div class='linenum'>3796</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3797"></a><div class='linenum'>3797</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3798"></a><div class='linenum'>3798</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;F,p,B,f,g,fac,ff,h,w;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3799"></a><div class='linenum'>3799</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3800"></a><div class='linenum'>3800</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;due&nbsp;to&nbsp;R.&nbsp;Beals
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3801"></a><div class='linenum'>3801</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3802"></a><div class='linenum'>3802</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;F:=&nbsp;DefaultFieldOfMatrix(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3803"></a><div class='linenum'>3803</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;F&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3804"></a><div class='linenum'>3804</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3805"></a><div class='linenum'>3805</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3806"></a><div class='linenum'>3806</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;p:=&nbsp;Characteristic(&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3807"></a><div class='linenum'>3807</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3808"></a><div class='linenum'>3808</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;First&nbsp;we&nbsp;determine&nbsp;a&nbsp;squarefree&nbsp;polynomial&nbsp;'g'&nbsp;such&nbsp;that&nbsp;'g^d(mat)=0'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3809"></a><div class='linenum'>3809</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3810"></a><div class='linenum'>3810</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;f:=&nbsp;CharacteristicPolynomial(&nbsp;F,&nbsp;F,&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3811"></a><div class='linenum'>3811</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;p&nbsp;=&nbsp;0&nbsp;or&nbsp;p&nbsp;>&nbsp;Length(&nbsp;mat&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3812"></a><div class='linenum'>3812</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;g:=&nbsp;f/Gcd(&nbsp;f,&nbsp;Derivative(&nbsp;f&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3813"></a><div class='linenum'>3813</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3814"></a><div class='linenum'>3814</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fac:=&nbsp;Factors(f);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3815"></a><div class='linenum'>3815</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;g:=&nbsp;One(&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3816"></a><div class='linenum'>3816</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ff:=&nbsp;[&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3817"></a><div class='linenum'>3817</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;h&nbsp;in&nbsp;fac&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3818"></a><div class='linenum'>3818</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;h&nbsp;in&nbsp;ff&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3819"></a><div class='linenum'>3819</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g:=&nbsp;g*h;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3820"></a><div class='linenum'>3820</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;ff,&nbsp;h&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3821"></a><div class='linenum'>3821</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3822"></a><div class='linenum'>3822</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3823"></a><div class='linenum'>3823</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3824"></a><div class='linenum'>3824</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3825"></a><div class='linenum'>3825</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;f=g&nbsp;then&nbsp;return&nbsp;[&nbsp;mat,&nbsp;0*mat&nbsp;];&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3826"></a><div class='linenum'>3826</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3827"></a><div class='linenum'>3827</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;Now&nbsp;'B'&nbsp;will&nbsp;be&nbsp;the&nbsp;semisimple&nbsp;part&nbsp;of&nbsp;the&nbsp;matrix&nbsp;'mat'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3828"></a><div class='linenum'>3828</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3829"></a><div class='linenum'>3829</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;w:=&nbsp;GcdRepresentation(&nbsp;g,&nbsp;Derivative(&nbsp;g&nbsp;)&nbsp;)[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3830"></a><div class='linenum'>3830</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;w:=&nbsp;w*g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3831"></a><div class='linenum'>3831</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;B:=&nbsp;ShallowCopy(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3832"></a><div class='linenum'>3832</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;Value(&nbsp;g,&nbsp;B&nbsp;)&nbsp;&lt;>&nbsp;0*B&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3833"></a><div class='linenum'>3833</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;B:=&nbsp;B&nbsp;-&nbsp;Value(&nbsp;w,&nbsp;B&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3834"></a><div class='linenum'>3834</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3835"></a><div class='linenum'>3835</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3836"></a><div class='linenum'>3836</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;[&nbsp;B,&nbsp;mat-B&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3837"></a><div class='linenum'>3837</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3838"></a><div class='linenum'>3838</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3839"></a><div class='linenum'>3839</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3840"></a><div class='linenum'>3840</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3841"></a><div class='linenum'>3841</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3842"></a><div class='linenum'>3842</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OnSubspacesByCanonicalBasis(&lt;bas>,&lt;mat>)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3843"></a><div class='linenum'>3843</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3844"></a><div class='linenum'>3844</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(OnSubspacesByCanonicalBasis,function(&nbsp;mat,&nbsp;obj&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3845"></a><div class='linenum'>3845</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3846"></a><div class='linenum'>3846</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat:=mat*obj;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3847"></a><div class='linenum'>3847</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsMutable(mat)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3848"></a><div class='linenum'>3848</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;:=&nbsp;MutableCopyMat(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3849"></a><div class='linenum'>3849</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3850"></a><div class='linenum'>3850</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;[1..Length(mat)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3851"></a><div class='linenum'>3851</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsMutable(mat[row])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3852"></a><div class='linenum'>3852</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mat[row]&nbsp;:=&nbsp;ShallowCopy(mat[row]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3853"></a><div class='linenum'>3853</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3854"></a><div class='linenum'>3854</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3855"></a><div class='linenum'>3855</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3856"></a><div class='linenum'>3856</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TriangulizeMat(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3857"></a><div class='linenum'>3857</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3858"></a><div class='linenum'>3858</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3859"></a><div class='linenum'>3859</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3860"></a><div class='linenum'>3860</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3861"></a><div class='linenum'>3861</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3862"></a><div class='linenum'>3862</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OnSubspacesByCanonicalBasisConcatenations(&lt;basvec>,&lt;mat>)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3863"></a><div class='linenum'>3863</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3864"></a><div class='linenum'>3864</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(OnSubspacesByCanonicalBasisConcatenations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3865"></a><div class='linenum'>3865</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;bvec,&nbsp;obj&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3866"></a><div class='linenum'>3866</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;n,a,mat,r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3867"></a><div class='linenum'>3867</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;n:=Length(obj);&nbsp;#&nbsp;acting&nbsp;dimension
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3868"></a><div class='linenum'>3868</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;mat:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3869"></a><div class='linenum'>3869</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;a:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3870"></a><div class='linenum'>3870</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;a&lt;Length(bvec)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3871"></a><div class='linenum'>3871</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=bvec{[a..a+n-1]}*obj;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3872"></a><div class='linenum'>3872</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsMutable(r)&nbsp;then&nbsp;r:=ShallowCopy(r);fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3873"></a><div class='linenum'>3873</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Add(mat,r);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3874"></a><div class='linenum'>3874</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;a:=a+n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3875"></a><div class='linenum'>3875</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3876"></a><div class='linenum'>3876</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;TriangulizeMat(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3877"></a><div class='linenum'>3877</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Concatenation(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3878"></a><div class='linenum'>3878</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3879"></a><div class='linenum'>3879</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3880"></a><div class='linenum'>3880</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3881"></a><div class='linenum'>3881</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3882"></a><div class='linenum'>3882</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;FieldOfMatrixList
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3883"></a><div class='linenum'>3883</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3884"></a><div class='linenum'>3884</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(FieldOfMatrixList,"generic:&nbsp;form&nbsp;field",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3885"></a><div class='linenum'>3885</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsListOrCollection],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3886"></a><div class='linenum'>3886</div></td><td></td><td></td><td></td><td><span><tt>function(l)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3887"></a><div class='linenum'>3887</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;i,j,k,fg,f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3888"></a><div class='linenum'>3888</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;try&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3889"></a><div class='linenum'>3889</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(l)=0&nbsp;or&nbsp;ForAny(l,i->not&nbsp;IsMatrix(i))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3890"></a><div class='linenum'>3890</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("&lt;l>&nbsp;must&nbsp;be&nbsp;a&nbsp;list&nbsp;of&nbsp;matrices");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3891"></a><div class='linenum'>3891</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3892"></a><div class='linenum'>3892</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fg:=[l[1][1][1]];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3893"></a><div class='linenum'>3893</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;f:=Field(fg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3894"></a><div class='linenum'>3894</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;l&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3895"></a><div class='linenum'>3895</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;i&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3896"></a><div class='linenum'>3896</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;j&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3897"></a><div class='linenum'>3897</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;k&nbsp;in&nbsp;f&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3898"></a><div class='linenum'>3898</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(fg,k);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3899"></a><div class='linenum'>3899</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f:=Field(fg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3900"></a><div class='linenum'>3900</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3901"></a><div class='linenum'>3901</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3902"></a><div class='linenum'>3902</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3903"></a><div class='linenum'>3903</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3904"></a><div class='linenum'>3904</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3905"></a><div class='linenum'>3905</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3906"></a><div class='linenum'>3906</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3907"></a><div class='linenum'>3907</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3908"></a><div class='linenum'>3908</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3909"></a><div class='linenum'>3909</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DefaultScalarDomainOfMatrixList
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3910"></a><div class='linenum'>3910</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3911"></a><div class='linenum'>3911</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(DefaultScalarDomainOfMatrixList,&nbsp;"generic:&nbsp;form&nbsp;ring",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3912"></a><div class='linenum'>3912</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsListOrCollection],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3913"></a><div class='linenum'>3913</div></td><td></td><td></td><td></td><td><span><tt>function(l)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3914"></a><div class='linenum'>3914</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;i,j,k,fg,f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3915"></a><div class='linenum'>3915</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;try&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3916"></a><div class='linenum'>3916</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(l)=0&nbsp;or&nbsp;ForAny(l,i->not&nbsp;IsMatrix(i))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3917"></a><div class='linenum'>3917</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("&lt;l>&nbsp;must&nbsp;be&nbsp;a&nbsp;list&nbsp;of&nbsp;matrices");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3918"></a><div class='linenum'>3918</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3919"></a><div class='linenum'>3919</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fg:=[l[1][1][1]];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3920"></a><div class='linenum'>3920</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Characteristic(fg)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3921"></a><div class='linenum'>3921</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f:=DefaultField(fg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3922"></a><div class='linenum'>3922</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3923"></a><div class='linenum'>3923</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f:=DefaultRing(fg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3924"></a><div class='linenum'>3924</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3925"></a><div class='linenum'>3925</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;l&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3926"></a><div class='linenum'>3926</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;i&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3927"></a><div class='linenum'>3927</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;j&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3928"></a><div class='linenum'>3928</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;k&nbsp;in&nbsp;f&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3929"></a><div class='linenum'>3929</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(fg,k);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3930"></a><div class='linenum'>3930</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f:=DefaultRing(fg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3931"></a><div class='linenum'>3931</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3932"></a><div class='linenum'>3932</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3933"></a><div class='linenum'>3933</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3934"></a><div class='linenum'>3934</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3935"></a><div class='linenum'>3935</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3936"></a><div class='linenum'>3936</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3937"></a><div class='linenum'>3937</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3938"></a><div class='linenum'>3938</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3939"></a><div class='linenum'>3939</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3940"></a><div class='linenum'>3940</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3941"></a><div class='linenum'>3941</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;NOT&nbsp;READY:&nbsp;BaseNullspace(&nbsp;&lt;struct>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3942"></a><div class='linenum'>3942</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3943"></a><div class='linenum'>3943</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;BaseNullspace&nbsp;:=&nbsp;function(&nbsp;struct&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3944"></a><div class='linenum'>3944</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;IsMat(&nbsp;struct&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3945"></a><div class='linenum'>3945</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NullspaceMat(&nbsp;struct&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3946"></a><div class='linenum'>3946</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsRecord(&nbsp;struct&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3947"></a><div class='linenum'>3947</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;struct.baseNullspace&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3948"></a><div class='linenum'>3948</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;struct.operations&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3949"></a><div class='linenum'>3949</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;struct>&nbsp;must&nbsp;have&nbsp;'operations'&nbsp;entry"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3950"></a><div class='linenum'>3950</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3951"></a><div class='linenum'>3951</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct.baseNullspace:=
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3952"></a><div class='linenum'>3952</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct.operations.BaseNullspace(&nbsp;struct&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3953"></a><div class='linenum'>3953</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3954"></a><div class='linenum'>3954</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;struct.baseNullspace;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3955"></a><div class='linenum'>3955</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3956"></a><div class='linenum'>3956</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;struct>&nbsp;must&nbsp;be&nbsp;a&nbsp;matrix&nbsp;or&nbsp;a&nbsp;record"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3957"></a><div class='linenum'>3957</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3958"></a><div class='linenum'>3958</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3959"></a><div class='linenum'>3959</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3960"></a><div class='linenum'>3960</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3961"></a><div class='linenum'>3961</div></td><td></td><td></td><td></td><td><span><tt>##########################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3962"></a><div class='linenum'>3962</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3963"></a><div class='linenum'>3963</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;NOT&nbsp;READY:&nbsp;MatricesOps.InvariantForm(&nbsp;&lt;D>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3964"></a><div class='linenum'>3964</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3965"></a><div class='linenum'>3965</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;MatricesOps.InvariantForm&nbsp;:=&nbsp;function(&nbsp;D&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3966"></a><div class='linenum'>3966</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;F,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3967"></a><div class='linenum'>3967</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;size&nbsp;of&nbsp;'F'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3968"></a><div class='linenum'>3968</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;'F'-algebra&nbsp;generated&nbsp;by&nbsp;'D'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3969"></a><div class='linenum'>3969</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;word&nbsp;number
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3970"></a><div class='linenum'>3970</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;algebra&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3971"></a><div class='linenum'>3971</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;variable
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3972"></a><div class='linenum'>3972</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ns,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;file&nbsp;for&nbsp;a&nbsp;nullspace
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3973"></a><div class='linenum'>3973</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;standard&nbsp;basis&nbsp;of&nbsp;'D'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3974"></a><div class='linenum'>3974</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;contragredient&nbsp;representation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3975"></a><div class='linenum'>3975</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;standard&nbsp;basis&nbsp;of&nbsp;'T'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3976"></a><div class='linenum'>3976</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;invariant&nbsp;form,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3977"></a><div class='linenum'>3977</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3978"></a><div class='linenum'>3978</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;not&nbsp;(&nbsp;IsList(&nbsp;D&nbsp;)&nbsp;and&nbsp;ForAll(&nbsp;D,&nbsp;IsMatrix&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3979"></a><div class='linenum'>3979</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;D>&nbsp;must&nbsp;be&nbsp;a&nbsp;list&nbsp;of&nbsp;matrices"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3980"></a><div class='linenum'>3980</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;D&nbsp;)&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3981"></a><div class='linenum'>3981</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"need&nbsp;at&nbsp;least&nbsp;one&nbsp;matrix"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3982"></a><div class='linenum'>3982</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3983"></a><div class='linenum'>3983</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3984"></a><div class='linenum'>3984</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F:=&nbsp;Field(&nbsp;Flat(&nbsp;D&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3985"></a><div class='linenum'>3985</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsFinite(&nbsp;F&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3986"></a><div class='linenum'>3986</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"sorry,&nbsp;for&nbsp;finite&nbsp;fields&nbsp;only"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3987"></a><div class='linenum'>3987</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3988"></a><div class='linenum'>3988</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q:=&nbsp;Size(&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3989"></a><div class='linenum'>3989</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3990"></a><div class='linenum'>3990</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Search&nbsp;for&nbsp;an&nbsp;algebra&nbsp;element&nbsp;of&nbsp;nullity&nbsp;1.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3991"></a><div class='linenum'>3991</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Use&nbsp;normed&nbsp;words&nbsp;only,&nbsp;that&nbsp;is,&nbsp;words&nbsp;of&nbsp;the&nbsp;form&nbsp;$I&nbsp;+&nbsp;w$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3992"></a><div class='linenum'>3992</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Write&nbsp;the&nbsp;'D'&nbsp;nullspace&nbsp;of&nbsp;the&nbsp;nullity&nbsp;1&nbsp;word&nbsp;to&nbsp;'ns'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3993"></a><div class='linenum'>3993</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A:=&nbsp;Algebra(&nbsp;F,&nbsp;D&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3994"></a><div class='linenum'>3994</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3995"></a><div class='linenum'>3995</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3996"></a><div class='linenum'>3996</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr:=&nbsp;nr&nbsp;+&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3997"></a><div class='linenum'>3997</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word:=&nbsp;ElementAlgebra(&nbsp;A,&nbsp;nr&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3998"></a><div class='linenum'>3998</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ns:=&nbsp;NullspaceMat(&nbsp;word&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3999"></a><div class='linenum'>3999</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;Length(&nbsp;ns&nbsp;)&nbsp;=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4000"></a><div class='linenum'>4000</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4001"></a><div class='linenum'>4001</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;standard&nbsp;basis&nbsp;for&nbsp;the&nbsp;natural&nbsp;module&nbsp;of&nbsp;'D',
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4002"></a><div class='linenum'>4002</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;starting&nbsp;with&nbsp;the&nbsp;word&nbsp;of&nbsp;nullity&nbsp;1,&nbsp;write&nbsp;output&nbsp;to&nbsp;'sb1'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4003"></a><div class='linenum'>4003</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb1:=&nbsp;BasisVectors(&nbsp;StandardBasis(&nbsp;Module(&nbsp;A,&nbsp;ns&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4004"></a><div class='linenum'>4004</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4005"></a><div class='linenum'>4005</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;whether&nbsp;the&nbsp;whole&nbsp;space&nbsp;is&nbsp;spanned.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4006"></a><div class='linenum'>4006</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;sb1&nbsp;)&nbsp;&lt;&nbsp;Length(&nbsp;ns[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4007"></a><div class='linenum'>4007</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"representation&nbsp;is&nbsp;reducible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4008"></a><div class='linenum'>4008</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4009"></a><div class='linenum'>4009</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4010"></a><div class='linenum'>4010</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Make&nbsp;the&nbsp;contragredient&nbsp;representation&nbsp;'T'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4011"></a><div class='linenum'>4011</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T:=&nbsp;Algebra(&nbsp;A.field,&nbsp;List(&nbsp;D,&nbsp;x&nbsp;->&nbsp;TransposedMat(&nbsp;x^-1&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4012"></a><div class='linenum'>4012</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4013"></a><div class='linenum'>4013</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Write&nbsp;the&nbsp;'T'&nbsp;nullspace&nbsp;of&nbsp;the&nbsp;nullity&nbsp;1&nbsp;word&nbsp;to&nbsp;'ns'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4014"></a><div class='linenum'>4014</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ns:=&nbsp;NullspaceMat(&nbsp;ElementAlgebra(&nbsp;T,&nbsp;nr&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4015"></a><div class='linenum'>4015</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4016"></a><div class='linenum'>4016</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;standard&nbsp;basis&nbsp;for&nbsp;the&nbsp;natural&nbsp;module&nbsp;of&nbsp;'T',
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4017"></a><div class='linenum'>4017</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;starting&nbsp;with&nbsp;the&nbsp;word&nbsp;of&nbsp;nullity&nbsp;1,&nbsp;write&nbsp;output&nbsp;to&nbsp;'sb2'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4018"></a><div class='linenum'>4018</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb2:=&nbsp;BasisVectors(&nbsp;StandardBasis(&nbsp;Module(&nbsp;T,&nbsp;ns&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4019"></a><div class='linenum'>4019</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4020"></a><div class='linenum'>4020</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;'D'&nbsp;and&nbsp;'T'&nbsp;are&nbsp;equivalent&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4021"></a><div class='linenum'>4021</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;invariant&nbsp;matrix&nbsp;is&nbsp;'M&nbsp;=&nbsp;sb1^(-1)&nbsp;*&nbsp;sb2',
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4022"></a><div class='linenum'>4022</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;since&nbsp;'sb1&nbsp;*&nbsp;D[i]&nbsp;*&nbsp;sb1^(-1)&nbsp;=&nbsp;sb2&nbsp;*&nbsp;T[i]&nbsp;*&nbsp;sb2^(-1)'&nbsp;implies
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4023"></a><div class='linenum'>4023</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;that&nbsp;'D[i]&nbsp;*&nbsp;M&nbsp;*&nbsp;D[i]^{tr}&nbsp;=&nbsp;M'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4024"></a><div class='linenum'>4024</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M:=&nbsp;sb1^-1&nbsp;*&nbsp;sb2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4025"></a><div class='linenum'>4025</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4026"></a><div class='linenum'>4026</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;for&nbsp;equality.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4027"></a><div class='linenum'>4027</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;D&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4028"></a><div class='linenum'>4028</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;D[i]&nbsp;*&nbsp;M&nbsp;*&nbsp;TransposedMat(&nbsp;D[i]&nbsp;)&nbsp;&lt;>&nbsp;M&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4029"></a><div class='linenum'>4029</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4030"></a><div class='linenum'>4030</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4031"></a><div class='linenum'>4031</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4032"></a><div class='linenum'>4032</div></td><td></td><td></td><td></td><td><span><tt>#T
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4033"></a><div class='linenum'>4033</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;result.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4034"></a><div class='linenum'>4034</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;M;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4035"></a><div class='linenum'>4035</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4036"></a><div class='linenum'>4036</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4037"></a><div class='linenum'>4037</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4038"></a><div class='linenum'>4038</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4039"></a><div class='linenum'>4039</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4040"></a><div class='linenum'>4040</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;BaseOrthogonalSpaceMat(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4041"></a><div class='linenum'>4041</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4042"></a><div class='linenum'>4042</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;BaseOrthogonalSpaceMat,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4043"></a><div class='linenum'>4043</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4044"></a><div class='linenum'>4044</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4045"></a><div class='linenum'>4045</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mat&nbsp;->&nbsp;NullspaceMat(&nbsp;TransposedMat(&nbsp;mat&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4046"></a><div class='linenum'>4046</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4047"></a><div class='linenum'>4047</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;simplex&nbsp;method,&nbsp;code&nbsp;by&nbsp;Ken&nbsp;Monks,&nbsp;AH
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4048"></a><div class='linenum'>4048</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4049"></a><div class='linenum'>4049</div></td><td></td><td></td><td></td><td><span><tt>#in&nbsp;matrix&nbsp;M,&nbsp;row&nbsp;reduce&nbsp;to&nbsp;get&nbsp;1s
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4050"></a><div class='linenum'>4050</div></td><td></td><td></td><td></td><td><span><tt>#in&nbsp;exactly&nbsp;the&nbsp;columns&nbsp;given&nbsp;by&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4051"></a><div class='linenum'>4051</div></td><td></td><td></td><td></td><td><span><tt>#L&nbsp;a&nbsp;list&nbsp;of&nbsp;indices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4052"></a><div class='linenum'>4052</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("TriangulizeMatPivotColumns",function(M,L)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4053"></a><div class='linenum'>4053</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;idx,i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4054"></a><div class='linenum'>4054</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4055"></a><div class='linenum'>4055</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;if&nbsp;L=[1..Length(L)]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4056"></a><div class='linenum'>4056</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TriangulizeMat(M);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4057"></a><div class='linenum'>4057</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4058"></a><div class='linenum'>4058</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx:=Concatenation(L,Filtered([1..Length(M[1])],x->not&nbsp;x&nbsp;in&nbsp;L));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4059"></a><div class='linenum'>4059</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(M)]&nbsp;do&nbsp;M[i]:=M[i]{idx};&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4060"></a><div class='linenum'>4060</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TriangulizeMat(M);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4061"></a><div class='linenum'>4061</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx:=ListPerm(PermList(idx)^-1,Length(M[1]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4062"></a><div class='linenum'>4062</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(M)]&nbsp;do&nbsp;M[i]:=M[i]{idx};&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4063"></a><div class='linenum'>4063</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4064"></a><div class='linenum'>4064</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4065"></a><div class='linenum'>4065</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4066"></a><div class='linenum'>4066</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4067"></a><div class='linenum'>4067</div></td><td></td><td></td><td></td><td><span><tt>#inputs&nbsp;a&nbsp;linear&nbsp;form&nbsp;c&nbsp;and&nbsp;maximizes&nbsp;it&nbsp;subject&nbsp;to&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4068"></a><div class='linenum'>4068</div></td><td></td><td></td><td></td><td><span><tt>#the&nbsp;constraints&nbsp;Ax&nbsp;&lt;=&nbsp;b&nbsp;where&nbsp;all&nbsp;entries&nbsp;of&nbsp;b&nbsp;are&nbsp;nonnegative.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4069"></a><div class='linenum'>4069</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(SimplexMethod,function(A,b,c)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4070"></a><div class='linenum'>4070</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;M,&nbsp;n,&nbsp;p,&nbsp;vars,&nbsp;slackVars,&nbsp;i,&nbsp;id,&nbsp;bestMove,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4071"></a><div class='linenum'>4071</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;newNonzero,&nbsp;len,&nbsp;ratios,&nbsp;newZero,&nbsp;positiveRatios,&nbsp;point,&nbsp;value,Val;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4072"></a><div class='linenum'>4072</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4073"></a><div class='linenum'>4073</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;Val:=function(M,vars,slackVars,len,x)&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4074"></a><div class='linenum'>4074</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;vars&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4075"></a><div class='linenum'>4075</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4076"></a><div class='linenum'>4076</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;return&nbsp;M[Position(slackVars,x)+1][len];&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4077"></a><div class='linenum'>4077</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4078"></a><div class='linenum'>4078</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4079"></a><div class='linenum'>4079</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4080"></a><div class='linenum'>4080</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#check&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;data&nbsp;is&nbsp;legit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4081"></a><div class='linenum'>4081</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4082"></a><div class='linenum'>4082</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;n:=Size(c);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4083"></a><div class='linenum'>4083</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;p:=Size(b);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4084"></a><div class='linenum'>4084</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(IsMatrix(A)&nbsp;and&nbsp;Size(A)=p&nbsp;and&nbsp;ForAny(A,R->Size(R)=n))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4085"></a><div class='linenum'>4085</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"usage:&nbsp;SimplexMethod(&nbsp;&lt;A>,&nbsp;&lt;b>,&nbsp;&lt;c>)");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4086"></a><div class='linenum'>4086</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4087"></a><div class='linenum'>4087</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4088"></a><div class='linenum'>4088</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;id:=IdentityMat(p,Rationals);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4089"></a><div class='linenum'>4089</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4090"></a><div class='linenum'>4090</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#build&nbsp;the&nbsp;augmented&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4091"></a><div class='linenum'>4091</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4092"></a><div class='linenum'>4092</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#first&nbsp;row&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4093"></a><div class='linenum'>4093</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;M:=[Concatenation([1],-c,List([1..p+1],x->0))];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4094"></a><div class='linenum'>4094</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#the&nbsp;rest&nbsp;of&nbsp;the&nbsp;rows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4095"></a><div class='linenum'>4095</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..p]&nbsp;do&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4096"></a><div class='linenum'>4096</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(M,Concatenation([0],A[i],id[i],[b[i]]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4097"></a><div class='linenum'>4097</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4098"></a><div class='linenum'>4098</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4099"></a><div class='linenum'>4099</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;len:=Size(M[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4100"></a><div class='linenum'>4100</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4101"></a><div class='linenum'>4101</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#initialize&nbsp;the&nbsp;feasible&nbsp;starting&nbsp;vertex
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4102"></a><div class='linenum'>4102</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(b,x->not&nbsp;x&lt;0)&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4103"></a><div class='linenum'>4103</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vars:=[2..2+n-1];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4104"></a><div class='linenum'>4104</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slackVars:=[2+n..n+p+1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4105"></a><div class='linenum'>4105</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4106"></a><div class='linenum'>4106</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"Invalid&nbsp;data:&nbsp;not&nbsp;all&nbsp;constraints&nbsp;nonnegative!";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4107"></a><div class='linenum'>4107</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4108"></a><div class='linenum'>4108</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4109"></a><div class='linenum'>4109</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#Print("slackVars&nbsp;are&nbsp;",slackVars&nbsp;,"\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4110"></a><div class='linenum'>4110</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#Print("vars&nbsp;are&nbsp;",vars,"\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4111"></a><div class='linenum'>4111</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#Display(M);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4112"></a><div class='linenum'>4112</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4113"></a><div class='linenum'>4113</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;TriangulizeMatPivotColumns(M,Concatenation([1],slackVars));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4114"></a><div class='linenum'>4114</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#Display(M);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4115"></a><div class='linenum'>4115</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#bestMove&nbsp;is&nbsp;the&nbsp;coeff&nbsp;var&nbsp;that&nbsp;will&nbsp;become&nbsp;nonzero
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4116"></a><div class='linenum'>4116</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;bestMove:=Minimum(List(vars,i->M[1][i]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4117"></a><div class='linenum'>4117</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;newNonzero:=vars[Position(List(vars,i->M[1][i]),bestMove)];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4118"></a><div class='linenum'>4118</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4119"></a><div class='linenum'>4119</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#Print(newNonzero,&nbsp;"&nbsp;is&nbsp;the&nbsp;new&nbsp;nonzero&nbsp;guy&nbsp;\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4120"></a><div class='linenum'>4120</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4121"></a><div class='linenum'>4121</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;while&nbsp;bestMove&lt;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4122"></a><div class='linenum'>4122</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4123"></a><div class='linenum'>4123</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#see&nbsp;if&nbsp;figure&nbsp;is&nbsp;unbounded
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4124"></a><div class='linenum'>4124</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print("about&nbsp;to&nbsp;do&nbsp;some&nbsp;ratios&nbsp;\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4125"></a><div class='linenum'>4125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print(List([1..p],x->&nbsp;M[x+1][newNonzero]),&nbsp;"&nbsp;is&nbsp;what&nbsp;we're&nbsp;going&nbsp;to&nbsp;divide&nbsp;by&nbsp;\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4126"></a><div class='linenum'>4126</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ratios:=List([1..p],&nbsp;function(x)&nbsp;if&nbsp;M[x+1][newNonzero]=0&nbsp;then&nbsp;return&nbsp;infinity;&nbsp;else&nbsp;return&nbsp;M[x+1][len]/M[x+1][newNonzero];&nbsp;fi;&nbsp;end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4127"></a><div class='linenum'>4127</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print("done&nbsp;doing&nbsp;some&nbsp;ratios");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4128"></a><div class='linenum'>4128</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;positiveRatios:=Filtered(ratios,x&nbsp;->&nbsp;x>0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4129"></a><div class='linenum'>4129</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Size(positiveRatios)=0&nbsp;then&nbsp;return&nbsp;"Feasible&nbsp;region&nbsp;unbounded!";&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4130"></a><div class='linenum'>4130</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4131"></a><div class='linenum'>4131</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print("Feasible&nbsp;region&nbsp;still&nbsp;looks&nbsp;bounded.&nbsp;\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4132"></a><div class='linenum'>4132</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4133"></a><div class='linenum'>4133</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#figure&nbsp;out&nbsp;who&nbsp;will&nbsp;become&nbsp;zero
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4134"></a><div class='linenum'>4134</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newZero:=slackVars[Position(ratios,Minimum(positiveRatios))];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4135"></a><div class='linenum'>4135</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4136"></a><div class='linenum'>4136</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print(newZero,&nbsp;"&nbsp;is&nbsp;the&nbsp;new&nbsp;zero&nbsp;guy&nbsp;\n");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4137"></a><div class='linenum'>4137</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4138"></a><div class='linenum'>4138</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove(slackVars,Position(slackVars,newZero));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4139"></a><div class='linenum'>4139</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove(vars,Position(vars,newNonzero));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4140"></a><div class='linenum'>4140</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(vars,newZero);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4141"></a><div class='linenum'>4141</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(slackVars,newNonzero);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4142"></a><div class='linenum'>4142</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4143"></a><div class='linenum'>4143</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slackVars:=Set(slackVars);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4144"></a><div class='linenum'>4144</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vars:=Set(vars);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4145"></a><div class='linenum'>4145</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4146"></a><div class='linenum'>4146</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print("slackVars&nbsp;are&nbsp;",slackVars,"\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4147"></a><div class='linenum'>4147</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print("vars&nbsp;are&nbsp;",vars,"\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4148"></a><div class='linenum'>4148</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4149"></a><div class='linenum'>4149</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TriangulizeMatPivotColumns(M,Concatenation([1],slackVars));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4150"></a><div class='linenum'>4150</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Display(M);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4151"></a><div class='linenum'>4151</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bestMove:=Minimum(List(vars,i->M[1][i]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4152"></a><div class='linenum'>4152</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4153"></a><div class='linenum'>4153</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newNonzero:=vars[Position(List(vars,i->M[1][i]),bestMove)];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4154"></a><div class='linenum'>4154</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print(newNonzero,"&nbsp;is&nbsp;the&nbsp;new&nbsp;nonzero&nbsp;guy");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4155"></a><div class='linenum'>4155</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4156"></a><div class='linenum'>4156</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4157"></a><div class='linenum'>4157</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4158"></a><div class='linenum'>4158</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;#calculate&nbsp;the&nbsp;original&nbsp;point&nbsp;and&nbsp;the&nbsp;max&nbsp;value&nbsp;there
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4159"></a><div class='linenum'>4159</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4160"></a><div class='linenum'>4160</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;point:=List([2..2+n-1],x&nbsp;->&nbsp;Val(M,vars,slackVars,len,x));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4161"></a><div class='linenum'>4161</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;value:=point*c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4162"></a><div class='linenum'>4162</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4163"></a><div class='linenum'>4163</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;return&nbsp;[point,value];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4164"></a><div class='linenum'>4164</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4165"></a><div class='linenum'>4165</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4166"></a><div class='linenum'>4166</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4167"></a><div class='linenum'>4167</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;can&nbsp;do&nbsp;better&nbsp;for&nbsp;matrices&nbsp;and&nbsp;large&nbsp;exponents,&nbsp;preliminary&nbsp;improvement,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4168"></a><div class='linenum'>4168</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;will&nbsp;be&nbsp;further&nbsp;improved&nbsp;(FL)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4169"></a><div class='linenum'>4169</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;InstallMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4170"></a><div class='linenum'>4170</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;matrices,&nbsp;use&nbsp;char.&nbsp;poly.&nbsp;for&nbsp;large&nbsp;exponents",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4171"></a><div class='linenum'>4171</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4172"></a><div class='linenum'>4172</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;function(mat,&nbsp;n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4173"></a><div class='linenum'>4173</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;pol,&nbsp;indet;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4174"></a><div class='linenum'>4174</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;generic&nbsp;method&nbsp;for&nbsp;small&nbsp;n,&nbsp;break&nbsp;even&nbsp;point&nbsp;probably&nbsp;a&nbsp;bit&nbsp;lower,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4175"></a><div class='linenum'>4175</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;needs&nbsp;rethinking&nbsp;and&nbsp;some&nbsp;experiments.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4176"></a><div class='linenum'>4176</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;2^Length(mat)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4177"></a><div class='linenum'>4177</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;POW_OBJ_INT(mat,&nbsp;n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4178"></a><div class='linenum'>4178</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4179"></a><div class='linenum'>4179</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;pol&nbsp;:=&nbsp;CharacteristicPolynomial(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4180"></a><div class='linenum'>4180</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;indet&nbsp;:=&nbsp;IndeterminateOfUnivariateRationalFunction(pol);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4181"></a><div class='linenum'>4181</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;cost&nbsp;of&nbsp;this&nbsp;needs&nbsp;to&nbsp;be&nbsp;investigated
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4182"></a><div class='linenum'>4182</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;pol&nbsp;:=&nbsp;PowerMod(indet,&nbsp;n,&nbsp;pol);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4183"></a><div class='linenum'>4183</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now&nbsp;we&nbsp;are&nbsp;sure&nbsp;that&nbsp;we&nbsp;need&nbsp;at&nbsp;most&nbsp;Length(mat)&nbsp;matrix&nbsp;multiplications
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4184"></a><div class='linenum'>4184</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Value(pol,&nbsp;mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4185"></a><div class='linenum'>4185</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4186"></a><div class='linenum'>4186</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4187"></a><div class='linenum'>4187</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;next&nbsp;iteration,&nbsp;conjugate&nbsp;matrix&nbsp;such&nbsp;that&nbsp;it&nbsp;is&nbsp;often&nbsp;very&nbsp;sparse&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4188"></a><div class='linenum'>4188</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;(a&nbsp;companion&nbsp;matrix),&nbsp;could&nbsp;still&nbsp;be&nbsp;improved,&nbsp;maybe&nbsp;with&nbsp;kernel&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4189"></a><div class='linenum'>4189</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;for&nbsp;compact&nbsp;matrices&nbsp;(FL)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4190"></a><div class='linenum'>4190</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("POW_MAT_INT",&nbsp;function(mat,&nbsp;n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4191"></a><div class='linenum'>4191</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;d,&nbsp;addb,&nbsp;trafo,&nbsp;value,&nbsp;t,&nbsp;ti,&nbsp;mm,&nbsp;pol,&nbsp;ind;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4192"></a><div class='linenum'>4192</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;d&nbsp;:=&nbsp;Length(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4193"></a><div class='linenum'>4193</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;finding&nbsp;a&nbsp;better&nbsp;break&nbsp;even&nbsp;point&nbsp;probably&nbsp;also&nbsp;depends&nbsp;on&nbsp;q
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4194"></a><div class='linenum'>4194</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;2^QuoInt(3*d,4)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4195"></a><div class='linenum'>4195</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;POW_OBJ_INT(mat,&nbsp;n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4196"></a><div class='linenum'>4196</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4197"></a><div class='linenum'>4197</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;helper&nbsp;function&nbsp;to&nbsp;build&nbsp;up&nbsp;a&nbsp;semi-echelon&nbsp;basis
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4198"></a><div class='linenum'>4198</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;addb&nbsp;:=&nbsp;function(seb,&nbsp;v)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4199"></a><div class='linenum'>4199</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;rows,&nbsp;pivots,&nbsp;len,&nbsp;vv,&nbsp;c,&nbsp;pos,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4200"></a><div class='linenum'>4200</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;:=&nbsp;seb.vectors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4201"></a><div class='linenum'>4201</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pivots&nbsp;:=&nbsp;seb.pivots;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4202"></a><div class='linenum'>4202</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;:=&nbsp;Length(rows);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4203"></a><div class='linenum'>4203</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;vv&nbsp;:=&nbsp;ShallowCopy(v);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4204"></a><div class='linenum'>4204</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..len]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4205"></a><div class='linenum'>4205</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;vv[pivots[i]];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4206"></a><div class='linenum'>4206</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsZero(c)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4207"></a><div class='linenum'>4207</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddRowVector(vv,&nbsp;rows[i],&nbsp;-c);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4208"></a><div class='linenum'>4208</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4209"></a><div class='linenum'>4209</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4210"></a><div class='linenum'>4210</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;:=&nbsp;PositionNonZero(vv);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4211"></a><div class='linenum'>4211</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pos&nbsp;&lt;=&nbsp;Length(vv)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4212"></a><div class='linenum'>4212</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsOne(vv[pos])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4213"></a><div class='linenum'>4213</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vv&nbsp;:=&nbsp;vv/vv[pos];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4214"></a><div class='linenum'>4214</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4215"></a><div class='linenum'>4215</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(rows,&nbsp;vv);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4216"></a><div class='linenum'>4216</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(pivots,&nbsp;pos);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4217"></a><div class='linenum'>4217</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seb.heads[pos]&nbsp;:=&nbsp;len&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4218"></a><div class='linenum'>4218</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4219"></a><div class='linenum'>4219</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4220"></a><div class='linenum'>4220</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4221"></a><div class='linenum'>4221</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4222"></a><div class='linenum'>4222</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4223"></a><div class='linenum'>4223</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;this&nbsp;returns&nbsp;a&nbsp;base&nbsp;change&nbsp;matrix&nbsp;such&nbsp;that&nbsp;t*m*t^-1&nbsp;is&nbsp;block&nbsp;triangular
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4224"></a><div class='linenum'>4224</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;with&nbsp;companion&nbsp;matrices&nbsp;along&nbsp;the&nbsp;diagonal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4225"></a><div class='linenum'>4225</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;(could/should?&nbsp;be&nbsp;improved&nbsp;to&nbsp;return&nbsp;t^-1,&nbsp;t*m*t^-1&nbsp;and&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4226"></a><div class='linenum'>4226</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;characteristic&nbsp;polynomial&nbsp;of&nbsp;m&nbsp;at&nbsp;the&nbsp;same&nbsp;time)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4227"></a><div class='linenum'>4227</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;trafo&nbsp;:=&nbsp;function(m)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4228"></a><div class='linenum'>4228</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;id,&nbsp;b,&nbsp;t,&nbsp;r,&nbsp;a;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4229"></a><div class='linenum'>4229</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;:=&nbsp;m^0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4230"></a><div class='linenum'>4230</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;:=&nbsp;rec(vectors&nbsp;:=&nbsp;[],&nbsp;pivots&nbsp;:=&nbsp;[],&nbsp;heads&nbsp;:=&nbsp;[]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4231"></a><div class='linenum'>4231</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4232"></a><div class='linenum'>4232</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;maybe&nbsp;better&nbsp;start&nbsp;with&nbsp;a&nbsp;random&nbsp;vector?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4233"></a><div class='linenum'>4233</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;a&nbsp;in&nbsp;id&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4234"></a><div class='linenum'>4234</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;addb(b,a);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4235"></a><div class='linenum'>4235</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;r&nbsp;=&nbsp;true&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4236"></a><div class='linenum'>4236</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4237"></a><div class='linenum'>4237</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(t,&nbsp;a);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4238"></a><div class='linenum'>4238</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;:=&nbsp;a*m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4239"></a><div class='linenum'>4239</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;addb(b,a);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4240"></a><div class='linenum'>4240</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;r&nbsp;&lt;>&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4241"></a><div class='linenum'>4241</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4242"></a><div class='linenum'>4242</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4243"></a><div class='linenum'>4243</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;Matrix(t,&nbsp;m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4244"></a><div class='linenum'>4244</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;t;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4245"></a><div class='linenum'>4245</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4246"></a><div class='linenum'>4246</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;compared&nbsp;to&nbsp;standard&nbsp;method,&nbsp;we&nbsp;avoid&nbsp;some&nbsp;zero&nbsp;or&nbsp;identity&nbsp;matrices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4247"></a><div class='linenum'>4247</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;and&nbsp;we&nbsp;multiply&nbsp;with&nbsp;mat&nbsp;from&nbsp;left&nbsp;to&nbsp;take&nbsp;advantage&nbsp;of&nbsp;sparseness&nbsp;of&nbsp;mat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4248"></a><div class='linenum'>4248</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;value&nbsp;:=&nbsp;function(pol,&nbsp;mat)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4249"></a><div class='linenum'>4249</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;f,&nbsp;c,&nbsp;i,&nbsp;val,&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4250"></a><div class='linenum'>4250</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;CoefficientsOfLaurentPolynomial(pol);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4251"></a><div class='linenum'>4251</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;f[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4252"></a><div class='linenum'>4252</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;Length(c);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4253"></a><div class='linenum'>4253</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4254"></a><div class='linenum'>4254</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0*mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4255"></a><div class='linenum'>4255</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4256"></a><div class='linenum'>4256</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4257"></a><div class='linenum'>4257</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;POW_OBJ_INT(mat,&nbsp;f[2]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4258"></a><div class='linenum'>4258</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;c[1]&nbsp;*&nbsp;val;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4259"></a><div class='linenum'>4259</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4260"></a><div class='linenum'>4260</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;c[i]&nbsp;*&nbsp;mat;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4261"></a><div class='linenum'>4261</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsMutable(val[1])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4262"></a><div class='linenum'>4262</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;MutableCopyMat(val);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4263"></a><div class='linenum'>4263</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4264"></a><div class='linenum'>4264</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4265"></a><div class='linenum'>4265</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..Length(mat)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4266"></a><div class='linenum'>4266</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val[j][j]&nbsp;:=&nbsp;val[j][j]+c[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4267"></a><div class='linenum'>4267</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4268"></a><div class='linenum'>4268</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;1&nbsp;&lt;&nbsp;i&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4269"></a><div class='linenum'>4269</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;mat&nbsp;*&nbsp;val;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4270"></a><div class='linenum'>4270</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;-&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4271"></a><div class='linenum'>4271</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..Length(mat)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4272"></a><div class='linenum'>4272</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val[j][j]&nbsp;:=&nbsp;val[j][j]+c[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4273"></a><div class='linenum'>4273</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4274"></a><div class='linenum'>4274</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4275"></a><div class='linenum'>4275</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;>&nbsp;f[2]&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4276"></a><div class='linenum'>4276</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;val&nbsp;*&nbsp;POW_OBJ_INT(mat,&nbsp;f[2]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4277"></a><div class='linenum'>4277</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4278"></a><div class='linenum'>4278</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;val;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4279"></a><div class='linenum'>4279</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4280"></a><div class='linenum'>4280</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;t&nbsp;:=&nbsp;trafo(mat);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4281"></a><div class='linenum'>4281</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ti&nbsp;:=&nbsp;t^-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4282"></a><div class='linenum'>4282</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;mm&nbsp;:=&nbsp;t&nbsp;*&nbsp;mat&nbsp;*&nbsp;ti;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4283"></a><div class='linenum'>4283</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;pol&nbsp;:=&nbsp;CharacteristicPolynomial(mm);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4284"></a><div class='linenum'>4284</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ind&nbsp;:=&nbsp;IndeterminateOfUnivariateRationalFunction(pol);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4285"></a><div class='linenum'>4285</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;pol&nbsp;:=&nbsp;PowerMod(ind,&nbsp;n,&nbsp;pol);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4286"></a><div class='linenum'>4286</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;mm&nbsp;:=&nbsp;value(pol,&nbsp;mm);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4287"></a><div class='linenum'>4287</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;ti&nbsp;*&nbsp;mm&nbsp;*&nbsp;t;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4288"></a><div class='linenum'>4288</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4289"></a><div class='linenum'>4289</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4290"></a><div class='linenum'>4290</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4291"></a><div class='linenum'>4291</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;matrices,&nbsp;use&nbsp;char.&nbsp;poly.&nbsp;for&nbsp;large&nbsp;exponents",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4292"></a><div class='linenum'>4292</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix,&nbsp;IsPosInt&nbsp;],&nbsp;POW_MAT_INT&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4293"></a><div class='linenum'>4293</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4294"></a><div class='linenum'>4294</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4295"></a><div class='linenum'>4295</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4296"></a><div class='linenum'>4296</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4297"></a><div class='linenum'>4297</div></td><td></td><td></td><td></td><td><span><tt>#E
</tt></span></td><td><span></span></td></tr>
</tbody>
</table></body></html>
