<!DOCTYPE html><script src="sorttable.js"></script><html><body>
<style>
table { border-collapse: collapse }
tr .linenum { text-align: right; }
tr:nth-child(odd)  { background-color: #EEE; }
tr:nth-child(even)  { background-color: #FFF; }
tr:nth-child(odd).exec  { background-color: #0F0; }
tr:nth-child(even).exec  { background-color: #3F3; }
tr:nth-child(odd).missed  { background-color: #F00; }
tr:nth-child(even).missed  { background-color: #F33; }
td, th {
    border: 1px solid #98bf21;
    padding: 3px 7px 2px 7px;
}
th {
    font-size: 1.1em;
    text-align: left;
    padding-top: 5px;
    padding-bottom: 4px;
    background-color: #A7C942;
    color: #ffffff;
}
table.sortable th:not(.sorttable_sorted):not(.sorttable_sorted_reverse):not(.sorttable_nosort):after {
    content: " \25B4\25BE"
}

/* HSV gradient made using http://www.perbang.dk/rgbgradient/ */
td.coverage00 { background-color: #FF0000; }
td.coverage10 { background-color: #F83100; }
td.coverage20 { background-color: #F25F00; }
td.coverage30 { background-color: #EB8B00; }
td.coverage40 { background-color: #E5B500; }
td.coverage50 { background-color: #DFDC00; }
td.coverage60 { background-color: #B0D800; }
td.coverage70 { background-color: #81D200; }
td.coverage80 { background-color: #55CB00; }
td.coverage90 { background-color: #2CC500; }
td.coverage100 { background-color: #04BF00; }
</style><p>This file was read by GAP before profiling was actived, so lines which were not read but not executed are not marked.</p><table class="sortable">
<thead><tr><th>Line</th><th>Execs</th><th>Time</th><th>Time+Childs</th><th>Code</th><th>Called Functions</th>
</tr></thead>
<tbody>
<tr class='ignore'><td><a name="line1"></a><div class='linenum'>1</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2"></a><div class='linenum'>2</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3"></a><div class='linenum'>3</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;integer.gi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAP&nbsp;library&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thomas&nbsp;Breuer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4"></a><div class='linenum'>4</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Frank&nbsp;Celler
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5"></a><div class='linenum'>5</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Stefan&nbsp;Kohl
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line6"></a><div class='linenum'>6</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Werner&nbsp;Nickel
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line7"></a><div class='linenum'>7</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Alice&nbsp;Niemeyer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line8"></a><div class='linenum'>8</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Martin&nbsp;Schönert
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line9"></a><div class='linenum'>9</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;Alex&nbsp;Wegner
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line10"></a><div class='linenum'>10</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line11"></a><div class='linenum'>11</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line12"></a><div class='linenum'>12</div></td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;&nbsp;1997,&nbsp;&nbsp;Lehrstuhl&nbsp;D&nbsp;für&nbsp;Mathematik,&nbsp;&nbsp;RWTH&nbsp;Aachen,&nbsp;&nbsp;Germany
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line13"></a><div class='linenum'>13</div></td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;(C)&nbsp;1998&nbsp;School&nbsp;Math&nbsp;and&nbsp;Comp.&nbsp;Sci.,&nbsp;University&nbsp;of&nbsp;St&nbsp;Andrews,&nbsp;Scotland
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line14"></a><div class='linenum'>14</div></td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;2002&nbsp;The&nbsp;GAP&nbsp;Group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line15"></a><div class='linenum'>15</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line16"></a><div class='linenum'>16</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line17"></a><div class='linenum'>17</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line18"></a><div class='linenum'>18</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line19"></a><div class='linenum'>19</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line20"></a><div class='linenum'>20</div></td><td></td><td></td><td></td><td><span><tt>#V&nbsp;&nbsp;Integers&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;ring&nbsp;of&nbsp;the&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line21"></a><div class='linenum'>21</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line22"></a><div class='linenum'>22</div></td><td></td><td></td><td></td><td><span><tt>InstallValue(&nbsp;Integers,&nbsp;Objectify(&nbsp;NewType(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line23"></a><div class='linenum'>23</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;CollectionsFamily(&nbsp;CyclotomicsFamily&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line24"></a><div class='linenum'>24</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIntegers&nbsp;and&nbsp;IsAttributeStoringRep&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line25"></a><div class='linenum'>25</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rec()&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line26"></a><div class='linenum'>26</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line27"></a><div class='linenum'>27</div></td><td></td><td></td><td></td><td><span><tt>SetName(&nbsp;Integers,&nbsp;"Integers"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line28"></a><div class='linenum'>28</div></td><td></td><td></td><td></td><td><span><tt>SetString(&nbsp;Integers,&nbsp;"Integers"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line29"></a><div class='linenum'>29</div></td><td></td><td></td><td></td><td><span><tt>SetIsLeftActedOnByDivisionRing(&nbsp;Integers,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line30"></a><div class='linenum'>30</div></td><td></td><td></td><td></td><td><span><tt>SetSize(&nbsp;Integers,&nbsp;infinity&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line31"></a><div class='linenum'>31</div></td><td></td><td></td><td></td><td><span><tt>SetLeftActingDomain(&nbsp;Integers,&nbsp;Integers&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line32"></a><div class='linenum'>32</div></td><td></td><td></td><td></td><td><span><tt>SetGeneratorsOfRing(&nbsp;Integers,&nbsp;[&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line33"></a><div class='linenum'>33</div></td><td></td><td></td><td></td><td><span><tt>SetGeneratorsOfLeftModule(&nbsp;Integers,&nbsp;[&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line34"></a><div class='linenum'>34</div></td><td></td><td></td><td></td><td><span><tt>SetIsFiniteDimensional(&nbsp;Integers,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line35"></a><div class='linenum'>35</div></td><td></td><td></td><td></td><td><span><tt>SetUnits(&nbsp;Integers,&nbsp;[&nbsp;-1,&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line36"></a><div class='linenum'>36</div></td><td></td><td></td><td></td><td><span><tt>SetIsWholeFamily(&nbsp;Integers,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line37"></a><div class='linenum'>37</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line38"></a><div class='linenum'>38</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line39"></a><div class='linenum'>39</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line40"></a><div class='linenum'>40</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line41"></a><div class='linenum'>41</div></td><td></td><td></td><td></td><td><span><tt>#V&nbsp;&nbsp;NonnegativeIntegers&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;semiring&nbsp;of&nbsp;nonnegative&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line42"></a><div class='linenum'>42</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line43"></a><div class='linenum'>43</div></td><td></td><td></td><td></td><td><span><tt>InstallValue(&nbsp;NonnegativeIntegers,&nbsp;Objectify(&nbsp;NewType(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line44"></a><div class='linenum'>44</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;CollectionsFamily(&nbsp;CyclotomicsFamily&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line45"></a><div class='linenum'>45</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsNonnegativeIntegers&nbsp;and&nbsp;IsAttributeStoringRep&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line46"></a><div class='linenum'>46</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rec()&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line47"></a><div class='linenum'>47</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line48"></a><div class='linenum'>48</div></td><td></td><td></td><td></td><td><span><tt>SetName(&nbsp;NonnegativeIntegers,&nbsp;"NonnegativeIntegers"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line49"></a><div class='linenum'>49</div></td><td></td><td></td><td></td><td><span><tt>SetString(&nbsp;NonnegativeIntegers,&nbsp;"NonnegativeIntegers"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line50"></a><div class='linenum'>50</div></td><td></td><td></td><td></td><td><span><tt>SetSize(&nbsp;NonnegativeIntegers,&nbsp;infinity&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line51"></a><div class='linenum'>51</div></td><td></td><td></td><td></td><td><span><tt>SetGeneratorsOfSemiringWithZero(&nbsp;NonnegativeIntegers,&nbsp;[&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line52"></a><div class='linenum'>52</div></td><td></td><td></td><td></td><td><span><tt>SetGeneratorsOfAdditiveMagmaWithZero(&nbsp;NonnegativeIntegers,&nbsp;[&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line53"></a><div class='linenum'>53</div></td><td></td><td></td><td></td><td><span><tt>SetIsWholeFamily(&nbsp;NonnegativeIntegers,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line54"></a><div class='linenum'>54</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line55"></a><div class='linenum'>55</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line56"></a><div class='linenum'>56</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line57"></a><div class='linenum'>57</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line58"></a><div class='linenum'>58</div></td><td></td><td></td><td></td><td><span><tt>#V&nbsp;&nbsp;PositiveIntegers&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;semiring&nbsp;of&nbsp;positive&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line59"></a><div class='linenum'>59</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line60"></a><div class='linenum'>60</div></td><td></td><td></td><td></td><td><span><tt>InstallValue(&nbsp;PositiveIntegers,&nbsp;Objectify(&nbsp;NewType(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line61"></a><div class='linenum'>61</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;CollectionsFamily(&nbsp;CyclotomicsFamily&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line62"></a><div class='linenum'>62</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsPositiveIntegers&nbsp;and&nbsp;IsAttributeStoringRep&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line63"></a><div class='linenum'>63</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rec()&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line64"></a><div class='linenum'>64</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line65"></a><div class='linenum'>65</div></td><td></td><td></td><td></td><td><span><tt>SetName(&nbsp;PositiveIntegers,&nbsp;"PositiveIntegers"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line66"></a><div class='linenum'>66</div></td><td></td><td></td><td></td><td><span><tt>SetString(&nbsp;PositiveIntegers,&nbsp;"PositiveIntegers"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line67"></a><div class='linenum'>67</div></td><td></td><td></td><td></td><td><span><tt>SetSize(&nbsp;PositiveIntegers,&nbsp;infinity&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line68"></a><div class='linenum'>68</div></td><td></td><td></td><td></td><td><span><tt>SetGeneratorsOfSemiring(&nbsp;PositiveIntegers,&nbsp;[&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line69"></a><div class='linenum'>69</div></td><td></td><td></td><td></td><td><span><tt>SetGeneratorsOfAdditiveMagma(&nbsp;PositiveIntegers,&nbsp;[&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line70"></a><div class='linenum'>70</div></td><td></td><td></td><td></td><td><span><tt>SetIsWholeFamily(&nbsp;PositiveIntegers,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line71"></a><div class='linenum'>71</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line72"></a><div class='linenum'>72</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line73"></a><div class='linenum'>73</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line74"></a><div class='linenum'>74</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line75"></a><div class='linenum'>75</div></td><td></td><td></td><td></td><td><span><tt>#V&nbsp;&nbsp;GaussianIntegers&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;ring&nbsp;of&nbsp;Gaussian&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line76"></a><div class='linenum'>76</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line77"></a><div class='linenum'>77</div></td><td></td><td></td><td></td><td><span><tt>InstallValue(&nbsp;GaussianIntegers,&nbsp;Objectify(&nbsp;NewType(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line78"></a><div class='linenum'>78</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;CollectionsFamily(CyclotomicsFamily),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line79"></a><div class='linenum'>79</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsGaussianIntegers&nbsp;and&nbsp;IsAttributeStoringRep&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line80"></a><div class='linenum'>80</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rec()&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line81"></a><div class='linenum'>81</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line82"></a><div class='linenum'>82</div></td><td></td><td></td><td></td><td><span><tt>SetLeftActingDomain(&nbsp;GaussianIntegers,&nbsp;Integers&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line83"></a><div class='linenum'>83</div></td><td></td><td></td><td></td><td><span><tt>SetName(&nbsp;GaussianIntegers,&nbsp;"GaussianIntegers"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line84"></a><div class='linenum'>84</div></td><td></td><td></td><td></td><td><span><tt>SetString(&nbsp;GaussianIntegers,&nbsp;"GaussianIntegers"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line85"></a><div class='linenum'>85</div></td><td></td><td></td><td></td><td><span><tt>SetIsLeftActedOnByDivisionRing(&nbsp;GaussianIntegers,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line86"></a><div class='linenum'>86</div></td><td></td><td></td><td></td><td><span><tt>SetSize(&nbsp;GaussianIntegers,&nbsp;infinity&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line87"></a><div class='linenum'>87</div></td><td></td><td></td><td></td><td><span><tt>SetGeneratorsOfRing(&nbsp;GaussianIntegers,&nbsp;[&nbsp;E(4)&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line88"></a><div class='linenum'>88</div></td><td></td><td></td><td></td><td><span><tt>SetGeneratorsOfLeftModule(&nbsp;GaussianIntegers,&nbsp;[&nbsp;1,&nbsp;E(4)&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line89"></a><div class='linenum'>89</div></td><td></td><td></td><td></td><td><span><tt>SetUnits(&nbsp;GaussianIntegers,&nbsp;[&nbsp;-1,&nbsp;1,&nbsp;-E(4),&nbsp;E(4)&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line90"></a><div class='linenum'>90</div></td><td></td><td></td><td></td><td><span><tt>SetIsWholeFamily(&nbsp;GaussianIntegers,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line91"></a><div class='linenum'>91</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line92"></a><div class='linenum'>92</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line93"></a><div class='linenum'>93</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line94"></a><div class='linenum'>94</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line95"></a><div class='linenum'>95</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line96"></a><div class='linenum'>96</div></td><td></td><td></td><td></td><td><span><tt>#R&nbsp;&nbsp;IsCanonicalBasisIntegersRep
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line97"></a><div class='linenum'>97</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line98"></a><div class='linenum'>98</div></td><td></td><td></td><td></td><td><span><tt>DeclareRepresentation(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line99"></a><div class='linenum'>99</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"IsCanonicalBasisIntegersRep",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line100"></a><div class='linenum'>100</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsAttributeStoringRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line101"></a><div class='linenum'>101</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line102"></a><div class='linenum'>102</div></td><td></td><td></td><td></td><td><span><tt>#T&nbsp;is&nbsp;this&nbsp;needed&nbsp;at&nbsp;all?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line103"></a><div class='linenum'>103</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line104"></a><div class='linenum'>104</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line105"></a><div class='linenum'>105</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line106"></a><div class='linenum'>106</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line107"></a><div class='linenum'>107</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Basis(&nbsp;Integers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line108"></a><div class='linenum'>108</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line109"></a><div class='linenum'>109</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Basis,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line110"></a><div class='linenum'>110</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers&nbsp;(delegate&nbsp;to&nbsp;`CanonicalBasis')",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line111"></a><div class='linenum'>111</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers&nbsp;],&nbsp;CANONICAL_BASIS_FLAGS,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line112"></a><div class='linenum'>112</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;CanonicalBasis&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line113"></a><div class='linenum'>113</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line114"></a><div class='linenum'>114</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line115"></a><div class='linenum'>115</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line116"></a><div class='linenum'>116</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line117"></a><div class='linenum'>117</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CanonicalBasis(&nbsp;Integers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line118"></a><div class='linenum'>118</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line119"></a><div class='linenum'>119</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CanonicalBasis,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line120"></a><div class='linenum'>120</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line121"></a><div class='linenum'>121</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line122"></a><div class='linenum'>122</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line123"></a><div class='linenum'>123</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;Integers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line124"></a><div class='linenum'>124</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;B;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line125"></a><div class='linenum'>125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;B:=&nbsp;Objectify(&nbsp;NewType(&nbsp;FamilyObj(&nbsp;Integers&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line126"></a><div class='linenum'>126</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsFiniteBasisDefault
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line127"></a><div class='linenum'>127</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsCanonicalBasis
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line128"></a><div class='linenum'>128</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsCanonicalBasisIntegersRep&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line129"></a><div class='linenum'>129</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rec()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line130"></a><div class='linenum'>130</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetUnderlyingLeftModule(&nbsp;B,&nbsp;Integers&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line131"></a><div class='linenum'>131</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetBasisVectors(&nbsp;B,&nbsp;[&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line132"></a><div class='linenum'>132</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line133"></a><div class='linenum'>133</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;B;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line134"></a><div class='linenum'>134</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line135"></a><div class='linenum'>135</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line136"></a><div class='linenum'>136</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Coefficients,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line137"></a><div class='linenum'>137</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;the&nbsp;canonical&nbsp;basis&nbsp;of&nbsp;Integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line138"></a><div class='linenum'>138</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsCollsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line139"></a><div class='linenum'>139</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsBasis&nbsp;and&nbsp;IsCanonicalBasis&nbsp;and&nbsp;IsCanonicalBasisIntegersRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line140"></a><div class='linenum'>140</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsCyc&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line141"></a><div class='linenum'>141</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;B,&nbsp;v&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line142"></a><div class='linenum'>142</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;v&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line143"></a><div class='linenum'>143</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;v&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line144"></a><div class='linenum'>144</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line145"></a><div class='linenum'>145</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line146"></a><div class='linenum'>146</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line147"></a><div class='linenum'>147</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line148"></a><div class='linenum'>148</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line149"></a><div class='linenum'>149</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line150"></a><div class='linenum'>150</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line151"></a><div class='linenum'>151</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line152"></a><div class='linenum'>152</div></td><td></td><td></td><td></td><td><span><tt>#V&nbsp;&nbsp;Primes&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;list&nbsp;of&nbsp;small&nbsp;primes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line153"></a><div class='linenum'>153</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line154"></a><div class='linenum'>154</div></td><td></td><td></td><td></td><td><span><tt>InstallValue(&nbsp;Primes,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line155"></a><div class='linenum'>155</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[&nbsp;&nbsp;&nbsp;2,&nbsp;&nbsp;3,&nbsp;&nbsp;5,&nbsp;&nbsp;7,&nbsp;11,&nbsp;13,&nbsp;17,&nbsp;19,&nbsp;23,&nbsp;29,&nbsp;31,&nbsp;37,&nbsp;41,&nbsp;43,&nbsp;47,&nbsp;53,&nbsp;59,&nbsp;61,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line156"></a><div class='linenum'>156</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;67,&nbsp;71,&nbsp;73,&nbsp;79,&nbsp;83,&nbsp;89,&nbsp;97,101,103,107,109,113,127,131,137,139,149,151,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line157"></a><div class='linenum'>157</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line158"></a><div class='linenum'>158</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line159"></a><div class='linenum'>159</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line160"></a><div class='linenum'>160</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line161"></a><div class='linenum'>161</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line162"></a><div class='linenum'>162</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line163"></a><div class='linenum'>163</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line164"></a><div class='linenum'>164</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;967,971,977,983,991,997&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line165"></a><div class='linenum'>165</div></td><td></td><td></td><td></td><td><span><tt>MakeImmutable(&nbsp;Primes&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line166"></a><div class='linenum'>166</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line167"></a><div class='linenum'>167</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line168"></a><div class='linenum'>168</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line169"></a><div class='linenum'>169</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line170"></a><div class='linenum'>170</div></td><td></td><td></td><td></td><td><span><tt>#V&nbsp;&nbsp;Primes2&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;additional&nbsp;prime&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line171"></a><div class='linenum'>171</div></td><td></td><td></td><td></td><td><span><tt>#V&nbsp;&nbsp;ProbablePrimes2&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;additional&nbsp;prime&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line172"></a><div class='linenum'>172</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line173"></a><div class='linenum'>173</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Some&nbsp;primes&nbsp;in&nbsp;`Primes2'&nbsp;are&nbsp;taken&nbsp;from&nbsp;the&nbsp;tables&nbsp;of&nbsp;Richard&nbsp;Brent,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line174"></a><div class='linenum'>174</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;which&nbsp;are&nbsp;available&nbsp;at
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line175"></a><div class='linenum'>175</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;ftp://ftp.comlab.ox.ac.uk/pub/Documents/techpapers/Richard.Brent/factors/
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line176"></a><div class='linenum'>176</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line177"></a><div class='linenum'>177</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;More&nbsp;factors&nbsp;of&nbsp;cyclotomic&nbsp;numbers&nbsp;are&nbsp;now&nbsp;available&nbsp;via&nbsp;the&nbsp;FactInt
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line178"></a><div class='linenum'>178</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;package.&nbsp;This&nbsp;should&nbsp;be&nbsp;cleaned&nbsp;up.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line179"></a><div class='linenum'>179</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line180"></a><div class='linenum'>180</div></td><td></td><td></td><td></td><td><span><tt>InstallFlushableValue(&nbsp;Primes2,&nbsp;[
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line181"></a><div class='linenum'>181</div></td><td></td><td></td><td></td><td><span><tt>10047871,&nbsp;10567201,&nbsp;10746341,&nbsp;12112549,&nbsp;12128131,&nbsp;12207031,&nbsp;12323587,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line182"></a><div class='linenum'>182</div></td><td></td><td></td><td></td><td><span><tt>12553493,&nbsp;12865927,&nbsp;13097927,&nbsp;13264529,&nbsp;13473433,&nbsp;13821503,&nbsp;13960201,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line183"></a><div class='linenum'>183</div></td><td></td><td></td><td></td><td><span><tt>14092193,&nbsp;14597959,&nbsp;15216601,&nbsp;15790321,&nbsp;16018507,&nbsp;18837001,&nbsp;20381027,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line184"></a><div class='linenum'>184</div></td><td></td><td></td><td></td><td><span><tt>20394401,&nbsp;20515111,&nbsp;20515909,&nbsp;21207101,&nbsp;21523361,&nbsp;22253377,&nbsp;22366891,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line185"></a><div class='linenum'>185</div></td><td></td><td></td><td></td><td><span><tt>22996651,&nbsp;23850061,&nbsp;25781083,&nbsp;26295457,&nbsp;28325071,&nbsp;28878847,&nbsp;29010221,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line186"></a><div class='linenum'>186</div></td><td></td><td></td><td></td><td><span><tt>29247661,&nbsp;29423041,&nbsp;29866451,&nbsp;32234893,&nbsp;32508061,&nbsp;36855109,&nbsp;41540861,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line187"></a><div class='linenum'>187</div></td><td></td><td></td><td></td><td><span><tt>42521761,&nbsp;43249589,&nbsp;44975113,&nbsp;47392381,&nbsp;47763361,&nbsp;48544121,&nbsp;48912491,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line188"></a><div class='linenum'>188</div></td><td></td><td></td><td></td><td><span><tt>49105547,&nbsp;49892851,&nbsp;51457561,&nbsp;55527473,&nbsp;56409643,&nbsp;56737873,&nbsp;59302051,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line189"></a><div class='linenum'>189</div></td><td></td><td></td><td></td><td><span><tt>59361349,&nbsp;59583967,&nbsp;60816001,&nbsp;62020897,&nbsp;63512437,&nbsp;65628751,&nbsp;69566521,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line190"></a><div class='linenum'>190</div></td><td></td><td></td><td></td><td><span><tt>75068993,&nbsp;76066181,&nbsp;85280581,&nbsp;93507247,&nbsp;96656723,&nbsp;97685839,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line191"></a><div class='linenum'>191</div></td><td></td><td></td><td></td><td><span><tt>106431697,&nbsp;107367629,&nbsp;109688713,&nbsp;110211473,&nbsp;112901153,&nbsp;119782433,&nbsp;127540261,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line192"></a><div class='linenum'>192</div></td><td></td><td></td><td></td><td><span><tt>134818753,&nbsp;134927809,&nbsp;136151713,&nbsp;147300841,&nbsp;155072369,&nbsp;160465489,&nbsp;164511353,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line193"></a><div class='linenum'>193</div></td><td></td><td></td><td></td><td><span><tt>177237331,&nbsp;183794551,&nbsp;184481113,&nbsp;190295821,&nbsp;190771747,&nbsp;193707721,&nbsp;195019441,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line194"></a><div class='linenum'>194</div></td><td></td><td></td><td></td><td><span><tt>202029703,&nbsp;206244761,&nbsp;212601841,&nbsp;212885833,&nbsp;228511817,&nbsp;231769777,&nbsp;234750601,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line195"></a><div class='linenum'>195</div></td><td></td><td></td><td></td><td><span><tt>272010961,&nbsp;280314943,&nbsp;283763713,&nbsp;297315901,&nbsp;305175781,&nbsp;308761441,&nbsp;319020217,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line196"></a><div class='linenum'>196</div></td><td></td><td></td><td></td><td><span><tt>359390389,&nbsp;407865361,&nbsp;420778751,&nbsp;424256201,&nbsp;432853009,&nbsp;457315063,&nbsp;466344409,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line197"></a><div class='linenum'>197</div></td><td></td><td></td><td></td><td><span><tt>510810301,&nbsp;515717329,&nbsp;527093491,&nbsp;529510939,&nbsp;536903681,&nbsp;540701761,&nbsp;550413361,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line198"></a><div class='linenum'>198</div></td><td></td><td></td><td></td><td><span><tt>603926681,&nbsp;616318177,&nbsp;632133361,&nbsp;715827883,&nbsp;724487149,&nbsp;745988807,&nbsp;763539787,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line199"></a><div class='linenum'>199</div></td><td></td><td></td><td></td><td><span><tt>815702161,&nbsp;834019001,&nbsp;852133201,&nbsp;857643277,&nbsp;879399649,&nbsp;909139159,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line200"></a><div class='linenum'>200</div></td><td></td><td></td><td></td><td><span><tt>1001523179,&nbsp;1036745531,&nbsp;1065264019,&nbsp;1106131489,&nbsp;1169382127,&nbsp;1390636259,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line201"></a><div class='linenum'>201</div></td><td></td><td></td><td></td><td><span><tt>1503418321,&nbsp;1527007411,&nbsp;1636258751,&nbsp;1644512641,&nbsp;1743831169,&nbsp;1824179209,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line202"></a><div class='linenum'>202</div></td><td></td><td></td><td></td><td><span><tt>1824726041,&nbsp;1826934301,&nbsp;1866013003,&nbsp;1990415149,&nbsp;2127357527,&nbsp;2127431041,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line203"></a><div class='linenum'>203</div></td><td></td><td></td><td></td><td><span><tt>2147483647,&nbsp;2238236249,&nbsp;2316281689,&nbsp;2413941289,&nbsp;2481791513,&nbsp;2550183799,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line204"></a><div class='linenum'>204</div></td><td></td><td></td><td></td><td><span><tt>2576743207,&nbsp;2664097031,&nbsp;2767631689,&nbsp;2903110321,&nbsp;2931542417,&nbsp;3021012311,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line205"></a><div class='linenum'>205</div></td><td></td><td></td><td></td><td><span><tt>3158528101,&nbsp;3173389601,&nbsp;3357897971,&nbsp;3652120847,&nbsp;4011586307,&nbsp;4058036683,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line206"></a><div class='linenum'>206</div></td><td></td><td></td><td></td><td><span><tt>4278255361,&nbsp;4375578271,&nbsp;4562284561,&nbsp;4649919401,&nbsp;4698932281,&nbsp;4795973261,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line207"></a><div class='linenum'>207</div></td><td></td><td></td><td></td><td><span><tt>4885168129,&nbsp;5960555749,&nbsp;6622733113,&nbsp;6630274723,&nbsp;6809710909,&nbsp;6860024417,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line208"></a><div class='linenum'>208</div></td><td></td><td></td><td></td><td><span><tt>7068569257,&nbsp;7151459701,&nbsp;7484047069,&nbsp;7685542369,&nbsp;7830118297,&nbsp;7866608083,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line209"></a><div class='linenum'>209</div></td><td></td><td></td><td></td><td><span><tt>8209475377,&nbsp;8831418697,&nbsp;9598959833,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line210"></a><div class='linenum'>210</div></td><td></td><td></td><td></td><td><span><tt>10879733611,&nbsp;11368765063,&nbsp;11898664849,&nbsp;12447002677,&nbsp;13455809771,&nbsp;13564461457,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line211"></a><div class='linenum'>211</div></td><td></td><td></td><td></td><td><span><tt>13841169553,&nbsp;13971969971,&nbsp;14425532687,&nbsp;15085812853,&nbsp;15768033143,&nbsp;15888756269,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line212"></a><div class='linenum'>212</div></td><td></td><td></td><td></td><td><span><tt>16055056483,&nbsp;16148168401,&nbsp;17056050293,&nbsp;17154094481,&nbsp;17189128703,&nbsp;19707683773,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line213"></a><div class='linenum'>213</div></td><td></td><td></td><td></td><td><span><tt>22434744889,&nbsp;23140471537,&nbsp;23535794707,&nbsp;24127552321,&nbsp;25194773531,&nbsp;25480398173,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line214"></a><div class='linenum'>214</div></td><td></td><td></td><td></td><td><span><tt>25829691707,&nbsp;25994736109,&nbsp;27669118297,&nbsp;27989941729,&nbsp;28086211607,&nbsp;30327152671,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line215"></a><div class='linenum'>215</div></td><td></td><td></td><td></td><td><span><tt>32952799801,&nbsp;33057806959,&nbsp;35532364099,&nbsp;39940132241,&nbsp;43872038849,&nbsp;45076044553,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line216"></a><div class='linenum'>216</div></td><td></td><td></td><td></td><td><span><tt>47072139617,&nbsp;50150933101,&nbsp;54410972897,&nbsp;56625998353,&nbsp;56770350869,&nbsp;60726444167,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line217"></a><div class='linenum'>217</div></td><td></td><td></td><td></td><td><span><tt>61070817601,&nbsp;62983048367,&nbsp;65247271367,&nbsp;69238518539,&nbsp;70845409351,&nbsp;76831835389,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line218"></a><div class='linenum'>218</div></td><td></td><td></td><td></td><td><span><tt>77158673929,&nbsp;77192844961,&nbsp;78009515593,&nbsp;83960385389,&nbsp;86950696619,&nbsp;87423871753,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line219"></a><div class='linenum'>219</div></td><td></td><td></td><td></td><td><span><tt>88959882481,&nbsp;99810171997,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line220"></a><div class='linenum'>220</div></td><td></td><td></td><td></td><td><span><tt>115868130379,&nbsp;125096112091,&nbsp;127522693159,&nbsp;128011456717,&nbsp;128653413121,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line221"></a><div class='linenum'>221</div></td><td></td><td></td><td></td><td><span><tt>129924628343,&nbsp;131105292137,&nbsp;152587500001,&nbsp;158822951431,&nbsp;159248456569,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line222"></a><div class='linenum'>222</div></td><td></td><td></td><td></td><td><span><tt>164504919713,&nbsp;165768537521,&nbsp;168749965921,&nbsp;213657222007,&nbsp;229890275929,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line223"></a><div class='linenum'>223</div></td><td></td><td></td><td></td><td><span><tt>241931001601,&nbsp;269089806001,&nbsp;282429005041,&nbsp;301077652751,&nbsp;332207361361,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line224"></a><div class='linenum'>224</div></td><td></td><td></td><td></td><td><span><tt>368592716837,&nbsp;374857981681,&nbsp;386478495679,&nbsp;392038110671,&nbsp;402011881627,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line225"></a><div class='linenum'>225</div></td><td></td><td></td><td></td><td><span><tt>441019876741,&nbsp;447600088289,&nbsp;461587317509,&nbsp;487824887233,&nbsp;531968664833,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line226"></a><div class='linenum'>226</div></td><td></td><td></td><td></td><td><span><tt>555915824341,&nbsp;593554036769,&nbsp;598761682261,&nbsp;641625222857,&nbsp;654652168021,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line227"></a><div class='linenum'>227</div></td><td></td><td></td><td></td><td><span><tt>761838257287,&nbsp;810221830361,&nbsp;840139875599,&nbsp;918585913061,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line228"></a><div class='linenum'>228</div></td><td></td><td></td><td></td><td><span><tt>1030330938209,&nbsp;1047623475541,&nbsp;1113491139767,&nbsp;1133836730401,&nbsp;1273880539247,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line229"></a><div class='linenum'>229</div></td><td></td><td></td><td></td><td><span><tt>1284297400723,&nbsp;1408429185797,&nbsp;1534179947851,&nbsp;1628744948329,&nbsp;1654058017289,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line230"></a><div class='linenum'>230</div></td><td></td><td></td><td></td><td><span><tt>1759217765581,&nbsp;1856458657451,&nbsp;2098303812601,&nbsp;2454335007529,&nbsp;2481357870461,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line231"></a><div class='linenum'>231</div></td><td></td><td></td><td></td><td><span><tt>2549755542947,&nbsp;2663568851051,&nbsp;2738039191709,&nbsp;2879347902817,&nbsp;2932031007403,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line232"></a><div class='linenum'>232</div></td><td></td><td></td><td></td><td><span><tt>3138426605161,&nbsp;3203431780337,&nbsp;3421169496361,&nbsp;3740221981231,&nbsp;4363953127297,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line233"></a><div class='linenum'>233</div></td><td></td><td></td><td></td><td><span><tt>4432676798593,&nbsp;4446437759531,&nbsp;4534166740403,&nbsp;4981857697937,&nbsp;5625767248687,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line234"></a><div class='linenum'>234</div></td><td></td><td></td><td></td><td><span><tt>6090817323763,&nbsp;6493405343627,&nbsp;6713103182899,&nbsp;6740339310641,&nbsp;7432339208719,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line235"></a><div class='linenum'>235</div></td><td></td><td></td><td></td><td><span><tt>8090594434231,&nbsp;8157179360521,&nbsp;8737481256739,&nbsp;8868050880709,&nbsp;9361973132609,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line236"></a><div class='linenum'>236</div></td><td></td><td></td><td></td><td><span><tt>9468940004449,&nbsp;9857737155463,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line237"></a><div class='linenum'>237</div></td><td></td><td></td><td></td><td><span><tt>10052678938039,&nbsp;10979607179423,&nbsp;13952598148481,&nbsp;15798461357509,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line238"></a><div class='linenum'>238</div></td><td></td><td></td><td></td><td><span><tt>15919793462773,&nbsp;17175865789597,&nbsp;18158209813151,&nbsp;22125996444329,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line239"></a><div class='linenum'>239</div></td><td></td><td></td><td></td><td><span><tt>22542470482159,&nbsp;22735632934561,&nbsp;23161037562937,&nbsp;23792163643711,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line240"></a><div class='linenum'>240</div></td><td></td><td></td><td></td><td><span><tt>24517014940753,&nbsp;24587411156281,&nbsp;28059810762433,&nbsp;29078814248401,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line241"></a><div class='linenum'>241</div></td><td></td><td></td><td></td><td><span><tt>31280679788951,&nbsp;31479823396757,&nbsp;32688470798197,&nbsp;33232924804801,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line242"></a><div class='linenum'>242</div></td><td></td><td></td><td></td><td><span><tt>42272797713043,&nbsp;44479210368001,&nbsp;45920153384867,&nbsp;49971617830801,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line243"></a><div class='linenum'>243</div></td><td></td><td></td><td></td><td><span><tt>57583418699431,&nbsp;62911130477521,&nbsp;67280421310721,&nbsp;70601370627701,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line244"></a><div class='linenum'>244</div></td><td></td><td></td><td></td><td><span><tt>71316922984999,&nbsp;83181652304609,&nbsp;89620825374601,&nbsp;94404837727799,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line245"></a><div class='linenum'>245</div></td><td></td><td></td><td></td><td><span><tt>95052547721497,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line246"></a><div class='linenum'>246</div></td><td></td><td></td><td></td><td><span><tt>110133112994711,&nbsp;140737471578113,&nbsp;145295143558111,&nbsp;150224123975857,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line247"></a><div class='linenum'>247</div></td><td></td><td></td><td></td><td><span><tt>160026187716961,&nbsp;204064664440913,&nbsp;205367807127911,&nbsp;242099935645987,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line248"></a><div class='linenum'>248</div></td><td></td><td></td><td></td><td><span><tt>270547105429567,&nbsp;303567967057423,&nbsp;332584516519201,&nbsp;434502978835771,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line249"></a><div class='linenum'>249</div></td><td></td><td></td><td></td><td><span><tt>475384700124973,&nbsp;500805747488153,&nbsp;520518327319589,&nbsp;560088668384411,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line250"></a><div class='linenum'>250</div></td><td></td><td></td><td></td><td><span><tt>608459012088799,&nbsp;637265428480297,&nbsp;643170158708221,&nbsp;707179356161321,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line251"></a><div class='linenum'>251</div></td><td></td><td></td><td></td><td><span><tt>866802946161469,&nbsp;926510094425921,&nbsp;990643452963163,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line252"></a><div class='linenum'>252</div></td><td></td><td></td><td></td><td><span><tt>1034150930241911,&nbsp;1066818132868207,&nbsp;1120648576818041,&nbsp;1357105535093947,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line253"></a><div class='linenum'>253</div></td><td></td><td></td><td></td><td><span><tt>1416258521793067,&nbsp;1587855697992791,&nbsp;1611479891519807,&nbsp;1628413557556843,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line254"></a><div class='linenum'>254</div></td><td></td><td></td><td></td><td><span><tt>1900857799450121,&nbsp;1958423494433591,&nbsp;2134387368610417,&nbsp;2646507710984041,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line255"></a><div class='linenum'>255</div></td><td></td><td></td><td></td><td><span><tt>2649263870814793,&nbsp;2752135920929651,&nbsp;2864226125209369,&nbsp;3208002856867129,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line256"></a><div class='linenum'>256</div></td><td></td><td></td><td></td><td><span><tt>4557772677741827,&nbsp;4889988840047743,&nbsp;5420506947192709,&nbsp;6957533874046531,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line257"></a><div class='linenum'>257</div></td><td></td><td></td><td></td><td><span><tt>9460375336977361,&nbsp;9472026608675509,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line258"></a><div class='linenum'>258</div></td><td></td><td></td><td></td><td><span><tt>11264087821629961,&nbsp;12557612956332313,&nbsp;13722816749522711,&nbsp;14436295738510501,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line259"></a><div class='linenum'>259</div></td><td></td><td></td><td></td><td><span><tt>18584774046020617,&nbsp;18624275418445601,&nbsp;20986207825565581,&nbsp;21180247636732981,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line260"></a><div class='linenum'>260</div></td><td></td><td></td><td></td><td><span><tt>22666879066355177,&nbsp;27145365052629449,&nbsp;32233368385529653,&nbsp;39392783590192547,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line261"></a><div class='linenum'>261</div></td><td></td><td></td><td></td><td><span><tt>46329453543600481,&nbsp;50544702849929377,&nbsp;59509429687890001,&nbsp;60081451169922001,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line262"></a><div class='linenum'>262</div></td><td></td><td></td><td></td><td><span><tt>70084436712553223,&nbsp;76394148218203559,&nbsp;77001139434480073,&nbsp;79787519018560501,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line263"></a><div class='linenum'>263</div></td><td></td><td></td><td></td><td><span><tt>96076791871613611,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line264"></a><div class='linenum'>264</div></td><td></td><td></td><td></td><td><span><tt>133088039373662309,&nbsp;144542918285300809,&nbsp;145171177264407947,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line265"></a><div class='linenum'>265</div></td><td></td><td></td><td></td><td><span><tt>153560376376050799,&nbsp;166003607842448777,&nbsp;177722253954175633,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line266"></a><div class='linenum'>266</div></td><td></td><td></td><td></td><td><span><tt>196915704073465747,&nbsp;316825425410373433,&nbsp;341117531003194129,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line267"></a><div class='linenum'>267</div></td><td></td><td></td><td></td><td><span><tt>380808546861411923,&nbsp;489769993189671059,&nbsp;538953023961943033,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line268"></a><div class='linenum'>268</div></td><td></td><td></td><td></td><td><span><tt>581283643249112959,&nbsp;617886851384381281,&nbsp;625552508473588471,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line269"></a><div class='linenum'>269</div></td><td></td><td></td><td></td><td><span><tt>645654335737185721,&nbsp;646675035253258729,&nbsp;658812288653553079,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line270"></a><div class='linenum'>270</div></td><td></td><td></td><td></td><td><span><tt>768614336404564651,&nbsp;862970652262943171,&nbsp;909456847814334401,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line271"></a><div class='linenum'>271</div></td><td></td><td></td><td></td><td><span><tt>1100876018364883721,&nbsp;1195857367853217109,&nbsp;1245576402371959291,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line272"></a><div class='linenum'>272</div></td><td></td><td></td><td></td><td><span><tt>1795918038741070627,&nbsp;2192537062271178641,&nbsp;2305843009213693951,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line273"></a><div class='linenum'>273</div></td><td></td><td></td><td></td><td><span><tt>2312581841562813841,&nbsp;2461243576713869557,&nbsp;2615418118891695851,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line274"></a><div class='linenum'>274</div></td><td></td><td></td><td></td><td><span><tt>2691614274040036601,&nbsp;3011347479614249131,&nbsp;3358335487319458201,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line275"></a><div class='linenum'>275</div></td><td></td><td></td><td></td><td><span><tt>3421093417510114543,&nbsp;3602372010909260861,&nbsp;3747607031112307667,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line276"></a><div class='linenum'>276</div></td><td></td><td></td><td></td><td><span><tt>3999088279399464409,&nbsp;4710883168879506001,&nbsp;5079304643216687969,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line277"></a><div class='linenum'>277</div></td><td></td><td></td><td></td><td><span><tt>5559917315850179173,&nbsp;5782172113400990737,&nbsp;6106505825833677713,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line278"></a><div class='linenum'>278</div></td><td></td><td></td><td></td><td><span><tt>6115909044841454629,&nbsp;9213624084535989031,&nbsp;9520972806333758431,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line279"></a><div class='linenum'>279</div></td><td></td><td></td><td></td><td><span><tt>10527743181888260981,&nbsp;14808607715315782481,&nbsp;18446744069414584321,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line280"></a><div class='linenum'>280</div></td><td></td><td></td><td></td><td><span><tt>26831423036065352611,&nbsp;32032215596496435569,&nbsp;34563155350221618511,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line281"></a><div class='linenum'>281</div></td><td></td><td></td><td></td><td><span><tt>36230454570129675721,&nbsp;58523123221688392679,&nbsp;60912916512835721519,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line282"></a><div class='linenum'>282</div></td><td></td><td></td><td></td><td><span><tt>82064241848634269407,&nbsp;86656268566282183151,&nbsp;87274497124602996457,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line283"></a><div class='linenum'>283</div></td><td></td><td></td><td></td><td><span><tt>105668621839502584913,&nbsp;157571957584602258799,&nbsp;162715052426691233701,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line284"></a><div class='linenum'>284</div></td><td></td><td></td><td></td><td><span><tt>172827552198815888791,&nbsp;195489390796456327201,&nbsp;240031591394168814433,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line285"></a><div class='linenum'>285</div></td><td></td><td></td><td></td><td><span><tt>266834785363181152127,&nbsp;344120456368919234899,&nbsp;358475907408445923469,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line286"></a><div class='linenum'>286</div></td><td></td><td></td><td></td><td><span><tt>846041103974872866961,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line287"></a><div class='linenum'>287</div></td><td></td><td></td><td></td><td><span><tt>2519545342349331183143,&nbsp;3658524738455131951223,&nbsp;3793685967117002179453,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line288"></a><div class='linenum'>288</div></td><td></td><td></td><td></td><td><span><tt>3976656429941438590393,&nbsp;5439042183600204290159,&nbsp;8198241112969626815581,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line289"></a><div class='linenum'>289</div></td><td></td><td></td><td></td><td><span><tt>11600321878916922053491,&nbsp;12812432238302009985937,&nbsp;17551032119981679046729,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line290"></a><div class='linenum'>290</div></td><td></td><td></td><td></td><td><span><tt>18489605314740987765913,&nbsp;27665283091695977275201,&nbsp;42437717969530394595211,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line291"></a><div class='linenum'>291</div></td><td></td><td></td><td></td><td><span><tt>57912614113275649087721,&nbsp;61654440233248340616559,&nbsp;63681511996418550459487,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line292"></a><div class='linenum'>292</div></td><td></td><td></td><td></td><td><span><tt>105293313660391861035901,&nbsp;155285743288572277679887,&nbsp;201487636602438195784363,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line293"></a><div class='linenum'>293</div></td><td></td><td></td><td></td><td><span><tt>231669654363683130095909,&nbsp;235169662395069356312233,&nbsp;402488219476647465854701,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line294"></a><div class='linenum'>294</div></td><td></td><td></td><td></td><td><span><tt>535347624791488552837151,&nbsp;604088623657497125653141,&nbsp;870035986098720987332873,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line295"></a><div class='linenum'>295</div></td><td></td><td></td><td></td><td><span><tt>950996059627210897943351,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line296"></a><div class='linenum'>296</div></td><td></td><td></td><td></td><td><span><tt>1412900479108654932024439,&nbsp;1431185706701868962383741,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line297"></a><div class='linenum'>297</div></td><td></td><td></td><td></td><td><span><tt>2047572230657338751575051,&nbsp;2048568835297380486760231,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line298"></a><div class='linenum'>298</div></td><td></td><td></td><td></td><td><span><tt>2741672362528725535068727,&nbsp;3042645634792541312037847,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line299"></a><div class='linenum'>299</div></td><td></td><td></td><td></td><td><span><tt>3745603812007166116831643,&nbsp;4362139336229068656094783,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line300"></a><div class='linenum'>300</div></td><td></td><td></td><td></td><td><span><tt>4805345109492315767981401,&nbsp;5042939439565996049162197,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line301"></a><div class='linenum'>301</div></td><td></td><td></td><td></td><td><span><tt>7289088383388253664437433,&nbsp;8235109336690846723986161,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line302"></a><div class='linenum'>302</div></td><td></td><td></td><td></td><td><span><tt>9680647790568589086355559,&nbsp;9768997162071483134919121,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line303"></a><div class='linenum'>303</div></td><td></td><td></td><td></td><td><span><tt>9842332430037465033595921,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line304"></a><div class='linenum'>304</div></td><td></td><td></td><td></td><td><span><tt>11053036065049294753459639,&nbsp;11735415506748076408140121,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line305"></a><div class='linenum'>305</div></td><td></td><td></td><td></td><td><span><tt>13842607235828485645766393,&nbsp;17499733663152976533452519,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line306"></a><div class='linenum'>306</div></td><td></td><td></td><td></td><td><span><tt>26273701844015319144827917,&nbsp;75582488424179347083438319,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line307"></a><div class='linenum'>307</div></td><td></td><td></td><td></td><td><span><tt>88040095945103834627376781,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line308"></a><div class='linenum'>308</div></td><td></td><td></td><td></td><td><span><tt>100641220283951395639601683,&nbsp;140194179307171898833699259,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line309"></a><div class='linenum'>309</div></td><td></td><td></td><td></td><td><span><tt>207617485544258392970753527,&nbsp;291280009243618888211558641,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line310"></a><div class='linenum'>310</div></td><td></td><td></td><td></td><td><span><tt>303309617049998388989376043,&nbsp;354639323684545612988577649,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line311"></a><div class='linenum'>311</div></td><td></td><td></td><td></td><td><span><tt>618970019642690137449562111,&nbsp;913242407367610843676812931,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line312"></a><div class='linenum'>312</div></td><td></td><td></td><td></td><td><span><tt>7222605228105536202757606969,&nbsp;7248808599285760001152755641,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line313"></a><div class='linenum'>313</div></td><td></td><td></td><td></td><td><span><tt>8170509011431363408568150369,&nbsp;8206973609150536446402438593,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line314"></a><div class='linenum'>314</div></td><td></td><td></td><td></td><td><span><tt>9080418348371887359375390001,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line315"></a><div class='linenum'>315</div></td><td></td><td></td><td></td><td><span><tt>14732265321145317331353282383,&nbsp;15403468930064931175264655869,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line316"></a><div class='linenum'>316</div></td><td></td><td></td><td></td><td><span><tt>15572244900182528777225808449,&nbsp;18806327041824690595747113889,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line317"></a><div class='linenum'>317</div></td><td></td><td></td><td></td><td><span><tt>21283620033217629539178799361,&nbsp;37201708625305146303973352041,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line318"></a><div class='linenum'>318</div></td><td></td><td></td><td></td><td><span><tt>42534656091583268045915654719,&nbsp;48845962828028421155731228333,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line319"></a><div class='linenum'>319</div></td><td></td><td></td><td></td><td><span><tt>123876132205208335762278423601,&nbsp;134304196845099262572814573351,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line320"></a><div class='linenum'>320</div></td><td></td><td></td><td></td><td><span><tt>172974812463239310024750410929,&nbsp;217648180992721729506406538251,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line321"></a><div class='linenum'>321</div></td><td></td><td></td><td></td><td><span><tt>227376585863531112677002031251,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line322"></a><div class='linenum'>322</div></td><td></td><td></td><td></td><td><span><tt>1786393878363164227858270210279,&nbsp;2598696228942460402343442913969,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line323"></a><div class='linenum'>323</div></td><td></td><td></td><td></td><td><span><tt>2643999917660728787808396988849,&nbsp;3340762283952395329506327023033,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line324"></a><div class='linenum'>324</div></td><td></td><td></td><td></td><td><span><tt>5465713352000770660547109750601,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line325"></a><div class='linenum'>325</div></td><td></td><td></td><td></td><td><span><tt>28870194250662203210437116612769,&nbsp;70722308812401674174993533367023,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line326"></a><div class='linenum'>326</div></td><td></td><td></td><td></td><td><span><tt>78958087694609321439660131899631,&nbsp;88262612316754526107621113329689,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line327"></a><div class='linenum'>327</div></td><td></td><td></td><td></td><td><span><tt>162259276829213363391578010288127,&nbsp;163537220852725398851434325720959,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line328"></a><div class='linenum'>328</div></td><td></td><td></td><td></td><td><span><tt>177635683940025046467781066894531,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line329"></a><div class='linenum'>329</div></td><td></td><td></td><td></td><td><span><tt>2679895157783862814690027494144991,&nbsp;3754733257489862401973357979128773,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line330"></a><div class='linenum'>330</div></td><td></td><td></td><td></td><td><span><tt>5283012903770196631383821046101707,&nbsp;5457586804596062091175455674392801,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line331"></a><div class='linenum'>331</div></td><td></td><td></td><td></td><td><span><tt>10052011757370829033540932021825161,&nbsp;11419697846380955982026777206637491,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line332"></a><div class='linenum'>332</div></td><td></td><td></td><td></td><td><span><tt>38904276017035188056372051839841219,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line333"></a><div class='linenum'>333</div></td><td></td><td></td><td></td><td><span><tt>1914662449813727660680530326064591907,&nbsp;7923871097285295625344647665764672671,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line334"></a><div class='linenum'>334</div></td><td></td><td></td><td></td><td><span><tt>9519524151770349914726200576714027279,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line335"></a><div class='linenum'>335</div></td><td></td><td></td><td></td><td><span><tt>10350794431055162386718619237468234569,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line336"></a><div class='linenum'>336</div></td><td></td><td></td><td></td><td><span><tt>170141183460469231731687303715884105727,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line337"></a><div class='linenum'>337</div></td><td></td><td></td><td></td><td><span><tt>1056836588644853738704557482552056406147,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line338"></a><div class='linenum'>338</div></td><td></td><td></td><td></td><td><span><tt>6918082374901313855125397665325977135579,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line339"></a><div class='linenum'>339</div></td><td></td><td></td><td></td><td><span><tt>235335702141939072378977155172505285655211,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line340"></a><div class='linenum'>340</div></td><td></td><td></td><td></td><td><span><tt>360426336941693434048414944508078750920763,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line341"></a><div class='linenum'>341</div></td><td></td><td></td><td></td><td><span><tt>1032670816743843860998850056278950666491537,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line342"></a><div class='linenum'>342</div></td><td></td><td></td><td></td><td><span><tt>1461808298382111034194027645506019619578037,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line343"></a><div class='linenum'>343</div></td><td></td><td></td><td></td><td><span><tt>79638304766856507377778616296087448490695649,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line344"></a><div class='linenum'>344</div></td><td></td><td></td><td></td><td><span><tt>169002145064468556765676975247413756542145739,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line345"></a><div class='linenum'>345</div></td><td></td><td></td><td></td><td><span><tt>8166146875847876762859119015147004762656450569,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line346"></a><div class='linenum'>346</div></td><td></td><td></td><td></td><td><span><tt>18607929421228039083223253529869111644362732899,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line347"></a><div class='linenum'>347</div></td><td></td><td></td><td></td><td><span><tt>33083146850190391025301565142735000331370209599,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line348"></a><div class='linenum'>348</div></td><td></td><td></td><td></td><td><span><tt>138497973518827432485604572537024087153816681041,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line349"></a><div class='linenum'>349</div></td><td></td><td></td><td></td><td><span><tt>673267426712748387612994804392183645147042355211,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line350"></a><div class='linenum'>350</div></td><td></td><td></td><td></td><td><span><tt>1489459109360039866456940197095433721664951999121,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line351"></a><div class='linenum'>351</div></td><td></td><td></td><td></td><td><span><tt>4884164093883941177660049098586324302977543600799,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line352"></a><div class='linenum'>352</div></td><td></td><td></td><td></td><td><span><tt>466345922275629775763320748688970211803553256223529,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line353"></a><div class='linenum'>353</div></td><td></td><td></td><td></td><td><span><tt>26828803997912886929710867041891989490486893845712448833,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line354"></a><div class='linenum'>354</div></td><td></td><td></td><td></td><td><span><tt>153159805660301568024613754993807288151489686913246436306439,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line355"></a><div class='linenum'>355</div></td><td></td><td></td><td></td><td><span><tt>1051153199500053598403188407217590190707671147285551702341089650185945215953
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line356"></a><div class='linenum'>356</div></td><td></td><td></td><td></td><td><span><tt>]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line357"></a><div class='linenum'>357</div></td><td></td><td></td><td></td><td><span><tt>IsSSortedList(&nbsp;Primes2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line358"></a><div class='linenum'>358</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;for&nbsp;41^41-1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line359"></a><div class='linenum'>359</div></td><td></td><td></td><td></td><td><span><tt>ADD_SET(Primes2,&nbsp;5926187589691497537793497756719);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line360"></a><div class='linenum'>360</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;for&nbsp;89^89-1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line361"></a><div class='linenum'>361</div></td><td></td><td></td><td></td><td><span><tt>ADD_SET(Primes2,&nbsp;4330075309599657322634371042967428373533799534566765522517);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line362"></a><div class='linenum'>362</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;for&nbsp;97^97-1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line363"></a><div class='linenum'>363</div></td><td></td><td></td><td></td><td><span><tt>ADD_SET(Primes2,&nbsp;549180361199324724418373466271912931710271534073773);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line364"></a><div class='linenum'>364</div></td><td></td><td></td><td></td><td><span><tt>ADD_SET(Primes2,&nbsp;&nbsp;85411410016592864938535742262164288660754818699519364051241927961077872028620787589587608357877);&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line365"></a><div class='linenum'>365</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line366"></a><div class='linenum'>366</div></td><td></td><td></td><td></td><td><span><tt>InstallFlushableValue(ProbablePrimes2,&nbsp;[]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line367"></a><div class='linenum'>367</div></td><td></td><td></td><td></td><td><span><tt>IsSSortedList(&nbsp;ProbablePrimes2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line368"></a><div class='linenum'>368</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line369"></a><div class='linenum'>369</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line370"></a><div class='linenum'>370</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line371"></a><div class='linenum'>371</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;BestQuoInt(&nbsp;&lt;n>,&nbsp;&lt;m>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line372"></a><div class='linenum'>372</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line373"></a><div class='linenum'>373</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`BestQuoInt'&nbsp;returns&nbsp;the&nbsp;best&nbsp;quotient&nbsp;&lt;q>&nbsp;of&nbsp;the&nbsp;integers&nbsp;&nbsp;&lt;n>&nbsp;and&nbsp;&nbsp;&lt;m>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line374"></a><div class='linenum'>374</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;is&nbsp;the&nbsp;quotient&nbsp;such&nbsp;that&nbsp;`&lt;n>-&lt;q>\*&lt;m>'&nbsp;has&nbsp;minimal&nbsp;absolute&nbsp;value.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line375"></a><div class='linenum'>375</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;If&nbsp;there&nbsp;are&nbsp;two&nbsp;quotients&nbsp;whose&nbsp;remainders&nbsp;have&nbsp;the&nbsp;same&nbsp;absolute&nbsp;value,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line376"></a><div class='linenum'>376</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;then&nbsp;the&nbsp;quotient&nbsp;with&nbsp;the&nbsp;smaller&nbsp;absolute&nbsp;value&nbsp;is&nbsp;choosen.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line377"></a><div class='linenum'>377</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line378"></a><div class='linenum'>378</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(BestQuoInt,function&nbsp;(&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line379"></a><div class='linenum'>379</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;0&nbsp;&lt;=&nbsp;m&nbsp;&nbsp;and&nbsp;0&nbsp;&lt;=&nbsp;n&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line380"></a><div class='linenum'>380</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;QuoInt(&nbsp;n&nbsp;+&nbsp;QuoInt(&nbsp;m&nbsp;-&nbsp;1,&nbsp;2&nbsp;),&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line381"></a><div class='linenum'>381</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;0&nbsp;&lt;=&nbsp;m&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line382"></a><div class='linenum'>382</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;QuoInt(&nbsp;n&nbsp;-&nbsp;QuoInt(&nbsp;m&nbsp;-&nbsp;1,&nbsp;2&nbsp;),&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line383"></a><div class='linenum'>383</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;0&nbsp;&lt;=&nbsp;n&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line384"></a><div class='linenum'>384</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;QuoInt(&nbsp;n&nbsp;-&nbsp;QuoInt(&nbsp;m&nbsp;+&nbsp;1,&nbsp;2&nbsp;),&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line385"></a><div class='linenum'>385</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line386"></a><div class='linenum'>386</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;QuoInt(&nbsp;n&nbsp;+&nbsp;QuoInt(&nbsp;m&nbsp;+&nbsp;1,&nbsp;2&nbsp;),&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line387"></a><div class='linenum'>387</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line388"></a><div class='linenum'>388</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line389"></a><div class='linenum'>389</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line390"></a><div class='linenum'>390</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line391"></a><div class='linenum'>391</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line392"></a><div class='linenum'>392</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line393"></a><div class='linenum'>393</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ChineseRem(&nbsp;&lt;moduli>,&nbsp;&lt;residues>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;chinese&nbsp;remainder
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line394"></a><div class='linenum'>394</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line395"></a><div class='linenum'>395</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(ChineseRem,function&nbsp;(&nbsp;moduli,&nbsp;residues&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line396"></a><div class='linenum'>396</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;i,&nbsp;c,&nbsp;l,&nbsp;g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line397"></a><div class='linenum'>397</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line398"></a><div class='linenum'>398</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;combine&nbsp;the&nbsp;residues&nbsp;modulo&nbsp;the&nbsp;moduli
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line399"></a><div class='linenum'>399</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line400"></a><div class='linenum'>400</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;residues[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line401"></a><div class='linenum'>401</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;moduli[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line402"></a><div class='linenum'>402</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;i&nbsp;&lt;&nbsp;Length(moduli)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line403"></a><div class='linenum'>403</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line404"></a><div class='linenum'>404</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;:=&nbsp;Gcdex(&nbsp;l,&nbsp;moduli[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line405"></a><div class='linenum'>405</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;g.gcd&nbsp;&lt;>&nbsp;1&nbsp;&nbsp;and&nbsp;(residues[i]-c)&nbsp;mod&nbsp;g.gcd&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line406"></a><div class='linenum'>406</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("the&nbsp;residues&nbsp;must&nbsp;be&nbsp;equal&nbsp;modulo&nbsp;",g.gcd);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line407"></a><div class='linenum'>407</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line408"></a><div class='linenum'>408</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;l&nbsp;*&nbsp;(((residues[i]-c)&nbsp;/&nbsp;g.gcd&nbsp;*&nbsp;g.coeff1)&nbsp;mod&nbsp;moduli[i])&nbsp;+&nbsp;c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line409"></a><div class='linenum'>409</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;moduli[i]&nbsp;/&nbsp;g.gcd&nbsp;*&nbsp;l;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line410"></a><div class='linenum'>410</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line411"></a><div class='linenum'>411</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line412"></a><div class='linenum'>412</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;reduce&nbsp;c&nbsp;into&nbsp;the&nbsp;range&nbsp;[0..l-1]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line413"></a><div class='linenum'>413</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;c&nbsp;mod&nbsp;l;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line414"></a><div class='linenum'>414</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line415"></a><div class='linenum'>415</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line416"></a><div class='linenum'>416</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line417"></a><div class='linenum'>417</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line418"></a><div class='linenum'>418</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line419"></a><div class='linenum'>419</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line420"></a><div class='linenum'>420</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;CoefficientsQadic(&nbsp;&lt;i>,&nbsp;&lt;q>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;&lt;q>-adic&nbsp;representation&nbsp;of&nbsp;&lt;i>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line421"></a><div class='linenum'>421</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line422"></a><div class='linenum'>422</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CoefficientsQadic,&nbsp;"for&nbsp;two&nbsp;integers",&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line423"></a><div class='linenum'>423</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,&nbsp;[&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line424"></a><div class='linenum'>424</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;i,&nbsp;q&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line425"></a><div class='linenum'>425</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;v;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line426"></a><div class='linenum'>426</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;q&nbsp;&lt;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line427"></a><div class='linenum'>427</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("2nd&nbsp;argument&nbsp;of&nbsp;CoefficientsQadic&nbsp;should&nbsp;be&nbsp;greater&nbsp;than&nbsp;1\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line428"></a><div class='linenum'>428</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line429"></a><div class='linenum'>429</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&lt;&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line430"></a><div class='linenum'>430</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;FR&nbsp;package&nbsp;is&nbsp;loaded&nbsp;and&nbsp;supplies&nbsp;an&nbsp;implementation&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line431"></a><div class='linenum'>431</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;return&nbsp;a&nbsp;periodic&nbsp;list&nbsp;for&nbsp;negative&nbsp;i
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line432"></a><div class='linenum'>432</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line433"></a><div class='linenum'>433</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line434"></a><div class='linenum'>434</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;represent&nbsp;the&nbsp;integer&nbsp;&lt;i>&nbsp;as&nbsp;&lt;q>-adic&nbsp;number
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line435"></a><div class='linenum'>435</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line436"></a><div class='linenum'>436</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;i&nbsp;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line437"></a><div class='linenum'>437</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;v,&nbsp;RemInt(&nbsp;i,&nbsp;q&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line438"></a><div class='linenum'>438</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;QuoInt(&nbsp;i,&nbsp;q&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line439"></a><div class='linenum'>439</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line440"></a><div class='linenum'>440</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;v;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line441"></a><div class='linenum'>441</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line442"></a><div class='linenum'>442</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line443"></a><div class='linenum'>443</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line444"></a><div class='linenum'>444</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line445"></a><div class='linenum'>445</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line446"></a><div class='linenum'>446</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;CoefficientsMultiadic(&nbsp;ints,&nbsp;int&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line447"></a><div class='linenum'>447</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line448"></a><div class='linenum'>448</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(CoefficientsMultiadic,&nbsp;function(&nbsp;ints,&nbsp;int&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line449"></a><div class='linenum'>449</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;vec,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line450"></a><div class='linenum'>450</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;vec&nbsp;:=&nbsp;List(&nbsp;ints,&nbsp;x&nbsp;->&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line451"></a><div class='linenum'>451</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;Reversed(&nbsp;[1..Length(ints)]&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line452"></a><div class='linenum'>452</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vec[i]&nbsp;:=&nbsp;RemInt(&nbsp;int,&nbsp;ints[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line453"></a><div class='linenum'>453</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;:=&nbsp;QuoInt(&nbsp;int,&nbsp;ints[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line454"></a><div class='linenum'>454</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line455"></a><div class='linenum'>455</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;vec;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line456"></a><div class='linenum'>456</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line457"></a><div class='linenum'>457</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line458"></a><div class='linenum'>458</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line459"></a><div class='linenum'>459</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line460"></a><div class='linenum'>460</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line461"></a><div class='linenum'>461</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;DivisorsInt(&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;divisors&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line462"></a><div class='linenum'>462</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line463"></a><div class='linenum'>463</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("DivisorsIntCache",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line464"></a><div class='linenum'>464</div></td><td></td><td></td><td></td><td><span><tt>List([[1],[1,2],[1,3],[1,2,4],[1,5],[1,2,3,6],[1,7]],&nbsp;Immutable));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line465"></a><div class='linenum'>465</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line466"></a><div class='linenum'>466</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(DivisorsInt,function&nbsp;(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line467"></a><div class='linenum'>467</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;divisors,&nbsp;factors,&nbsp;divs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line468"></a><div class='linenum'>468</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line469"></a><div class='linenum'>469</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;&lt;n>&nbsp;it&nbsp;nonnegative,&nbsp;handle&nbsp;trivial&nbsp;cases,&nbsp;and&nbsp;get&nbsp;prime&nbsp;factors
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line470"></a><div class='linenum'>470</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;-n;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line471"></a><div class='linenum'>471</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;0&nbsp;&nbsp;then&nbsp;Error("DivisorsInt:&nbsp;&lt;n>&nbsp;must&nbsp;not&nbsp;be&nbsp;0");&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line472"></a><div class='linenum'>472</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;=&nbsp;Length(DivisorsIntCache)&nbsp;&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line473"></a><div class='linenum'>473</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;DivisorsIntCache[n];&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line474"></a><div class='linenum'>474</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line475"></a><div class='linenum'>475</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;:=&nbsp;FactorsInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line476"></a><div class='linenum'>476</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line477"></a><div class='linenum'>477</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;recursive&nbsp;function&nbsp;to&nbsp;compute&nbsp;the&nbsp;divisors
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line478"></a><div class='linenum'>478</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;divs&nbsp;:=&nbsp;function&nbsp;(&nbsp;i,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line479"></a><div class='linenum'>479</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(factors)&nbsp;&lt;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;return&nbsp;[&nbsp;m&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line480"></a><div class='linenum'>480</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;m&nbsp;mod&nbsp;factors[i]&nbsp;=&nbsp;0&nbsp;&nbsp;then&nbsp;return&nbsp;divs(i+1,m*factors[i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line481"></a><div class='linenum'>481</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;return&nbsp;Concatenation(&nbsp;divs(i+1,m),&nbsp;divs(i+1,m*factors[i])&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line482"></a><div class='linenum'>482</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line483"></a><div class='linenum'>483</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line484"></a><div class='linenum'>484</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line485"></a><div class='linenum'>485</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;divisors&nbsp;:=&nbsp;divs(&nbsp;1,&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line486"></a><div class='linenum'>486</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Sort(&nbsp;divisors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line487"></a><div class='linenum'>487</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Immutable(divisors);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line488"></a><div class='linenum'>488</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line489"></a><div class='linenum'>489</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line490"></a><div class='linenum'>490</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line491"></a><div class='linenum'>491</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line492"></a><div class='linenum'>492</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line493"></a><div class='linenum'>493</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;FactorsRho(&nbsp;&lt;n>,&nbsp;&lt;inc>,&nbsp;&lt;cluster>,&nbsp;&lt;limit>&nbsp;)&nbsp;&nbsp;&nbsp;Pollards&nbsp;rho&nbsp;factorization
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line494"></a><div class='linenum'>494</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line495"></a><div class='linenum'>495</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`FactorsInt'&nbsp;does&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;the&nbsp;primes&nbsp;less&nbsp;than&nbsp;1000&nbsp;to&nbsp;&nbsp;detect
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line496"></a><div class='linenum'>496</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;all&nbsp;composites&nbsp;with&nbsp;a&nbsp;factor&nbsp;less&nbsp;than&nbsp;1000&nbsp;and&nbsp;primes&nbsp;less&nbsp;than&nbsp;1000000.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line497"></a><div class='linenum'>497</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;After&nbsp;that&nbsp;it&nbsp;calls&nbsp;`FactorsRho(&lt;n>,1,16,8192)'&nbsp;to&nbsp;do&nbsp;the&nbsp;hard&nbsp;work.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line498"></a><div class='linenum'>498</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line499"></a><div class='linenum'>499</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`FactorsRho'&nbsp;&nbsp;will&nbsp;&nbsp;return&nbsp;a&nbsp;&nbsp;list&nbsp;&nbsp;of&nbsp;factors&nbsp;&nbsp;&nbsp;and&nbsp;a&nbsp;list&nbsp;&nbsp;of&nbsp;composite
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line500"></a><div class='linenum'>500</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;number.&nbsp;&nbsp;&nbsp;Usually&nbsp;&nbsp;`FactorsInt'&nbsp;&nbsp;factors&nbsp;&nbsp;integers&nbsp;&nbsp;with&nbsp;&nbsp;&nbsp;prime&nbsp;&nbsp;factors
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line501"></a><div class='linenum'>501</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$\&lt;1000$&nbsp;faster.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;However&nbsp;&nbsp;for&nbsp;&nbsp;&nbsp;integers&nbsp;&nbsp;with&nbsp;&nbsp;no&nbsp;&nbsp;&nbsp;factor&nbsp;&nbsp;$\&lt;1000$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line502"></a><div class='linenum'>502</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`FactorsRho'&nbsp;will&nbsp;be&nbsp;faster.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line503"></a><div class='linenum'>503</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line504"></a><div class='linenum'>504</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`FactorsRho'&nbsp;uses&nbsp;Pollards&nbsp;$\rho$&nbsp;method&nbsp;to&nbsp;factor&nbsp;the&nbsp;integer&nbsp;$n&nbsp;=&nbsp;p&nbsp;q$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line505"></a><div class='linenum'>505</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;For&nbsp;a&nbsp;small&nbsp;simple&nbsp;example&nbsp;lets&nbsp;assume&nbsp;we&nbsp;want&nbsp;to&nbsp;factor&nbsp;$667&nbsp;=&nbsp;23&nbsp;*&nbsp;29$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line506"></a><div class='linenum'>506</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`FactorsRho'&nbsp;first&nbsp;calls&nbsp;`IsPrimeInt'&nbsp;to&nbsp;avoid&nbsp;trying&nbsp;to&nbsp;factor&nbsp;a&nbsp;prime.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line507"></a><div class='linenum'>507</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line508"></a><div class='linenum'>508</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Then&nbsp;it&nbsp;uses&nbsp;the&nbsp;sequence&nbsp;defined&nbsp;by&nbsp;&nbsp;$x_0=1,&nbsp;x_{i+1}=(x_i^2+1)$&nbsp;mod&nbsp;$n$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line509"></a><div class='linenum'>509</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;In&nbsp;our&nbsp;example&nbsp;this&nbsp;is&nbsp;$1,&nbsp;2,&nbsp;5,&nbsp;26,&nbsp;10,&nbsp;101,&nbsp;197,&nbsp;124,&nbsp;36,&nbsp;630,&nbsp;..&nbsp;$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line510"></a><div class='linenum'>510</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line511"></a><div class='linenum'>511</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Modulo&nbsp;$p$&nbsp;it&nbsp;takes&nbsp;on&nbsp;at&nbsp;most&nbsp;$p-1$&nbsp;different&nbsp;values,&nbsp;thus&nbsp;it&nbsp;eventually
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line512"></a><div class='linenum'>512</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;becomes&nbsp;recurrent,&nbsp;usually&nbsp;this&nbsp;happens&nbsp;after&nbsp;roughly&nbsp;$2&nbsp;\sqrt{p}$&nbsp;steps.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line513"></a><div class='linenum'>513</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;In&nbsp;our&nbsp;example&nbsp;modulo&nbsp;23&nbsp;we&nbsp;get&nbsp;$1,&nbsp;2,&nbsp;5,&nbsp;3,&nbsp;10,&nbsp;9,&nbsp;13,&nbsp;9,&nbsp;13,&nbsp;9,&nbsp;..&nbsp;$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line514"></a><div class='linenum'>514</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line515"></a><div class='linenum'>515</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Thus&nbsp;there&nbsp;exist&nbsp;pairs&nbsp;$i,&nbsp;j$&nbsp;such&nbsp;that&nbsp;$x_i&nbsp;=&nbsp;x_j$&nbsp;mod&nbsp;$p$,&nbsp;&nbsp;i.e.,&nbsp;&nbsp;such
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line516"></a><div class='linenum'>516</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;that&nbsp;$p$&nbsp;divides&nbsp;$Gcd(&nbsp;n,&nbsp;x_j-x_i&nbsp;)$.&nbsp;&nbsp;With&nbsp;a&nbsp;bit&nbsp;of&nbsp;luck&nbsp;no&nbsp;other&nbsp;factor
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line517"></a><div class='linenum'>517</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;of&nbsp;$n$&nbsp;divides&nbsp;$x_j&nbsp;-&nbsp;x_i$&nbsp;so&nbsp;we&nbsp;find&nbsp;$p$&nbsp;if&nbsp;we&nbsp;know&nbsp;such&nbsp;a&nbsp;pair.&nbsp;&nbsp;In&nbsp;our
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line518"></a><div class='linenum'>518</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;example&nbsp;$5,&nbsp;7$&nbsp;is&nbsp;the&nbsp;first&nbsp;pair,&nbsp;$x_7-x_5=23$,&nbsp;and&nbsp;$Gcd(667,23)&nbsp;=&nbsp;23$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line519"></a><div class='linenum'>519</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line520"></a><div class='linenum'>520</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Now&nbsp;it&nbsp;is&nbsp;too&nbsp;expensive&nbsp;to&nbsp;check&nbsp;all&nbsp;pairs,&nbsp;but&nbsp;there&nbsp;also&nbsp;must&nbsp;be&nbsp;&nbsp;pairs
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line521"></a><div class='linenum'>521</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;of&nbsp;the&nbsp;form&nbsp;$2^i-1,&nbsp;j$&nbsp;with&nbsp;$3*2^{i-1}&nbsp;&lt;=&nbsp;j&nbsp;&lt;&nbsp;4*2^{i-1}$.&nbsp;&nbsp;In&nbsp;our&nbsp;example
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line522"></a><div class='linenum'>522</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$7,&nbsp;13$&nbsp;is&nbsp;the&nbsp;first&nbsp;such&nbsp;pair,&nbsp;$x_13-x_7=506$,&nbsp;and&nbsp;$Gcd(667,506)&nbsp;=&nbsp;23$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line523"></a><div class='linenum'>523</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line524"></a><div class='linenum'>524</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Thus&nbsp;by&nbsp;taking&nbsp;the&nbsp;gcds&nbsp;of&nbsp;$n$&nbsp;and&nbsp;$x_j-x_i$&nbsp;for&nbsp;such&nbsp;pairs,&nbsp;we&nbsp;will&nbsp;find
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line525"></a><div class='linenum'>525</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;the&nbsp;factor&nbsp;$p$&nbsp;after&nbsp;approximately&nbsp;$2&nbsp;\sqrt{p}&nbsp;\&lt;=&nbsp;2&nbsp;\sqrt^4{n}$&nbsp;steps.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line526"></a><div class='linenum'>526</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line527"></a><div class='linenum'>527</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;If&nbsp;$Gcd(&nbsp;n,&nbsp;x_j&nbsp;-&nbsp;x_i&nbsp;)$&nbsp;&nbsp;is&nbsp;not&nbsp;a&nbsp;prime&nbsp;`FactorsRho'&nbsp;&nbsp;will&nbsp;&nbsp;call&nbsp;&nbsp;itself
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line528"></a><div class='linenum'>528</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;recursivly&nbsp;with&nbsp;a&nbsp;different&nbsp;value&nbsp;for&nbsp;&lt;inc>,&nbsp;i.e.,&nbsp;it&nbsp;&nbsp;will&nbsp;try&nbsp;to&nbsp;factor
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line529"></a><div class='linenum'>529</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;the&nbsp;gcd&nbsp;using&nbsp;a&nbsp;different&nbsp;sequence&nbsp;$x_{i+1}&nbsp;=&nbsp;(x_i^2&nbsp;+&nbsp;inc)$&nbsp;mod&nbsp;$n$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line530"></a><div class='linenum'>530</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line531"></a><div class='linenum'>531</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Since&nbsp;the&nbsp;gcd&nbsp;computations&nbsp;are&nbsp;by&nbsp;far&nbsp;the&nbsp;most&nbsp;time&nbsp;consuming&nbsp;part&nbsp;of&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line532"></a><div class='linenum'>532</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;algorithm&nbsp;&nbsp;one&nbsp;can&nbsp;save&nbsp;time&nbsp;by&nbsp;&nbsp;clustering&nbsp;differences&nbsp;and&nbsp;computing&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line533"></a><div class='linenum'>533</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;gcd&nbsp;&nbsp;only&nbsp;every&nbsp;&lt;cluster>&nbsp;&nbsp;iteration.&nbsp;&nbsp;This&nbsp;slightly&nbsp;increases&nbsp;the&nbsp;chance
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line534"></a><div class='linenum'>534</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;that&nbsp;a&nbsp;gcd&nbsp;is&nbsp;composite,&nbsp;but&nbsp;reduces&nbsp;the&nbsp;runtime&nbsp;by&nbsp;a&nbsp;large&nbsp;amount.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line535"></a><div class='linenum'>535</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line536"></a><div class='linenum'>536</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Finally&nbsp;`FactorsRho'&nbsp;accepts&nbsp;an&nbsp;argument&nbsp;&lt;limit>&nbsp;&nbsp;which&nbsp;is&nbsp;the&nbsp;number&nbsp;&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line537"></a><div class='linenum'>537</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;iterations&nbsp;&nbsp;performed&nbsp;by&nbsp;`FactorsRho'&nbsp;before&nbsp;giving&nbsp;up.&nbsp;The&nbsp;default&nbsp;value
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line538"></a><div class='linenum'>538</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;is&nbsp;&nbsp;8192&nbsp;&nbsp;which&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;few&nbsp;minutes&nbsp;&nbsp;while&nbsp;guaranteing&nbsp;that&nbsp;&nbsp;all
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line539"></a><div class='linenum'>539</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;prime&nbsp;factors&nbsp;less&nbsp;than&nbsp;$10^6$&nbsp;and&nbsp;most&nbsp;less&nbsp;than&nbsp;$10^9$&nbsp;are&nbsp;found.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line540"></a><div class='linenum'>540</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line541"></a><div class='linenum'>541</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Better&nbsp;descriptions&nbsp;of&nbsp;the&nbsp;algorithm&nbsp;and&nbsp;related&nbsp;topics&nbsp;can&nbsp;be&nbsp;found&nbsp;&nbsp;in:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line542"></a><div class='linenum'>542</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;J.&nbsp;Pollard,&nbsp;A&nbsp;Monte&nbsp;Carlo&nbsp;Method&nbsp;for&nbsp;Factorization,&nbsp;BIT&nbsp;15,&nbsp;1975,&nbsp;331-334
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line543"></a><div class='linenum'>543</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;R.&nbsp;Brent,&nbsp;An&nbsp;Improved&nbsp;Monte&nbsp;Carlo&nbsp;Method&nbsp;for&nbsp;Fact.,&nbsp;BIT&nbsp;20,&nbsp;1980,&nbsp;176-184
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line544"></a><div class='linenum'>544</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;D.&nbsp;Knuth,&nbsp;Seminumerical&nbsp;Algorithms&nbsp;&nbsp;(TACP&nbsp;II),&nbsp;&nbsp;AddiWesl,&nbsp;&nbsp;1973,&nbsp;&nbsp;369-371
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line545"></a><div class='linenum'>545</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line546"></a><div class='linenum'>546</div></td><td></td><td></td><td></td><td><span><tt>FactorsRho&nbsp;:=&nbsp;function&nbsp;(&nbsp;n,&nbsp;inc,&nbsp;cluster,&nbsp;limit&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line547"></a><div class='linenum'>547</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line548"></a><div class='linenum'>548</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;sign,&nbsp;&nbsp;factors,&nbsp;&nbsp;composite,&nbsp;&nbsp;x,&nbsp;&nbsp;y,&nbsp;&nbsp;k,&nbsp;&nbsp;z,&nbsp;&nbsp;g,&nbsp;&nbsp;tmp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line549"></a><div class='linenum'>549</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsPrimeOrProbablyPrimeInt;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line550"></a><div class='linenum'>550</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line551"></a><div class='linenum'>551</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;$n$&nbsp;positive&nbsp;and&nbsp;handle&nbsp;trivial&nbsp;cases
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line552"></a><div class='linenum'>552</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sign&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line553"></a><div class='linenum'>553</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then&nbsp;sign&nbsp;:=&nbsp;-sign;&nbsp;&nbsp;n&nbsp;:=&nbsp;-n;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line554"></a><div class='linenum'>554</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;4&nbsp;&nbsp;then&nbsp;return&nbsp;[&nbsp;[&nbsp;sign&nbsp;*&nbsp;n&nbsp;],&nbsp;[]&nbsp;];&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line555"></a><div class='linenum'>555</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;&nbsp;&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line556"></a><div class='linenum'>556</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;composite&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line557"></a><div class='linenum'>557</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;&nbsp;do&nbsp;Add(&nbsp;factors,&nbsp;2&nbsp;);&nbsp;&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;2;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line558"></a><div class='linenum'>558</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;3&nbsp;=&nbsp;0&nbsp;&nbsp;do&nbsp;Add(&nbsp;factors,&nbsp;3&nbsp;);&nbsp;&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;3;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line559"></a><div class='linenum'>559</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line560"></a><div class='linenum'>560</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;ValueOption("UseProbabilisticPrimalityTest")&nbsp;=&nbsp;true
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line561"></a><div class='linenum'>561</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;IsPrimeOrProbablyPrimeInt&nbsp;:=&nbsp;IsProbablyPrimeInt;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line562"></a><div class='linenum'>562</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;IsPrimeOrProbablyPrimeInt&nbsp;:=&nbsp;IsPrimeInt;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line563"></a><div class='linenum'>563</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line564"></a><div class='linenum'>564</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsPrimeOrProbablyPrimeInt(n)&nbsp;&nbsp;then&nbsp;Add(&nbsp;factors,&nbsp;n&nbsp;);&nbsp;&nbsp;n&nbsp;:=&nbsp;1;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line565"></a><div class='linenum'>565</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line566"></a><div class='linenum'>566</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;initialize&nbsp;$x_0$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line567"></a><div class='linenum'>567</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;1;&nbsp;&nbsp;z&nbsp;:=&nbsp;1;&nbsp;&nbsp;i&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line568"></a><div class='linenum'>568</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line569"></a><div class='linenum'>569</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;until&nbsp;we&nbsp;have&nbsp;factored&nbsp;$n$&nbsp;completely&nbsp;or&nbsp;run&nbsp;out&nbsp;of&nbsp;patience
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line570"></a><div class='linenum'>570</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;1&nbsp;&lt;&nbsp;n&nbsp;&nbsp;and&nbsp;2^i&nbsp;&lt;=&nbsp;limit&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line571"></a><div class='linenum'>571</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line572"></a><div class='linenum'>572</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;$y&nbsp;=&nbsp;x_{2^i-1}$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line573"></a><div class='linenum'>573</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;x;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line574"></a><div class='linenum'>574</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line575"></a><div class='linenum'>575</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;$x_{2^i},&nbsp;..,&nbsp;x_{3*2^{i-1}-1}$&nbsp;need&nbsp;not&nbsp;be&nbsp;compared&nbsp;to&nbsp;$x_{2^i-1}$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line576"></a><div class='linenum'>576</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[1..2^(i-1)]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line577"></a><div class='linenum'>577</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;(x^2&nbsp;+&nbsp;inc)&nbsp;mod&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line578"></a><div class='linenum'>578</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line579"></a><div class='linenum'>579</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line580"></a><div class='linenum'>580</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compare&nbsp;$x_{3*2^{i-1}},&nbsp;..,&nbsp;x_{4*2^{i-1}-1}$&nbsp;with&nbsp;$x_{2^i-1}$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line581"></a><div class='linenum'>581</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[1..2^(i-1)]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line582"></a><div class='linenum'>582</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;(x^2&nbsp;+&nbsp;inc)&nbsp;mod&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line583"></a><div class='linenum'>583</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;z&nbsp;*&nbsp;(x&nbsp;-&nbsp;y)&nbsp;mod&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line584"></a><div class='linenum'>584</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line585"></a><div class='linenum'>585</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;from&nbsp;time&nbsp;to&nbsp;time&nbsp;compute&nbsp;the&nbsp;gcd
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line586"></a><div class='linenum'>586</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;mod&nbsp;cluster&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line587"></a><div class='linenum'>587</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;:=&nbsp;GcdInt(&nbsp;n,&nbsp;z&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line588"></a><div class='linenum'>588</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line589"></a><div class='linenum'>589</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;it&nbsp;is&nbsp;>&nbsp;1&nbsp;we&nbsp;have&nbsp;found&nbsp;a&nbsp;factor&nbsp;which&nbsp;need&nbsp;not&nbsp;be&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line590"></a><div class='linenum'>590</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;g&nbsp;>&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line591"></a><div class='linenum'>591</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;:=&nbsp;FactorsRho(g,inc+1,QuoInt(cluster+1,2),limit);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line592"></a><div class='linenum'>592</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;&nbsp;&nbsp;:=&nbsp;Concatenation(&nbsp;factors,&nbsp;&nbsp;&nbsp;tmp[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line593"></a><div class='linenum'>593</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;composite&nbsp;:=&nbsp;Concatenation(&nbsp;composite,&nbsp;tmp[2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line594"></a><div class='linenum'>594</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line595"></a><div class='linenum'>595</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line596"></a><div class='linenum'>596</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsPrimeOrProbablyPrimeInt(n)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line597"></a><div class='linenum'>597</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;factors,&nbsp;n&nbsp;);&nbsp;&nbsp;n&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line598"></a><div class='linenum'>598</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line599"></a><div class='linenum'>599</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line600"></a><div class='linenum'>600</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line601"></a><div class='linenum'>601</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line602"></a><div class='linenum'>602</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line603"></a><div class='linenum'>603</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line604"></a><div class='linenum'>604</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;add&nbsp;&lt;n>&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;composite&nbsp;numbers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line605"></a><div class='linenum'>605</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;1&nbsp;&lt;&nbsp;n&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line606"></a><div class='linenum'>606</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;composite,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line607"></a><div class='linenum'>607</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line608"></a><div class='linenum'>608</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line609"></a><div class='linenum'>609</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;sort&nbsp;the&nbsp;list&nbsp;of&nbsp;factors&nbsp;and&nbsp;composite&nbsp;numbers&nbsp;and&nbsp;return&nbsp;it
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line610"></a><div class='linenum'>610</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Sort(factors);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line611"></a><div class='linenum'>611</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Sort(composite);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line612"></a><div class='linenum'>612</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;&nbsp;Length(factors)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line613"></a><div class='linenum'>613</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factors[1]&nbsp;:=&nbsp;sign&nbsp;*&nbsp;factors[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line614"></a><div class='linenum'>614</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line615"></a><div class='linenum'>615</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;composite[1]&nbsp;:=&nbsp;sign&nbsp;*&nbsp;composite[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line616"></a><div class='linenum'>616</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line617"></a><div class='linenum'>617</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;factors,&nbsp;composite&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line618"></a><div class='linenum'>618</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line619"></a><div class='linenum'>619</div></td><td></td><td></td><td></td><td><span><tt>end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line620"></a><div class='linenum'>620</div></td><td></td><td></td><td></td><td><span><tt>MakeReadOnlyGlobal(&nbsp;"FactorsRho"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line621"></a><div class='linenum'>621</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line622"></a><div class='linenum'>622</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line623"></a><div class='linenum'>623</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line624"></a><div class='linenum'>624</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line625"></a><div class='linenum'>625</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;FactorsInt(&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;prime&nbsp;factors&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line626"></a><div class='linenum'>626</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;FactorsInt(&nbsp;&lt;n>&nbsp;:&nbsp;RhoTrials&nbsp;:=&nbsp;&lt;trials>)&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line627"></a><div class='linenum'>627</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;FactorsInt(&nbsp;&lt;n>&nbsp;:&nbsp;quiet)&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line628"></a><div class='linenum'>628</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line629"></a><div class='linenum'>629</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;In&nbsp;the&nbsp;second&nbsp;form,&nbsp;FactorsRho&nbsp;is&nbsp;called&nbsp;with&nbsp;a&nbsp;limit&nbsp;of&nbsp;&lt;trials>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line630"></a><div class='linenum'>630</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;trials&nbsp;is&nbsp;performs.&nbsp;The&nbsp;&nbsp;default&nbsp;is&nbsp;8192.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line631"></a><div class='linenum'>631</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line632"></a><div class='linenum'>632</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;option&nbsp;`quiet'&nbsp;makes&nbsp;the&nbsp;function&nbsp;return&nbsp;even&nbsp;if&nbsp;the&nbsp;`rho'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line633"></a><div class='linenum'>633</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;factorization&nbsp;failed&nbsp;and&nbsp;return&nbsp;the&nbsp;factorization&nbsp;found&nbsp;so&nbsp;far.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line634"></a><div class='linenum'>634</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line635"></a><div class='linenum'>635</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(FactorsInt,function&nbsp;(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line636"></a><div class='linenum'>636</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line637"></a><div class='linenum'>637</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;sign,&nbsp;&nbsp;factors,&nbsp;&nbsp;p,&nbsp;&nbsp;tmp,&nbsp;n_orig,&nbsp;len,&nbsp;rt,&nbsp;tmp2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line638"></a><div class='linenum'>638</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line639"></a><div class='linenum'>639</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n_orig&nbsp;:=&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line640"></a><div class='linenum'>640</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line641"></a><div class='linenum'>641</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;$n$&nbsp;positive&nbsp;and&nbsp;handle&nbsp;trivial&nbsp;cases
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line642"></a><div class='linenum'>642</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sign&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line643"></a><div class='linenum'>643</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then&nbsp;sign&nbsp;:=&nbsp;-sign;&nbsp;&nbsp;n&nbsp;:=&nbsp;-n;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line644"></a><div class='linenum'>644</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;4&nbsp;&nbsp;then&nbsp;return&nbsp;[&nbsp;sign&nbsp;*&nbsp;n&nbsp;];&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line645"></a><div class='linenum'>645</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line646"></a><div class='linenum'>646</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line647"></a><div class='linenum'>647</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;the&nbsp;primes&nbsp;less&nbsp;than&nbsp;1000
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line648"></a><div class='linenum'>648</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;faster&nbsp;than&nbsp;anything&nbsp;fancier&nbsp;because&nbsp;$n$&nbsp;mod&nbsp;&lt;small&nbsp;int>&nbsp;is&nbsp;very&nbsp;fast
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line649"></a><div class='linenum'>649</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;&nbsp;in&nbsp;Primes&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line650"></a><div class='linenum'>650</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;&nbsp;do&nbsp;Add(&nbsp;factors,&nbsp;p&nbsp;);&nbsp;&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;p;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line651"></a><div class='linenum'>651</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;(p+1)^2&nbsp;and&nbsp;1&nbsp;&lt;&nbsp;n&nbsp;&nbsp;then&nbsp;Add(factors,n);&nbsp;&nbsp;n&nbsp;:=&nbsp;1;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line652"></a><div class='linenum'>652</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;&nbsp;then&nbsp;factors[1]&nbsp;:=&nbsp;sign*factors[1];&nbsp;&nbsp;return&nbsp;factors;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line653"></a><div class='linenum'>653</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line654"></a><div class='linenum'>654</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line655"></a><div class='linenum'>655</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;known&nbsp;primes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line656"></a><div class='linenum'>656</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;&nbsp;in&nbsp;Primes2&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line657"></a><div class='linenum'>657</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;&nbsp;do&nbsp;Add(&nbsp;factors,&nbsp;p&nbsp;);&nbsp;&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;p;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line658"></a><div class='linenum'>658</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p^2&nbsp;>&nbsp;n&nbsp;then&nbsp;break;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line659"></a><div class='linenum'>659</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;&nbsp;then&nbsp;factors[1]&nbsp;:=&nbsp;sign*factors[1];&nbsp;&nbsp;return&nbsp;factors;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line660"></a><div class='linenum'>660</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line661"></a><div class='linenum'>661</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line662"></a><div class='linenum'>662</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;known&nbsp;probable&nbsp;primes&nbsp;(and&nbsp;issue&nbsp;warning,&nbsp;if&nbsp;found)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line663"></a><div class='linenum'>663</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line664"></a><div class='linenum'>664</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;&nbsp;in&nbsp;ProbablePrimes2&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line665"></a><div class='linenum'>665</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;&nbsp;do&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line666"></a><div class='linenum'>666</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(tmp,&nbsp;p);&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line667"></a><div class='linenum'>667</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;factors,&nbsp;p&nbsp;);&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line668"></a><div class='linenum'>668</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;p;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line669"></a><div class='linenum'>669</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line670"></a><div class='linenum'>670</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;&nbsp;then&nbsp;break;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line671"></a><div class='linenum'>671</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line672"></a><div class='linenum'>672</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(tmp)&nbsp;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line673"></a><div class='linenum'>673</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoPrimeInt,&nbsp;1&nbsp;,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line674"></a><div class='linenum'>674</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"FactorsInt:&nbsp;used&nbsp;the&nbsp;following&nbsp;factor(s)&nbsp;which&nbsp;are&nbsp;probably&nbsp;primes:");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line675"></a><div class='linenum'>675</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;in&nbsp;tmp&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line676"></a><div class='linenum'>676</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoPrimeInt,&nbsp;1,&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",&nbsp;p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line677"></a><div class='linenum'>677</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line678"></a><div class='linenum'>678</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line679"></a><div class='linenum'>679</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;&nbsp;then&nbsp;factors[1]&nbsp;:=&nbsp;sign*factors[1];&nbsp;&nbsp;return&nbsp;factors;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line680"></a><div class='linenum'>680</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line681"></a><div class='linenum'>681</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line682"></a><div class='linenum'>682</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;perfect&nbsp;powers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line683"></a><div class='linenum'>683</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;SmallestRootInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line684"></a><div class='linenum'>684</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p&nbsp;&lt;&nbsp;n&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line685"></a><div class='linenum'>685</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;1&nbsp;&lt;&nbsp;n&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line686"></a><div class='linenum'>686</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;factors,&nbsp;FactorsInt(p)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line687"></a><div class='linenum'>687</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line688"></a><div class='linenum'>688</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line689"></a><div class='linenum'>689</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sort(&nbsp;factors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line690"></a><div class='linenum'>690</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factors[1]&nbsp;:=&nbsp;sign&nbsp;*&nbsp;factors[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line691"></a><div class='linenum'>691</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;factors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line692"></a><div class='linenum'>692</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line693"></a><div class='linenum'>693</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line694"></a><div class='linenum'>694</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;let&nbsp;`FactorsRho'&nbsp;do&nbsp;the&nbsp;work
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line695"></a><div class='linenum'>695</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ValueOption("RhoTrials")&nbsp;&lt;>&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line696"></a><div class='linenum'>696</div></td><td></td><td></td><td></td><td><span><tt>	tmp&nbsp;:=&nbsp;FactorsRho(&nbsp;n,&nbsp;1,&nbsp;16,&nbsp;&nbsp;ValueOption("RhoTrials")&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line697"></a><div class='linenum'>697</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line698"></a><div class='linenum'>698</div></td><td></td><td></td><td></td><td><span><tt>	tmp&nbsp;:=&nbsp;FactorsRho(&nbsp;n,&nbsp;1,&nbsp;16,&nbsp;8192&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line699"></a><div class='linenum'>699</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line700"></a><div class='linenum'>700</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;&nbsp;Length(tmp[2])&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line701"></a><div class='linenum'>701</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ValueOption("quiet")&lt;>true&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line702"></a><div class='linenum'>702</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;:=&nbsp;Length(tmp[2]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line703"></a><div class='linenum'>703</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;LoadPackage("FactInt")&nbsp;=&nbsp;true&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line704"></a><div class='linenum'>704</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;in&nbsp;general&nbsp;cases&nbsp;we&nbsp;should&nbsp;proceed&nbsp;with&nbsp;the&nbsp;found&nbsp;factors:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line705"></a><div class='linenum'>705</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;len&nbsp;>&nbsp;0&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line706"></a><div class='linenum'>706</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(tmp[1],&nbsp;Factors(tmp[2][len]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line707"></a><div class='linenum'>707</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unbind(tmp[2][len]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line708"></a><div class='linenum'>708</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;:=&nbsp;len-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line709"></a><div class='linenum'>709</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line710"></a><div class='linenum'>710</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;but&nbsp;this&nbsp;way&nbsp;we&nbsp;miss&nbsp;that&nbsp;FactInt&nbsp;can&nbsp;detect&nbsp;certain&nbsp;numbers&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line711"></a><div class='linenum'>711</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;special&nbsp;shape&nbsp;for&nbsp;which&nbsp;it&nbsp;uses&nbsp;lookup&nbsp;tables,&nbsp;therefore&nbsp;for&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line712"></a><div class='linenum'>712</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;moment:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line713"></a><div class='linenum'>713</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Factors(n_orig);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line714"></a><div class='linenum'>714</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line715"></a><div class='linenum'>715</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"sorry,&nbsp;&nbsp;cannot&nbsp;factor&nbsp;",&nbsp;tmp[2],&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line716"></a><div class='linenum'>716</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\ntype&nbsp;'return;'&nbsp;to&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;larger&nbsp;number&nbsp;of&nbsp;trials&nbsp;in\n",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line717"></a><div class='linenum'>717</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"FactorsRho&nbsp;(or&nbsp;use&nbsp;option&nbsp;'RhoTrials')\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line718"></a><div class='linenum'>718</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ValueOption("RhoTrials")&nbsp;&lt;>&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line719"></a><div class='linenum'>719</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rt&nbsp;:=&nbsp;5&nbsp;*&nbsp;ValueOption("RhoTrials");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line720"></a><div class='linenum'>720</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line721"></a><div class='linenum'>721</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rt&nbsp;:=&nbsp;5&nbsp;*&nbsp;8192;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line722"></a><div class='linenum'>722</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line723"></a><div class='linenum'>723</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;len&nbsp;>&nbsp;0&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line724"></a><div class='linenum'>724</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp2&nbsp;:=&nbsp;FactorsInt(tmp[2][len]:&nbsp;RhoTrials&nbsp;:=&nbsp;rt);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line725"></a><div class='linenum'>725</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(tmp[1],&nbsp;tmp2);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line726"></a><div class='linenum'>726</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unbind(tmp[2][len]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line727"></a><div class='linenum'>727</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;:=&nbsp;len-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line728"></a><div class='linenum'>728</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line729"></a><div class='linenum'>729</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line730"></a><div class='linenum'>730</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line731"></a><div class='linenum'>731</div></td><td></td><td></td><td></td><td><span><tt>	factors&nbsp;:=&nbsp;Concatenation(&nbsp;factors,&nbsp;tmp[2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line732"></a><div class='linenum'>732</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line733"></a><div class='linenum'>733</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line734"></a><div class='linenum'>734</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;:=&nbsp;Concatenation(&nbsp;factors,&nbsp;tmp[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line735"></a><div class='linenum'>735</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Sort(&nbsp;factors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line736"></a><div class='linenum'>736</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;factors[1]&nbsp;:=&nbsp;sign&nbsp;*&nbsp;factors[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line737"></a><div class='linenum'>737</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;factors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line738"></a><div class='linenum'>738</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line739"></a><div class='linenum'>739</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line740"></a><div class='linenum'>740</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line741"></a><div class='linenum'>741</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line742"></a><div class='linenum'>742</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line743"></a><div class='linenum'>743</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;PrimeDivisors(&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;list&nbsp;of&nbsp;prime&nbsp;divisors
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line744"></a><div class='linenum'>744</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line745"></a><div class='linenum'>745</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;delegating&nbsp;to&nbsp;FactorsInt
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line746"></a><div class='linenum'>746</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line747"></a><div class='linenum'>747</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PrimeDivisors,&nbsp;"for&nbsp;integer",&nbsp;[&nbsp;IsInt&nbsp;],&nbsp;function(n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line748"></a><div class='linenum'>748</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line749"></a><div class='linenum'>749</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("PrimeDivisors:&nbsp;0&nbsp;has&nbsp;an&nbsp;infinite&nbsp;number&nbsp;of&nbsp;prime&nbsp;divisors.");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line750"></a><div class='linenum'>750</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line751"></a><div class='linenum'>751</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line752"></a><div class='linenum'>752</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line753"></a><div class='linenum'>753</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;-n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line754"></a><div class='linenum'>754</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line755"></a><div class='linenum'>755</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line756"></a><div class='linenum'>756</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line757"></a><div class='linenum'>757</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line758"></a><div class='linenum'>758</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Set(FactorsInt(n));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line759"></a><div class='linenum'>759</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line760"></a><div class='linenum'>760</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line761"></a><div class='linenum'>761</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line762"></a><div class='linenum'>762</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line763"></a><div class='linenum'>763</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line764"></a><div class='linenum'>764</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PartialFactorization(&nbsp;&lt;n>,&nbsp;&lt;effort>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;generic&nbsp;method
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line765"></a><div class='linenum'>765</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line766"></a><div class='linenum'>766</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PartialFactorization,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line767"></a><div class='linenum'>767</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method",&nbsp;true,&nbsp;[&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line768"></a><div class='linenum'>768</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line769"></a><div class='linenum'>769</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;function&nbsp;(&nbsp;n,&nbsp;effort&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line770"></a><div class='linenum'>770</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line771"></a><div class='linenum'>771</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;N,&nbsp;sign,&nbsp;factors,&nbsp;p,&nbsp;k,&nbsp;root,&nbsp;rootfactors,&nbsp;rhotrials,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line772"></a><div class='linenum'>772</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp,&nbsp;CheckAndSortFactors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line773"></a><div class='linenum'>773</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line774"></a><div class='linenum'>774</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;CheckAndSortFactors&nbsp;:=&nbsp;function&nbsp;(&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line775"></a><div class='linenum'>775</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;SortedList(factors);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line776"></a><div class='linenum'>776</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factors[1]&nbsp;:=&nbsp;sign*factors[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line777"></a><div class='linenum'>777</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;Product(factors)&nbsp;&lt;>&nbsp;N
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line778"></a><div class='linenum'>778</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;Error("PartialFactorization:&nbsp;Internal&nbsp;error,&nbsp;wrong&nbsp;result!");&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line779"></a><div class='linenum'>779</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line780"></a><div class='linenum'>780</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line781"></a><div class='linenum'>781</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;:=&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line782"></a><div class='linenum'>782</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;effort&nbsp;&lt;&nbsp;0&nbsp;then&nbsp;effort&nbsp;:=&nbsp;5;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line783"></a><div class='linenum'>783</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line784"></a><div class='linenum'>784</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;$n$&nbsp;positive&nbsp;and&nbsp;handle&nbsp;trivial&nbsp;cases
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line785"></a><div class='linenum'>785</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sign&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line786"></a><div class='linenum'>786</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then&nbsp;sign&nbsp;:=&nbsp;-sign;&nbsp;&nbsp;n&nbsp;:=&nbsp;-n;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line787"></a><div class='linenum'>787</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;4&nbsp;&nbsp;then&nbsp;return&nbsp;[&nbsp;sign&nbsp;*&nbsp;n&nbsp;];&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line788"></a><div class='linenum'>788</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line789"></a><div class='linenum'>789</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line790"></a><div class='linenum'>790</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;least&nbsp;effort:&nbsp;do&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;the&nbsp;primes&nbsp;less&nbsp;than&nbsp;100
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line791"></a><div class='linenum'>791</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;effort&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line792"></a><div class='linenum'>792</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;in&nbsp;Primes{[1..25]}&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line793"></a><div class='linenum'>793</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;do&nbsp;Add(&nbsp;factors,&nbsp;p&nbsp;);&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;p;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line794"></a><div class='linenum'>794</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;(p+1)^2&nbsp;and&nbsp;1&nbsp;&lt;&nbsp;n&nbsp;then&nbsp;Add(factors,n);&nbsp;n&nbsp;:=&nbsp;1;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line795"></a><div class='linenum'>795</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then&nbsp;CheckAndSortFactors();&nbsp;return&nbsp;factors;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line796"></a><div class='linenum'>796</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line797"></a><div class='linenum'>797</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(factors,n);&nbsp;CheckAndSortFactors();&nbsp;return&nbsp;factors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line798"></a><div class='linenum'>798</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line799"></a><div class='linenum'>799</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line800"></a><div class='linenum'>800</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;the&nbsp;primes&nbsp;less&nbsp;than&nbsp;1000
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line801"></a><div class='linenum'>801</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;faster&nbsp;than&nbsp;anything&nbsp;fancier&nbsp;because&nbsp;$n$&nbsp;mod&nbsp;&lt;small&nbsp;int>&nbsp;is&nbsp;very&nbsp;fast
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line802"></a><div class='linenum'>802</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;in&nbsp;Primes&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line803"></a><div class='linenum'>803</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;do&nbsp;Add(&nbsp;factors,&nbsp;p&nbsp;);&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;p;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line804"></a><div class='linenum'>804</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;(p+1)^2&nbsp;and&nbsp;1&nbsp;&lt;&nbsp;n&nbsp;then&nbsp;Add(factors,n);&nbsp;&nbsp;n&nbsp;:=&nbsp;1;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line805"></a><div class='linenum'>805</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then&nbsp;CheckAndSortFactors();&nbsp;return&nbsp;factors;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line806"></a><div class='linenum'>806</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line807"></a><div class='linenum'>807</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line808"></a><div class='linenum'>808</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;effort&nbsp;&lt;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line809"></a><div class='linenum'>809</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(factors,n);&nbsp;CheckAndSortFactors();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line810"></a><div class='linenum'>810</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;factors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line811"></a><div class='linenum'>811</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line812"></a><div class='linenum'>812</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line813"></a><div class='linenum'>813</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;known&nbsp;primes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line814"></a><div class='linenum'>814</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;in&nbsp;Primes2&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line815"></a><div class='linenum'>815</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;do&nbsp;Add(&nbsp;factors,&nbsp;p&nbsp;);&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;p;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line816"></a><div class='linenum'>816</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then&nbsp;CheckAndSortFactors();&nbsp;return&nbsp;factors;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line817"></a><div class='linenum'>817</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line818"></a><div class='linenum'>818</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line819"></a><div class='linenum'>819</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;known&nbsp;probable&nbsp;primes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line820"></a><div class='linenum'>820</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line821"></a><div class='linenum'>821</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;in&nbsp;ProbablePrimes2&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line822"></a><div class='linenum'>822</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;do&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line823"></a><div class='linenum'>823</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(tmp,&nbsp;p);&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line824"></a><div class='linenum'>824</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;factors,&nbsp;p&nbsp;);&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line825"></a><div class='linenum'>825</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;n&nbsp;/&nbsp;p;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line826"></a><div class='linenum'>826</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line827"></a><div class='linenum'>827</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then&nbsp;break;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line828"></a><div class='linenum'>828</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line829"></a><div class='linenum'>829</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line830"></a><div class='linenum'>830</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then&nbsp;CheckAndSortFactors();&nbsp;return&nbsp;factors;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line831"></a><div class='linenum'>831</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line832"></a><div class='linenum'>832</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;perfect&nbsp;powers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line833"></a><div class='linenum'>833</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;:=&nbsp;SmallestRootInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line834"></a><div class='linenum'>834</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;root&nbsp;&lt;&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line835"></a><div class='linenum'>835</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootfactors&nbsp;:=&nbsp;PartialFactorization(root,effort);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line836"></a><div class='linenum'>836</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;LogInt(n,root);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line837"></a><div class='linenum'>837</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootfactors&nbsp;:=&nbsp;Concatenation(List([1..k],i->rootfactors));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line838"></a><div class='linenum'>838</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;SortedList(Concatenation(factors,rootfactors));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line839"></a><div class='linenum'>839</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckAndSortFactors();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line840"></a><div class='linenum'>840</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;factors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line841"></a><div class='linenum'>841</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line842"></a><div class='linenum'>842</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line843"></a><div class='linenum'>843</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;effort&nbsp;=&nbsp;2&nbsp;or&nbsp;IsProbablyPrimeInt(n)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line844"></a><div class='linenum'>844</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(factors,n);&nbsp;CheckAndSortFactors();&nbsp;return&nbsp;factors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line845"></a><div class='linenum'>845</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line846"></a><div class='linenum'>846</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line847"></a><div class='linenum'>847</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;effort&nbsp;>=&nbsp;3,&nbsp;use&nbsp;`FactorsRho'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line848"></a><div class='linenum'>848</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ValueOption("RhoTrials")&nbsp;&lt;>&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line849"></a><div class='linenum'>849</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;:=&nbsp;FactorsRho(n,1,16,ValueOption("RhoTrials"):
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line850"></a><div class='linenum'>850</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UseProbabilisticPrimalityTest);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line851"></a><div class='linenum'>851</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line852"></a><div class='linenum'>852</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;effort&nbsp;&nbsp;=&nbsp;3&nbsp;then&nbsp;rhotrials&nbsp;:=&nbsp;256;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line853"></a><div class='linenum'>853</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;effort&nbsp;&nbsp;=&nbsp;4&nbsp;then&nbsp;rhotrials&nbsp;:=&nbsp;2048;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line854"></a><div class='linenum'>854</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;effort&nbsp;>=&nbsp;5&nbsp;then&nbsp;rhotrials&nbsp;:=&nbsp;8192;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line855"></a><div class='linenum'>855</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;:=&nbsp;FactorsRho(n,1,16,rhotrials:UseProbabilisticPrimalityTest);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line856"></a><div class='linenum'>856</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line857"></a><div class='linenum'>857</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;factors&nbsp;:=&nbsp;SortedList(Concatenation(factors,tmp[1],tmp[2]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line858"></a><div class='linenum'>858</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;CheckAndSortFactors();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line859"></a><div class='linenum'>859</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;factors;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line860"></a><div class='linenum'>860</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line861"></a><div class='linenum'>861</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line862"></a><div class='linenum'>862</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line863"></a><div class='linenum'>863</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line864"></a><div class='linenum'>864</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line865"></a><div class='linenum'>865</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PartialFactorization(&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;partial&nbsp;factorization&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line866"></a><div class='linenum'>866</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line867"></a><div class='linenum'>867</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;PartialFactorization,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line868"></a><div class='linenum'>868</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",&nbsp;true,&nbsp;[&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line869"></a><div class='linenum'>869</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;->&nbsp;PartialFactorization(n,5)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line870"></a><div class='linenum'>870</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line871"></a><div class='linenum'>871</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line872"></a><div class='linenum'>872</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line873"></a><div class='linenum'>873</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line874"></a><div class='linenum'>874</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;Gcdex(&nbsp;&lt;m>,&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;greatest&nbsp;common&nbsp;divisor&nbsp;of&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line875"></a><div class='linenum'>875</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line876"></a><div class='linenum'>876</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(Gcdex,function&nbsp;(&nbsp;m,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line877"></a><div class='linenum'>877</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;f,&nbsp;g,&nbsp;h,&nbsp;fm,&nbsp;gm,&nbsp;hm,&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line878"></a><div class='linenum'>878</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;=&nbsp;m&nbsp;&nbsp;then&nbsp;f:=m;&nbsp;fm:=1;&nbsp;else&nbsp;f:=-m;&nbsp;fm:=-1;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line879"></a><div class='linenum'>879</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;=&nbsp;n&nbsp;&nbsp;then&nbsp;g:=n;&nbsp;gm:=0;&nbsp;else&nbsp;g:=-n;&nbsp;gm:=0;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line880"></a><div class='linenum'>880</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;g&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line881"></a><div class='linenum'>881</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;:=&nbsp;QuoInt(&nbsp;f,&nbsp;g&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line882"></a><div class='linenum'>882</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;:=&nbsp;g;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hm&nbsp;:=&nbsp;gm;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line883"></a><div class='linenum'>883</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;:=&nbsp;f&nbsp;-&nbsp;q&nbsp;*&nbsp;g;&nbsp;&nbsp;gm&nbsp;:=&nbsp;fm&nbsp;-&nbsp;q&nbsp;*&nbsp;gm;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line884"></a><div class='linenum'>884</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;h;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fm&nbsp;:=&nbsp;hm;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line885"></a><div class='linenum'>885</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line886"></a><div class='linenum'>886</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line887"></a><div class='linenum'>887</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;gcd&nbsp;:=&nbsp;f,&nbsp;coeff1&nbsp;:=&nbsp;fm,&nbsp;coeff2&nbsp;:=&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line888"></a><div class='linenum'>888</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coeff3&nbsp;:=&nbsp;gm,&nbsp;coeff4&nbsp;:=&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line889"></a><div class='linenum'>889</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line890"></a><div class='linenum'>890</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;gcd&nbsp;:=&nbsp;f,&nbsp;coeff1&nbsp;:=&nbsp;fm,&nbsp;coeff2&nbsp;:=&nbsp;(f&nbsp;-&nbsp;fm&nbsp;*&nbsp;m)&nbsp;/&nbsp;n,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line891"></a><div class='linenum'>891</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coeff3&nbsp;:=&nbsp;gm,&nbsp;coeff4&nbsp;:=&nbsp;(0&nbsp;-&nbsp;gm&nbsp;*&nbsp;m)&nbsp;/&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line892"></a><div class='linenum'>892</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line893"></a><div class='linenum'>893</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line894"></a><div class='linenum'>894</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line895"></a><div class='linenum'>895</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line896"></a><div class='linenum'>896</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line897"></a><div class='linenum'>897</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line898"></a><div class='linenum'>898</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IsEvenInt(&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;test&nbsp;if&nbsp;&lt;n>&nbsp;is&nbsp;even
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line899"></a><div class='linenum'>899</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line900"></a><div class='linenum'>900</div></td><td>8609</td><td>7525</td><td>7525</td><td><span><tt>InstallGlobalFunction(&nbsp;IsEvenInt,&nbsp;n&nbsp;->&nbsp;n&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line901"></a><div class='linenum'>901</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line902"></a><div class='linenum'>902</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line903"></a><div class='linenum'>903</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line904"></a><div class='linenum'>904</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line905"></a><div class='linenum'>905</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IsOddInt(&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;test&nbsp;if&nbsp;&lt;n>&nbsp;is&nbsp;odd
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line906"></a><div class='linenum'>906</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line907"></a><div class='linenum'>907</div></td><td>845844</td><td>648340</td><td>648340</td><td><span><tt>InstallGlobalFunction(&nbsp;IsOddInt,&nbsp;n&nbsp;->&nbsp;n&nbsp;mod&nbsp;2&nbsp;=&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line908"></a><div class='linenum'>908</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line909"></a><div class='linenum'>909</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line910"></a><div class='linenum'>910</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line911"></a><div class='linenum'>911</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line912"></a><div class='linenum'>912</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IsPrimeInt(&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;test&nbsp;for&nbsp;a&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line913"></a><div class='linenum'>913</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line914"></a><div class='linenum'>914</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`IsPrimeInt'&nbsp;does&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;the&nbsp;primes&nbsp;less&nbsp;&nbsp;than&nbsp;1000&nbsp;to&nbsp;detect
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line915"></a><div class='linenum'>915</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;composites&nbsp;with&nbsp;a&nbsp;factor&nbsp;less&nbsp;than&nbsp;1000&nbsp;and&nbsp;&nbsp;primes&nbsp;&nbsp;less&nbsp;&nbsp;than&nbsp;&nbsp;1000000.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line916"></a><div class='linenum'>916</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line917"></a><div class='linenum'>917</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`IsPrimeInt'&nbsp;then&nbsp;checks&nbsp;that&nbsp;$n$&nbsp;is&nbsp;a&nbsp;strong&nbsp;pseudoprime&nbsp;to&nbsp;the&nbsp;&nbsp;base&nbsp;2.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line918"></a><div class='linenum'>918</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;uses&nbsp;Fermats&nbsp;theorem&nbsp;which&nbsp;says&nbsp;$2^{n-1}=1$&nbsp;mod&nbsp;$n$&nbsp;for&nbsp;a&nbsp;prime&nbsp;$n$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line919"></a><div class='linenum'>919</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;If&nbsp;$2^{n-1}\&lt;>1$&nbsp;mod&nbsp;$n$,&nbsp;$n$&nbsp;is&nbsp;composite,&nbsp;`IsPrimeInt'&nbsp;returns&nbsp;`false'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line920"></a><div class='linenum'>920</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;There&nbsp;are&nbsp;composite&nbsp;numbers&nbsp;for&nbsp;which&nbsp;$2^{n-1}=1$,&nbsp;&nbsp;but&nbsp;they&nbsp;are&nbsp;&nbsp;seldom.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line921"></a><div class='linenum'>921</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line922"></a><div class='linenum'>922</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Then&nbsp;`IsPrimeInt'&nbsp;checks&nbsp;that&nbsp;$n$&nbsp;is&nbsp;a&nbsp;Lucas&nbsp;pseudoprime&nbsp;for&nbsp;$p$,&nbsp;choosen
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line923"></a><div class='linenum'>923</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;so&nbsp;that&nbsp;the&nbsp;discriminant&nbsp;$d=p^2/4-1$&nbsp;is&nbsp;an&nbsp;&nbsp;quadratic&nbsp;nonresidue&nbsp;mod&nbsp;$n$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line924"></a><div class='linenum'>924</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;I.e.,&nbsp;`IsPrimeInt'&nbsp;takes&nbsp;the&nbsp;root&nbsp;$a&nbsp;=&nbsp;p/2+\sqrt{d}$&nbsp;of&nbsp;$x^2&nbsp;-&nbsp;px&nbsp;+&nbsp;1$&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line925"></a><div class='linenum'>925</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;the&nbsp;&nbsp;ring&nbsp;$Z_n[\sqrt{d}]&nbsp;and&nbsp;computes&nbsp;the&nbsp;&nbsp;traces&nbsp;of&nbsp;$a^n$&nbsp;and&nbsp;$a^{n+1}$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line926"></a><div class='linenum'>926</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;If&nbsp;$n$&nbsp;is&nbsp;a&nbsp;prime,&nbsp;this&nbsp;&nbsp;ring&nbsp;is&nbsp;the&nbsp;field&nbsp;of&nbsp;&nbsp;order&nbsp;$n^2$&nbsp;and&nbsp;raising&nbsp;to
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line927"></a><div class='linenum'>927</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;the&nbsp;$n$th&nbsp;power&nbsp;is&nbsp;conjugation,&nbsp;so&nbsp;$trace(a^n)=p$&nbsp;and&nbsp;$trace(a^{n+1})=2$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line928"></a><div class='linenum'>928</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;However,&nbsp;these&nbsp;identities&nbsp;hold&nbsp;only&nbsp;for&nbsp;extremely&nbsp;few&nbsp;composite&nbsp;numbers.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line929"></a><div class='linenum'>929</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line930"></a><div class='linenum'>930</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Note&nbsp;that&nbsp;&nbsp;this&nbsp;&nbsp;test&nbsp;&nbsp;for&nbsp;$trace(a^n)&nbsp;=&nbsp;p$&nbsp;&nbsp;and&nbsp;&nbsp;$trace(a^{n+1})&nbsp;=&nbsp;2$&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line931"></a><div class='linenum'>931</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;usually&nbsp;formulated&nbsp;using&nbsp;the&nbsp;Lucas&nbsp;sequences&nbsp;&nbsp;$U_k&nbsp;=&nbsp;(a^k-b^k)/(a-b)$&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line932"></a><div class='linenum'>932</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$V_k&nbsp;=&nbsp;(a^k+b^k)=trace(a^k)$,&nbsp;where&nbsp;one&nbsp;tests&nbsp;$U_{n+1}&nbsp;=&nbsp;0,&nbsp;V_{n+1}&nbsp;=&nbsp;2$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line933"></a><div class='linenum'>933</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;However,&nbsp;the&nbsp;trace&nbsp;test&nbsp;is&nbsp;equivalent&nbsp;and&nbsp;requires&nbsp;fewer&nbsp;multiplications.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line934"></a><div class='linenum'>934</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Thanks&nbsp;to&nbsp;Daniel&nbsp;R.&nbsp;Grayson&nbsp;(dan@symcom.math.uiuc.edu)&nbsp;&nbsp;for&nbsp;&nbsp;telling&nbsp;&nbsp;me.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line935"></a><div class='linenum'>935</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line936"></a><div class='linenum'>936</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`IsPrimeInt'&nbsp;can&nbsp;be&nbsp;shown&nbsp;to&nbsp;return&nbsp;the&nbsp;correct&nbsp;answer&nbsp;for&nbsp;$n&nbsp;&lt;&nbsp;10^{13}$,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line937"></a><div class='linenum'>937</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;by&nbsp;testing&nbsp;against&nbsp;R.G.E.&nbsp;Pinch's&nbsp;list&nbsp;of&nbsp;all&nbsp;pseudoprimes&nbsp;to&nbsp;base&nbsp;2&nbsp;less
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line938"></a><div class='linenum'>938</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;than&nbsp;$10^{13}$&nbsp;('ftp://dpmms.cam.ac.uk/pub/rgep/PSP/psp13.gz').
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line939"></a><div class='linenum'>939</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line940"></a><div class='linenum'>940</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Better&nbsp;descriptions&nbsp;of&nbsp;the&nbsp;algorithm&nbsp;and&nbsp;related&nbsp;topics&nbsp;can&nbsp;be&nbsp;found&nbsp;&nbsp;in:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line941"></a><div class='linenum'>941</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;G.&nbsp;Miller,&nbsp;cf.&nbsp;Algorithms&nbsp;and&nbsp;Complexity&nbsp;ed.&nbsp;Traub,&nbsp;AcademPr,&nbsp;1976,&nbsp;35-36
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line942"></a><div class='linenum'>942</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;C.&nbsp;Pomerance&nbsp;et.al.,&nbsp;Pseudoprimes&nbsp;to&nbsp;25*10^9,&nbsp;MathComp&nbsp;35&nbsp;1980,&nbsp;1003-1026
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line943"></a><div class='linenum'>943</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;D.&nbsp;Knuth,&nbsp;Seminumerical&nbsp;Algorithms&nbsp;&nbsp;(TACP&nbsp;II),&nbsp;&nbsp;AddiWesl,&nbsp;&nbsp;1973,&nbsp;&nbsp;378-380
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line944"></a><div class='linenum'>944</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;G.&nbsp;Gonnet,&nbsp;Heuristic&nbsp;Primality&nbsp;Testing,&nbsp;Maple&nbsp;Newsletter&nbsp;4,&nbsp;&nbsp;1989,&nbsp;&nbsp;36-38
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line945"></a><div class='linenum'>945</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;R.&nbsp;Baillie,&nbsp;S.&nbsp;Wagstaff,&nbsp;Lucas&nbsp;Pseudoprimes,&nbsp;MathComp&nbsp;35&nbsp;1980,&nbsp;&nbsp;1391-1417
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line946"></a><div class='linenum'>946</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;R.&nbsp;Pinch,&nbsp;Some&nbsp;Primality&nbsp;Testing&nbsp;Algorithms,&nbsp;Notic.&nbsp;AMS&nbsp;9&nbsp;1993,&nbsp;1203-1210
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line947"></a><div class='linenum'>947</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line948"></a><div class='linenum'>948</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;a&nbsp;non-recursive&nbsp;version,&nbsp;&nbsp;nowadays&nbsp;the&nbsp;algorithm&nbsp;can&nbsp;be&nbsp;applied&nbsp;to
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line949"></a><div class='linenum'>949</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;numbers&nbsp;with&nbsp;many&nbsp;thousand&nbsp;digits
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line950"></a><div class='linenum'>950</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(TraceModQF,&nbsp;function&nbsp;(&nbsp;p,&nbsp;k,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line951"></a><div class='linenum'>951</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;kb,&nbsp;trc,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line952"></a><div class='linenum'>952</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;kb&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line953"></a><div class='linenum'>953</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;k&nbsp;&lt;>&nbsp;1&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line954"></a><div class='linenum'>954</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line955"></a><div class='linenum'>955</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;k/2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line956"></a><div class='linenum'>956</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(kb,&nbsp;0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line957"></a><div class='linenum'>957</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line958"></a><div class='linenum'>958</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;(k+1)/2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line959"></a><div class='linenum'>959</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(kb,&nbsp;1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line960"></a><div class='linenum'>960</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line961"></a><div class='linenum'>961</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line962"></a><div class='linenum'>962</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;trc&nbsp;:=&nbsp;[p,&nbsp;2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line963"></a><div class='linenum'>963</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;i&nbsp;:=&nbsp;Length(kb);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line964"></a><div class='linenum'>964</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;i&nbsp;>=&nbsp;1&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line965"></a><div class='linenum'>965</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;kb[i]&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line966"></a><div class='linenum'>966</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trc&nbsp;:=&nbsp;[&nbsp;(trc[1]^2&nbsp;-&nbsp;2)&nbsp;mod&nbsp;n,&nbsp;(trc[1]*trc[2]&nbsp;-&nbsp;p)&nbsp;mod&nbsp;n&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line967"></a><div class='linenum'>967</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line968"></a><div class='linenum'>968</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trc&nbsp;:=&nbsp;[&nbsp;(trc[1]*trc[2]&nbsp;-&nbsp;p)&nbsp;mod&nbsp;n,&nbsp;(trc[2]^2&nbsp;-&nbsp;2)&nbsp;mod&nbsp;n&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line969"></a><div class='linenum'>969</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line970"></a><div class='linenum'>970</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line971"></a><div class='linenum'>971</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line972"></a><div class='linenum'>972</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;trc;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line973"></a><div class='linenum'>973</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line974"></a><div class='linenum'>974</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line975"></a><div class='linenum'>975</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;returns&nbsp;`false'&nbsp;for&nbsp;proven&nbsp;composite,&nbsp;`true'&nbsp;for&nbsp;proven&nbsp;prime&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line976"></a><div class='linenum'>976</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`fail'&nbsp;for&nbsp;probable&nbsp;prime.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line977"></a><div class='linenum'>977</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal(&nbsp;"IsProbablyPrimeIntWithFail",&nbsp;function(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line978"></a><div class='linenum'>978</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;p,&nbsp;e,&nbsp;o,&nbsp;x,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line979"></a><div class='linenum'>979</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line980"></a><div class='linenum'>980</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;$n$&nbsp;positive&nbsp;and&nbsp;handle&nbsp;trivial&nbsp;cases
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line981"></a><div class='linenum'>981</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;-n;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line982"></a><div class='linenum'>982</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;in&nbsp;Primes&nbsp;&nbsp;&nbsp;then&nbsp;return&nbsp;true;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line983"></a><div class='linenum'>983</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;in&nbsp;Primes2&nbsp;&nbsp;then&nbsp;return&nbsp;true;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line984"></a><div class='linenum'>984</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;in&nbsp;ProbablePrimes2&nbsp;&nbsp;then&nbsp;return&nbsp;fail;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line985"></a><div class='linenum'>985</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;=&nbsp;1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;return&nbsp;false;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line986"></a><div class='linenum'>986</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line987"></a><div class='linenum'>987</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;divisions&nbsp;by&nbsp;the&nbsp;primes&nbsp;less&nbsp;than&nbsp;1000
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line988"></a><div class='linenum'>988</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;faster&nbsp;than&nbsp;anything&nbsp;fancier&nbsp;because&nbsp;$n$&nbsp;mod&nbsp;&lt;small&nbsp;int>&nbsp;is&nbsp;very&nbsp;fast
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line989"></a><div class='linenum'>989</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;&nbsp;in&nbsp;Primes&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line990"></a><div class='linenum'>990</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;&nbsp;then&nbsp;return&nbsp;false;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line991"></a><div class='linenum'>991</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;(p+1)^2&nbsp;&nbsp;then&nbsp;AddSet(&nbsp;Primes2,&nbsp;n&nbsp;);&nbsp;&nbsp;return&nbsp;true;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line992"></a><div class='linenum'>992</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line993"></a><div class='linenum'>993</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line994"></a><div class='linenum'>994</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;division&nbsp;by&nbsp;the&nbsp;other&nbsp;known&nbsp;primes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line995"></a><div class='linenum'>995</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;&nbsp;in&nbsp;Primes2&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line996"></a><div class='linenum'>996</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;&nbsp;then&nbsp;return&nbsp;false;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line997"></a><div class='linenum'>997</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line998"></a><div class='linenum'>998</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;trial&nbsp;division&nbsp;by&nbsp;the&nbsp;other&nbsp;known&nbsp;probable&nbsp;primes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line999"></a><div class='linenum'>999</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;&nbsp;in&nbsp;ProbablePrimes2&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1000"></a><div class='linenum'>1000</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;&nbsp;then&nbsp;return&nbsp;false;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1001"></a><div class='linenum'>1001</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1002"></a><div class='linenum'>1002</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1003"></a><div class='linenum'>1003</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;$e$&nbsp;and&nbsp;$o$&nbsp;odd&nbsp;such&nbsp;that&nbsp;$n-1&nbsp;=&nbsp;2^e&nbsp;*&nbsp;o$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1004"></a><div class='linenum'>1004</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;:=&nbsp;0;&nbsp;&nbsp;o&nbsp;:=&nbsp;n-1;&nbsp;&nbsp;&nbsp;while&nbsp;o&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;&nbsp;do&nbsp;e&nbsp;:=&nbsp;e+1;&nbsp;&nbsp;o&nbsp;:=&nbsp;o/2;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1005"></a><div class='linenum'>1005</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1006"></a><div class='linenum'>1006</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;look&nbsp;at&nbsp;the&nbsp;seq&nbsp;$2^o,&nbsp;2^{2&nbsp;o},&nbsp;2^{4&nbsp;o},&nbsp;..,&nbsp;2^{2^e&nbsp;o}=2^{n-1}$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1007"></a><div class='linenum'>1007</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;PowerModInt(&nbsp;2,&nbsp;o,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1008"></a><div class='linenum'>1008</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1009"></a><div class='linenum'>1009</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;i&nbsp;&lt;&nbsp;e&nbsp;&nbsp;and&nbsp;x&nbsp;&lt;>&nbsp;1&nbsp;&nbsp;and&nbsp;x&nbsp;&lt;>&nbsp;n-1&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1010"></a><div class='linenum'>1010</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;x&nbsp;*&nbsp;x&nbsp;mod&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1011"></a><div class='linenum'>1011</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1012"></a><div class='linenum'>1012</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1013"></a><div class='linenum'>1013</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1014"></a><div class='linenum'>1014</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;it&nbsp;is&nbsp;not&nbsp;of&nbsp;the&nbsp;form&nbsp;$..,&nbsp;-1,&nbsp;1,&nbsp;1,&nbsp;..$&nbsp;then&nbsp;$n$&nbsp;is&nbsp;composite
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1015"></a><div class='linenum'>1015</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(x&nbsp;=&nbsp;n-1&nbsp;or&nbsp;(i&nbsp;=&nbsp;0&nbsp;and&nbsp;x&nbsp;=&nbsp;1))&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1016"></a><div class='linenum'>1016</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1017"></a><div class='linenum'>1017</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1018"></a><div class='linenum'>1018</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1019"></a><div class='linenum'>1019</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;there&nbsp;are&nbsp;no&nbsp;strong&nbsp;pseudo-primes&nbsp;to&nbsp;base&nbsp;2&nbsp;smaller&nbsp;than&nbsp;2047
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1020"></a><div class='linenum'>1020</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;FL:&nbsp;never&nbsp;used
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1021"></a><div class='linenum'>1021</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;2047&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1022"></a><div class='linenum'>1022</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;Primes2,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1023"></a><div class='linenum'>1023</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1024"></a><div class='linenum'>1024</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1025"></a><div class='linenum'>1025</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1026"></a><div class='linenum'>1026</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;sure&nbsp;that&nbsp;$n$&nbsp;is&nbsp;not&nbsp;a&nbsp;perfect&nbsp;power&nbsp;(especially&nbsp;not&nbsp;a&nbsp;square)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1027"></a><div class='linenum'>1027</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;SmallestRootInt(n)&nbsp;&lt;&nbsp;n&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1028"></a><div class='linenum'>1028</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1029"></a><div class='linenum'>1029</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1030"></a><div class='linenum'>1030</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1031"></a><div class='linenum'>1031</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;a&nbsp;quadratic&nbsp;nonresidue&nbsp;$d&nbsp;=&nbsp;p^2/4-1$&nbsp;mod&nbsp;$n$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1032"></a><div class='linenum'>1032</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;2;&nbsp;&nbsp;while&nbsp;Jacobi(&nbsp;p^2-4,&nbsp;n&nbsp;)&nbsp;&lt;>&nbsp;-1&nbsp;&nbsp;do&nbsp;p&nbsp;:=&nbsp;p+1;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1033"></a><div class='linenum'>1033</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1034"></a><div class='linenum'>1034</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;for&nbsp;a&nbsp;prime&nbsp;$n$&nbsp;the&nbsp;trace&nbsp;of&nbsp;$(p/2+\sqrt{d})^n$&nbsp;must&nbsp;be&nbsp;$p$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1035"></a><div class='linenum'>1035</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;the&nbsp;trace&nbsp;of&nbsp;$(p/2+\sqrt{d})^{n+1}$&nbsp;must&nbsp;be&nbsp;2
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1036"></a><div class='linenum'>1036</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;TraceModQF(&nbsp;p,&nbsp;n+1,&nbsp;n&nbsp;)&nbsp;=&nbsp;[&nbsp;2,&nbsp;p&nbsp;]&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1037"></a><div class='linenum'>1037</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;n&nbsp;&lt;&nbsp;10^13&nbsp;fulfilling&nbsp;the&nbsp;tests&nbsp;so&nbsp;far&nbsp;are&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1038"></a><div class='linenum'>1038</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;10^13&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1039"></a><div class='linenum'>1039</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1040"></a><div class='linenum'>1040</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1041"></a><div class='linenum'>1041</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1042"></a><div class='linenum'>1042</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1043"></a><div class='linenum'>1043</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1044"></a><div class='linenum'>1044</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1045"></a><div class='linenum'>1045</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;$n$&nbsp;is&nbsp;not&nbsp;a&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1046"></a><div class='linenum'>1046</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1047"></a><div class='linenum'>1047</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1048"></a><div class='linenum'>1048</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1049"></a><div class='linenum'>1049</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(IsPrimeIntOld,function&nbsp;(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1050"></a><div class='linenum'>1050</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;res;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1051"></a><div class='linenum'>1051</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;res&nbsp;:=&nbsp;IsProbablyPrimeIntWithFail(n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1052"></a><div class='linenum'>1052</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;res&nbsp;=&nbsp;false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1053"></a><div class='linenum'>1053</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1054"></a><div class='linenum'>1054</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1055"></a><div class='linenum'>1055</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;res&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1056"></a><div class='linenum'>1056</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoPrimeInt,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1057"></a><div class='linenum'>1057</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"IsPrimeInt:&nbsp;probably&nbsp;prime,&nbsp;but&nbsp;not&nbsp;proven:&nbsp;",&nbsp;n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1058"></a><div class='linenum'>1058</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;ProbablePrimes2,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1059"></a><div class='linenum'>1059</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1060"></a><div class='linenum'>1060</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;Primes2,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1061"></a><div class='linenum'>1061</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1062"></a><div class='linenum'>1062</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1063"></a><div class='linenum'>1063</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1064"></a><div class='linenum'>1064</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1065"></a><div class='linenum'>1065</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1066"></a><div class='linenum'>1066</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1067"></a><div class='linenum'>1067</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1068"></a><div class='linenum'>1068</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1069"></a><div class='linenum'>1069</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IsPrimePowerInt(&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;test&nbsp;for&nbsp;a&nbsp;power&nbsp;of&nbsp;a&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1070"></a><div class='linenum'>1070</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1071"></a><div class='linenum'>1071</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;IsPrimePowerInt,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1072"></a><div class='linenum'>1072</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;->&nbsp;IsPrimeInt(&nbsp;SmallestRootInt(&nbsp;n&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1073"></a><div class='linenum'>1073</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1074"></a><div class='linenum'>1074</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1075"></a><div class='linenum'>1075</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1076"></a><div class='linenum'>1076</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1077"></a><div class='linenum'>1077</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;LcmInt(&nbsp;&lt;m>,&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;least&nbsp;common&nbsp;multiple&nbsp;of&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1078"></a><div class='linenum'>1078</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1079"></a><div class='linenum'>1079</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(LcmInt,function&nbsp;(&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1080"></a><div class='linenum'>1080</div></td><td>1149208</td><td>471089</td><td>471089</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;=&nbsp;0&nbsp;&nbsp;and&nbsp;n&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1081"></a><div class='linenum'>1081</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1082"></a><div class='linenum'>1082</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1083"></a><div class='linenum'>1083</div></td><td>574604</td><td>824610</td><td>1282238</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;AbsInt(&nbsp;m&nbsp;/&nbsp;GcdInt(&nbsp;m,&nbsp;n&nbsp;)&nbsp;*&nbsp;n&nbsp;);
</tt></span></td><td><span><a href="_opt_gap_gap4r8p5_lib_integer.gi.html#line1287">AbsInt</a> </span></td></tr>
<tr class='exec'><td><a name="line1084"></a><div class='linenum'>1084</div></td><td>574604</td><td>223052</td><td>223052</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1085"></a><div class='linenum'>1085</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1086"></a><div class='linenum'>1086</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1087"></a><div class='linenum'>1087</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1088"></a><div class='linenum'>1088</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1089"></a><div class='linenum'>1089</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1090"></a><div class='linenum'>1090</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;LogInt(&nbsp;&lt;n>,&nbsp;&lt;base>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;logarithm&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1091"></a><div class='linenum'>1091</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1092"></a><div class='linenum'>1092</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(LogInt,function&nbsp;(&nbsp;n,&nbsp;base&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1093"></a><div class='linenum'>1093</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;log,&nbsp;p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1094"></a><div class='linenum'>1094</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1095"></a><div class='linenum'>1095</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;arguments
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1096"></a><div class='linenum'>1096</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(n)&nbsp;or&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&lt;=&nbsp;0&nbsp;&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1097"></a><div class='linenum'>1097</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("&lt;n>&nbsp;must&nbsp;be&nbsp;a&nbsp;positive&nbsp;integer");&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1098"></a><div class='linenum'>1098</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1099"></a><div class='linenum'>1099</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(base)&nbsp;or&nbsp;base&nbsp;&lt;=&nbsp;1&nbsp;&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1100"></a><div class='linenum'>1100</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("&lt;base>&nbsp;must&nbsp;be&nbsp;an&nbsp;integer&nbsp;greater&nbsp;than&nbsp;1");&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1101"></a><div class='linenum'>1101</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1102"></a><div class='linenum'>1102</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1103"></a><div class='linenum'>1103</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`log(b)'&nbsp;returns&nbsp;$log_b(n)$&nbsp;and&nbsp;divides&nbsp;`n'&nbsp;by&nbsp;`b^log(b)'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1104"></a><div class='linenum'>1104</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log&nbsp;:=&nbsp;function&nbsp;(&nbsp;b&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1105"></a><div class='linenum'>1105</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1106"></a><div class='linenum'>1106</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;b&nbsp;>&nbsp;n&nbsp;&nbsp;then&nbsp;return&nbsp;0;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1107"></a><div class='linenum'>1107</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;log(&nbsp;b^2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1108"></a><div class='linenum'>1108</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;b&nbsp;>&nbsp;n&nbsp;&nbsp;then&nbsp;return&nbsp;2&nbsp;*&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1109"></a><div class='linenum'>1109</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;n&nbsp;:=&nbsp;QuoInt(&nbsp;n,&nbsp;b&nbsp;);&nbsp;&nbsp;return&nbsp;2&nbsp;*&nbsp;i&nbsp;+&nbsp;1;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1110"></a><div class='linenum'>1110</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1111"></a><div class='linenum'>1111</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1112"></a><div class='linenum'>1112</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;log(&nbsp;base&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1113"></a><div class='linenum'>1113</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;base&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1114"></a><div class='linenum'>1114</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1115"></a><div class='linenum'>1115</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;base&nbsp;=&nbsp;2&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1116"></a><div class='linenum'>1116</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Log2Int(n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1117"></a><div class='linenum'>1117</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;base&nbsp;=&nbsp;8&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1118"></a><div class='linenum'>1118</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;QuoInt(Log2Int(n),&nbsp;3);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1119"></a><div class='linenum'>1119</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;base&nbsp;=&nbsp;16&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1120"></a><div class='linenum'>1120</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;QuoInt(Log2Int(n),&nbsp;4);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1121"></a><div class='linenum'>1121</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;IsSmallIntRep(n)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1122"></a><div class='linenum'>1122</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;log&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1123"></a><div class='linenum'>1123</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;base&nbsp;*&nbsp;base;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1124"></a><div class='linenum'>1124</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;p&nbsp;&lt;=&nbsp;n&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1125"></a><div class='linenum'>1125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log&nbsp;:=&nbsp;log&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1126"></a><div class='linenum'>1126</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;p&nbsp;*&nbsp;base;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1127"></a><div class='linenum'>1127</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1128"></a><div class='linenum'>1128</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;log;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1129"></a><div class='linenum'>1129</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;base&nbsp;=&nbsp;10&nbsp;then&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1130"></a><div class='linenum'>1130</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;log&nbsp;:=&nbsp;QuoInt(Log2Int(n)&nbsp;*&nbsp;10^6&nbsp;,&nbsp;3321929);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1131"></a><div class='linenum'>1131</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;log&nbsp;+&nbsp;LogInt(QuoInt(n,&nbsp;10^log),&nbsp;10);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1132"></a><div class='linenum'>1132</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1133"></a><div class='linenum'>1133</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;log&nbsp;:=&nbsp;QuoInt(Log2Int(n),&nbsp;Log2Int(base)+1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1134"></a><div class='linenum'>1134</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;log&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1135"></a><div class='linenum'>1135</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1136"></a><div class='linenum'>1136</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1137"></a><div class='linenum'>1137</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;log&nbsp;+&nbsp;LogInt(QuoInt(n,&nbsp;base^log),&nbsp;base);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1138"></a><div class='linenum'>1138</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1139"></a><div class='linenum'>1139</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1140"></a><div class='linenum'>1140</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1141"></a><div class='linenum'>1141</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1142"></a><div class='linenum'>1142</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1143"></a><div class='linenum'>1143</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;NextPrimeInt(&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;next&nbsp;larger&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1144"></a><div class='linenum'>1144</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1145"></a><div class='linenum'>1145</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(NextPrimeInt,function&nbsp;(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1146"></a><div class='linenum'>1146</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;-3&nbsp;=&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;-2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1147"></a><div class='linenum'>1147</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;-3&nbsp;&lt;&nbsp;n&nbsp;&nbsp;and&nbsp;n&nbsp;&lt;&nbsp;2&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1148"></a><div class='linenum'>1148</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;n+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1149"></a><div class='linenum'>1149</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;n+2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1150"></a><div class='linenum'>1150</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1151"></a><div class='linenum'>1151</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;not&nbsp;IsPrimeInt(n)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1152"></a><div class='linenum'>1152</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;6&nbsp;=&nbsp;1&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;n+4;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1153"></a><div class='linenum'>1153</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;n+2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1154"></a><div class='linenum'>1154</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1155"></a><div class='linenum'>1155</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1156"></a><div class='linenum'>1156</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1157"></a><div class='linenum'>1157</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1158"></a><div class='linenum'>1158</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1159"></a><div class='linenum'>1159</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1160"></a><div class='linenum'>1160</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1161"></a><div class='linenum'>1161</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1162"></a><div class='linenum'>1162</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;PowerModInt(&lt;r>,&lt;e>,&lt;m>)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;power&nbsp;of&nbsp;one&nbsp;integer&nbsp;modulo&nbsp;another
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1163"></a><div class='linenum'>1163</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1164"></a><div class='linenum'>1164</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(PowerModInt,function&nbsp;(&nbsp;r,&nbsp;e,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1165"></a><div class='linenum'>1165</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;pow,&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1166"></a><div class='linenum'>1166</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1167"></a><div class='linenum'>1167</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;special&nbsp;cases
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1168"></a><div class='linenum'>1168</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;=&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1169"></a><div class='linenum'>1169</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1170"></a><div class='linenum'>1170</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;e&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1171"></a><div class='linenum'>1171</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1172"></a><div class='linenum'>1172</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1173"></a><div class='linenum'>1173</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1174"></a><div class='linenum'>1174</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;reduce&nbsp;`r'&nbsp;initially
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1175"></a><div class='linenum'>1175</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;r&nbsp;mod&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1176"></a><div class='linenum'>1176</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1177"></a><div class='linenum'>1177</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;`e'&nbsp;is&nbsp;negative&nbsp;then&nbsp;invert&nbsp;`r'&nbsp;modulo&nbsp;`m'&nbsp;with&nbsp;Euclids&nbsp;algorithm
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1178"></a><div class='linenum'>1178</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1179"></a><div class='linenum'>1179</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;1/r&nbsp;mod&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1180"></a><div class='linenum'>1180</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;:=&nbsp;-e;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1181"></a><div class='linenum'>1181</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1182"></a><div class='linenum'>1182</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1183"></a><div class='linenum'>1183</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now&nbsp;use&nbsp;the&nbsp;repeated&nbsp;squaring&nbsp;method&nbsp;(right-to-left)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1184"></a><div class='linenum'>1184</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pow&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1185"></a><div class='linenum'>1185</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;2&nbsp;^&nbsp;(LogInt(&nbsp;e,&nbsp;2&nbsp;)&nbsp;+&nbsp;1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1186"></a><div class='linenum'>1186</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;1&nbsp;&lt;&nbsp;f&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1187"></a><div class='linenum'>1187</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pow&nbsp;:=&nbsp;(pow&nbsp;*&nbsp;pow)&nbsp;mod&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1188"></a><div class='linenum'>1188</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;QuoInt(&nbsp;f,&nbsp;2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1189"></a><div class='linenum'>1189</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;f&nbsp;&lt;=&nbsp;e&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1190"></a><div class='linenum'>1190</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pow&nbsp;:=&nbsp;(pow&nbsp;*&nbsp;r)&nbsp;mod&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1191"></a><div class='linenum'>1191</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;:=&nbsp;e&nbsp;-&nbsp;f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1192"></a><div class='linenum'>1192</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1193"></a><div class='linenum'>1193</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1194"></a><div class='linenum'>1194</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1195"></a><div class='linenum'>1195</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;power
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1196"></a><div class='linenum'>1196</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;pow;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1197"></a><div class='linenum'>1197</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1198"></a><div class='linenum'>1198</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1199"></a><div class='linenum'>1199</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1200"></a><div class='linenum'>1200</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1201"></a><div class='linenum'>1201</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1202"></a><div class='linenum'>1202</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;PrevPrimeInt(&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;previous&nbsp;smaller&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1203"></a><div class='linenum'>1203</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1204"></a><div class='linenum'>1204</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`PrevPrimeInt'&nbsp;returns&nbsp;the&nbsp;largest&nbsp;prime&nbsp;&nbsp;which&nbsp;is&nbsp;strictly&nbsp;smaller&nbsp;&nbsp;than
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1205"></a><div class='linenum'>1205</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;the&nbsp;integer&nbsp;&lt;n>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1206"></a><div class='linenum'>1206</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1207"></a><div class='linenum'>1207</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(PrevPrimeInt,function&nbsp;(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1208"></a><div class='linenum'>1208</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;=&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1209"></a><div class='linenum'>1209</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;-2&nbsp;&lt;&nbsp;n&nbsp;&nbsp;and&nbsp;n&nbsp;&lt;&nbsp;3&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;-2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1210"></a><div class='linenum'>1210</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;n-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1211"></a><div class='linenum'>1211</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;n-2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1212"></a><div class='linenum'>1212</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1213"></a><div class='linenum'>1213</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;not&nbsp;IsPrimeInt(n)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1214"></a><div class='linenum'>1214</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;6&nbsp;=&nbsp;5&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;n-4;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1215"></a><div class='linenum'>1215</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;n-2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1216"></a><div class='linenum'>1216</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1217"></a><div class='linenum'>1217</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1218"></a><div class='linenum'>1218</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1219"></a><div class='linenum'>1219</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1220"></a><div class='linenum'>1220</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1221"></a><div class='linenum'>1221</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1222"></a><div class='linenum'>1222</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1223"></a><div class='linenum'>1223</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1224"></a><div class='linenum'>1224</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;PrimePowerInt(&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;prime&nbsp;powers&nbsp;of&nbsp;&lt;n>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1225"></a><div class='linenum'>1225</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1226"></a><div class='linenum'>1226</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(PrimePowersInt,function(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1227"></a><div class='linenum'>1227</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;p,&nbsp;&nbsp;pows,&nbsp;&nbsp;lst;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1228"></a><div class='linenum'>1228</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1229"></a><div class='linenum'>1229</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1230"></a><div class='linenum'>1230</div></td><td></td><td></td><td></td><td><span><tt>	return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1231"></a><div class='linenum'>1231</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1232"></a><div class='linenum'>1232</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;	Error(&nbsp;"&lt;n>&nbsp;must&nbsp;be&nbsp;non&nbsp;zero"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1233"></a><div class='linenum'>1233</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1234"></a><div class='linenum'>1234</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;	n&nbsp;:=&nbsp;-1&nbsp;*&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1235"></a><div class='linenum'>1235</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1236"></a><div class='linenum'>1236</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;lst&nbsp;&nbsp;:=&nbsp;Factors(&nbsp;Integers,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1237"></a><div class='linenum'>1237</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pows&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1238"></a><div class='linenum'>1238</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;&nbsp;in&nbsp;Set(&nbsp;lst&nbsp;)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1239"></a><div class='linenum'>1239</div></td><td></td><td></td><td></td><td><span><tt>	Add(&nbsp;pows,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1240"></a><div class='linenum'>1240</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;pows,&nbsp;Number(&nbsp;lst,&nbsp;x&nbsp;->&nbsp;x&nbsp;=&nbsp;p&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1241"></a><div class='linenum'>1241</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1242"></a><div class='linenum'>1242</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;pows;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1243"></a><div class='linenum'>1243</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1244"></a><div class='linenum'>1244</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1245"></a><div class='linenum'>1245</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1246"></a><div class='linenum'>1246</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1247"></a><div class='linenum'>1247</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1248"></a><div class='linenum'>1248</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1249"></a><div class='linenum'>1249</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RootInt(&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;root&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1250"></a><div class='linenum'>1250</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RootInt(&nbsp;&lt;n>,&nbsp;&lt;k>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1251"></a><div class='linenum'>1251</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1252"></a><div class='linenum'>1252</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(RootInt,function&nbsp;(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1253"></a><div class='linenum'>1253</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;n,&nbsp;k,&nbsp;r,&nbsp;s,&nbsp;t;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1254"></a><div class='linenum'>1254</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1255"></a><div class='linenum'>1255</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;arguments
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1256"></a><div class='linenum'>1256</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;Length(arg)&nbsp;=&nbsp;1&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;arg[1];&nbsp;&nbsp;k&nbsp;:=&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1257"></a><div class='linenum'>1257</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(arg)&nbsp;=&nbsp;2&nbsp;&nbsp;then&nbsp;n&nbsp;:=&nbsp;arg[1];&nbsp;&nbsp;k&nbsp;:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1258"></a><div class='linenum'>1258</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;Error("usage:&nbsp;`Root(&nbsp;&lt;n>&nbsp;)'&nbsp;or&nbsp;`Root(&nbsp;&lt;n>,&nbsp;&lt;k>&nbsp;)'");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1259"></a><div class='linenum'>1259</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1260"></a><div class='linenum'>1260</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1261"></a><div class='linenum'>1261</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;the&nbsp;arguments&nbsp;and&nbsp;handle&nbsp;trivial&nbsp;cases
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1262"></a><div class='linenum'>1262</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;k&nbsp;&lt;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;Error("&lt;k>&nbsp;must&nbsp;be&nbsp;positive");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1263"></a><div class='linenum'>1263</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;k&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;return&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1264"></a><div class='linenum'>1264</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;and&nbsp;k&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;&nbsp;then&nbsp;Error("&lt;n>&nbsp;must&nbsp;be&nbsp;positive");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1265"></a><div class='linenum'>1265</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;and&nbsp;k&nbsp;mod&nbsp;2&nbsp;=&nbsp;1&nbsp;&nbsp;then&nbsp;return&nbsp;-RootInt(&nbsp;-n,&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1266"></a><div class='linenum'>1266</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1267"></a><div class='linenum'>1267</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;&lt;=&nbsp;k&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;return&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1268"></a><div class='linenum'>1268</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1269"></a><div class='linenum'>1269</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1270"></a><div class='linenum'>1270</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;r&nbsp;is&nbsp;the&nbsp;first&nbsp;approximation,&nbsp;s&nbsp;the&nbsp;second,&nbsp;we&nbsp;need:&nbsp;root&nbsp;&lt;=&nbsp;s&nbsp;&lt;&nbsp;r
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1271"></a><div class='linenum'>1271</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;n;&nbsp;&nbsp;s&nbsp;:=&nbsp;2^(&nbsp;QuoInt(&nbsp;LogInt(n,2),&nbsp;k&nbsp;)&nbsp;+&nbsp;1&nbsp;)&nbsp;-&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1272"></a><div class='linenum'>1272</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1273"></a><div class='linenum'>1273</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;Newton&nbsp;iterations&nbsp;until&nbsp;the&nbsp;approximations&nbsp;stop&nbsp;decreasing
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1274"></a><div class='linenum'>1274</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;s&nbsp;&lt;&nbsp;r&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1275"></a><div class='linenum'>1275</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;s;&nbsp;&nbsp;t&nbsp;:=&nbsp;r^(k-1);&nbsp;&nbsp;s&nbsp;:=&nbsp;QuoInt(&nbsp;n&nbsp;+&nbsp;(k-1)*r*t,&nbsp;k*t&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1276"></a><div class='linenum'>1276</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1277"></a><div class='linenum'>1277</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1278"></a><div class='linenum'>1278</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;thats&nbsp;the&nbsp;integer&nbsp;part&nbsp;of&nbsp;the&nbsp;root
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1279"></a><div class='linenum'>1279</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1280"></a><div class='linenum'>1280</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1281"></a><div class='linenum'>1281</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1282"></a><div class='linenum'>1282</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1283"></a><div class='linenum'>1283</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1284"></a><div class='linenum'>1284</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1285"></a><div class='linenum'>1285</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;AbsInt(&nbsp;&lt;n>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;absolute&nbsp;value&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1286"></a><div class='linenum'>1286</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1287"></a><div class='linenum'>1287</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;AbsInt,&nbsp;function(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1288"></a><div class='linenum'>1288</div></td><td>1149694</td><td>1203934</td><td>1203934</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;=&nbsp;n&nbsp;&nbsp;then&nbsp;return&nbsp;&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1289"></a><div class='linenum'>1289</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-n;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line1290"></a><div class='linenum'>1290</div></td><td>574847</td><td>222778</td><td>222778</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1291"></a><div class='linenum'>1291</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1292"></a><div class='linenum'>1292</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1293"></a><div class='linenum'>1293</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1294"></a><div class='linenum'>1294</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1295"></a><div class='linenum'>1295</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;AbsoluteValue(&nbsp;&lt;n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1296"></a><div class='linenum'>1296</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1297"></a><div class='linenum'>1297</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;uses&nbsp;the&nbsp;particular&nbsp;form&nbsp;of&nbsp;AbsInt
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1298"></a><div class='linenum'>1298</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(AbsoluteValue,"rationals",true,[IsRat],0,AbsInt);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1299"></a><div class='linenum'>1299</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1300"></a><div class='linenum'>1300</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1301"></a><div class='linenum'>1301</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1302"></a><div class='linenum'>1302</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1303"></a><div class='linenum'>1303</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1304"></a><div class='linenum'>1304</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;SignInt(&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;sign&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1305"></a><div class='linenum'>1305</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1306"></a><div class='linenum'>1306</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;SignInt,&nbsp;function(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1307"></a><div class='linenum'>1307</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;0&nbsp;=&nbsp;&nbsp;n&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1308"></a><div class='linenum'>1308</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1309"></a><div class='linenum'>1309</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;0&nbsp;&lt;=&nbsp;n&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1310"></a><div class='linenum'>1310</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1311"></a><div class='linenum'>1311</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1312"></a><div class='linenum'>1312</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1313"></a><div class='linenum'>1313</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1314"></a><div class='linenum'>1314</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1315"></a><div class='linenum'>1315</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1316"></a><div class='linenum'>1316</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1317"></a><div class='linenum'>1317</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1318"></a><div class='linenum'>1318</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1319"></a><div class='linenum'>1319</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;SmallestRootInt(&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;smallest&nbsp;root&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1320"></a><div class='linenum'>1320</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1321"></a><div class='linenum'>1321</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(SmallestRootInt,function&nbsp;(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1322"></a><div class='linenum'>1322</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;k,&nbsp;r,&nbsp;s,&nbsp;p,&nbsp;l,&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1323"></a><div class='linenum'>1323</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1324"></a><div class='linenum'>1324</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;the&nbsp;argument
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1325"></a><div class='linenum'>1325</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;n&nbsp;>&nbsp;0&nbsp;&nbsp;then&nbsp;k&nbsp;:=&nbsp;2;&nbsp;&nbsp;s&nbsp;:=&nbsp;&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1326"></a><div class='linenum'>1326</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then&nbsp;k&nbsp;:=&nbsp;3;&nbsp;&nbsp;s&nbsp;:=&nbsp;-1;&nbsp;&nbsp;n&nbsp;:=&nbsp;-n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1327"></a><div class='linenum'>1327</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1328"></a><div class='linenum'>1328</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1329"></a><div class='linenum'>1329</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1330"></a><div class='linenum'>1330</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;exclude&nbsp;small&nbsp;divisors,&nbsp;and&nbsp;thereby&nbsp;large&nbsp;exponents
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1331"></a><div class='linenum'>1331</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1332"></a><div class='linenum'>1332</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1333"></a><div class='linenum'>1333</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1334"></a><div class='linenum'>1334</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;3;&nbsp;&nbsp;while&nbsp;p&nbsp;&lt;&nbsp;100&nbsp;&nbsp;and&nbsp;n&nbsp;mod&nbsp;p&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do&nbsp;p&nbsp;:=&nbsp;p+2;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1335"></a><div class='linenum'>1335</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1336"></a><div class='linenum'>1336</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;LogInt(&nbsp;n,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1337"></a><div class='linenum'>1337</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1338"></a><div class='linenum'>1338</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;possible&nbsp;prime&nbsp;divisors&nbsp;of&nbsp;exponents
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1339"></a><div class='linenum'>1339</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;use&nbsp;Euler's&nbsp;criterion&nbsp;to&nbsp;cast&nbsp;out&nbsp;impossible&nbsp;ones
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1340"></a><div class='linenum'>1340</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;k&nbsp;&lt;=&nbsp;l&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1341"></a><div class='linenum'>1341</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;:=&nbsp;2*k+1;&nbsp;&nbsp;while&nbsp;not&nbsp;IsPrimeInt(q)&nbsp;&nbsp;do&nbsp;q&nbsp;:=&nbsp;q+2*k;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1342"></a><div class='linenum'>1342</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;PowerModInt(&nbsp;n,&nbsp;(q-1)/k,&nbsp;q&nbsp;)&nbsp;&lt;=&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1343"></a><div class='linenum'>1343</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;:=&nbsp;RootInt(&nbsp;n,&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1344"></a><div class='linenum'>1344</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;r&nbsp;^&nbsp;k&nbsp;=&nbsp;n&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1345"></a><div class='linenum'>1345</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1346"></a><div class='linenum'>1346</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;QuoInt(&nbsp;l,&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1347"></a><div class='linenum'>1347</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1348"></a><div class='linenum'>1348</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;NextPrimeInt(&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1349"></a><div class='linenum'>1349</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1350"></a><div class='linenum'>1350</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1351"></a><div class='linenum'>1351</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;NextPrimeInt(&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1352"></a><div class='linenum'>1352</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1353"></a><div class='linenum'>1353</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1354"></a><div class='linenum'>1354</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1355"></a><div class='linenum'>1355</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;s&nbsp;*&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1356"></a><div class='linenum'>1356</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1357"></a><div class='linenum'>1357</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1358"></a><div class='linenum'>1358</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1359"></a><div class='linenum'>1359</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1360"></a><div class='linenum'>1360</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1361"></a><div class='linenum'>1361</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RingByGenerators(&nbsp;&lt;elms>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;ring&nbsp;generated&nbsp;by&nbsp;some&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1362"></a><div class='linenum'>1362</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1363"></a><div class='linenum'>1363</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RingByGenerators,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1364"></a><div class='linenum'>1364</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"method&nbsp;that&nbsp;catches&nbsp;the&nbsp;cases&nbsp;of&nbsp;`Integers'&nbsp;and&nbsp;subrings&nbsp;of&nbsp;`Integers'",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1365"></a><div class='linenum'>1365</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCyclotomicCollection&nbsp;],&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1366"></a><div class='linenum'>1366</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SUM_FLAGS,&nbsp;#&nbsp;test&nbsp;this&nbsp;before&nbsp;doing&nbsp;anything&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1367"></a><div class='linenum'>1367</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;elms&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1368"></a><div class='linenum'>1368</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;elms,&nbsp;IsInt&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1369"></a><div class='linenum'>1369</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;that&nbsp;the&nbsp;number&nbsp;of&nbsp;generators&nbsp;is&nbsp;bigger&nbsp;than&nbsp;one
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1370"></a><div class='linenum'>1370</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;recursion&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1371"></a><div class='linenum'>1371</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;elms&nbsp;)&nbsp;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1372"></a><div class='linenum'>1372</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RingByGenerators(&nbsp;[&nbsp;Gcd(elms)&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1373"></a><div class='linenum'>1373</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;elms[1]&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1374"></a><div class='linenum'>1374</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Integers;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1375"></a><div class='linenum'>1375</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1376"></a><div class='linenum'>1376</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1377"></a><div class='linenum'>1377</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1378"></a><div class='linenum'>1378</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1379"></a><div class='linenum'>1379</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1380"></a><div class='linenum'>1380</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1381"></a><div class='linenum'>1381</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1382"></a><div class='linenum'>1382</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1383"></a><div class='linenum'>1383</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1384"></a><div class='linenum'>1384</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1385"></a><div class='linenum'>1385</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1386"></a><div class='linenum'>1386</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RingWithOneByGenerators(&nbsp;&lt;elms>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;ring&nbsp;generated&nbsp;by&nbsp;some&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1387"></a><div class='linenum'>1387</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1388"></a><div class='linenum'>1388</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RingWithOneByGenerators,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1389"></a><div class='linenum'>1389</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"method&nbsp;that&nbsp;catches&nbsp;the&nbsp;cases&nbsp;of&nbsp;`Integers'",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1390"></a><div class='linenum'>1390</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCyclotomicCollection&nbsp;],&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1391"></a><div class='linenum'>1391</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SUM_FLAGS,&nbsp;#&nbsp;test&nbsp;this&nbsp;before&nbsp;doing&nbsp;anything&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1392"></a><div class='linenum'>1392</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;elms&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1393"></a><div class='linenum'>1393</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;elms,&nbsp;IsInt&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1394"></a><div class='linenum'>1394</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Integers;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1395"></a><div class='linenum'>1395</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1396"></a><div class='linenum'>1396</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1397"></a><div class='linenum'>1397</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1398"></a><div class='linenum'>1398</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1399"></a><div class='linenum'>1399</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1400"></a><div class='linenum'>1400</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1401"></a><div class='linenum'>1401</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1402"></a><div class='linenum'>1402</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1403"></a><div class='linenum'>1403</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DefaultRingByGenerators(&nbsp;&lt;elms>&nbsp;)&nbsp;default&nbsp;ring&nbsp;generated&nbsp;by&nbsp;some&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1404"></a><div class='linenum'>1404</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1405"></a><div class='linenum'>1405</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DefaultRingByGenerators,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1406"></a><div class='linenum'>1406</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"method&nbsp;that&nbsp;catches&nbsp;the&nbsp;cases&nbsp;of&nbsp;`(Gaussian)Integers'&nbsp;and&nbsp;cycl.&nbsp;fields",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1407"></a><div class='linenum'>1407</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCyclotomicCollection&nbsp;],&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1408"></a><div class='linenum'>1408</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SUM_FLAGS,&nbsp;#&nbsp;test&nbsp;this&nbsp;before&nbsp;doing&nbsp;anything&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1409"></a><div class='linenum'>1409</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;elms&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1410"></a><div class='linenum'>1410</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;elms,&nbsp;IsInt&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1411"></a><div class='linenum'>1411</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Integers;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1412"></a><div class='linenum'>1412</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;ForAll(&nbsp;elms,&nbsp;IsGaussInt&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1413"></a><div class='linenum'>1413</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;GaussianIntegers;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1414"></a><div class='linenum'>1414</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1415"></a><div class='linenum'>1415</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;DefaultField(&nbsp;elms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1416"></a><div class='linenum'>1416</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1417"></a><div class='linenum'>1417</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1418"></a><div class='linenum'>1418</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1419"></a><div class='linenum'>1419</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1420"></a><div class='linenum'>1420</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1421"></a><div class='linenum'>1421</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1422"></a><div class='linenum'>1422</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DefaultRingByGenerators(&nbsp;&lt;mats>&nbsp;)&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;list&nbsp;of&nbsp;n&nbsp;x&nbsp;n&nbsp;integer&nbsp;matrices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1423"></a><div class='linenum'>1423</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1424"></a><div class='linenum'>1424</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DefaultRingByGenerators,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1425"></a><div class='linenum'>1425</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;lists&nbsp;of&nbsp;n&nbsp;x&nbsp;n&nbsp;integer&nbsp;matrices",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1426"></a><div class='linenum'>1426</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCyclotomicCollCollColl&nbsp;and&nbsp;IsFinite&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1427"></a><div class='linenum'>1427</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1428"></a><div class='linenum'>1428</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;function&nbsp;(&nbsp;mats&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1429"></a><div class='linenum'>1429</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;d;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1430"></a><div class='linenum'>1430</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(mats)&nbsp;or&nbsp;not&nbsp;ForAll(mats,IsRectangularTable&nbsp;and&nbsp;IsMatrix)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1431"></a><div class='linenum'>1431</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1432"></a><div class='linenum'>1432</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1433"></a><div class='linenum'>1433</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;Length(&nbsp;mats[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1434"></a><div class='linenum'>1434</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;d=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1435"></a><div class='linenum'>1435</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1436"></a><div class='linenum'>1436</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1437"></a><div class='linenum'>1437</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;ForAll(&nbsp;mats,&nbsp;m&nbsp;->&nbsp;Length(m)=d&nbsp;and&nbsp;Length(m[1])=d&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1438"></a><div class='linenum'>1438</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1439"></a><div class='linenum'>1439</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1440"></a><div class='linenum'>1440</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;ForAll(&nbsp;mats,&nbsp;m&nbsp;->&nbsp;ForAll(&nbsp;m,&nbsp;r&nbsp;->&nbsp;ForAll(r,IsInt)))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1441"></a><div class='linenum'>1441</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1442"></a><div class='linenum'>1442</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1443"></a><div class='linenum'>1443</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;FullMatrixAlgebra(Integers,d);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1444"></a><div class='linenum'>1444</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1445"></a><div class='linenum'>1445</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1446"></a><div class='linenum'>1446</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1447"></a><div class='linenum'>1447</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1448"></a><div class='linenum'>1448</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1449"></a><div class='linenum'>1449</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Enumerator(&nbsp;Integers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1450"></a><div class='linenum'>1450</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1451"></a><div class='linenum'>1451</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$a_n&nbsp;=&nbsp;\frac{n}{2}$&nbsp;if&nbsp;$n$&nbsp;is&nbsp;even,&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1452"></a><div class='linenum'>1452</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$a_n&nbsp;=&nbsp;\frac{1-n}{2}$&nbsp;otherwise.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1453"></a><div class='linenum'>1453</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1454"></a><div class='linenum'>1454</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Enumerator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1455"></a><div class='linenum'>1455</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1456"></a><div class='linenum'>1456</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1457"></a><div class='linenum'>1457</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Integers&nbsp;->&nbsp;EnumeratorByFunctions(&nbsp;Integers,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1458"></a><div class='linenum'>1458</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rec(&nbsp;ElementNumber&nbsp;:=&nbsp;function(&nbsp;e,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1459"></a><div class='linenum'>1459</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1460"></a><div class='linenum'>1460</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n&nbsp;/&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1461"></a><div class='linenum'>1461</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1462"></a><div class='linenum'>1462</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(&nbsp;1&nbsp;-&nbsp;n&nbsp;)&nbsp;/&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1463"></a><div class='linenum'>1463</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1464"></a><div class='linenum'>1464</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1465"></a><div class='linenum'>1465</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1466"></a><div class='linenum'>1466</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NumberElement&nbsp;:=&nbsp;function(&nbsp;e,&nbsp;x&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1467"></a><div class='linenum'>1467</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;pos;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1468"></a><div class='linenum'>1468</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(&nbsp;x&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1469"></a><div class='linenum'>1469</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1470"></a><div class='linenum'>1470</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1471"></a><div class='linenum'>1471</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;2&nbsp;*&nbsp;x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1472"></a><div class='linenum'>1472</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1473"></a><div class='linenum'>1473</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;-2&nbsp;*&nbsp;x&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1474"></a><div class='linenum'>1474</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1475"></a><div class='linenum'>1475</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;pos;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1476"></a><div class='linenum'>1476</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1477"></a><div class='linenum'>1477</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1478"></a><div class='linenum'>1478</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1479"></a><div class='linenum'>1479</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1480"></a><div class='linenum'>1480</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1481"></a><div class='linenum'>1481</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;EuclideanDegree(&nbsp;Integers,&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;absolut&nbsp;value
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1482"></a><div class='linenum'>1482</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1483"></a><div class='linenum'>1483</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;EuclideanDegree,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1484"></a><div class='linenum'>1484</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1485"></a><div class='linenum'>1485</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1486"></a><div class='linenum'>1486</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1487"></a><div class='linenum'>1487</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1488"></a><div class='linenum'>1488</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1489"></a><div class='linenum'>1489</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1490"></a><div class='linenum'>1490</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1491"></a><div class='linenum'>1491</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1492"></a><div class='linenum'>1492</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1493"></a><div class='linenum'>1493</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1494"></a><div class='linenum'>1494</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1495"></a><div class='linenum'>1495</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1496"></a><div class='linenum'>1496</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1497"></a><div class='linenum'>1497</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1498"></a><div class='linenum'>1498</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;EuclideanQuotient(&nbsp;Integers,&nbsp;&lt;n>,&nbsp;&lt;m>&nbsp;)&nbsp;&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;Euclidean&nbsp;quotient
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1499"></a><div class='linenum'>1499</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1500"></a><div class='linenum'>1500</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;EuclideanQuotient,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1501"></a><div class='linenum'>1501</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1502"></a><div class='linenum'>1502</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1503"></a><div class='linenum'>1503</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1504"></a><div class='linenum'>1504</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1505"></a><div class='linenum'>1505</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;QuoInt(&nbsp;n,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1506"></a><div class='linenum'>1506</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1507"></a><div class='linenum'>1507</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1508"></a><div class='linenum'>1508</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1509"></a><div class='linenum'>1509</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1510"></a><div class='linenum'>1510</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1511"></a><div class='linenum'>1511</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;EuclideanRemainder(&nbsp;Integers,&nbsp;&lt;n>,&nbsp;&lt;m>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;Euclidean&nbsp;remainder
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1512"></a><div class='linenum'>1512</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1513"></a><div class='linenum'>1513</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;EuclideanRemainder,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1514"></a><div class='linenum'>1514</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1515"></a><div class='linenum'>1515</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1516"></a><div class='linenum'>1516</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1517"></a><div class='linenum'>1517</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1518"></a><div class='linenum'>1518</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RemInt(&nbsp;n,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1519"></a><div class='linenum'>1519</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1520"></a><div class='linenum'>1520</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1521"></a><div class='linenum'>1521</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1522"></a><div class='linenum'>1522</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1523"></a><div class='linenum'>1523</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1524"></a><div class='linenum'>1524</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Factors(&nbsp;Integers,&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;factorization&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1525"></a><div class='linenum'>1525</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1526"></a><div class='linenum'>1526</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Factors,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1527"></a><div class='linenum'>1527</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1528"></a><div class='linenum'>1528</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1529"></a><div class='linenum'>1529</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1530"></a><div class='linenum'>1530</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1531"></a><div class='linenum'>1531</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;FactorsInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1532"></a><div class='linenum'>1532</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1533"></a><div class='linenum'>1533</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1534"></a><div class='linenum'>1534</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1535"></a><div class='linenum'>1535</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1536"></a><div class='linenum'>1536</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1537"></a><div class='linenum'>1537</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;GcdOp(&nbsp;Integers,&nbsp;&lt;n>,&nbsp;&lt;m>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;gcd&nbsp;of&nbsp;two&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1538"></a><div class='linenum'>1538</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1539"></a><div class='linenum'>1539</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;GcdOp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1540"></a><div class='linenum'>1540</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1541"></a><div class='linenum'>1541</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1542"></a><div class='linenum'>1542</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1543"></a><div class='linenum'>1543</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1544"></a><div class='linenum'>1544</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;GcdInt(&nbsp;n,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1545"></a><div class='linenum'>1545</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1546"></a><div class='linenum'>1546</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1547"></a><div class='linenum'>1547</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1548"></a><div class='linenum'>1548</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1549"></a><div class='linenum'>1549</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1550"></a><div class='linenum'>1550</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsIrreducibleRingElement(&nbsp;Integers,&nbsp;&lt;n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1551"></a><div class='linenum'>1551</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1552"></a><div class='linenum'>1552</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsIrreducibleRingElement,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1553"></a><div class='linenum'>1553</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1554"></a><div class='linenum'>1554</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1555"></a><div class='linenum'>1555</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1556"></a><div class='linenum'>1556</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1557"></a><div class='linenum'>1557</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsPrimeInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1558"></a><div class='linenum'>1558</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1559"></a><div class='linenum'>1559</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1560"></a><div class='linenum'>1560</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1561"></a><div class='linenum'>1561</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1562"></a><div class='linenum'>1562</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1563"></a><div class='linenum'>1563</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsPrime(&nbsp;Integers,&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;test&nbsp;whether&nbsp;an&nbsp;integer&nbsp;is&nbsp;a&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1564"></a><div class='linenum'>1564</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1565"></a><div class='linenum'>1565</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsPrime,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1566"></a><div class='linenum'>1566</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1567"></a><div class='linenum'>1567</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1568"></a><div class='linenum'>1568</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1569"></a><div class='linenum'>1569</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1570"></a><div class='linenum'>1570</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsPrimeInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1571"></a><div class='linenum'>1571</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1572"></a><div class='linenum'>1572</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1573"></a><div class='linenum'>1573</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1574"></a><div class='linenum'>1574</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1575"></a><div class='linenum'>1575</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1576"></a><div class='linenum'>1576</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Iterator(&nbsp;Integers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1577"></a><div class='linenum'>1577</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1578"></a><div class='linenum'>1578</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;uses&nbsp;the&nbsp;succession&nbsp;$0,&nbsp;1,&nbsp;-1,&nbsp;2,&nbsp;-2,&nbsp;3,&nbsp;-3,&nbsp;\ldots$,&nbsp;that&nbsp;is,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1579"></a><div class='linenum'>1579</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$a_n&nbsp;=&nbsp;\frac{n}{2}$&nbsp;if&nbsp;$n$&nbsp;is&nbsp;even,&nbsp;and&nbsp;$a_n&nbsp;=&nbsp;\frac{1-n}{2}$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1580"></a><div class='linenum'>1580</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;otherwise.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1581"></a><div class='linenum'>1581</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1582"></a><div class='linenum'>1582</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Iterator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1583"></a><div class='linenum'>1583</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;`Integers'",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1584"></a><div class='linenum'>1584</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1585"></a><div class='linenum'>1585</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Integers&nbsp;->&nbsp;IteratorByFunctions(&nbsp;rec(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1586"></a><div class='linenum'>1586</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NextIterator&nbsp;:=&nbsp;function(&nbsp;iter&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1587"></a><div class='linenum'>1587</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iter!.counter:=&nbsp;iter!.counter&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1588"></a><div class='linenum'>1588</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;iter!.counter&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1589"></a><div class='linenum'>1589</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;iter!.counter&nbsp;/&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1590"></a><div class='linenum'>1590</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1591"></a><div class='linenum'>1591</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(&nbsp;1&nbsp;-&nbsp;iter!.counter&nbsp;)&nbsp;/&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1592"></a><div class='linenum'>1592</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1593"></a><div class='linenum'>1593</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1594"></a><div class='linenum'>1594</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsDoneIterator&nbsp;:=&nbsp;ReturnFalse,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1595"></a><div class='linenum'>1595</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShallowCopy&nbsp;:=&nbsp;iter&nbsp;->&nbsp;rec(&nbsp;counter:=&nbsp;iter!.counter&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1596"></a><div class='linenum'>1596</div></td><td></td><td></td><td></td><td><span><tt>	PrintObj&nbsp;:=&nbsp;function(iter)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1597"></a><div class='linenum'>1597</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;msg;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1598"></a><div class='linenum'>1598</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;:=&nbsp;"&lt;iterator&nbsp;of&nbsp;Integers&nbsp;at&nbsp;";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1599"></a><div class='linenum'>1599</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;iter!.counter&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1600"></a><div class='linenum'>1600</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(msg,&nbsp;String(iter!.counter&nbsp;/&nbsp;2));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1601"></a><div class='linenum'>1601</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1602"></a><div class='linenum'>1602</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(msg,&nbsp;String((1&nbsp;-&nbsp;iter!.counter)&nbsp;/&nbsp;2));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1603"></a><div class='linenum'>1603</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1604"></a><div class='linenum'>1604</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(msg,">");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1605"></a><div class='linenum'>1605</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(msg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1606"></a><div class='linenum'>1606</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1607"></a><div class='linenum'>1607</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;counter&nbsp;:=&nbsp;0&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1608"></a><div class='linenum'>1608</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1609"></a><div class='linenum'>1609</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1610"></a><div class='linenum'>1610</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1611"></a><div class='linenum'>1611</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1612"></a><div class='linenum'>1612</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Iterator(&nbsp;PositiveIntegers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1613"></a><div class='linenum'>1613</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1614"></a><div class='linenum'>1614</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Iterator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1615"></a><div class='linenum'>1615</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;`PositiveIntegers'",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1616"></a><div class='linenum'>1616</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPositiveIntegers&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1617"></a><div class='linenum'>1617</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsPositiveIntegers&nbsp;->&nbsp;IteratorByFunctions(&nbsp;rec(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1618"></a><div class='linenum'>1618</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NextIterator&nbsp;:=&nbsp;function(&nbsp;iter&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1619"></a><div class='linenum'>1619</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iter!.counter:=&nbsp;iter!.counter&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1620"></a><div class='linenum'>1620</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;iter!.counter;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1621"></a><div class='linenum'>1621</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1622"></a><div class='linenum'>1622</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsDoneIterator&nbsp;:=&nbsp;ReturnFalse,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1623"></a><div class='linenum'>1623</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShallowCopy&nbsp;:=&nbsp;iter&nbsp;->&nbsp;rec(&nbsp;counter:=&nbsp;iter!.counter&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1624"></a><div class='linenum'>1624</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1625"></a><div class='linenum'>1625</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;counter&nbsp;:=&nbsp;0&nbsp;)&nbsp;)&nbsp;);&nbsp;#&nbsp;0,&nbsp;since&nbsp;we&nbsp;first&nbsp;increment&nbsp;then&nbsp;return
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1626"></a><div class='linenum'>1626</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1627"></a><div class='linenum'>1627</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1628"></a><div class='linenum'>1628</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1629"></a><div class='linenum'>1629</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1630"></a><div class='linenum'>1630</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;LcmOp(&nbsp;Integers,&nbsp;&lt;n>,&nbsp;&lt;m>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;least&nbsp;common&nbsp;multiple&nbsp;of&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1631"></a><div class='linenum'>1631</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1632"></a><div class='linenum'>1632</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;LcmOp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1633"></a><div class='linenum'>1633</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1634"></a><div class='linenum'>1634</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1635"></a><div class='linenum'>1635</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1636"></a><div class='linenum'>1636</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1637"></a><div class='linenum'>1637</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;LcmInt(&nbsp;n,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1638"></a><div class='linenum'>1638</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1639"></a><div class='linenum'>1639</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1640"></a><div class='linenum'>1640</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1641"></a><div class='linenum'>1641</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1642"></a><div class='linenum'>1642</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1643"></a><div class='linenum'>1643</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Log(&nbsp;&lt;n>,&nbsp;&lt;base>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1644"></a><div class='linenum'>1644</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1645"></a><div class='linenum'>1645</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Log,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1646"></a><div class='linenum'>1646</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1647"></a><div class='linenum'>1647</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1648"></a><div class='linenum'>1648</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1649"></a><div class='linenum'>1649</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;LogInt&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1650"></a><div class='linenum'>1650</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1651"></a><div class='linenum'>1651</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1652"></a><div class='linenum'>1652</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1653"></a><div class='linenum'>1653</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1654"></a><div class='linenum'>1654</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PowerMod(&nbsp;Integers,&nbsp;&lt;r>,&nbsp;&lt;e>,&nbsp;&lt;m>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;power&nbsp;of&nbsp;an&nbsp;integer&nbsp;mod&nbsp;another
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1655"></a><div class='linenum'>1655</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1656"></a><div class='linenum'>1656</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PowerMod,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1657"></a><div class='linenum'>1657</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1658"></a><div class='linenum'>1658</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1659"></a><div class='linenum'>1659</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt,&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1660"></a><div class='linenum'>1660</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;r,&nbsp;e,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1661"></a><div class='linenum'>1661</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;PowerModInt(&nbsp;r,&nbsp;e,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1662"></a><div class='linenum'>1662</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1663"></a><div class='linenum'>1663</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1664"></a><div class='linenum'>1664</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1665"></a><div class='linenum'>1665</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1666"></a><div class='linenum'>1666</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1667"></a><div class='linenum'>1667</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Quotient(&nbsp;&lt;Integers>,&nbsp;&lt;n>,&nbsp;&lt;m>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;quotient&nbsp;of&nbsp;two&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1668"></a><div class='linenum'>1668</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1669"></a><div class='linenum'>1669</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Quotient,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1670"></a><div class='linenum'>1670</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1671"></a><div class='linenum'>1671</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1672"></a><div class='linenum'>1672</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1673"></a><div class='linenum'>1673</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1674"></a><div class='linenum'>1674</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1675"></a><div class='linenum'>1675</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;:=&nbsp;QuoInt(&nbsp;n,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1676"></a><div class='linenum'>1676</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;>&nbsp;q&nbsp;*&nbsp;m&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1677"></a><div class='linenum'>1677</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;:=&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1678"></a><div class='linenum'>1678</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1679"></a><div class='linenum'>1679</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1680"></a><div class='linenum'>1680</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1681"></a><div class='linenum'>1681</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1682"></a><div class='linenum'>1682</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1683"></a><div class='linenum'>1683</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1684"></a><div class='linenum'>1684</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1685"></a><div class='linenum'>1685</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;QuotientMod(&nbsp;Integers&nbsp;,&nbsp;&lt;r>,&nbsp;&lt;s>,&nbsp;&lt;m>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;quotient&nbsp;modulo&nbsp;&lt;m>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1686"></a><div class='linenum'>1686</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1687"></a><div class='linenum'>1687</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;QuotientMod,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1688"></a><div class='linenum'>1688</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1689"></a><div class='linenum'>1689</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1690"></a><div class='linenum'>1690</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt,&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1691"></a><div class='linenum'>1691</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;r,&nbsp;s,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1692"></a><div class='linenum'>1692</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s&nbsp;>&nbsp;m&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1693"></a><div class='linenum'>1693</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;s&nbsp;mod&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1694"></a><div class='linenum'>1694</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1695"></a><div class='linenum'>1695</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1696"></a><div class='linenum'>1696</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1697"></a><div class='linenum'>1697</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;GcdInt(&nbsp;s,&nbsp;m&nbsp;)&nbsp;&lt;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1698"></a><div class='linenum'>1698</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1699"></a><div class='linenum'>1699</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1700"></a><div class='linenum'>1700</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r/s&nbsp;mod&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1701"></a><div class='linenum'>1701</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1702"></a><div class='linenum'>1702</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1703"></a><div class='linenum'>1703</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1704"></a><div class='linenum'>1704</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1705"></a><div class='linenum'>1705</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1706"></a><div class='linenum'>1706</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1707"></a><div class='linenum'>1707</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;QuotientRemainder(&nbsp;Integers,&nbsp;&lt;n>,&nbsp;&lt;m>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;quo&nbsp;and&nbsp;rem
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1708"></a><div class='linenum'>1708</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1709"></a><div class='linenum'>1709</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;QuotientRemainder,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1710"></a><div class='linenum'>1710</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1711"></a><div class='linenum'>1711</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1712"></a><div class='linenum'>1712</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1713"></a><div class='linenum'>1713</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1714"></a><div class='linenum'>1714</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1715"></a><div class='linenum'>1715</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;:=&nbsp;QuoInt(n,m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1716"></a><div class='linenum'>1716</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#T&nbsp;kernel&nbsp;function&nbsp;should&nbsp;compute&nbsp;remainder&nbsp;at&nbsp;same&nbsp;time
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1717"></a><div class='linenum'>1717</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;q,&nbsp;n&nbsp;-&nbsp;q&nbsp;*&nbsp;m&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1718"></a><div class='linenum'>1718</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1719"></a><div class='linenum'>1719</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1720"></a><div class='linenum'>1720</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1721"></a><div class='linenum'>1721</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1722"></a><div class='linenum'>1722</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1723"></a><div class='linenum'>1723</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Random(&nbsp;Integers&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;random&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1724"></a><div class='linenum'>1724</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1725"></a><div class='linenum'>1725</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;returns&nbsp;pseudo&nbsp;random&nbsp;integers&nbsp;between&nbsp;$-10$&nbsp;and&nbsp;$10$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1726"></a><div class='linenum'>1726</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;distributed&nbsp;according&nbsp;to&nbsp;a&nbsp;binomial&nbsp;distribution.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1727"></a><div class='linenum'>1727</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1728"></a><div class='linenum'>1728</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;\begintt
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1729"></a><div class='linenum'>1729</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;gap>&nbsp;Random(&nbsp;Integers&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1730"></a><div class='linenum'>1730</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1731"></a><div class='linenum'>1731</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;gap>&nbsp;Random(&nbsp;Integers&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1732"></a><div class='linenum'>1732</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;-4
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1733"></a><div class='linenum'>1733</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;\endtt
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1734"></a><div class='linenum'>1734</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1735"></a><div class='linenum'>1735</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;To&nbsp;generate&nbsp;uniformly&nbsp;distributed&nbsp;integers&nbsp;from&nbsp;a&nbsp;range,&nbsp;use&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1736"></a><div class='linenum'>1736</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;construct&nbsp;`Random(&nbsp;[&nbsp;&lt;low>&nbsp;..&nbsp;&lt;high>&nbsp;]&nbsp;)'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1737"></a><div class='linenum'>1737</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1738"></a><div class='linenum'>1738</div></td><td></td><td></td><td></td><td><span><tt>NrBitsInt&nbsp;:=&nbsp;function&nbsp;(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1739"></a><div class='linenum'>1739</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;nr,&nbsp;nr64;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1740"></a><div class='linenum'>1740</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nr64:=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1741"></a><div class='linenum'>1741</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1742"></a><div class='linenum'>1742</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nr&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1743"></a><div class='linenum'>1743</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;0&nbsp;&lt;&nbsp;n&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1744"></a><div class='linenum'>1744</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr&nbsp;:=&nbsp;nr&nbsp;+&nbsp;nr64[&nbsp;n&nbsp;mod&nbsp;64&nbsp;+&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1745"></a><div class='linenum'>1745</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;QuoInt(&nbsp;n,&nbsp;64&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1746"></a><div class='linenum'>1746</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1747"></a><div class='linenum'>1747</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1748"></a><div class='linenum'>1748</div></td><td></td><td></td><td></td><td><span><tt>end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1749"></a><div class='linenum'>1749</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1750"></a><div class='linenum'>1750</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Random,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1751"></a><div class='linenum'>1751</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;`Integers'",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1752"></a><div class='linenum'>1752</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1753"></a><div class='linenum'>1753</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1754"></a><div class='linenum'>1754</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;Integers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1755"></a><div class='linenum'>1755</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NrBitsInt(&nbsp;Random(&nbsp;[0..2^20-1]&nbsp;)&nbsp;)&nbsp;-&nbsp;10;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1756"></a><div class='linenum'>1756</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1757"></a><div class='linenum'>1757</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1758"></a><div class='linenum'>1758</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1759"></a><div class='linenum'>1759</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1760"></a><div class='linenum'>1760</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1761"></a><div class='linenum'>1761</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1762"></a><div class='linenum'>1762</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Root(&nbsp;&lt;n>,&nbsp;&lt;k>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1763"></a><div class='linenum'>1763</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1764"></a><div class='linenum'>1764</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Root,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1765"></a><div class='linenum'>1765</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1766"></a><div class='linenum'>1766</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1767"></a><div class='linenum'>1767</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsInt,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1768"></a><div class='linenum'>1768</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;RootInt&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1769"></a><div class='linenum'>1769</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1770"></a><div class='linenum'>1770</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1771"></a><div class='linenum'>1771</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1772"></a><div class='linenum'>1772</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1773"></a><div class='linenum'>1773</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RoundCyc(&nbsp;&lt;cyc>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;cyclotomic&nbsp;integer&nbsp;near&nbsp;to&nbsp;&lt;cyc>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1774"></a><div class='linenum'>1774</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1775"></a><div class='linenum'>1775</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RoundCyc,&nbsp;"Integer",&nbsp;true,&nbsp;[&nbsp;IsInt&nbsp;],&nbsp;0,&nbsp;&nbsp;x->x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1776"></a><div class='linenum'>1776</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1777"></a><div class='linenum'>1777</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1778"></a><div class='linenum'>1778</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1779"></a><div class='linenum'>1779</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1780"></a><div class='linenum'>1780</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RoundCycDown(&nbsp;&lt;cyc>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;cyclotomic&nbsp;integer&nbsp;near&nbsp;to&nbsp;&lt;cyc>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1781"></a><div class='linenum'>1781</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1782"></a><div class='linenum'>1782</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RoundCycDown,&nbsp;"Integer",&nbsp;true,&nbsp;[&nbsp;IsInt&nbsp;],&nbsp;0,&nbsp;&nbsp;x->x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1783"></a><div class='linenum'>1783</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1784"></a><div class='linenum'>1784</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1785"></a><div class='linenum'>1785</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1786"></a><div class='linenum'>1786</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1787"></a><div class='linenum'>1787</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;StandardAssociate(&nbsp;Integers,&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;absolute&nbsp;value
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1788"></a><div class='linenum'>1788</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1789"></a><div class='linenum'>1789</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;StandardAssociate,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1790"></a><div class='linenum'>1790</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1791"></a><div class='linenum'>1791</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1792"></a><div class='linenum'>1792</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1793"></a><div class='linenum'>1793</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1794"></a><div class='linenum'>1794</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1795"></a><div class='linenum'>1795</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1796"></a><div class='linenum'>1796</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1797"></a><div class='linenum'>1797</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1798"></a><div class='linenum'>1798</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1799"></a><div class='linenum'>1799</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1800"></a><div class='linenum'>1800</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1801"></a><div class='linenum'>1801</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1802"></a><div class='linenum'>1802</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1803"></a><div class='linenum'>1803</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;StandardAssociateUnit(&nbsp;Integers,&nbsp;&lt;n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1804"></a><div class='linenum'>1804</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1805"></a><div class='linenum'>1805</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;StandardAssociateUnit,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1806"></a><div class='linenum'>1806</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1807"></a><div class='linenum'>1807</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1808"></a><div class='linenum'>1808</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsIntegers,&nbsp;IsInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1809"></a><div class='linenum'>1809</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;Integers,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1810"></a><div class='linenum'>1810</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1811"></a><div class='linenum'>1811</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1812"></a><div class='linenum'>1812</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1813"></a><div class='linenum'>1813</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1814"></a><div class='linenum'>1814</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1815"></a><div class='linenum'>1815</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1816"></a><div class='linenum'>1816</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1817"></a><div class='linenum'>1817</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1818"></a><div class='linenum'>1818</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1819"></a><div class='linenum'>1819</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1820"></a><div class='linenum'>1820</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Valuation(&nbsp;&lt;n>,&nbsp;&lt;m>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1821"></a><div class='linenum'>1821</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1822"></a><div class='linenum'>1822</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;Valuation,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1823"></a><div class='linenum'>1823</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1824"></a><div class='linenum'>1824</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1825"></a><div class='linenum'>1825</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsInt,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1826"></a><div class='linenum'>1826</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1827"></a><div class='linenum'>1827</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1828"></a><div class='linenum'>1828</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1829"></a><div class='linenum'>1829</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;n,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1830"></a><div class='linenum'>1830</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;val;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1831"></a><div class='linenum'>1831</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1832"></a><div class='linenum'>1832</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1833"></a><div class='linenum'>1833</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1834"></a><div class='linenum'>1834</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1835"></a><div class='linenum'>1835</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1836"></a><div class='linenum'>1836</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;mod&nbsp;m&nbsp;=&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1837"></a><div class='linenum'>1837</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;val&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1838"></a><div class='linenum'>1838</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;:=&nbsp;n&nbsp;/&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1839"></a><div class='linenum'>1839</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1840"></a><div class='linenum'>1840</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1841"></a><div class='linenum'>1841</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;val;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1842"></a><div class='linenum'>1842</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1843"></a><div class='linenum'>1843</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1844"></a><div class='linenum'>1844</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1845"></a><div class='linenum'>1845</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1846"></a><div class='linenum'>1846</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1847"></a><div class='linenum'>1847</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1848"></a><div class='linenum'>1848</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\in(&nbsp;&lt;n>,&nbsp;&lt;Integers>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;membership&nbsp;test&nbsp;for&nbsp;integers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1849"></a><div class='linenum'>1849</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1850"></a><div class='linenum'>1850</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\in,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1851"></a><div class='linenum'>1851</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1852"></a><div class='linenum'>1852</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsElmsColls,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1853"></a><div class='linenum'>1853</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCyclotomic,&nbsp;IsIntegers&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1854"></a><div class='linenum'>1854</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;n,&nbsp;Integers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1855"></a><div class='linenum'>1855</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1856"></a><div class='linenum'>1856</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1857"></a><div class='linenum'>1857</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1858"></a><div class='linenum'>1858</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1859"></a><div class='linenum'>1859</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1860"></a><div class='linenum'>1860</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1861"></a><div class='linenum'>1861</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\in(&nbsp;&lt;n>,&nbsp;&lt;PositiveIntegers>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1862"></a><div class='linenum'>1862</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1863"></a><div class='linenum'>1863</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\in,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1864"></a><div class='linenum'>1864</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;positive&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1865"></a><div class='linenum'>1865</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsElmsColls,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1866"></a><div class='linenum'>1866</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCyclotomic,&nbsp;IsPositiveIntegers&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1867"></a><div class='linenum'>1867</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;n,&nbsp;PositiveIntegers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1868"></a><div class='linenum'>1868</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsPosInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1869"></a><div class='linenum'>1869</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1870"></a><div class='linenum'>1870</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1871"></a><div class='linenum'>1871</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1872"></a><div class='linenum'>1872</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1873"></a><div class='linenum'>1873</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1874"></a><div class='linenum'>1874</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\in(&nbsp;&lt;n>,&nbsp;&lt;NonnegativeIntegers>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1875"></a><div class='linenum'>1875</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1876"></a><div class='linenum'>1876</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\in,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1877"></a><div class='linenum'>1877</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;nonnegative&nbsp;integers",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1878"></a><div class='linenum'>1878</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsElmsColls,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1879"></a><div class='linenum'>1879</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCyclotomic,&nbsp;IsNonnegativeIntegers&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1880"></a><div class='linenum'>1880</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;n,&nbsp;NonnegativeIntegers&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1881"></a><div class='linenum'>1881</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsPosInt(&nbsp;n&nbsp;)&nbsp;or&nbsp;IsZeroCyc(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1882"></a><div class='linenum'>1882</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1883"></a><div class='linenum'>1883</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1884"></a><div class='linenum'>1884</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1885"></a><div class='linenum'>1885</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1886"></a><div class='linenum'>1886</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1887"></a><div class='linenum'>1887</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;PrintFactorsInt(&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;print&nbsp;factorization&nbsp;of&nbsp;an&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1888"></a><div class='linenum'>1888</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1889"></a><div class='linenum'>1889</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(PrintFactorsInt,function&nbsp;(&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1890"></a><div class='linenum'>1890</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;decomp,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1891"></a><div class='linenum'>1891</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1892"></a><div class='linenum'>1892</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;-4&nbsp;&lt;&nbsp;n&nbsp;and&nbsp;n&nbsp;&lt;&nbsp;4&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1893"></a><div class='linenum'>1893</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1894"></a><div class='linenum'>1894</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1895"></a><div class='linenum'>1895</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decomp&nbsp;:=&nbsp;Collected(&nbsp;Factors(&nbsp;AbsInt(&nbsp;n&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1896"></a><div class='linenum'>1896</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1897"></a><div class='linenum'>1897</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;decomp[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1898"></a><div class='linenum'>1898</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1899"></a><div class='linenum'>1899</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;-decomp[1][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1900"></a><div class='linenum'>1900</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1901"></a><div class='linenum'>1901</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;decomp[1][2]&nbsp;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1902"></a><div class='linenum'>1902</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"^",&nbsp;decomp[1][2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1903"></a><div class='linenum'>1903</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1904"></a><div class='linenum'>1904</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;Length(&nbsp;decomp&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1905"></a><div class='linenum'>1905</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"*",&nbsp;decomp[i][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1906"></a><div class='linenum'>1906</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;decomp[i][2]&nbsp;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1907"></a><div class='linenum'>1907</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"^",&nbsp;decomp[i][2]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1908"></a><div class='linenum'>1908</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1909"></a><div class='linenum'>1909</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1910"></a><div class='linenum'>1910</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1911"></a><div class='linenum'>1911</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1912"></a><div class='linenum'>1912</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1913"></a><div class='linenum'>1913</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1914"></a><div class='linenum'>1914</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1915"></a><div class='linenum'>1915</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Iterator(&nbsp;&lt;posint>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.give&nbsp;more&nbsp;informative&nbsp;error
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1916"></a><div class='linenum'>1916</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1917"></a><div class='linenum'>1917</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;method&nbsp;is&nbsp;mainly&nbsp;there&nbsp;to&nbsp;trap&nbsp;the&nbsp;"natural"&nbsp;error&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1918"></a><div class='linenum'>1918</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;3&nbsp;do&nbsp;...&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1919"></a><div class='linenum'>1919</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1920"></a><div class='linenum'>1920</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1921"></a><div class='linenum'>1921</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(Iterator,&nbsp;"more&nbsp;helpful&nbsp;error&nbsp;for&nbsp;integers",&nbsp;true,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1922"></a><div class='linenum'>1922</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[IsPosInt],&nbsp;0,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1923"></a><div class='linenum'>1923</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(n)&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1924"></a><div class='linenum'>1924</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("You&nbsp;cannot&nbsp;loop&nbsp;over&nbsp;the&nbsp;integer&nbsp;",n,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1925"></a><div class='linenum'>1925</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;did&nbsp;you&nbsp;mean&nbsp;the&nbsp;range&nbsp;[1..",n,"]");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1926"></a><div class='linenum'>1926</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1927"></a><div class='linenum'>1927</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1928"></a><div class='linenum'>1928</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(PowerDecompositions,function(n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1929"></a><div class='linenum'>1929</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;d,i,r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1930"></a><div class='linenum'>1930</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;i:=2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1931"></a><div class='linenum'>1931</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;d:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1932"></a><div class='linenum'>1932</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1933"></a><div class='linenum'>1933</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=RootInt(n,i);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1934"></a><div class='linenum'>1934</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n=r^i&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1935"></a><div class='linenum'>1935</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(d,[r,i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1936"></a><div class='linenum'>1936</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1937"></a><div class='linenum'>1937</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1938"></a><div class='linenum'>1938</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;until&nbsp;r&lt;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1939"></a><div class='linenum'>1939</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;d;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1940"></a><div class='linenum'>1940</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1941"></a><div class='linenum'>1941</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1942"></a><div class='linenum'>1942</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;behaviour&nbsp;of&nbsp;View(String)&nbsp;for&nbsp;large&nbsp;integers&nbsp;can&nbsp;be&nbsp;configured&nbsp;via&nbsp;a
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1943"></a><div class='linenum'>1943</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;user&nbsp;preference.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1944"></a><div class='linenum'>1944</div></td><td></td><td></td><td></td><td><span><tt>DeclareUserPreference(&nbsp;rec(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1945"></a><div class='linenum'>1945</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;name:=&nbsp;"MaxBitsIntView",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1946"></a><div class='linenum'>1946</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;description:=&nbsp;[
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1947"></a><div class='linenum'>1947</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"Maximal&nbsp;bit&nbsp;length&nbsp;of&nbsp;integers&nbsp;to&nbsp;'view'&nbsp;unabbreviated.&nbsp;&nbsp;\
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1948"></a><div class='linenum'>1948</div></td><td></td><td></td><td></td><td><span><tt>Default&nbsp;is&nbsp;about&nbsp;30&nbsp;lines&nbsp;of&nbsp;a&nbsp;80&nbsp;character&nbsp;wide&nbsp;terminal.&nbsp;&nbsp;\
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1949"></a><div class='linenum'>1949</div></td><td></td><td></td><td></td><td><span><tt>Set&nbsp;this&nbsp;to&nbsp;'0'&nbsp;to&nbsp;avoid&nbsp;abbreviated&nbsp;ints."
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1950"></a><div class='linenum'>1950</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1951"></a><div class='linenum'>1951</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;default:=&nbsp;8000,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1952"></a><div class='linenum'>1952</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;check:=&nbsp;val&nbsp;->&nbsp;IsInt(&nbsp;val&nbsp;)&nbsp;and&nbsp;0&nbsp;&lt;=&nbsp;val,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1953"></a><div class='linenum'>1953</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1954"></a><div class='linenum'>1954</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;give&nbsp;only&nbsp;a&nbsp;short&nbsp;info&nbsp;if&nbsp;|n|&nbsp;is&nbsp;larger&nbsp;than&nbsp;2^GAPInfo.MaxBitsIntView
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1955"></a><div class='linenum'>1955</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(ViewString,&nbsp;"for&nbsp;integer",&nbsp;[IsInt],&nbsp;function(n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1956"></a><div class='linenum'>1956</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;mb,&nbsp;l,&nbsp;start,&nbsp;trail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1957"></a><div class='linenum'>1957</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;mb&nbsp;:=&nbsp;UserPreference("MaxBitsIntView");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1958"></a><div class='linenum'>1958</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsSmallIntRep(n)&nbsp;and&nbsp;mb&nbsp;&lt;>&nbsp;fail&nbsp;and&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1959"></a><div class='linenum'>1959</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mb&nbsp;>&nbsp;64&nbsp;and&nbsp;Log2Int(n)&nbsp;>&nbsp;mb&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1960"></a><div class='linenum'>1960</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1961"></a><div class='linenum'>1961</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;LogInt(-n,&nbsp;10);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1962"></a><div class='linenum'>1962</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trail&nbsp;:=&nbsp;String(-n&nbsp;mod&nbsp;1000);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1963"></a><div class='linenum'>1963</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1964"></a><div class='linenum'>1964</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;LogInt(n,&nbsp;10);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1965"></a><div class='linenum'>1965</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trail&nbsp;:=&nbsp;String(n&nbsp;mod&nbsp;1000);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1966"></a><div class='linenum'>1966</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1967"></a><div class='linenum'>1967</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;start&nbsp;:=&nbsp;String(QuoInt(n,&nbsp;10^(l-2)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1968"></a><div class='linenum'>1968</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(trail)&nbsp;&lt;&nbsp;3&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1969"></a><div class='linenum'>1969</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trail&nbsp;:=&nbsp;Concatenation("0",&nbsp;trail);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1970"></a><div class='linenum'>1970</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1971"></a><div class='linenum'>1971</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Concatenation("&lt;integer&nbsp;",start,"...",trail,"&nbsp;(",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1972"></a><div class='linenum'>1972</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(l+1),"&nbsp;digits)>");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1973"></a><div class='linenum'>1973</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1974"></a><div class='linenum'>1974</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;String(n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1975"></a><div class='linenum'>1975</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1976"></a><div class='linenum'>1976</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1977"></a><div class='linenum'>1977</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1978"></a><div class='linenum'>1978</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1979"></a><div class='linenum'>1979</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1980"></a><div class='linenum'>1980</div></td><td></td><td></td><td></td><td><span><tt>#E
</tt></span></td><td><span></span></td></tr>
</tbody>
</table></body></html>
