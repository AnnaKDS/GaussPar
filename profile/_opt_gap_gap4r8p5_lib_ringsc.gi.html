<!DOCTYPE html><script src="sorttable.js"></script><html><body>
<style>
table { border-collapse: collapse }
tr .linenum { text-align: right; }
tr:nth-child(odd)  { background-color: #EEE; }
tr:nth-child(even)  { background-color: #FFF; }
tr:nth-child(odd).exec  { background-color: #0F0; }
tr:nth-child(even).exec  { background-color: #3F3; }
tr:nth-child(odd).missed  { background-color: #F00; }
tr:nth-child(even).missed  { background-color: #F33; }
td, th {
    border: 1px solid #98bf21;
    padding: 3px 7px 2px 7px;
}
th {
    font-size: 1.1em;
    text-align: left;
    padding-top: 5px;
    padding-bottom: 4px;
    background-color: #A7C942;
    color: #ffffff;
}
table.sortable th:not(.sorttable_sorted):not(.sorttable_sorted_reverse):not(.sorttable_nosort):after {
    content: " \25B4\25BE"
}

/* HSV gradient made using http://www.perbang.dk/rgbgradient/ */
td.coverage00 { background-color: #FF0000; }
td.coverage10 { background-color: #F83100; }
td.coverage20 { background-color: #F25F00; }
td.coverage30 { background-color: #EB8B00; }
td.coverage40 { background-color: #E5B500; }
td.coverage50 { background-color: #DFDC00; }
td.coverage60 { background-color: #B0D800; }
td.coverage70 { background-color: #81D200; }
td.coverage80 { background-color: #55CB00; }
td.coverage90 { background-color: #2CC500; }
td.coverage100 { background-color: #04BF00; }
</style><p>This file was read by GAP before profiling was actived, so lines which were not read but not executed are not marked.</p><table class="sortable">
<thead><tr><th>Line</th><th>Execs</th><th>Time</th><th>Time+Childs</th><th>Code</th><th>Called Functions</th>
</tr></thead>
<tbody>
<tr class='ignore'><td><a name="line1"></a><div class='linenum'>1</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2"></a><div class='linenum'>2</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3"></a><div class='linenum'>3</div></td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;ringsc.gi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAP&nbsp;library&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alexander&nbsp;Hulpke
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4"></a><div class='linenum'>4</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5"></a><div class='linenum'>5</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line6"></a><div class='linenum'>6</div></td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;2008&nbsp;The&nbsp;GAP&nbsp;Group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line7"></a><div class='linenum'>7</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line8"></a><div class='linenum'>8</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;file&nbsp;contains&nbsp;methods&nbsp;for&nbsp;elements&nbsp;of&nbsp;rings,&nbsp;given&nbsp;as&nbsp;Z-modules&nbsp;with
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line9"></a><div class='linenum'>9</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;structure&nbsp;constants&nbsp;for&nbsp;multiplication.&nbsp;It&nbsp;is&nbsp;based&nbsp;on&nbsp;algsc.gi
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line10"></a><div class='linenum'>10</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line11"></a><div class='linenum'>11</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line12"></a><div class='linenum'>12</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line13"></a><div class='linenum'>13</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("SCRingReducedModuli",function(moduli,l)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line14"></a><div class='linenum'>14</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line15"></a><div class='linenum'>15</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsMutable(l)&nbsp;then&nbsp;l:=ShallowCopy(l);fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line16"></a><div class='linenum'>16</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(l)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line17"></a><div class='linenum'>17</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;moduli[i]&lt;>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line18"></a><div class='linenum'>18</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l[i]:=l[i]&nbsp;mod&nbsp;moduli[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line19"></a><div class='linenum'>19</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line20"></a><div class='linenum'>20</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line21"></a><div class='linenum'>21</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;l;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line22"></a><div class='linenum'>22</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line23"></a><div class='linenum'>23</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line24"></a><div class='linenum'>24</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line25"></a><div class='linenum'>25</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line26"></a><div class='linenum'>26</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ObjByExtRep(&nbsp;&lt;Fam>,&nbsp;&lt;descr>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;s.~c.&nbsp;ring&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line27"></a><div class='linenum'>27</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line28"></a><div class='linenum'>28</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Check&nbsp;whether&nbsp;the&nbsp;coefficients&nbsp;list&nbsp;&lt;coeffs>&nbsp;has&nbsp;the&nbsp;right&nbsp;length,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line29"></a><div class='linenum'>29</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;has&nbsp;integer&nbsp;entries&nbsp;bound&nbsp;by&nbsp;the&nbsp;moduli
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line30"></a><div class='linenum'>30</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line31"></a><div class='linenum'>31</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ObjByExtRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line32"></a><div class='linenum'>32</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;elements&nbsp;family",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line33"></a><div class='linenum'>33</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObjFamily,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line34"></a><div class='linenum'>34</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;Fam,&nbsp;coeffs&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line35"></a><div class='linenum'>35</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;coeffs&nbsp;)&nbsp;&lt;>&nbsp;Length(&nbsp;Fam!.names&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line36"></a><div class='linenum'>36</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;coeffs>&nbsp;must&nbsp;be&nbsp;a&nbsp;list&nbsp;of&nbsp;length&nbsp;",&nbsp;Fam!.names&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line37"></a><div class='linenum'>37</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;ForAll(&nbsp;[1..Length(coeffs)],&nbsp;IsInt&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line38"></a><div class='linenum'>38</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ForAll([1..Length(coeffs)],p->Fam!.moduli[p]=0&nbsp;or&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line39"></a><div class='linenum'>39</div></td><td></td><td></td><td></td><td><span><tt>	(0&lt;=coeffs[p]&nbsp;and&nbsp;coeffs[p]&lt;Fam!.moduli[p]))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line40"></a><div class='linenum'>40</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"all&nbsp;in&nbsp;&lt;coeffs>&nbsp;must&nbsp;be&nbsp;integers&nbsp;bounded&nbsp;by&nbsp;`moduli'"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line41"></a><div class='linenum'>41</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line42"></a><div class='linenum'>42</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Objectify(&nbsp;Fam!.defaultTypeDenseCoeffVectorRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line43"></a><div class='linenum'>43</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;Immutable(&nbsp;coeffs&nbsp;)&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line44"></a><div class='linenum'>44</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line45"></a><div class='linenum'>45</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line46"></a><div class='linenum'>46</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line47"></a><div class='linenum'>47</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line48"></a><div class='linenum'>48</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ExtRepOfObj(&nbsp;&lt;elm>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;s.~c.&nbsp;ring&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line49"></a><div class='linenum'>49</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line50"></a><div class='linenum'>50</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ExtRepOfObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line51"></a><div class='linenum'>51</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element&nbsp;in&nbsp;dense&nbsp;coeff.&nbsp;vector&nbsp;rep.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line52"></a><div class='linenum'>52</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep&nbsp;],&nbsp;elm&nbsp;->&nbsp;elm![1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line53"></a><div class='linenum'>53</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line54"></a><div class='linenum'>54</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line55"></a><div class='linenum'>55</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line56"></a><div class='linenum'>56</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Print(&nbsp;&lt;elm>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;s.~c.&nbsp;ring&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line57"></a><div class='linenum'>57</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line58"></a><div class='linenum'>58</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PrintObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line59"></a><div class='linenum'>59</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line60"></a><div class='linenum'>60</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObj&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line61"></a><div class='linenum'>61</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;elm&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line62"></a><div class='linenum'>62</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line63"></a><div class='linenum'>63</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;F,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;family&nbsp;of&nbsp;`elm'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line64"></a><div class='linenum'>64</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names,&nbsp;&nbsp;#&nbsp;generators&nbsp;names
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line65"></a><div class='linenum'>65</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;moduli,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line66"></a><div class='linenum'>66</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;dimension&nbsp;of&nbsp;the&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line67"></a><div class='linenum'>67</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero,&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;element&nbsp;of&nbsp;the&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line68"></a><div class='linenum'>68</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;depth,&nbsp;&nbsp;#&nbsp;first&nbsp;nonzero&nbsp;position&nbsp;in&nbsp;coefficients&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line69"></a><div class='linenum'>69</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;coefficients&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line70"></a><div class='linenum'>70</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line71"></a><div class='linenum'>71</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;FamilyObj(&nbsp;elm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line72"></a><div class='linenum'>72</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;names&nbsp;:=&nbsp;F!.names;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line73"></a><div class='linenum'>73</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;moduli:=&nbsp;F!.moduli;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line74"></a><div class='linenum'>74</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elm&nbsp;&nbsp;&nbsp;:=&nbsp;ExtRepOfObj(&nbsp;elm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line75"></a><div class='linenum'>75</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;&nbsp;&nbsp;:=&nbsp;Length(&nbsp;elm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line76"></a><div class='linenum'>76</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line77"></a><div class='linenum'>77</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Treat&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;ring&nbsp;is&nbsp;trivial.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line78"></a><div class='linenum'>78</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line79"></a><div class='linenum'>79</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"&lt;zero&nbsp;of&nbsp;trivial&nbsp;s.c.&nbsp;ring>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line80"></a><div class='linenum'>80</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line81"></a><div class='linenum'>81</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line82"></a><div class='linenum'>82</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line83"></a><div class='linenum'>83</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;depth&nbsp;:=&nbsp;PositionNot(&nbsp;elm,&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line84"></a><div class='linenum'>84</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line85"></a><div class='linenum'>85</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;&lt;&nbsp;depth&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line86"></a><div class='linenum'>86</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line87"></a><div class='linenum'>87</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Print&nbsp;the&nbsp;zero&nbsp;element.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line88"></a><div class='linenum'>88</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Note&nbsp;that&nbsp;the&nbsp;unique&nbsp;element&nbsp;of&nbsp;a&nbsp;zero&nbsp;ring&nbsp;has&nbsp;a&nbsp;name.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line89"></a><div class='linenum'>89</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"0*",&nbsp;names[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line90"></a><div class='linenum'>90</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line91"></a><div class='linenum'>91</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line92"></a><div class='linenum'>92</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line93"></a><div class='linenum'>93</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;elm[depth]&lt;>1&nbsp;and&nbsp;elm[depth]-moduli[depth]&nbsp;=-1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line94"></a><div class='linenum'>94</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;Print("-");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line95"></a><div class='linenum'>95</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;elm[&nbsp;depth&nbsp;]&nbsp;&lt;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line96"></a><div class='linenum'>96</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;elm[&nbsp;depth&nbsp;],&nbsp;"*"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line97"></a><div class='linenum'>97</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line98"></a><div class='linenum'>98</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;names[&nbsp;depth&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line99"></a><div class='linenum'>99</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line100"></a><div class='linenum'>100</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;depth+1&nbsp;..&nbsp;len&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line101"></a><div class='linenum'>101</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;elm[i]&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line102"></a><div class='linenum'>102</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;elm[i]=1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line103"></a><div class='linenum'>103</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"+"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line104"></a><div class='linenum'>104</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;elm[i]-moduli[i]&nbsp;=-1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line105"></a><div class='linenum'>105</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;Print("-");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line106"></a><div class='linenum'>106</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;elm[i]&nbsp;&lt;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line107"></a><div class='linenum'>107</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print("+",&nbsp;elm[i],&nbsp;"*"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line108"></a><div class='linenum'>108</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line109"></a><div class='linenum'>109</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;names[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line110"></a><div class='linenum'>110</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line111"></a><div class='linenum'>111</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line112"></a><div class='linenum'>112</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line113"></a><div class='linenum'>113</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line114"></a><div class='linenum'>114</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line115"></a><div class='linenum'>115</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line116"></a><div class='linenum'>116</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line117"></a><div class='linenum'>117</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;String(&nbsp;&lt;elm>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;s.~c.&nbsp;ring&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line118"></a><div class='linenum'>118</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line119"></a><div class='linenum'>119</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;String,&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element",&nbsp;[&nbsp;IsSCRingObj&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line120"></a><div class='linenum'>120</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;elm&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line121"></a><div class='linenum'>121</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line122"></a><div class='linenum'>122</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;s,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;string
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line123"></a><div class='linenum'>123</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names,&nbsp;&nbsp;#&nbsp;generators&nbsp;names
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line124"></a><div class='linenum'>124</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;moduli,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line125"></a><div class='linenum'>125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;dimension&nbsp;of&nbsp;the&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line126"></a><div class='linenum'>126</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero,&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;element&nbsp;of&nbsp;the&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line127"></a><div class='linenum'>127</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;depth,&nbsp;&nbsp;#&nbsp;first&nbsp;nonzero&nbsp;position&nbsp;in&nbsp;coefficients&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line128"></a><div class='linenum'>128</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;coefficients&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line129"></a><div class='linenum'>129</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line130"></a><div class='linenum'>130</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;names&nbsp;:=&nbsp;FamilyObj(elm)!.names;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line131"></a><div class='linenum'>131</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;moduli:=&nbsp;FamilyObj(elm)!.moduli;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line132"></a><div class='linenum'>132</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elm&nbsp;&nbsp;&nbsp;:=&nbsp;ExtRepOfObj(&nbsp;elm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line133"></a><div class='linenum'>133</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;&nbsp;&nbsp;:=&nbsp;Length(&nbsp;elm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line134"></a><div class='linenum'>134</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line135"></a><div class='linenum'>135</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Treat&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;ring&nbsp;is&nbsp;trivial.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line136"></a><div class='linenum'>136</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line137"></a><div class='linenum'>137</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"&lt;zero&nbsp;of&nbsp;trivial&nbsp;s.c.&nbsp;ring>";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line138"></a><div class='linenum'>138</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line139"></a><div class='linenum'>139</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line140"></a><div class='linenum'>140</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;depth&nbsp;:=&nbsp;PositionNot(&nbsp;elm,&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line141"></a><div class='linenum'>141</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line142"></a><div class='linenum'>142</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len&nbsp;&lt;&nbsp;depth&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line143"></a><div class='linenum'>143</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line144"></a><div class='linenum'>144</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Print&nbsp;the&nbsp;zero&nbsp;element.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line145"></a><div class='linenum'>145</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Note&nbsp;that&nbsp;the&nbsp;unique&nbsp;element&nbsp;of&nbsp;a&nbsp;zero&nbsp;ring&nbsp;has&nbsp;a&nbsp;name.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line146"></a><div class='linenum'>146</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Concatenation(&nbsp;"0*",&nbsp;names[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line147"></a><div class='linenum'>147</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line148"></a><div class='linenum'>148</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line149"></a><div class='linenum'>149</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line150"></a><div class='linenum'>150</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s:="";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line151"></a><div class='linenum'>151</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;elm[depth]&lt;>1&nbsp;and&nbsp;elm[depth]-moduli[depth]&nbsp;=-1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line152"></a><div class='linenum'>152</div></td><td></td><td></td><td></td><td><span><tt>	Add(s,'-');
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line153"></a><div class='linenum'>153</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;elm[&nbsp;depth&nbsp;]&nbsp;&lt;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line154"></a><div class='linenum'>154</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(s,String(elm[&nbsp;depth&nbsp;]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line155"></a><div class='linenum'>155</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(s,'*');
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line156"></a><div class='linenum'>156</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line157"></a><div class='linenum'>157</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(s,&nbsp;names[&nbsp;depth&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line158"></a><div class='linenum'>158</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line159"></a><div class='linenum'>159</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;depth+1&nbsp;..&nbsp;len&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line160"></a><div class='linenum'>160</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;elm[i]&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line161"></a><div class='linenum'>161</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;elm[i]=1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line162"></a><div class='linenum'>162</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;Add(s,'+');
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line163"></a><div class='linenum'>163</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;elm[i]-moduli[i]&nbsp;=-1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line164"></a><div class='linenum'>164</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;Add(s,'-');
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line165"></a><div class='linenum'>165</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;elm[i]&nbsp;&lt;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line166"></a><div class='linenum'>166</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;Add(s,'+');
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line167"></a><div class='linenum'>167</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(s,String(&nbsp;elm[i]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line168"></a><div class='linenum'>168</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;Add(s,'*');
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line169"></a><div class='linenum'>169</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line170"></a><div class='linenum'>170</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(s,&nbsp;names[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line171"></a><div class='linenum'>171</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line172"></a><div class='linenum'>172</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line173"></a><div class='linenum'>173</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line174"></a><div class='linenum'>174</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line175"></a><div class='linenum'>175</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;s;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line176"></a><div class='linenum'>176</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line177"></a><div class='linenum'>177</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line178"></a><div class='linenum'>178</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line179"></a><div class='linenum'>179</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line180"></a><div class='linenum'>180</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\=(&nbsp;&lt;x>,&nbsp;&lt;y>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;equality&nbsp;of&nbsp;two&nbsp;s.~c.&nbsp;ring&nbsp;objects
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line181"></a><div class='linenum'>181</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\&lt;(&nbsp;&lt;x>,&nbsp;&lt;y>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;comparison&nbsp;of&nbsp;two&nbsp;s.~c.&nbsp;ring&nbsp;objects
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line182"></a><div class='linenum'>182</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\+(&nbsp;&lt;x>,&nbsp;&lt;y>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;sum&nbsp;of&nbsp;two&nbsp;s.~c.&nbsp;ring&nbsp;objects
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line183"></a><div class='linenum'>183</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\-(&nbsp;&lt;x>,&nbsp;&lt;y>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;difference&nbsp;of&nbsp;two&nbsp;s.~c.&nbsp;ring&nbsp;objects
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line184"></a><div class='linenum'>184</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\*(&nbsp;&lt;x>,&nbsp;&lt;y>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;product&nbsp;of&nbsp;two&nbsp;s.~c.&nbsp;ring&nbsp;objects
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line185"></a><div class='linenum'>185</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Zero(&nbsp;&lt;x>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;zero&nbsp;of&nbsp;an&nbsp;s.~c.&nbsp;ring&nbsp;element
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line186"></a><div class='linenum'>186</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;AdditiveInverse(&nbsp;&lt;x>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;&nbsp;additive&nbsp;inverse&nbsp;of&nbsp;an&nbsp;s.~c.&nbsp;ring&nbsp;element
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line187"></a><div class='linenum'>187</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Inverse(&nbsp;&lt;x>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;inverse&nbsp;of&nbsp;an&nbsp;s.~c.&nbsp;ring&nbsp;element
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line188"></a><div class='linenum'>188</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line189"></a><div class='linenum'>189</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\=,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line190"></a><div class='linenum'>190</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;elements&nbsp;in&nbsp;dense&nbsp;vector&nbsp;rep.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line191"></a><div class='linenum'>191</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line192"></a><div class='linenum'>192</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line193"></a><div class='linenum'>193</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line194"></a><div class='linenum'>194</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;x,&nbsp;y&nbsp;)&nbsp;return&nbsp;x![1]&nbsp;=&nbsp;y![1];&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line195"></a><div class='linenum'>195</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line196"></a><div class='linenum'>196</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\&lt;,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line197"></a><div class='linenum'>197</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;elements&nbsp;in&nbsp;dense&nbsp;vector&nbsp;rep.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line198"></a><div class='linenum'>198</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line199"></a><div class='linenum'>199</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line200"></a><div class='linenum'>200</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line201"></a><div class='linenum'>201</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;x,&nbsp;y&nbsp;)&nbsp;return&nbsp;x![1]&nbsp;&lt;&nbsp;y![1];&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line202"></a><div class='linenum'>202</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line203"></a><div class='linenum'>203</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\+,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line204"></a><div class='linenum'>204</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;elements&nbsp;in&nbsp;dense&nbsp;vector&nbsp;rep.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line205"></a><div class='linenum'>205</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line206"></a><div class='linenum'>206</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line207"></a><div class='linenum'>207</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line208"></a><div class='linenum'>208</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;x,&nbsp;y&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line209"></a><div class='linenum'>209</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line210"></a><div class='linenum'>210</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line211"></a><div class='linenum'>211</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Objectify(&nbsp;fam!.defaultTypeDenseCoeffVectorRep,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line212"></a><div class='linenum'>212</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;Immutable(&nbsp;SCRingReducedModuli(fam!.moduli,x![1]+y![1]))&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line213"></a><div class='linenum'>213</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line214"></a><div class='linenum'>214</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line215"></a><div class='linenum'>215</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\-,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line216"></a><div class='linenum'>216</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;elements&nbsp;in&nbsp;dense&nbsp;vector&nbsp;rep.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line217"></a><div class='linenum'>217</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line218"></a><div class='linenum'>218</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line219"></a><div class='linenum'>219</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line220"></a><div class='linenum'>220</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;x,&nbsp;y&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line221"></a><div class='linenum'>221</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line222"></a><div class='linenum'>222</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line223"></a><div class='linenum'>223</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Objectify(&nbsp;fam!.defaultTypeDenseCoeffVectorRep,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line224"></a><div class='linenum'>224</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;Immutable(&nbsp;SCRingReducedModuli(fam!.moduli,x![1]-y![1]))&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line225"></a><div class='linenum'>225</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line226"></a><div class='linenum'>226</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line227"></a><div class='linenum'>227</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line228"></a><div class='linenum'>228</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;elements&nbsp;in&nbsp;dense&nbsp;vector&nbsp;rep.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line229"></a><div class='linenum'>229</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line230"></a><div class='linenum'>230</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line231"></a><div class='linenum'>231</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line232"></a><div class='linenum'>232</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;x,&nbsp;y&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line233"></a><div class='linenum'>233</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line234"></a><div class='linenum'>234</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=&nbsp;FamilyObj(&nbsp;x&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line235"></a><div class='linenum'>235</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Objectify(&nbsp;fam!.defaultTypeDenseCoeffVectorRep,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line236"></a><div class='linenum'>236</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;Immutable(&nbsp;SCRingReducedModuli(fam!.moduli,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line237"></a><div class='linenum'>237</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCTableProduct(&nbsp;fam!.sctable,&nbsp;x![1],&nbsp;y![1]&nbsp;)&nbsp;))&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line238"></a><div class='linenum'>238</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line239"></a><div class='linenum'>239</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line240"></a><div class='linenum'>240</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line241"></a><div class='linenum'>241</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integer&nbsp;and&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element&nbsp;in&nbsp;dense&nbsp;vector&nbsp;rep.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line242"></a><div class='linenum'>242</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsCoeffsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line243"></a><div class='linenum'>243</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsInt,&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line244"></a><div class='linenum'>244</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;x,&nbsp;y&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line245"></a><div class='linenum'>245</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line246"></a><div class='linenum'>246</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(y);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line247"></a><div class='linenum'>247</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Objectify(&nbsp;fam!.defaultTypeDenseCoeffVectorRep,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line248"></a><div class='linenum'>248</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;Immutable(&nbsp;SCRingReducedModuli(fam!.moduli,x*y![1]))&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line249"></a><div class='linenum'>249</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line250"></a><div class='linenum'>250</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line251"></a><div class='linenum'>251</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line252"></a><div class='linenum'>252</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element&nbsp;in&nbsp;dense&nbsp;vector&nbsp;rep.&nbsp;and&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line253"></a><div class='linenum'>253</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsElmsCoeffs,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line254"></a><div class='linenum'>254</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep,&nbsp;IsInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line255"></a><div class='linenum'>255</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;x,&nbsp;y&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line256"></a><div class='linenum'>256</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line257"></a><div class='linenum'>257</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line258"></a><div class='linenum'>258</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Objectify(&nbsp;fam!.defaultTypeDenseCoeffVectorRep,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line259"></a><div class='linenum'>259</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;Immutable(&nbsp;SCRingReducedModuli(fam!.moduli,x![1]*y))&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line260"></a><div class='linenum'>260</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line261"></a><div class='linenum'>261</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line262"></a><div class='linenum'>262</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ZeroOp,&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element",&nbsp;[&nbsp;IsSCRingObj&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line263"></a><div class='linenum'>263</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;x&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line264"></a><div class='linenum'>264</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line265"></a><div class='linenum'>265</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line266"></a><div class='linenum'>266</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Objectify(&nbsp;fam!.defaultTypeDenseCoeffVectorRep,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line267"></a><div class='linenum'>267</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;Immutable(&nbsp;SCRingReducedModuli(fam!.moduli,0*x![1]))&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line268"></a><div class='linenum'>268</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line269"></a><div class='linenum'>269</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line270"></a><div class='linenum'>270</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AdditiveInverseOp,&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element",&nbsp;[&nbsp;IsSCRingObj&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line271"></a><div class='linenum'>271</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;x&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line272"></a><div class='linenum'>272</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line273"></a><div class='linenum'>273</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line274"></a><div class='linenum'>274</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Objectify(&nbsp;fam!.defaultTypeDenseCoeffVectorRep,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line275"></a><div class='linenum'>275</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;Immutable(&nbsp;SCRingReducedModuli(fam!.moduli,-x![1]))&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line276"></a><div class='linenum'>276</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line277"></a><div class='linenum'>277</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line278"></a><div class='linenum'>278</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;OneOp,&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element",&nbsp;[&nbsp;IsSCRingObj&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line279"></a><div class='linenum'>279</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;x&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line280"></a><div class='linenum'>280</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam,r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line281"></a><div class='linenum'>281</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line282"></a><div class='linenum'>282</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;r:=fam!.fullSCRing;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line283"></a><div class='linenum'>283</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;One(r);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line284"></a><div class='linenum'>284</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line285"></a><div class='linenum'>285</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line286"></a><div class='linenum'>286</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InverseOp,&nbsp;"for&nbsp;s.&nbsp;c.&nbsp;ring&nbsp;element",&nbsp;[&nbsp;IsSCRingObj&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line287"></a><div class='linenum'>287</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;x&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line288"></a><div class='linenum'>288</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam,r,w,l,o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line289"></a><div class='linenum'>289</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line290"></a><div class='linenum'>290</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;r:=fam!.fullSCRing;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line291"></a><div class='linenum'>291</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;One(r)=fail&nbsp;then&nbsp;return&nbsp;fail;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line292"></a><div class='linenum'>292</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsFinite(r)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line293"></a><div class='linenum'>293</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=Filtered(Elements(r),y->x*y=One(r)&nbsp;and&nbsp;y*x=One(r));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line294"></a><div class='linenum'>294</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(r)>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line295"></a><div class='linenum'>295</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line296"></a><div class='linenum'>296</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line297"></a><div class='linenum'>297</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line298"></a><div class='linenum'>298</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line299"></a><div class='linenum'>299</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line300"></a><div class='linenum'>300</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o:=One(r);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line301"></a><div class='linenum'>301</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x=o&nbsp;then&nbsp;return&nbsp;x;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line302"></a><div class='linenum'>302</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;try&nbsp;powering
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line303"></a><div class='linenum'>303</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;w:=x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line304"></a><div class='linenum'>304</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l:=[w];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line305"></a><div class='linenum'>305</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line306"></a><div class='linenum'>306</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w:=w*x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line307"></a><div class='linenum'>307</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;w=o&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line308"></a><div class='linenum'>308</div></td><td></td><td></td><td></td><td><span><tt>	#&nbsp;last&nbsp;entry&nbsp;was&nbsp;inverse
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line309"></a><div class='linenum'>309</div></td><td></td><td></td><td></td><td><span><tt>	return&nbsp;l[Length(l)];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line310"></a><div class='linenum'>310</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line311"></a><div class='linenum'>311</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;w&nbsp;in&nbsp;l&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line312"></a><div class='linenum'>312</div></td><td></td><td></td><td></td><td><span><tt>	#&nbsp;loop&nbsp;without&nbsp;inverse&nbsp;--&nbsp;not&nbsp;invertible
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line313"></a><div class='linenum'>313</div></td><td></td><td></td><td></td><td><span><tt>	return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line314"></a><div class='linenum'>314</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line315"></a><div class='linenum'>315</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(l,w);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line316"></a><div class='linenum'>316</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;Length(l)>10^6;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line317"></a><div class='linenum'>317</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("cannot&nbsp;find&nbsp;inverse");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line318"></a><div class='linenum'>318</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line319"></a><div class='linenum'>319</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line320"></a><div class='linenum'>320</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line321"></a><div class='linenum'>321</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line322"></a><div class='linenum'>322</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line323"></a><div class='linenum'>323</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RingByStructureConstants(&nbsp;&lt;moduli>,&nbsp;&lt;sctable>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line324"></a><div class='linenum'>324</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RingByStructureConstants(&nbsp;&lt;moduli>,&nbsp;&lt;sctable>,&nbsp;&lt;name>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line325"></a><div class='linenum'>325</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RingByStructureConstants(&nbsp;&lt;moduli>,&nbsp;&lt;sctable>,&nbsp;&lt;names>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line326"></a><div class='linenum'>326</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RingByStructureConstants(&nbsp;&lt;moduli>,&nbsp;&lt;sctable>,&nbsp;&lt;name1>,&nbsp;&lt;name2>,&nbsp;...&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line327"></a><div class='linenum'>327</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line328"></a><div class='linenum'>328</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;is&nbsp;an&nbsp;Z-module&nbsp;$M$&nbsp;defined&nbsp;by&nbsp;the&nbsp;structure&nbsp;constants
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line329"></a><div class='linenum'>329</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;table&nbsp;&lt;sctable>&nbsp;of&nbsp;length&nbsp;$n$,&nbsp;say.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line330"></a><div class='linenum'>330</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line331"></a><div class='linenum'>331</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;generators&nbsp;of&nbsp;$M$&nbsp;are&nbsp;linearly&nbsp;independent&nbsp;abstract&nbsp;space&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line332"></a><div class='linenum'>332</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$x_1,&nbsp;x_2,&nbsp;\ldots,&nbsp;x_n$&nbsp;whose&nbsp;additive&nbsp;orders&nbsp;is&nbsp;given&nbsp;by&nbsp;the&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line333"></a><div class='linenum'>333</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&lt;moduli>.&nbsp;&nbsp;They&nbsp;are&nbsp;multiplied&nbsp;according&nbsp;to&nbsp;the&nbsp;formula
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line334"></a><div class='linenum'>334</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$&nbsp;x_i&nbsp;x_j&nbsp;=&nbsp;\sum_{k=1}^n&nbsp;c_{ijk}&nbsp;x_k$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line335"></a><div class='linenum'>335</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;where&nbsp;`$c_{ijk}$&nbsp;=&nbsp;&lt;sctable>[i][j][1][i_k]'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line336"></a><div class='linenum'>336</div></td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;`&lt;sctable>[i][j][2][i_k]&nbsp;=&nbsp;k'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line337"></a><div class='linenum'>337</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line338"></a><div class='linenum'>338</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;RingByStructureConstants,&nbsp;function(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line339"></a><div class='linenum'>339</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;T,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;structure&nbsp;constants&nbsp;table
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line340"></a><div class='linenum'>340</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;dimensions&nbsp;of&nbsp;structure&nbsp;matrices
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line341"></a><div class='linenum'>341</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduli,&nbsp;#&nbsp;additive&nbsp;orders&nbsp;of&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line342"></a><div class='linenum'>342</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero,&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;of&nbsp;`R'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line343"></a><div class='linenum'>343</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names,&nbsp;&nbsp;#&nbsp;names&nbsp;of&nbsp;the&nbsp;ring&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line344"></a><div class='linenum'>344</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fam,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;family&nbsp;of&nbsp;ring&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line345"></a><div class='linenum'>345</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;ring,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line346"></a><div class='linenum'>346</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;filter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line347"></a><div class='linenum'>347</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens;&nbsp;&nbsp;&nbsp;#&nbsp;ring&nbsp;generators&nbsp;of&nbsp;`A'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line348"></a><div class='linenum'>348</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line349"></a><div class='linenum'>349</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;the&nbsp;argument&nbsp;list.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line350"></a><div class='linenum'>350</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;1&nbsp;&lt;&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;and&nbsp;IsList(&nbsp;arg[1]&nbsp;)&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line351"></a><div class='linenum'>351</div></td><td></td><td></td><td></td><td><span><tt>				&nbsp;and&nbsp;Length(arg[1])>0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line352"></a><div class='linenum'>352</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsList(&nbsp;arg[2]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line353"></a><div class='linenum'>353</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"usage:&nbsp;RingByStructureConstants([&lt;moduli>,&lt;sctable>])&nbsp;or&nbsp;\n",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line354"></a><div class='linenum'>354</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"RingByStructureConstants([&lt;moduli>,&lt;sctable>,&lt;name1>,...])"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line355"></a><div class='linenum'>355</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line356"></a><div class='linenum'>356</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line357"></a><div class='linenum'>357</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;moduli&nbsp;:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line358"></a><div class='linenum'>358</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=Length(moduli);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line359"></a><div class='linenum'>359</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;Immutable(arg[2]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line360"></a><div class='linenum'>360</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line361"></a><div class='linenum'>361</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Construct&nbsp;names&nbsp;of&nbsp;generators&nbsp;(used&nbsp;for&nbsp;printing&nbsp;only).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line362"></a><div class='linenum'>362</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;2&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line363"></a><div class='linenum'>363</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names:=&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line364"></a><div class='linenum'>364</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;Concatenation(&nbsp;"r.",&nbsp;String(x)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line365"></a><div class='linenum'>365</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MakeImmutable(&nbsp;names&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line366"></a><div class='linenum'>366</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;3&nbsp;and&nbsp;IsString(&nbsp;arg[3]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line367"></a><div class='linenum'>367</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names:=&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line368"></a><div class='linenum'>368</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;Concatenation(&nbsp;arg[3],&nbsp;String(x)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line369"></a><div class='linenum'>369</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MakeImmutable(&nbsp;names&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line370"></a><div class='linenum'>370</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;3&nbsp;and&nbsp;IsHomogeneousList(&nbsp;arg[3]&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line371"></a><div class='linenum'>371</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;Length(&nbsp;arg[3]&nbsp;)&nbsp;=&nbsp;n
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line372"></a><div class='linenum'>372</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ForAll(&nbsp;arg[3],&nbsp;IsString&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line373"></a><div class='linenum'>373</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names:=&nbsp;Immutable(&nbsp;arg[3]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line374"></a><div class='linenum'>374</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;2&nbsp;+&nbsp;n&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line375"></a><div class='linenum'>375</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names:=&nbsp;Immutable(&nbsp;arg{&nbsp;[&nbsp;3&nbsp;..&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;]&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line376"></a><div class='linenum'>376</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line377"></a><div class='linenum'>377</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"usage:&nbsp;RingByStructureConstants([&lt;moduli>,&lt;sctable>])&nbsp;or&nbsp;\n",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line378"></a><div class='linenum'>378</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"RingByStructureConstants([&lt;moduli>,&lt;sctable>,&lt;name1>,...])"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line379"></a><div class='linenum'>379</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line380"></a><div class='linenum'>380</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line381"></a><div class='linenum'>381</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;filter:=&nbsp;IsSCRingObj&nbsp;and&nbsp;IsAdditivelyCommutativeElement;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line382"></a><div class='linenum'>382</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line383"></a><div class='linenum'>383</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Construct&nbsp;the&nbsp;family&nbsp;of&nbsp;elements&nbsp;of&nbsp;our&nbsp;ring.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line384"></a><div class='linenum'>384</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Fam:=&nbsp;NewFamily(&nbsp;"SCRingObjFamily",&nbsp;filter&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line385"></a><div class='linenum'>385</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line386"></a><div class='linenum'>386</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;the&nbsp;elements&nbsp;family&nbsp;of&nbsp;`R'&nbsp;has&nbsp;a&nbsp;uniquely&nbsp;determined&nbsp;zero&nbsp;element,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line387"></a><div class='linenum'>387</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;then&nbsp;all&nbsp;coefficients&nbsp;in&nbsp;this&nbsp;family&nbsp;are&nbsp;admissible.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line388"></a><div class='linenum'>388</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Otherwise&nbsp;only&nbsp;coefficients&nbsp;from&nbsp;`R'&nbsp;itself&nbsp;are&nbsp;allowed.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line389"></a><div class='linenum'>389</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Zero(&nbsp;ElementsFamily(&nbsp;FamilyObj(&nbsp;R&nbsp;)&nbsp;)&nbsp;)&nbsp;&lt;>&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line390"></a><div class='linenum'>390</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetFilterObj(&nbsp;Fam,&nbsp;IsFamilyOverFullCoefficientsFamily&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line391"></a><div class='linenum'>391</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line392"></a><div class='linenum'>392</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fam!.coefficientsDomain:=&nbsp;R;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line393"></a><div class='linenum'>393</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line394"></a><div class='linenum'>394</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line395"></a><div class='linenum'>395</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Fam!.moduli&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;moduli;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line396"></a><div class='linenum'>396</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Fam!.sctable&nbsp;&nbsp;&nbsp;:=&nbsp;T;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line397"></a><div class='linenum'>397</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Fam!.names&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;names;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line398"></a><div class='linenum'>398</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line399"></a><div class='linenum'>399</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Construct&nbsp;the&nbsp;default&nbsp;type&nbsp;of&nbsp;the&nbsp;family.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line400"></a><div class='linenum'>400</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Fam!.defaultTypeDenseCoeffVectorRep&nbsp;:=
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line401"></a><div class='linenum'>401</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewType(&nbsp;Fam,&nbsp;IsSCRingObj&nbsp;and&nbsp;IsDenseCoeffVectorRep&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line402"></a><div class='linenum'>402</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line403"></a><div class='linenum'>403</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetCoefficientsFamily(&nbsp;Fam,&nbsp;ElementsFamily(&nbsp;FamilyObj(&nbsp;Integers&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line404"></a><div class='linenum'>404</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;temporary
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line405"></a><div class='linenum'>405</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIsUFDFamily(Fam,false);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line406"></a><div class='linenum'>406</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line407"></a><div class='linenum'>407</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Make&nbsp;the&nbsp;generators&nbsp;and&nbsp;the&nbsp;ring.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line408"></a><div class='linenum'>408</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetZero(&nbsp;Fam,&nbsp;ObjByExtRep(&nbsp;Fam,&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;],&nbsp;x&nbsp;->&nbsp;0&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line409"></a><div class='linenum'>409</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gens:=&nbsp;Immutable(&nbsp;List(&nbsp;IdentityMat(&nbsp;n,&nbsp;Integers&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line410"></a><div class='linenum'>410</div></td><td></td><td></td><td></td><td><span><tt>			&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;ObjByExtRep(&nbsp;Fam,&nbsp;x&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line411"></a><div class='linenum'>411</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;A:=&nbsp;RingByGenerators(&nbsp;gens&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line412"></a><div class='linenum'>412</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIsWholeFamily(A,true);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line413"></a><div class='linenum'>413</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line414"></a><div class='linenum'>414</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(moduli)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line415"></a><div class='linenum'>415</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetSize(A,1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line416"></a><div class='linenum'>416</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Product(moduli)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line417"></a><div class='linenum'>417</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetSize(A,infinity);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line418"></a><div class='linenum'>418</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line419"></a><div class='linenum'>419</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetSize(A,Product(moduli));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line420"></a><div class='linenum'>420</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line421"></a><div class='linenum'>421</div></td><td></td><td></td><td></td><td><span><tt>#X&nbsp;&nbsp;&nbsp;&nbsp;Fam!.basisVectors:=&nbsp;gens;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line422"></a><div class='linenum'>422</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line423"></a><div class='linenum'>423</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Store&nbsp;the&nbsp;ring&nbsp;in&nbsp;the&nbsp;family&nbsp;of&nbsp;the&nbsp;elements,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line424"></a><div class='linenum'>424</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;for&nbsp;accessing&nbsp;the&nbsp;full&nbsp;ring,&nbsp;e.g.,&nbsp;in&nbsp;`DefaultFieldOfMatrixGroup'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line425"></a><div class='linenum'>425</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Fam!.fullSCRing:=&nbsp;A;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line426"></a><div class='linenum'>426</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line427"></a><div class='linenum'>427</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetRepresentative(A,Zero(A));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line428"></a><div class='linenum'>428</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line429"></a><div class='linenum'>429</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;there&nbsp;is&nbsp;only&nbsp;1&nbsp;generator,&nbsp;the&nbsp;`One'&nbsp;-&nbsp;if&nbsp;any&nbsp;-&nbsp;can&nbsp;be&nbsp;obtained&nbsp;easily
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line430"></a><div class='linenum'>430</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(moduli)=1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line431"></a><div class='linenum'>431</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n:=ExtRepOfObj(gens[1]^2)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line432"></a><div class='linenum'>432</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;moduli[1]=0&nbsp;and&nbsp;n=1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line433"></a><div class='linenum'>433</div></td><td></td><td></td><td></td><td><span><tt>	n:=ObjByExtRep(Fam,[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line434"></a><div class='linenum'>434</div></td><td></td><td></td><td></td><td><span><tt>	SetOne(Fam,n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line435"></a><div class='linenum'>435</div></td><td></td><td></td><td></td><td><span><tt>	SetOne(A,n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line436"></a><div class='linenum'>436</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;moduli[1]=0&nbsp;and&nbsp;n=-1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line437"></a><div class='linenum'>437</div></td><td></td><td></td><td></td><td><span><tt>	n:=ObjByExtRep(Fam,[-1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line438"></a><div class='linenum'>438</div></td><td></td><td></td><td></td><td><span><tt>	SetOne(Fam,n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line439"></a><div class='linenum'>439</div></td><td></td><td></td><td></td><td><span><tt>	SetOne(A,n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line440"></a><div class='linenum'>440</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;moduli[1]>1&nbsp;and&nbsp;Gcd(n,moduli[1])=1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line441"></a><div class='linenum'>441</div></td><td></td><td></td><td></td><td><span><tt>	n:=1/n&nbsp;mod&nbsp;moduli[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line442"></a><div class='linenum'>442</div></td><td></td><td></td><td></td><td><span><tt>	n:=ObjByExtRep(Fam,[n]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line443"></a><div class='linenum'>443</div></td><td></td><td></td><td></td><td><span><tt>	SetOne(Fam,n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line444"></a><div class='linenum'>444</div></td><td></td><td></td><td></td><td><span><tt>	SetOne(A,n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line445"></a><div class='linenum'>445</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line446"></a><div class='linenum'>446</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line447"></a><div class='linenum'>447</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line448"></a><div class='linenum'>448</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;ring.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line449"></a><div class='linenum'>449</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;A;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line450"></a><div class='linenum'>450</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line451"></a><div class='linenum'>451</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line452"></a><div class='linenum'>452</div></td><td></td><td></td><td></td><td><span><tt>InstallAccessToGenerators(&nbsp;IsSubringSCRing&nbsp;and&nbsp;IsWholeFamily,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line453"></a><div class='linenum'>453</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"whole&nbsp;SC&nbsp;ring",&nbsp;GeneratorsOfRing&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line454"></a><div class='linenum'>454</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line455"></a><div class='linenum'>455</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("SCRingElmSift",function(moduli,l,pivots,e,test)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line456"></a><div class='linenum'>456</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;i,&nbsp;j,&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line457"></a><div class='linenum'>457</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line458"></a><div class='linenum'>458</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(l)=0&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line459"></a><div class='linenum'>459</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;test=true&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line460"></a><div class='linenum'>460</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsZero(e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line461"></a><div class='linenum'>461</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line462"></a><div class='linenum'>462</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;e;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line463"></a><div class='linenum'>463</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line464"></a><div class='linenum'>464</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line465"></a><div class='linenum'>465</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line466"></a><div class='linenum'>466</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;i:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line467"></a><div class='linenum'>467</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;i&lt;=Length(e)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line468"></a><div class='linenum'>468</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e[i]&lt;>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line469"></a><div class='linenum'>469</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;corresponding&nbsp;pivot
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line470"></a><div class='linenum'>470</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(pivots[i])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line471"></a><div class='linenum'>471</div></td><td></td><td></td><td></td><td><span><tt>	j:=pivots[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line472"></a><div class='linenum'>472</div></td><td></td><td></td><td></td><td><span><tt>	#&nbsp;reduce
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line473"></a><div class='linenum'>473</div></td><td></td><td></td><td></td><td><span><tt>	q:=e[i]/l[j][i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line474"></a><div class='linenum'>474</div></td><td></td><td></td><td></td><td><span><tt>	if&nbsp;IsInt(q)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line475"></a><div class='linenum'>475</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;#&nbsp;can&nbsp;reduce&nbsp;completely
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line476"></a><div class='linenum'>476</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=e-q*l[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line477"></a><div class='linenum'>477</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line478"></a><div class='linenum'>478</div></td><td></td><td></td><td></td><td><span><tt>	else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line479"></a><div class='linenum'>479</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;#&nbsp;cannot&nbsp;eliminate
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line480"></a><div class='linenum'>480</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;test=true&nbsp;then&nbsp;return&nbsp;false;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line481"></a><div class='linenum'>481</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=e-Int(q)*l[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line482"></a><div class='linenum'>482</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line483"></a><div class='linenum'>483</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;test=0&nbsp;and&nbsp;e[i]&lt;>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line484"></a><div class='linenum'>484</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;stop&nbsp;after&nbsp;first&nbsp;nonzero&nbsp;reduction
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line485"></a><div class='linenum'>485</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;e;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line486"></a><div class='linenum'>486</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line487"></a><div class='linenum'>487</div></td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line488"></a><div class='linenum'>488</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line489"></a><div class='linenum'>489</div></td><td></td><td></td><td></td><td><span><tt>	#&nbsp;no&nbsp;pivot&nbsp;--&nbsp;not&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line490"></a><div class='linenum'>490</div></td><td></td><td></td><td></td><td><span><tt>	if&nbsp;test=true&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line491"></a><div class='linenum'>491</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line492"></a><div class='linenum'>492</div></td><td></td><td></td><td></td><td><span><tt>	elif&nbsp;test=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line493"></a><div class='linenum'>493</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;#&nbsp;element&nbsp;will&nbsp;give&nbsp;new&nbsp;pivot
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line494"></a><div class='linenum'>494</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;return&nbsp;e;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line495"></a><div class='linenum'>495</div></td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line496"></a><div class='linenum'>496</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line497"></a><div class='linenum'>497</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line498"></a><div class='linenum'>498</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line499"></a><div class='linenum'>499</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line500"></a><div class='linenum'>500</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;test=true&nbsp;then&nbsp;return&nbsp;IsZero(e);fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line501"></a><div class='linenum'>501</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;e;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line502"></a><div class='linenum'>502</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line503"></a><div class='linenum'>503</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line504"></a><div class='linenum'>504</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("SCRingElmSiftImages",function(moduli,l,imgs,pivots,e,ei)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line505"></a><div class='linenum'>505</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;i,&nbsp;j,&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line506"></a><div class='linenum'>506</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(l)=0&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line507"></a><div class='linenum'>507</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[e,ei];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line508"></a><div class='linenum'>508</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line509"></a><div class='linenum'>509</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line510"></a><div class='linenum'>510</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;i:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line511"></a><div class='linenum'>511</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;i&lt;=Length(e)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line512"></a><div class='linenum'>512</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e[i]&lt;>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line513"></a><div class='linenum'>513</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;corresponding&nbsp;pivot
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line514"></a><div class='linenum'>514</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(pivots[i])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line515"></a><div class='linenum'>515</div></td><td></td><td></td><td></td><td><span><tt>	j:=pivots[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line516"></a><div class='linenum'>516</div></td><td></td><td></td><td></td><td><span><tt>	#&nbsp;reduce
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line517"></a><div class='linenum'>517</div></td><td></td><td></td><td></td><td><span><tt>	q:=e[i]/l[j][i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line518"></a><div class='linenum'>518</div></td><td></td><td></td><td></td><td><span><tt>	if&nbsp;IsInt(q)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line519"></a><div class='linenum'>519</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;#&nbsp;can&nbsp;reduce&nbsp;completely
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line520"></a><div class='linenum'>520</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=e-q*l[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line521"></a><div class='linenum'>521</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line522"></a><div class='linenum'>522</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;ei:=ei-q*imgs[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line523"></a><div class='linenum'>523</div></td><td></td><td></td><td></td><td><span><tt>	else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line524"></a><div class='linenum'>524</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;#&nbsp;cannot&nbsp;eliminate
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line525"></a><div class='linenum'>525</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=e-Int(q)*l[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line526"></a><div class='linenum'>526</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line527"></a><div class='linenum'>527</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;ei:=ei-Int(q)*imgs[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line528"></a><div class='linenum'>528</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;#&nbsp;stop&nbsp;after&nbsp;first&nbsp;reduction
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line529"></a><div class='linenum'>529</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;e[i]&lt;>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line530"></a><div class='linenum'>530</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[e,ei];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line531"></a><div class='linenum'>531</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line532"></a><div class='linenum'>532</div></td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line533"></a><div class='linenum'>533</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line534"></a><div class='linenum'>534</div></td><td></td><td></td><td></td><td><span><tt>	#&nbsp;no&nbsp;pivot&nbsp;--&nbsp;not&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line535"></a><div class='linenum'>535</div></td><td></td><td></td><td></td><td><span><tt>	#&nbsp;element&nbsp;will&nbsp;give&nbsp;new&nbsp;pivot
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line536"></a><div class='linenum'>536</div></td><td></td><td></td><td></td><td><span><tt>	return&nbsp;[e,ei];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line537"></a><div class='linenum'>537</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line538"></a><div class='linenum'>538</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line539"></a><div class='linenum'>539</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line540"></a><div class='linenum'>540</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line541"></a><div class='linenum'>541</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;[e,ei];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line542"></a><div class='linenum'>542</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line543"></a><div class='linenum'>543</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line544"></a><div class='linenum'>544</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("SCRHNFExtend",function(moduli,l,pivots,e,imgs,ei)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line545"></a><div class='linenum'>545</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;p,&nbsp;j,&nbsp;f,&nbsp;fj,&nbsp;g,&nbsp;q,&nbsp;gj,&nbsp;m,&nbsp;k,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line546"></a><div class='linenum'>546</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsMutable(l)&nbsp;then&nbsp;l:=ShallowCopy(l);fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line547"></a><div class='linenum'>547</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsMutable(pivots)&nbsp;then&nbsp;pivots:=ShallowCopy(pivots);fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line548"></a><div class='linenum'>548</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line549"></a><div class='linenum'>549</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;imgs=false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line550"></a><div class='linenum'>550</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=SCRingElmSift(moduli,l,pivots,e,0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line551"></a><div class='linenum'>551</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ei:=0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line552"></a><div class='linenum'>552</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line553"></a><div class='linenum'>553</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=SCRingElmSiftImages(moduli,l,imgs,pivots,e,ei);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line554"></a><div class='linenum'>554</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ei:=e[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line555"></a><div class='linenum'>555</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=e[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line556"></a><div class='linenum'>556</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line557"></a><div class='linenum'>557</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p:=PositionNot(e,0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line558"></a><div class='linenum'>558</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(pivots[p])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line559"></a><div class='linenum'>559</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;reduction&nbsp;occured&nbsp;at&nbsp;pivot&nbsp;element&nbsp;--&nbsp;need&nbsp;to&nbsp;reduce&nbsp;further
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line560"></a><div class='linenum'>560</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=pivots[p];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line561"></a><div class='linenum'>561</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f:=l[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line562"></a><div class='linenum'>562</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line563"></a><div class='linenum'>563</div></td><td></td><td></td><td></td><td><span><tt>	fj:=imgs[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line564"></a><div class='linenum'>564</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line565"></a><div class='linenum'>565</div></td><td></td><td></td><td></td><td><span><tt>	fj:=0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line566"></a><div class='linenum'>566</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line567"></a><div class='linenum'>567</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line568"></a><div class='linenum'>568</div></td><td></td><td></td><td></td><td><span><tt>	g:=f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line569"></a><div class='linenum'>569</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f:=e;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line570"></a><div class='linenum'>570</div></td><td></td><td></td><td></td><td><span><tt>	q:=QuoInt(g[p],f[p]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line571"></a><div class='linenum'>571</div></td><td></td><td></td><td></td><td><span><tt>	e:=g-q*f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line572"></a><div class='linenum'>572</div></td><td></td><td></td><td></td><td><span><tt>	if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line573"></a><div class='linenum'>573</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;gj:=fj;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line574"></a><div class='linenum'>574</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;fj:=ei;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line575"></a><div class='linenum'>575</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;ei:=gj-q*fj;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line576"></a><div class='linenum'>576</div></td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line577"></a><div class='linenum'>577</div></td><td></td><td></td><td></td><td><span><tt>	e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line578"></a><div class='linenum'>578</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;e[p]=0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line579"></a><div class='linenum'>579</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;reduce&nbsp;modulo
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line580"></a><div class='linenum'>580</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;moduli[p]>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line581"></a><div class='linenum'>581</div></td><td></td><td></td><td></td><td><span><tt>	m:=Gcdex(e[p],moduli[p]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line582"></a><div class='linenum'>582</div></td><td></td><td></td><td></td><td><span><tt>	e:=e*m.coeff1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line583"></a><div class='linenum'>583</div></td><td></td><td></td><td></td><td><span><tt>	e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line584"></a><div class='linenum'>584</div></td><td></td><td></td><td></td><td><span><tt>	if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line585"></a><div class='linenum'>585</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;ei:=ei*m.coeff1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line586"></a><div class='linenum'>586</div></td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line587"></a><div class='linenum'>587</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line588"></a><div class='linenum'>588</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#mjdify&nbsp;l
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line589"></a><div class='linenum'>589</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;f[p]&lt;0&nbsp;then&nbsp;f:=-f;fj:=-fj;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line590"></a><div class='linenum'>590</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;clean&nbsp;out&nbsp;f
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line591"></a><div class='linenum'>591</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[p+1..Length(moduli)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line592"></a><div class='linenum'>592</div></td><td></td><td></td><td></td><td><span><tt>	if&nbsp;IsBound(pivots[k])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line593"></a><div class='linenum'>593</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;q:=QuoInt(f[k],l[pivots[k]][k]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line594"></a><div class='linenum'>594</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;f:=SCRingReducedModuli(moduli,f-q*l[pivots[k]]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line595"></a><div class='linenum'>595</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line596"></a><div class='linenum'>596</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;fj:=fj-q*imgs[pivots[k]];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line597"></a><div class='linenum'>597</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line598"></a><div class='linenum'>598</div></td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line599"></a><div class='linenum'>599</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line600"></a><div class='linenum'>600</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line601"></a><div class='linenum'>601</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print("Set&nbsp;l[",j,"]:=",f,"&nbsp;at&nbsp;",p,"\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line602"></a><div class='linenum'>602</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l[j]:=f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line603"></a><div class='linenum'>603</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line604"></a><div class='linenum'>604</div></td><td></td><td></td><td></td><td><span><tt>	imgs[j]:=f;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line605"></a><div class='linenum'>605</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line606"></a><div class='linenum'>606</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;clean&nbsp;out&nbsp;above
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line607"></a><div class='linenum'>607</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..j-1]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line608"></a><div class='linenum'>608</div></td><td></td><td></td><td></td><td><span><tt>	for&nbsp;k&nbsp;in&nbsp;[p..Length(moduli)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line609"></a><div class='linenum'>609</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;IsBound(pivots[k])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line610"></a><div class='linenum'>610</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;q:=QuoInt(l[i][k],l[pivots[k]][k]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line611"></a><div class='linenum'>611</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;l[i]:=SCRingReducedModuli(moduli,l[i]-q*l[pivots[k]]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line612"></a><div class='linenum'>612</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line613"></a><div class='linenum'>613</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imgs[i]:=imgs[i]-q*imgs[pivots[k]];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line614"></a><div class='linenum'>614</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line615"></a><div class='linenum'>615</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line616"></a><div class='linenum'>616</div></td><td></td><td></td><td></td><td><span><tt>	od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line617"></a><div class='linenum'>617</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line618"></a><div class='linenum'>618</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line619"></a><div class='linenum'>619</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;until&nbsp;IsZero(e)&nbsp;or&nbsp;not&nbsp;IsBound(pivots[p]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line620"></a><div class='linenum'>620</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsZero(e)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line621"></a><div class='linenum'>621</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;reduce&nbsp;modulo:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line622"></a><div class='linenum'>622</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;moduli[p]>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line623"></a><div class='linenum'>623</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m:=Gcdex(e[p],moduli[p]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line624"></a><div class='linenum'>624</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=e*m.coeff1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line625"></a><div class='linenum'>625</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line626"></a><div class='linenum'>626</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line627"></a><div class='linenum'>627</div></td><td></td><td></td><td></td><td><span><tt>	ei:=ei*m.coeff1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line628"></a><div class='linenum'>628</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line629"></a><div class='linenum'>629</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line630"></a><div class='linenum'>630</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line631"></a><div class='linenum'>631</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e[p]&lt;0&nbsp;then&nbsp;e:=-e;ei:=-ei;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line632"></a><div class='linenum'>632</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;last&nbsp;known&nbsp;pivot&nbsp;before&nbsp;p
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line633"></a><div class='linenum'>633</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;j:=p-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line634"></a><div class='linenum'>634</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j>0&nbsp;and&nbsp;not&nbsp;IsBound(pivots[j])&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line635"></a><div class='linenum'>635</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=j-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line636"></a><div class='linenum'>636</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line637"></a><div class='linenum'>637</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line638"></a><div class='linenum'>638</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=pivots[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line639"></a><div class='linenum'>639</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line640"></a><div class='linenum'>640</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;adjust&nbsp;pivots&nbsp;for&nbsp;insertion
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line641"></a><div class='linenum'>641</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(pivots)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line642"></a><div class='linenum'>642</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(pivots[i])&nbsp;and&nbsp;pivots[i]>=j+1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line643"></a><div class='linenum'>643</div></td><td></td><td></td><td></td><td><span><tt>	pivots[i]:=pivots[i]+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line644"></a><div class='linenum'>644</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line645"></a><div class='linenum'>645</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line646"></a><div class='linenum'>646</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pivots[p]:=j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line647"></a><div class='linenum'>647</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;clean&nbsp;out&nbsp;l[1..j]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line648"></a><div class='linenum'>648</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line649"></a><div class='linenum'>649</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gj:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line650"></a><div class='linenum'>650</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..j]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line651"></a><div class='linenum'>651</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q:=QuoInt(l[i][p],e[p]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line652"></a><div class='linenum'>652</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(m,SCRingReducedModuli(moduli,l[i]-q*e));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line653"></a><div class='linenum'>653</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line654"></a><div class='linenum'>654</div></td><td></td><td></td><td></td><td><span><tt>	Add(gj,imgs[i]-q*ei);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line655"></a><div class='linenum'>655</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line656"></a><div class='linenum'>656</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line657"></a><div class='linenum'>657</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l:=Concatenation(m,[e],l{[j+1..Length(l)]});
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line658"></a><div class='linenum'>658</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;imgs&lt;>false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line659"></a><div class='linenum'>659</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imgs:=Concatenation(gj,[ei],imgs{[j+1..Length(imgs)]});
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line660"></a><div class='linenum'>660</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line661"></a><div class='linenum'>661</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line662"></a><div class='linenum'>662</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;[l,pivots,imgs];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line663"></a><div class='linenum'>663</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line664"></a><div class='linenum'>664</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line665"></a><div class='linenum'>665</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(StandardGeneratorsSubringSCRing,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line666"></a><div class='linenum'>666</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;"for&nbsp;sc&nbsp;rings&nbsp;and&nbsp;their&nbsp;subrings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line667"></a><div class='linenum'>667</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsSubringSCRing],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line668"></a><div class='linenum'>668</div></td><td></td><td></td><td></td><td><span><tt>function(R)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line669"></a><div class='linenum'>669</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam,&nbsp;l,&nbsp;piv,&nbsp;m,&nbsp;new,&nbsp;i,&nbsp;j,&nbsp;p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line670"></a><div class='linenum'>670</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=ElementsFamily(FamilyObj(R));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line671"></a><div class='linenum'>671</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;l:=[];piv:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line672"></a><div class='linenum'>672</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;GeneratorsOfRing(R)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line673"></a><div class='linenum'>673</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=SCRHNFExtend(fam!.moduli,l,piv,ExtRepOfObj(i),false,false);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line674"></a><div class='linenum'>674</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l:=m[1];piv:=m[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line675"></a><div class='linenum'>675</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line676"></a><div class='linenum'>676</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line677"></a><div class='linenum'>677</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;new:=false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line678"></a><div class='linenum'>678</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line679"></a><div class='linenum'>679</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;new=false&nbsp;and&nbsp;i&lt;=Length(l)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line680"></a><div class='linenum'>680</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line681"></a><div class='linenum'>681</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;new=false&nbsp;and&nbsp;j&lt;=Length(l)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line682"></a><div class='linenum'>682</div></td><td></td><td></td><td></td><td><span><tt>	p:=ExtRepOfObj(ObjByExtRep(fam,l[i])*ObjByExtRep(fam,l[j]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line683"></a><div class='linenum'>683</div></td><td></td><td></td><td></td><td><span><tt>	m:=SCRHNFExtend(fam!.moduli,l,piv,p,false,false);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line684"></a><div class='linenum'>684</div></td><td></td><td></td><td></td><td><span><tt>	new:=Length(m[1])>Length(l);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line685"></a><div class='linenum'>685</div></td><td></td><td></td><td></td><td><span><tt>	l:=m[1];piv:=m[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line686"></a><div class='linenum'>686</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line687"></a><div class='linenum'>687</div></td><td></td><td></td><td></td><td><span><tt>	j:=j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line688"></a><div class='linenum'>688</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line689"></a><div class='linenum'>689</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line690"></a><div class='linenum'>690</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line691"></a><div class='linenum'>691</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;until&nbsp;new=false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line692"></a><div class='linenum'>692</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;[l,piv,List(l,i->ObjByExtRep(fam,i))];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line693"></a><div class='linenum'>693</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line694"></a><div class='linenum'>694</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line695"></a><div class='linenum'>695</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("StandardGeneratorsImagesSubringSCRing",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line696"></a><div class='linenum'>696</div></td><td></td><td></td><td></td><td><span><tt>function(fam,gens,imgs)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line697"></a><div class='linenum'>697</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;l,&nbsp;piv,&nbsp;li,&nbsp;m,&nbsp;new,&nbsp;i,&nbsp;j,&nbsp;p,&nbsp;q;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line698"></a><div class='linenum'>698</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;l:=[];piv:=[];li:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line699"></a><div class='linenum'>699</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(gens)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line700"></a><div class='linenum'>700</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=SCRHNFExtend(fam!.moduli,l,piv,ExtRepOfObj(gens[i]),li,imgs[i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line701"></a><div class='linenum'>701</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l:=m[1];piv:=m[2];li:=m[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line702"></a><div class='linenum'>702</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line703"></a><div class='linenum'>703</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line704"></a><div class='linenum'>704</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;new:=false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line705"></a><div class='linenum'>705</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line706"></a><div class='linenum'>706</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;new=false&nbsp;and&nbsp;i&lt;=Length(l)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line707"></a><div class='linenum'>707</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line708"></a><div class='linenum'>708</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;new=false&nbsp;and&nbsp;j&lt;=Length(l)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line709"></a><div class='linenum'>709</div></td><td></td><td></td><td></td><td><span><tt>	p:=ExtRepOfObj(ObjByExtRep(fam,l[i])*ObjByExtRep(fam,l[j]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line710"></a><div class='linenum'>710</div></td><td></td><td></td><td></td><td><span><tt>	q:=li[i]*li[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line711"></a><div class='linenum'>711</div></td><td></td><td></td><td></td><td><span><tt>	m:=SCRHNFExtend(fam!.moduli,l,piv,p,li,q);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line712"></a><div class='linenum'>712</div></td><td></td><td></td><td></td><td><span><tt>	new:=Length(m[1])>Length(l);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line713"></a><div class='linenum'>713</div></td><td></td><td></td><td></td><td><span><tt>	l:=m[1];piv:=m[2];li:=m[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line714"></a><div class='linenum'>714</div></td><td></td><td></td><td></td><td><span><tt>	j:=j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line715"></a><div class='linenum'>715</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line716"></a><div class='linenum'>716</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line717"></a><div class='linenum'>717</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line718"></a><div class='linenum'>718</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;until&nbsp;new=false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line719"></a><div class='linenum'>719</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;[l,piv,List(l,i->ObjByExtRep(fam,i)),li];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line720"></a><div class='linenum'>720</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line721"></a><div class='linenum'>721</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line722"></a><div class='linenum'>722</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;s&nbsp;is&nbsp;``standard&nbsp;generators''&nbsp;entry,&nbsp;e&nbsp;an&nbsp;element,&nbsp;return&nbsp;coefficients
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line723"></a><div class='linenum'>723</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("SCRingDecompositionStandardGens",function(s,e)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line724"></a><div class='linenum'>724</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;moduli,&nbsp;c,&nbsp;p,&nbsp;x,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line725"></a><div class='linenum'>725</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;moduli:=FamilyObj(e)!.moduli;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line726"></a><div class='linenum'>726</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;e:=ExtRepOfObj(e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line727"></a><div class='linenum'>727</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;c:=ListWithIdenticalEntries(Length(s[1]),0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line728"></a><div class='linenum'>728</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(moduli)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line729"></a><div class='linenum'>729</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e[i]&lt;>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line730"></a><div class='linenum'>730</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(s[2][i])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line731"></a><div class='linenum'>731</div></td><td></td><td></td><td></td><td><span><tt>	Error("element&nbsp;does&nbsp;not&nbsp;lie&nbsp;in&nbsp;ring");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line732"></a><div class='linenum'>732</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line733"></a><div class='linenum'>733</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p:=s[2][i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line734"></a><div class='linenum'>734</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;moduli[i]&lt;>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line735"></a><div class='linenum'>735</div></td><td></td><td></td><td></td><td><span><tt>	x:=e[i]/s[1][p][i]&nbsp;mod&nbsp;moduli[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line736"></a><div class='linenum'>736</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line737"></a><div class='linenum'>737</div></td><td></td><td></td><td></td><td><span><tt>	x:=e[i]/s[1][p][i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line738"></a><div class='linenum'>738</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line739"></a><div class='linenum'>739</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c[p]:=x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line740"></a><div class='linenum'>740</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=e-x*s[1][p];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line741"></a><div class='linenum'>741</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=SCRingReducedModuli(moduli,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line742"></a><div class='linenum'>742</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line743"></a><div class='linenum'>743</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line744"></a><div class='linenum'>744</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line745"></a><div class='linenum'>745</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line746"></a><div class='linenum'>746</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line747"></a><div class='linenum'>747</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(Characteristic,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line748"></a><div class='linenum'>748</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;"for&nbsp;sc&nbsp;rings&nbsp;and&nbsp;their&nbsp;subrings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line749"></a><div class='linenum'>749</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsSubringSCRing&nbsp;and&nbsp;HasGeneratorsOfRing],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line750"></a><div class='linenum'>750</div></td><td></td><td></td><td></td><td><span><tt>function(R)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line751"></a><div class='linenum'>751</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;fam,&nbsp;s,&nbsp;moduli,&nbsp;ind,&nbsp;ords,&nbsp;o,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line752"></a><div class='linenum'>752</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=ElementsFamily(FamilyObj(R));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line753"></a><div class='linenum'>753</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;s:=StandardGeneratorsSubringSCRing(R);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line754"></a><div class='linenum'>754</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line755"></a><div class='linenum'>755</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;are&nbsp;there&nbsp;generators&nbsp;of&nbsp;infinite&nbsp;order?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line756"></a><div class='linenum'>756</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;moduli:=fam!.moduli;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line757"></a><div class='linenum'>757</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ind:=Filtered([1..Length(moduli)],i->moduli[i]=0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line758"></a><div class='linenum'>758</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;ForAny(s,i->ForAny(ind,x->i[x]&lt;>0))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line759"></a><div class='linenum'>759</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetSize(R,infinity);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line760"></a><div class='linenum'>760</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line761"></a><div class='linenum'>761</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line762"></a><div class='linenum'>762</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line763"></a><div class='linenum'>763</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;get&nbsp;additive&nbsp;order&nbsp;for&nbsp;each&nbsp;generator
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line764"></a><div class='linenum'>764</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ords:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line765"></a><div class='linenum'>765</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;s[1]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line766"></a><div class='linenum'>766</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ind:=Filtered([1..Length(moduli)],x->i[x]&lt;>0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line767"></a><div class='linenum'>767</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o:=Lcm(List(ind,x->moduli[x]/Gcd(moduli[x],i[x])));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line768"></a><div class='linenum'>768</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Add(ords,o);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line769"></a><div class='linenum'>769</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line770"></a><div class='linenum'>770</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;SetSize(R,Product(ords));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line771"></a><div class='linenum'>771</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Lcm(ords);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line772"></a><div class='linenum'>772</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line773"></a><div class='linenum'>773</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line774"></a><div class='linenum'>774</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(Size,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line775"></a><div class='linenum'>775</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;"for&nbsp;sc&nbsp;rings&nbsp;and&nbsp;their&nbsp;subrings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line776"></a><div class='linenum'>776</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsSubringSCRing&nbsp;and&nbsp;HasGeneratorsOfRing],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line777"></a><div class='linenum'>777</div></td><td></td><td></td><td></td><td><span><tt>function(R)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line778"></a><div class='linenum'>778</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;fam,&nbsp;s,&nbsp;moduli,&nbsp;ind,&nbsp;ords,&nbsp;o,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line779"></a><div class='linenum'>779</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=ElementsFamily(FamilyObj(R));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line780"></a><div class='linenum'>780</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;s:=StandardGeneratorsSubringSCRing(R);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line781"></a><div class='linenum'>781</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line782"></a><div class='linenum'>782</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;are&nbsp;there&nbsp;generators&nbsp;of&nbsp;infinite&nbsp;order?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line783"></a><div class='linenum'>783</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;moduli:=fam!.moduli;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line784"></a><div class='linenum'>784</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ind:=Filtered([1..Length(moduli)],i->moduli[i]=0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line785"></a><div class='linenum'>785</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;ForAny(s,i->ForAny(ind,x->i[x]&lt;>0))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line786"></a><div class='linenum'>786</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetCharacteristic(R,0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line787"></a><div class='linenum'>787</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line788"></a><div class='linenum'>788</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line789"></a><div class='linenum'>789</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line790"></a><div class='linenum'>790</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;get&nbsp;additive&nbsp;order&nbsp;for&nbsp;each&nbsp;generator
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line791"></a><div class='linenum'>791</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ords:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line792"></a><div class='linenum'>792</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;s[1]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line793"></a><div class='linenum'>793</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ind:=Filtered([1..Length(moduli)],x->i[x]&lt;>0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line794"></a><div class='linenum'>794</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o:=Lcm(List(ind,x->moduli[x]/Gcd(moduli[x],i[x])));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line795"></a><div class='linenum'>795</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Add(ords,o);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line796"></a><div class='linenum'>796</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line797"></a><div class='linenum'>797</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(ords)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line798"></a><div class='linenum'>798</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ords:=[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line799"></a><div class='linenum'>799</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line800"></a><div class='linenum'>800</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetCharacteristic(R,Lcm(ords));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line801"></a><div class='linenum'>801</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line802"></a><div class='linenum'>802</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Product(ords);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line803"></a><div class='linenum'>803</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line804"></a><div class='linenum'>804</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line805"></a><div class='linenum'>805</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(\in,"SC&nbsp;Rings",IsElmsColls,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line806"></a><div class='linenum'>806</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsSCRingObj,IsSubringSCRing&nbsp;and&nbsp;HasGeneratorsOfRing],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line807"></a><div class='linenum'>807</div></td><td></td><td></td><td></td><td><span><tt>function(e,r)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line808"></a><div class='linenum'>808</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;fam,s;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line809"></a><div class='linenum'>809</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=FamilyObj(e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line810"></a><div class='linenum'>810</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;s:=StandardGeneratorsSubringSCRing(r);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line811"></a><div class='linenum'>811</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;SCRingElmSift(fam!.moduli,s[1],s[2],ExtRepOfObj(e),true);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line812"></a><div class='linenum'>812</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line813"></a><div class='linenum'>813</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line814"></a><div class='linenum'>814</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("SCRingGroupInFamily",function(fam)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line815"></a><div class='linenum'>815</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;m,&nbsp;a,&nbsp;pcgs,&nbsp;rel,&nbsp;rcgs,&nbsp;x,&nbsp;c,&nbsp;p,&nbsp;e,&nbsp;i,o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line816"></a><div class='linenum'>816</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;m:=fam!.moduli;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line817"></a><div class='linenum'>817</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;0&nbsp;in&nbsp;m&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line818"></a><div class='linenum'>818</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line819"></a><div class='linenum'>819</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;not&nbsp;IsBound(fam!.group)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line820"></a><div class='linenum'>820</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;a:=AbelianGroup(m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line821"></a><div class='linenum'>821</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;translate&nbsp;pcgs&nbsp;generators&nbsp;to&nbsp;ring&nbsp;elements
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line822"></a><div class='linenum'>822</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pcgs:=FamilyPcgs(a);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line823"></a><div class='linenum'>823</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rel:=RelativeOrders(pcgs);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line824"></a><div class='linenum'>824</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rcgs:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line825"></a><div class='linenum'>825</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(GeneratorsOfGroup(a))]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line826"></a><div class='linenum'>826</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=GeneratorsOfGroup(a)[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line827"></a><div class='linenum'>827</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line828"></a><div class='linenum'>828</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;not&nbsp;IsOne(x)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line829"></a><div class='linenum'>829</div></td><td></td><td></td><td></td><td><span><tt>	p:=Position(pcgs,x);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line830"></a><div class='linenum'>830</div></td><td></td><td></td><td></td><td><span><tt>	e:=ListWithIdenticalEntries(Length(m),0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line831"></a><div class='linenum'>831</div></td><td></td><td></td><td></td><td><span><tt>	e[i]:=c;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line832"></a><div class='linenum'>832</div></td><td></td><td></td><td></td><td><span><tt>	rcgs[p]:=ObjByExtRep(fam,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line833"></a><div class='linenum'>833</div></td><td></td><td></td><td></td><td><span><tt>	o:=RelativeOrders(pcgs)[p];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line834"></a><div class='linenum'>834</div></td><td></td><td></td><td></td><td><span><tt>	x:=x^o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line835"></a><div class='linenum'>835</div></td><td></td><td></td><td></td><td><span><tt>	c:=c*o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line836"></a><div class='linenum'>836</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line837"></a><div class='linenum'>837</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line838"></a><div class='linenum'>838</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fam!.group:=a;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line839"></a><div class='linenum'>839</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fam!.rcgs:=rcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line840"></a><div class='linenum'>840</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line841"></a><div class='linenum'>841</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;fam!.group;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line842"></a><div class='linenum'>842</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line843"></a><div class='linenum'>843</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line844"></a><div class='linenum'>844</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("SCRingGroupElement",function(fam,e)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line845"></a><div class='linenum'>845</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;a,&nbsp;w,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line846"></a><div class='linenum'>846</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;a:=SCRingGroupInFamily(fam);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line847"></a><div class='linenum'>847</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;e:=ExponentsOfPcElement(FamilyPcgs(a),e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line848"></a><div class='linenum'>848</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;w:=Zero(fam);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line849"></a><div class='linenum'>849</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(e)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line850"></a><div class='linenum'>850</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;w:=w+e[i]*fam!.rcgs[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line851"></a><div class='linenum'>851</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line852"></a><div class='linenum'>852</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;w;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line853"></a><div class='linenum'>853</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line854"></a><div class='linenum'>854</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line855"></a><div class='linenum'>855</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(One,"for&nbsp;finite&nbsp;SC&nbsp;Rings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line856"></a><div class='linenum'>856</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsRing],0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line857"></a><div class='linenum'>857</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#-SIZE_FLAGS(WITH_HIDDEN_IMPS_FLAGS(FLAGS_FILTER(IsRing))),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line858"></a><div class='linenum'>858</div></td><td></td><td></td><td></td><td><span><tt>function(R)
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line859"></a><div class='linenum'>859</div></td><td>56</td><td>40</td><td>40</td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;(IsSubringSCRing(R)&nbsp;and&nbsp;IsFinite(R))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line860"></a><div class='linenum'>860</div></td><td>28</td><td>77</td><td>77</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line861"></a><div class='linenum'>861</div></td><td>28</td><td>5</td><td>5</td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line862"></a><div class='linenum'>862</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#T&nbsp;should&nbsp;be&nbsp;better&nbsp;code&nbsp;for&nbsp;SC&nbsp;rings&nbsp;by&nbsp;solving&nbsp;an&nbsp;equation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line863"></a><div class='linenum'>863</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;First(Enumerator(R),i->i=i*i&nbsp;and&nbsp;i&lt;>i+i&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line864"></a><div class='linenum'>864</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ForAll(Enumerator(R),j->i*j=j&nbsp;and&nbsp;j*i=j));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line865"></a><div class='linenum'>865</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line866"></a><div class='linenum'>866</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line867"></a><div class='linenum'>867</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(One,"for&nbsp;SC&nbsp;Rings&nbsp;--&nbsp;try&nbsp;generators",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line868"></a><div class='linenum'>868</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsRing],0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line869"></a><div class='linenum'>869</div></td><td></td><td></td><td></td><td><span><tt>function(R)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line870"></a><div class='linenum'>870</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;l,a;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line871"></a><div class='linenum'>871</div></td><td>56</td><td>57</td><td>57</td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsSubringSCRing(R)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line872"></a><div class='linenum'>872</div></td><td>28</td><td>62</td><td>62</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line873"></a><div class='linenum'>873</div></td><td>28</td><td>11</td><td>11</td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line874"></a><div class='linenum'>874</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;l:=GeneratorsOfRing(R);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line875"></a><div class='linenum'>875</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;a:=First(l,x->ForAll(l,y->x*y=y&nbsp;and&nbsp;y*x=y));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line876"></a><div class='linenum'>876</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;a=fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line877"></a><div class='linenum'>877</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line878"></a><div class='linenum'>878</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line879"></a><div class='linenum'>879</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;a;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line880"></a><div class='linenum'>880</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line881"></a><div class='linenum'>881</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line882"></a><div class='linenum'>882</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line883"></a><div class='linenum'>883</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(OneOp,"for&nbsp;finite&nbsp;SC&nbsp;Rings&nbsp;family",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line884"></a><div class='linenum'>884</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsSCRingObjFamily],0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line885"></a><div class='linenum'>885</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#-SIZE_FLAGS(WITH_HIDDEN_IMPS_FLAGS(FLAGS_FILTER(IsRing))),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line886"></a><div class='linenum'>886</div></td><td></td><td></td><td></td><td><span><tt>function(fam)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line887"></a><div class='linenum'>887</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;R;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line888"></a><div class='linenum'>888</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;R:=fam!.fullSCRing;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line889"></a><div class='linenum'>889</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;One(R);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line890"></a><div class='linenum'>890</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line891"></a><div class='linenum'>891</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line892"></a><div class='linenum'>892</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(IsUnit,"for&nbsp;finite&nbsp;Rings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line893"></a><div class='linenum'>893</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;IsCollsElms,[IsRing,IsScalar],0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line894"></a><div class='linenum'>894</div></td><td></td><td></td><td></td><td><span><tt>function(R,e)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line895"></a><div class='linenum'>895</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsFinite(R)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line896"></a><div class='linenum'>896</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line897"></a><div class='linenum'>897</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line898"></a><div class='linenum'>898</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;One(R)&lt;>fail&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line899"></a><div class='linenum'>899</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ForAny(Enumerator(R),x->x*e=One(R)&nbsp;and&nbsp;e*x=One(R));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line900"></a><div class='linenum'>900</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line901"></a><div class='linenum'>901</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line902"></a><div class='linenum'>902</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(Subrings,"for&nbsp;SC&nbsp;Rings",[IsSubringSCRing],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line903"></a><div class='linenum'>903</div></td><td></td><td></td><td></td><td><span><tt>function(R)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line904"></a><div class='linenum'>904</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;fam,&nbsp;a,&nbsp;u,&nbsp;sr,&nbsp;g,&nbsp;l,&nbsp;piv,&nbsp;m,&nbsp;test,&nbsp;x,&nbsp;y,&nbsp;e,&nbsp;t,&nbsp;s,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line905"></a><div class='linenum'>905</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fam:=ElementsFamily(FamilyObj(R));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line906"></a><div class='linenum'>906</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;a:=SCRingGroupInFamily(fam);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line907"></a><div class='linenum'>907</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;construct&nbsp;all&nbsp;subgroups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line908"></a><div class='linenum'>908</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;m:=StandardGeneratorsSubringSCRing(R);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line909"></a><div class='linenum'>909</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;a:=Subgroup(a,List(m[1],i->LinearCombinationPcgs(GeneratorsOfGroup(a),i)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line910"></a><div class='linenum'>910</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;u:=List(ConjugacyClassesSubgroups(a),Representative);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line911"></a><div class='linenum'>911</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;sr:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line912"></a><div class='linenum'>912</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#test&nbsp;which&nbsp;ones&nbsp;are&nbsp;a&nbsp;subring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line913"></a><div class='linenum'>913</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;s&nbsp;in&nbsp;u&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line914"></a><div class='linenum'>914</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;g:=List(GeneratorsOfGroup(s),x->SCRingGroupElement(fam,x));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line915"></a><div class='linenum'>915</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l:=[];piv:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line916"></a><div class='linenum'>916</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;g&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line917"></a><div class='linenum'>917</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m:=SCRHNFExtend(fam!.moduli,l,piv,ExtRepOfObj(i),false,false);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line918"></a><div class='linenum'>918</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l:=m[1];piv:=m[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line919"></a><div class='linenum'>919</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line920"></a><div class='linenum'>920</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;test:=true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line921"></a><div class='linenum'>921</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;x:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line922"></a><div class='linenum'>922</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;test&nbsp;and&nbsp;x&lt;=Length(g)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line923"></a><div class='linenum'>923</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line924"></a><div class='linenum'>924</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;test&nbsp;and&nbsp;y&lt;=Length(g)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line925"></a><div class='linenum'>925</div></td><td></td><td></td><td></td><td><span><tt>	e:=ExtRepOfObj(g[x]*g[y]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line926"></a><div class='linenum'>926</div></td><td></td><td></td><td></td><td><span><tt>	test:=SCRingElmSift(fam!.moduli,l,piv,e,true);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line927"></a><div class='linenum'>927</div></td><td></td><td></td><td></td><td><span><tt>	y:=y+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line928"></a><div class='linenum'>928</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line929"></a><div class='linenum'>929</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=x+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line930"></a><div class='linenum'>930</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line931"></a><div class='linenum'>931</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;test&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line932"></a><div class='linenum'>932</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#workaround
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line933"></a><div class='linenum'>933</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(g)=0&nbsp;then&nbsp;g:=[Zero(fam)];fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line934"></a><div class='linenum'>934</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:=Subring(R,g);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line935"></a><div class='linenum'>935</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetSize(t,Size(s));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line936"></a><div class='linenum'>936</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(sr,t);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line937"></a><div class='linenum'>937</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print("Added&nbsp;size&nbsp;",Size(s),":&nbsp;",g,"\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line938"></a><div class='linenum'>938</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line939"></a><div class='linenum'>939</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print("Discarded&nbsp;size&nbsp;",Size(s),":&nbsp;",g,"\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line940"></a><div class='linenum'>940</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line941"></a><div class='linenum'>941</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line942"></a><div class='linenum'>942</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;sr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line943"></a><div class='linenum'>943</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line944"></a><div class='linenum'>944</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line945"></a><div class='linenum'>945</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line946"></a><div class='linenum'>946</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line947"></a><div class='linenum'>947</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsLeftIdealOp(&nbsp;&lt;A>,&nbsp;&lt;S>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line948"></a><div class='linenum'>948</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line949"></a><div class='linenum'>949</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;IsLeftIdealOp,&nbsp;"for&nbsp;SCRings",&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line950"></a><div class='linenum'>950</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSubringSCRing,&nbsp;IsSubringSCRing&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line951"></a><div class='linenum'>951</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;A,&nbsp;S&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line952"></a><div class='linenum'>952</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;gens,&nbsp;a,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line953"></a><div class='linenum'>953</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsSubset(&nbsp;A,&nbsp;S&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line954"></a><div class='linenum'>954</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line955"></a><div class='linenum'>955</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line956"></a><div class='linenum'>956</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line957"></a><div class='linenum'>957</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;gens:=StandardGeneratorsSubringSCRing(S)[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line958"></a><div class='linenum'>958</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;a&nbsp;in&nbsp;GeneratorsOfRing(&nbsp;A&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line959"></a><div class='linenum'>959</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;gens&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line960"></a><div class='linenum'>960</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;a&nbsp;*&nbsp;i&nbsp;in&nbsp;S&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line961"></a><div class='linenum'>961</div></td><td></td><td></td><td></td><td><span><tt>	return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line962"></a><div class='linenum'>962</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line963"></a><div class='linenum'>963</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line964"></a><div class='linenum'>964</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line965"></a><div class='linenum'>965</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line966"></a><div class='linenum'>966</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line967"></a><div class='linenum'>967</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line968"></a><div class='linenum'>968</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line969"></a><div class='linenum'>969</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line970"></a><div class='linenum'>970</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsRightIdealOp(&nbsp;&lt;A>,&nbsp;&lt;S>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line971"></a><div class='linenum'>971</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line972"></a><div class='linenum'>972</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;IsRightIdealOp,&nbsp;"for&nbsp;SCRings",&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line973"></a><div class='linenum'>973</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsSubringSCRing,&nbsp;IsSubringSCRing&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line974"></a><div class='linenum'>974</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;A,&nbsp;S&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line975"></a><div class='linenum'>975</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;gens,&nbsp;a,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line976"></a><div class='linenum'>976</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsSubset(&nbsp;A,&nbsp;S&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line977"></a><div class='linenum'>977</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line978"></a><div class='linenum'>978</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line979"></a><div class='linenum'>979</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line980"></a><div class='linenum'>980</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;gens:=StandardGeneratorsSubringSCRing(S)[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line981"></a><div class='linenum'>981</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;a&nbsp;in&nbsp;GeneratorsOfRing(&nbsp;A&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line982"></a><div class='linenum'>982</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;gens&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line983"></a><div class='linenum'>983</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;i*a&nbsp;in&nbsp;S&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line984"></a><div class='linenum'>984</div></td><td></td><td></td><td></td><td><span><tt>	return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line985"></a><div class='linenum'>985</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line986"></a><div class='linenum'>986</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line987"></a><div class='linenum'>987</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line988"></a><div class='linenum'>988</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line989"></a><div class='linenum'>989</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line990"></a><div class='linenum'>990</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line991"></a><div class='linenum'>991</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;IsTwoSidedIdealOp,&nbsp;"for&nbsp;rings&nbsp;and&nbsp;subrings",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line992"></a><div class='linenum'>992</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,&nbsp;[&nbsp;IsRing,&nbsp;IsRing&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line993"></a><div class='linenum'>993</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;A,&nbsp;S&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line994"></a><div class='linenum'>994</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;IsLeftIdeal(&nbsp;A,&nbsp;S&nbsp;)&nbsp;and&nbsp;IsRightIdeal(&nbsp;A,&nbsp;S&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line995"></a><div class='linenum'>995</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#T&nbsp;Check&nbsp;containment&nbsp;only&nbsp;once!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line996"></a><div class='linenum'>996</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line997"></a><div class='linenum'>997</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line998"></a><div class='linenum'>998</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(Ideals,"for&nbsp;SC&nbsp;Rings",[IsSubringSCRing],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line999"></a><div class='linenum'>999</div></td><td></td><td></td><td></td><td><span><tt>function(R)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1000"></a><div class='linenum'>1000</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Filtered(Subrings(R),i->IsIdeal(R,i));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1001"></a><div class='linenum'>1001</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1002"></a><div class='linenum'>1002</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1003"></a><div class='linenum'>1003</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1004"></a><div class='linenum'>1004</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1005"></a><div class='linenum'>1005</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1006"></a><div class='linenum'>1006</div></td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;DirectSum(&nbsp;&lt;arg>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1007"></a><div class='linenum'>1007</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1008"></a><div class='linenum'>1008</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;DirectSum,&nbsp;function(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1009"></a><div class='linenum'>1009</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;d,t,i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1010"></a><div class='linenum'>1010</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1011"></a><div class='linenum'>1011</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;arg>&nbsp;must&nbsp;be&nbsp;nonempty"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1012"></a><div class='linenum'>1012</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;1&nbsp;and&nbsp;IsList(&nbsp;arg[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1013"></a><div class='linenum'>1013</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;arg[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1014"></a><div class='linenum'>1014</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;arg>[1]&nbsp;must&nbsp;be&nbsp;nonempty"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1015"></a><div class='linenum'>1015</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1016"></a><div class='linenum'>1016</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;arg:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1017"></a><div class='linenum'>1017</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1018"></a><div class='linenum'>1018</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1019"></a><div class='linenum'>1019</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;special&nbsp;treatment&nbsp;of&nbsp;``Integers''&nbsp;as&nbsp;part&nbsp;of&nbsp;a&nbsp;direct&nbsp;sum:&nbsp;Replace&nbsp;by
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1020"></a><div class='linenum'>1020</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;SC&nbsp;ring:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1021"></a><div class='linenum'>1021</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;ForAny(arg,x->IsIdenticalObj(x,Integers))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1022"></a><div class='linenum'>1022</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;t:=EmptySCTable(1,0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1023"></a><div class='linenum'>1023</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetEntrySCTable(t,1,1,[1,1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1024"></a><div class='linenum'>1024</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;t:=RingByStructureConstants([0],t,"n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1025"></a><div class='linenum'>1025</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;arg:=ShallowCopy(arg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1026"></a><div class='linenum'>1026</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(arg)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1027"></a><div class='linenum'>1027</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsIdenticalObj(arg[i],Integers)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1028"></a><div class='linenum'>1028</div></td><td></td><td></td><td></td><td><span><tt>	arg[i]:=t;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1029"></a><div class='linenum'>1029</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1030"></a><div class='linenum'>1030</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1031"></a><div class='linenum'>1031</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1032"></a><div class='linenum'>1032</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1033"></a><div class='linenum'>1033</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;d:=DirectSumOp(&nbsp;arg,&nbsp;arg[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1034"></a><div class='linenum'>1034</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;ForAll(arg,HasSize)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1035"></a><div class='linenum'>1035</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;ForAll(arg,IsFinite)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1036"></a><div class='linenum'>1036</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;SetSize(d,Product(List(arg,Size)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1037"></a><div class='linenum'>1037</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;SetSize(d,infinity);&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1038"></a><div class='linenum'>1038</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1039"></a><div class='linenum'>1039</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;d;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1040"></a><div class='linenum'>1040</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1041"></a><div class='linenum'>1041</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1042"></a><div class='linenum'>1042</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1043"></a><div class='linenum'>1043</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1044"></a><div class='linenum'>1044</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1045"></a><div class='linenum'>1045</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DirectSumOp(&nbsp;&lt;list>,&nbsp;&lt;R>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1046"></a><div class='linenum'>1046</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1047"></a><div class='linenum'>1047</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DirectSumOp,&nbsp;"for&nbsp;a&nbsp;list&nbsp;(of&nbsp;rings),&nbsp;and&nbsp;a&nbsp;ring",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1048"></a><div class='linenum'>1048</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsRing&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1049"></a><div class='linenum'>1049</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;list,&nbsp;gp&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1050"></a><div class='linenum'>1050</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;ids,&nbsp;tup,&nbsp;first,&nbsp;i,&nbsp;G,&nbsp;gens,&nbsp;g,&nbsp;new,&nbsp;D,&nbsp;prop;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1051"></a><div class='linenum'>1051</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1052"></a><div class='linenum'>1052</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;Check&nbsp;the&nbsp;arguments.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1053"></a><div class='linenum'>1053</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1054"></a><div class='linenum'>1054</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;list>&nbsp;must&nbsp;be&nbsp;nonempty"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1055"></a><div class='linenum'>1055</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;ForAny(&nbsp;list,&nbsp;G&nbsp;->&nbsp;not&nbsp;IsRing(&nbsp;G&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1056"></a><div class='linenum'>1056</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1057"></a><div class='linenum'>1057</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1058"></a><div class='linenum'>1058</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1059"></a><div class='linenum'>1059</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ids&nbsp;:=&nbsp;List(&nbsp;list,&nbsp;Zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1060"></a><div class='linenum'>1060</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;tup&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1061"></a><div class='linenum'>1061</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;first&nbsp;:=&nbsp;[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1062"></a><div class='linenum'>1062</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(&nbsp;list&nbsp;)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1063"></a><div class='linenum'>1063</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;list[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1064"></a><div class='linenum'>1064</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gens&nbsp;:=&nbsp;GeneratorsOfRing(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1065"></a><div class='linenum'>1065</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(gens)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1066"></a><div class='linenum'>1066</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens:=[Zero(G)];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1067"></a><div class='linenum'>1067</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1068"></a><div class='linenum'>1068</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;g&nbsp;in&nbsp;gens&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1069"></a><div class='linenum'>1069</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;:=&nbsp;ShallowCopy(&nbsp;ids&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1070"></a><div class='linenum'>1070</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new[i]&nbsp;:=&nbsp;g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1071"></a><div class='linenum'>1071</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;:=&nbsp;DirectProductElement(&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1072"></a><div class='linenum'>1072</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;tup,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1073"></a><div class='linenum'>1073</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1074"></a><div class='linenum'>1074</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;first,&nbsp;Length(&nbsp;tup&nbsp;)+1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1075"></a><div class='linenum'>1075</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1076"></a><div class='linenum'>1076</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1077"></a><div class='linenum'>1077</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;D&nbsp;:=&nbsp;RingByGenerators(&nbsp;tup&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1078"></a><div class='linenum'>1078</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1079"></a><div class='linenum'>1079</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;SetDirectSumInfo(&nbsp;D,&nbsp;rec(&nbsp;rings&nbsp;:=&nbsp;list,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1080"></a><div class='linenum'>1080</div></td><td></td><td></td><td></td><td><span><tt>				first&nbsp;&nbsp;:=&nbsp;first,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1081"></a><div class='linenum'>1081</div></td><td></td><td></td><td></td><td><span><tt>				embeddings&nbsp;:=&nbsp;[],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1082"></a><div class='linenum'>1082</div></td><td></td><td></td><td></td><td><span><tt>				projections&nbsp;:=&nbsp;[]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1083"></a><div class='linenum'>1083</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1084"></a><div class='linenum'>1084</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;D;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1085"></a><div class='linenum'>1085</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1086"></a><div class='linenum'>1086</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1087"></a><div class='linenum'>1087</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DirectSumOp,&nbsp;"for&nbsp;SC&nbsp;Rings",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1088"></a><div class='linenum'>1088</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsSubringSCRing&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1089"></a><div class='linenum'>1089</div></td><td></td><td></td><td></td><td><span><tt>function(&nbsp;list,&nbsp;gp&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1090"></a><div class='linenum'>1090</div></td><td></td><td></td><td></td><td><span><tt>local&nbsp;ones,s,&nbsp;moduli,&nbsp;orders,&nbsp;offsets,&nbsp;o,&nbsp;p,&nbsp;newmod,&nbsp;t,&nbsp;nams,&nbsp;gens,&nbsp;e,&nbsp;f,&nbsp;D,&nbsp;i,&nbsp;j,&nbsp;k,&nbsp;ii;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1091"></a><div class='linenum'>1091</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1092"></a><div class='linenum'>1092</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;Check&nbsp;the&nbsp;arguments.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1093"></a><div class='linenum'>1093</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1094"></a><div class='linenum'>1094</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;list>&nbsp;must&nbsp;be&nbsp;nonempty"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1095"></a><div class='linenum'>1095</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;ForAny(&nbsp;list,&nbsp;G&nbsp;->&nbsp;not&nbsp;IsSubringSCRing(&nbsp;G&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1096"></a><div class='linenum'>1096</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1097"></a><div class='linenum'>1097</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1098"></a><div class='linenum'>1098</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1099"></a><div class='linenum'>1099</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;get&nbsp;respective&nbsp;standard&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1100"></a><div class='linenum'>1100</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;s:=List(list,StandardGeneratorsSubringSCRing);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1101"></a><div class='linenum'>1101</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;moduli:=List(list,i->ElementsFamily(FamilyObj(i))!.moduli);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1102"></a><div class='linenum'>1102</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;orders:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1103"></a><div class='linenum'>1103</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;offsets:=[0];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1104"></a><div class='linenum'>1104</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ones:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1105"></a><div class='linenum'>1105</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(list)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1106"></a><div class='linenum'>1106</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;o:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1107"></a><div class='linenum'>1107</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..Length(s[i][1])]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1108"></a><div class='linenum'>1108</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p:=PositionNot(s[i][1][j],0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1109"></a><div class='linenum'>1109</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;moduli[i][p]=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1110"></a><div class='linenum'>1110</div></td><td></td><td></td><td></td><td><span><tt>	Add(o,0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1111"></a><div class='linenum'>1111</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1112"></a><div class='linenum'>1112</div></td><td></td><td></td><td></td><td><span><tt>	Add(o,moduli[i][p]/s[i][1][j][p]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1113"></a><div class='linenum'>1113</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1114"></a><div class='linenum'>1114</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1115"></a><div class='linenum'>1115</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Add(orders,o);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1116"></a><div class='linenum'>1116</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;offsets[i+1]:=Sum(List(orders,Length));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1117"></a><div class='linenum'>1117</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(HasOne(list[i])&nbsp;or&nbsp;(HasIsFinite(list[i])&nbsp;and&nbsp;Size(list[i])&lt;10^5&nbsp;))&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1118"></a><div class='linenum'>1118</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;One(list[i])&lt;>fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1119"></a><div class='linenum'>1119</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o:=One(list[i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1120"></a><div class='linenum'>1120</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o:=SCRingDecompositionStandardGens(s[i],o);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1121"></a><div class='linenum'>1121</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(ones,o);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1122"></a><div class='linenum'>1122</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1123"></a><div class='linenum'>1123</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(ones,fail);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1124"></a><div class='linenum'>1124</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1125"></a><div class='linenum'>1125</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1126"></a><div class='linenum'>1126</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1127"></a><div class='linenum'>1127</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;newmod:=Concatenation(orders);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1128"></a><div class='linenum'>1128</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;t:=EmptySCTable(Length(newmod),0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1129"></a><div class='linenum'>1129</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;nams:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1130"></a><div class='linenum'>1130</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(list)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1131"></a><div class='linenum'>1131</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gens:=s[i][3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1132"></a><div class='linenum'>1132</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Append(nams,List([1..Length(gens)],j->[CHARS_UALPHA[i],CHARS_LALPHA[j]]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1133"></a><div class='linenum'>1133</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[1..Length(gens)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1134"></a><div class='linenum'>1134</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[1..Length(gens)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1135"></a><div class='linenum'>1135</div></td><td></td><td></td><td></td><td><span><tt>	e:=gens[j]*gens[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1136"></a><div class='linenum'>1136</div></td><td></td><td></td><td></td><td><span><tt>	if&nbsp;not&nbsp;IsZero(e)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1137"></a><div class='linenum'>1137</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;e:=SCRingDecompositionStandardGens(s[i],e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1138"></a><div class='linenum'>1138</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;f:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1139"></a><div class='linenum'>1139</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;for&nbsp;ii&nbsp;in&nbsp;[1..Length(e)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1140"></a><div class='linenum'>1140</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e[ii]&lt;>0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1141"></a><div class='linenum'>1141</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(f,e[ii]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1142"></a><div class='linenum'>1142</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(f,ii+offsets[i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1143"></a><div class='linenum'>1143</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1144"></a><div class='linenum'>1144</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1145"></a><div class='linenum'>1145</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;SetEntrySCTable(t,j+offsets[i],k+offsets[i],f);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1146"></a><div class='linenum'>1146</div></td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1147"></a><div class='linenum'>1147</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1148"></a><div class='linenum'>1148</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1149"></a><div class='linenum'>1149</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1150"></a><div class='linenum'>1150</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1151"></a><div class='linenum'>1151</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;D&nbsp;:=&nbsp;RingByStructureConstants(newmod,t,nams);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1152"></a><div class='linenum'>1152</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1153"></a><div class='linenum'>1153</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;ForAll(ones,i->i&lt;>fail)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1154"></a><div class='linenum'>1154</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f:=FamilyObj(Zero(D));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1155"></a><div class='linenum'>1155</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;e:=ObjByExtRep(f,Concatenation(ones));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1156"></a><div class='linenum'>1156</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetOne(D,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1157"></a><div class='linenum'>1157</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetOne(f,e);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1158"></a><div class='linenum'>1158</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1159"></a><div class='linenum'>1159</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1160"></a><div class='linenum'>1160</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;SetDirectSumInfo(&nbsp;D,&nbsp;rec(&nbsp;rings&nbsp;:=&nbsp;list,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1161"></a><div class='linenum'>1161</div></td><td></td><td></td><td></td><td><span><tt>				first&nbsp;&nbsp;:=&nbsp;offsets,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1162"></a><div class='linenum'>1162</div></td><td></td><td></td><td></td><td><span><tt>				embeddings&nbsp;:=&nbsp;[],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1163"></a><div class='linenum'>1163</div></td><td></td><td></td><td></td><td><span><tt>				projections&nbsp;:=&nbsp;[]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1164"></a><div class='linenum'>1164</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1165"></a><div class='linenum'>1165</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;D;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1166"></a><div class='linenum'>1166</div></td><td></td><td></td><td></td><td><span><tt>end&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1167"></a><div class='linenum'>1167</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1168"></a><div class='linenum'>1168</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1169"></a><div class='linenum'>1169</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1170"></a><div class='linenum'>1170</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\+(&nbsp;&lt;R1>,&nbsp;&lt;R2>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;sum&nbsp;of&nbsp;rings
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1171"></a><div class='linenum'>1171</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1172"></a><div class='linenum'>1172</div></td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\+,&nbsp;"for&nbsp;two&nbsp;rings",&nbsp;[&nbsp;IsRing,&nbsp;IsRing&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1173"></a><div class='linenum'>1173</div></td><td></td><td></td><td></td><td><span><tt>function(R1,R2)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1174"></a><div class='linenum'>1174</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;DirectSum(R1,R2);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1175"></a><div class='linenum'>1175</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1176"></a><div class='linenum'>1176</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1177"></a><div class='linenum'>1177</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;data&nbsp;base&nbsp;of&nbsp;small&nbsp;rings.&nbsp;(Data&nbsp;taken&nbsp;from&nbsp;the&nbsp;nearring&nbsp;library&nbsp;in&nbsp;SONATA)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1178"></a><div class='linenum'>1178</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1179"></a><div class='linenum'>1179</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("NUMBER_SMALL_RINGS",[1,2,2,11,2,4,2,52,11,4,2,22,2,4,4]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1180"></a><div class='linenum'>1180</div></td><td></td><td></td><td></td><td><span><tt>BindGlobal("SMALL_RINGS_DATA",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1181"></a><div class='linenum'>1181</div></td><td></td><td></td><td></td><td><span><tt>[[1,1,[1],[]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1182"></a><div class='linenum'>1182</div></td><td></td><td></td><td></td><td><span><tt>[2,1,[2],[]],[2,2,[2],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1183"></a><div class='linenum'>1183</div></td><td></td><td></td><td></td><td><span><tt>[3,1,[3],[]],[3,2,[3],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1184"></a><div class='linenum'>1184</div></td><td></td><td></td><td></td><td><span><tt>[4,1,[4],[]],[4,2,[4],[[1,1,[2,1]]]],[4,3,[4],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1185"></a><div class='linenum'>1185</div></td><td></td><td></td><td></td><td><span><tt>[4,4,[2,2],[]],[4,5,[2,2],[[1,1,[1,2]]]],[4,6,[2,2],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1186"></a><div class='linenum'>1186</div></td><td></td><td></td><td></td><td><span><tt>[4,7,[2,2],[[1,1,[1,1]],[1,2,[1,2]]]],[4,8,[2,2],[[1,1,[1,1]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1187"></a><div class='linenum'>1187</div></td><td></td><td></td><td></td><td><span><tt>[4,9,[2,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1188"></a><div class='linenum'>1188</div></td><td></td><td></td><td></td><td><span><tt>[4,10,[2,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1189"></a><div class='linenum'>1189</div></td><td></td><td></td><td></td><td><span><tt>[4,11,[2,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[1,1,1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1190"></a><div class='linenum'>1190</div></td><td></td><td></td><td></td><td><span><tt>[5,1,[5],[]],[5,2,[5],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1191"></a><div class='linenum'>1191</div></td><td></td><td></td><td></td><td><span><tt>[6,1,[6],[]],[6,2,[6],[[1,1,[4,1]]]],[6,3,[6],[[1,1,[3,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1192"></a><div class='linenum'>1192</div></td><td></td><td></td><td></td><td><span><tt>[6,4,[6],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1193"></a><div class='linenum'>1193</div></td><td></td><td></td><td></td><td><span><tt>[7,1,[7],[]],[7,2,[7],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1194"></a><div class='linenum'>1194</div></td><td></td><td></td><td></td><td><span><tt>[8,1,[8],[]],[8,2,[8],[[1,1,[2,1]]]],[8,3,[8],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1195"></a><div class='linenum'>1195</div></td><td></td><td></td><td></td><td><span><tt>[8,4,[8],[[1,1,[4,1]]]],[8,5,[4,2],[]],[8,6,[4,2],[[2,2,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1196"></a><div class='linenum'>1196</div></td><td></td><td></td><td></td><td><span><tt>[8,7,[4,2],[[2,2,[1,2]]]],[8,8,[4,2],[[2,1,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1197"></a><div class='linenum'>1197</div></td><td></td><td></td><td></td><td><span><tt>[8,9,[4,2],[[2,1,[2,1]],[2,2,[2,1]]]],[8,10,[4,2],[[1,2,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1198"></a><div class='linenum'>1198</div></td><td></td><td></td><td></td><td><span><tt>[8,11,[4,2],[[1,2,[2,1]],[2,1,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1199"></a><div class='linenum'>1199</div></td><td></td><td></td><td></td><td><span><tt>[8,12,[4,2],[[1,2,[2,1]],[2,1,[2,1]],[2,2,[2,1]]]],[8,13,[4,2],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1200"></a><div class='linenum'>1200</div></td><td></td><td></td><td></td><td><span><tt>[8,14,[4,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1201"></a><div class='linenum'>1201</div></td><td></td><td></td><td></td><td><span><tt>[8,15,[4,2],[[1,1,[1,1]],[2,1,[1,2]]]],[8,16,[4,2],[[1,1,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1202"></a><div class='linenum'>1202</div></td><td></td><td></td><td></td><td><span><tt>[8,17,[4,2],[[1,1,[2,1]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1203"></a><div class='linenum'>1203</div></td><td></td><td></td><td></td><td><span><tt>[8,18,[4,2],[[1,1,[2,1]],[2,1,[2,1]],[2,2,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1204"></a><div class='linenum'>1204</div></td><td></td><td></td><td></td><td><span><tt>[8,19,[4,2],[[1,1,[2,1]],[1,2,[2,1]],[2,1,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1205"></a><div class='linenum'>1205</div></td><td></td><td></td><td></td><td><span><tt>[8,20,[4,2],[[1,1,[3,1]],[1,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1206"></a><div class='linenum'>1206</div></td><td></td><td></td><td></td><td><span><tt>[8,21,[4,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1207"></a><div class='linenum'>1207</div></td><td></td><td></td><td></td><td><span><tt>[8,22,[4,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1208"></a><div class='linenum'>1208</div></td><td></td><td></td><td></td><td><span><tt>[8,23,[4,2],[[1,1,[1,2]]]],[8,24,[4,2],[[1,1,[1,2]],[1,2,[2,1]],[2,1,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1209"></a><div class='linenum'>1209</div></td><td></td><td></td><td></td><td><span><tt>[8,25,[2,2,2],[]],[8,26,[2,2,2],[[1,1,[1,3]]]],[8,27,[2,2,2],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1210"></a><div class='linenum'>1210</div></td><td></td><td></td><td></td><td><span><tt>[8,28,[2,2,2],[[1,2,[1,3]]]],[8,29,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1211"></a><div class='linenum'>1211</div></td><td></td><td></td><td></td><td><span><tt>[8,30,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[1,3,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1212"></a><div class='linenum'>1212</div></td><td></td><td></td><td></td><td><span><tt>[8,31,[2,2,2],[[1,2,[1,3]],[2,1,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1213"></a><div class='linenum'>1213</div></td><td></td><td></td><td></td><td><span><tt>[8,32,[2,2,2],[[1,1,[1,3]],[1,2,[1,3]],[2,1,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1214"></a><div class='linenum'>1214</div></td><td></td><td></td><td></td><td><span><tt>[8,33,[2,2,2],[[1,1,[1,2]],[1,2,[1,3]],[2,1,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1215"></a><div class='linenum'>1215</div></td><td></td><td></td><td></td><td><span><tt>[8,34,[2,2,2],[[1,1,[1,1]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1216"></a><div class='linenum'>1216</div></td><td></td><td></td><td></td><td><span><tt>[8,35,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1217"></a><div class='linenum'>1217</div></td><td></td><td></td><td></td><td><span><tt>[8,36,[2,2,2],[[1,1,[1,1]],[1,3,[1,3]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1218"></a><div class='linenum'>1218</div></td><td></td><td></td><td></td><td><span><tt>[8,37,[2,2,2],[[1,1,[1,1,1,2]],[1,2,[1,2]],[1,3,[1,3]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1219"></a><div class='linenum'>1219</div></td><td></td><td></td><td></td><td><span><tt>[8,38,[2,2,2],[[1,1,[1,1]],[2,2,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1220"></a><div class='linenum'>1220</div></td><td></td><td></td><td></td><td><span><tt>[8,39,[2,2,2],[[1,1,[1,3]],[1,2,[1,3]],[2,2,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1221"></a><div class='linenum'>1221</div></td><td></td><td></td><td></td><td><span><tt>[8,40,[2,2,2],[[1,1,[1,1]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1222"></a><div class='linenum'>1222</div></td><td></td><td></td><td></td><td><span><tt>[8,41,[2,2,2],[[1,1,[1,1]],[1,3,[1,3]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1223"></a><div class='linenum'>1223</div></td><td></td><td></td><td></td><td><span><tt>[8,42,[2,2,2],[[1,1,[1,1,1,2]],[1,2,[1,1]],[2,1,[1,1]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1224"></a><div class='linenum'>1224</div></td><td></td><td></td><td></td><td><span><tt>[8,43,[2,2,2],[[1,1,[1,1]],[2,1,[1,2]],[3,1,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1225"></a><div class='linenum'>1225</div></td><td></td><td></td><td></td><td><span><tt>[8,44,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[3,1,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1226"></a><div class='linenum'>1226</div></td><td></td><td></td><td></td><td><span><tt>[8,45,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[1,3,[1,3]],[2,1,[1,2]],[2,2,[1,1]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1227"></a><div class='linenum'>1227</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[2,3,[1,3]],[3,1,[1,3]],[3,2,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1228"></a><div class='linenum'>1228</div></td><td></td><td></td><td></td><td><span><tt>[8,46,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[1,3,[1,3]],[2,1,[1,2]],[2,2,[1,1]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1229"></a><div class='linenum'>1229</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[2,3,[1,3]],[3,1,[1,3]],[3,2,[1,3]],[3,3,[1,1,1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1230"></a><div class='linenum'>1230</div></td><td></td><td></td><td></td><td><span><tt>[8,47,[2,2,2],[[1,1,[1,1]],[2,2,[1,2]],[3,1,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1231"></a><div class='linenum'>1231</div></td><td></td><td></td><td></td><td><span><tt>[8,48,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[1,3,[1,3]],[2,1,[1,2]],[2,2,[1,2]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1232"></a><div class='linenum'>1232</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[2,3,[1,3]],[3,1,[1,3]],[3,2,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1233"></a><div class='linenum'>1233</div></td><td></td><td></td><td></td><td><span><tt>[8,49,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[1,3,[1,3]],[2,1,[1,2]],[2,2,[1,2]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1234"></a><div class='linenum'>1234</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[3,1,[1,3]],[3,2,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1235"></a><div class='linenum'>1235</div></td><td></td><td></td><td></td><td><span><tt>[8,50,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[1,3,[1,3]],[2,1,[1,2]],[2,2,[1,2]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1236"></a><div class='linenum'>1236</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[3,1,[1,3]],[3,3,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1237"></a><div class='linenum'>1237</div></td><td></td><td></td><td></td><td><span><tt>[8,51,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[1,3,[1,3]],[2,1,[1,2]],[2,2,[1,2,1,3]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1238"></a><div class='linenum'>1238</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[2,3,[1,2]],[3,1,[1,3]],[3,2,[1,2]],[3,3,[1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1239"></a><div class='linenum'>1239</div></td><td></td><td></td><td></td><td><span><tt>[8,52,[2,2,2],[[1,1,[1,1]],[1,2,[1,2]],[1,3,[1,3]],[2,1,[1,2]],[2,2,[1,1,1,3]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1240"></a><div class='linenum'>1240</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[2,3,[1,2,1,3]],[3,1,[1,3]],[3,2,[1,2,1,3]],[3,3,[1,1,1,2,1,3]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1241"></a><div class='linenum'>1241</div></td><td></td><td></td><td></td><td><span><tt>[9,1,[9],[]],[9,2,[9],[[1,1,[1,1]]]],[9,3,[9],[[1,1,[3,1]]]],[9,4,[3,3],[]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1242"></a><div class='linenum'>1242</div></td><td></td><td></td><td></td><td><span><tt>[9,5,[3,3],[[1,1,[1,2]]]],[9,6,[3,3],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1243"></a><div class='linenum'>1243</div></td><td></td><td></td><td></td><td><span><tt>[9,7,[3,3],[[1,1,[2,1]],[1,2,[2,2]]]],[9,8,[3,3],[[1,1,[1,1]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1244"></a><div class='linenum'>1244</div></td><td></td><td></td><td></td><td><span><tt>[9,9,[3,3],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[2,1,2,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1245"></a><div class='linenum'>1245</div></td><td></td><td></td><td></td><td><span><tt>[9,10,[3,3],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1246"></a><div class='linenum'>1246</div></td><td></td><td></td><td></td><td><span><tt>[9,11,[3,3],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[2,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1247"></a><div class='linenum'>1247</div></td><td></td><td></td><td></td><td><span><tt>[10,1,[10],[]],[10,2,[10],[[1,1,[4,1]]]],[10,3,[10],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1248"></a><div class='linenum'>1248</div></td><td></td><td></td><td></td><td><span><tt>[10,4,[10],[[1,1,[5,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1249"></a><div class='linenum'>1249</div></td><td></td><td></td><td></td><td><span><tt>[11,1,[11],[]],[11,2,[11],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1250"></a><div class='linenum'>1250</div></td><td></td><td></td><td></td><td><span><tt>[12,1,[12],[]],[12,2,[12],[[1,1,[2,1]]]],[12,3,[12],[[1,1,[9,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1251"></a><div class='linenum'>1251</div></td><td></td><td></td><td></td><td><span><tt>[12,4,[12],[[1,1,[4,1]]]],[12,5,[12],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1252"></a><div class='linenum'>1252</div></td><td></td><td></td><td></td><td><span><tt>[12,6,[12],[[1,1,[6,1]]]],[12,7,[6,2],[]],[12,8,[6,2],[[1,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1253"></a><div class='linenum'>1253</div></td><td></td><td></td><td></td><td><span><tt>[12,9,[6,2],[[1,1,[3,1]]]],[12,10,[6,2],[[1,1,[3,1]],[1,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1254"></a><div class='linenum'>1254</div></td><td></td><td></td><td></td><td><span><tt>[12,11,[6,2],[[1,1,[3,1]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1255"></a><div class='linenum'>1255</div></td><td></td><td></td><td></td><td><span><tt>[12,12,[6,2],[[1,1,[3,1]],[1,2,[1,2]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1256"></a><div class='linenum'>1256</div></td><td></td><td></td><td></td><td><span><tt>[12,13,[6,2],[[1,1,[2,1]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1257"></a><div class='linenum'>1257</div></td><td></td><td></td><td></td><td><span><tt>[12,14,[6,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1258"></a><div class='linenum'>1258</div></td><td></td><td></td><td></td><td><span><tt>[12,15,[6,2],[[1,1,[2,1]],[1,2,[3,1]],[2,2,[1,2]]]],[12,16,[6,2],[[1,1,[4,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1259"></a><div class='linenum'>1259</div></td><td></td><td></td><td></td><td><span><tt>[12,17,[6,2],[[1,1,[4,1,1,2]]]],[12,18,[6,2],[[1,1,[1,1]],[1,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1260"></a><div class='linenum'>1260</div></td><td></td><td></td><td></td><td><span><tt>[12,19,[6,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1261"></a><div class='linenum'>1261</div></td><td></td><td></td><td></td><td><span><tt>[12,20,[6,2],[[1,1,[3,1]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1262"></a><div class='linenum'>1262</div></td><td></td><td></td><td></td><td><span><tt>[12,21,[6,2],[[1,1,[3,1,1,2]],[1,2,[3,1]],[2,1,[3,1]],[2,2,[1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1263"></a><div class='linenum'>1263</div></td><td></td><td></td><td></td><td><span><tt>[12,22,[6,2],[[1,1,[1,1]],[1,2,[1,2]],[2,1,[1,2]],[2,2,[3,1,1,2]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1264"></a><div class='linenum'>1264</div></td><td></td><td></td><td></td><td><span><tt>[13,1,[13],[]],[13,2,[13],[[1,1,[1,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1265"></a><div class='linenum'>1265</div></td><td></td><td></td><td></td><td><span><tt>[14,1,[14],[]],[14,2,[14],[[1,1,[4,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1266"></a><div class='linenum'>1266</div></td><td></td><td></td><td></td><td><span><tt>[14,3,[14],[[1,1,[1,1]]]],[14,4,[14],[[1,1,[7,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1267"></a><div class='linenum'>1267</div></td><td></td><td></td><td></td><td><span><tt>[15,1,[15],[]],[15,2,[15],[[1,1,[1,1]]]],[15,3,[15],[[1,1,[9,1]]]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1268"></a><div class='linenum'>1268</div></td><td></td><td></td><td></td><td><span><tt>[15,4,[15],[[1,1,[10,1]]]]]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1269"></a><div class='linenum'>1269</div></td><td></td><td></td><td></td><td><span><tt>);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1270"></a><div class='linenum'>1270</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1271"></a><div class='linenum'>1271</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(NumberSmallRings,function(x)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1272"></a><div class='linenum'>1272</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsPosInt(x)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1273"></a><div class='linenum'>1273</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(NUMBER_SMALL_RINGS[x])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1274"></a><div class='linenum'>1274</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NUMBER_SMALL_RINGS[x];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1275"></a><div class='linenum'>1275</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1276"></a><div class='linenum'>1276</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("the&nbsp;library&nbsp;of&nbsp;rings&nbsp;of&nbsp;size&nbsp;",&nbsp;x,&nbsp;"&nbsp;is&nbsp;not&nbsp;available");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1277"></a><div class='linenum'>1277</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1278"></a><div class='linenum'>1278</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1279"></a><div class='linenum'>1279</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("NumberSmallRings:&nbsp;the&nbsp;argument&nbsp;should&nbsp;be&nbsp;a&nbsp;positive&nbsp;integer");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1280"></a><div class='linenum'>1280</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1281"></a><div class='linenum'>1281</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1282"></a><div class='linenum'>1282</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1283"></a><div class='linenum'>1283</div></td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(SmallRing,function(x,n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1284"></a><div class='linenum'>1284</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;r,&nbsp;s,&nbsp;t,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1285"></a><div class='linenum'>1285</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;(IsPosInt(x)&nbsp;and&nbsp;IsBound(NUMBER_SMALL_RINGS[x])
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1286"></a><div class='linenum'>1286</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsPosInt(n)&nbsp;and&nbsp;n&lt;=NUMBER_SMALL_RINGS[x])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1287"></a><div class='linenum'>1287</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=Filtered([1..Length(NUMBER_SMALL_RINGS)],i->NUMBER_SMALL_RINGS[i]>0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1288"></a><div class='linenum'>1288</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsRange(r);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1289"></a><div class='linenum'>1289</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("Size&nbsp;must&nbsp;be&nbsp;in&nbsp;",r,"&nbsp;and&nbsp;number&nbsp;in&nbsp;[1..",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1290"></a><div class='linenum'>1290</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_SMALL_RINGS[x],"]\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1291"></a><div class='linenum'>1291</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1292"></a><div class='linenum'>1292</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;s:=First(SMALL_RINGS_DATA,i->i[1]=x&nbsp;and&nbsp;i[2]=n);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1293"></a><div class='linenum'>1293</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=s[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1294"></a><div class='linenum'>1294</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;t:=EmptySCTable(Length(r),0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1295"></a><div class='linenum'>1295</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;s[4]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1296"></a><div class='linenum'>1296</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetEntrySCTable(t,i[1],i[2],i[3]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1297"></a><div class='linenum'>1297</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1298"></a><div class='linenum'>1298</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(r)>26&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1299"></a><div class='linenum'>1299</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s:="R";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1300"></a><div class='linenum'>1300</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1301"></a><div class='linenum'>1301</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s:=List([1..Length(r)],i->[CHARS_LALPHA[i]]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1302"></a><div class='linenum'>1302</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1303"></a><div class='linenum'>1303</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r:=RingByStructureConstants(r,t,s);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1304"></a><div class='linenum'>1304</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1305"></a><div class='linenum'>1305</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1306"></a><div class='linenum'>1306</div></td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1307"></a><div class='linenum'>1307</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1308"></a><div class='linenum'>1308</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1309"></a><div class='linenum'>1309</div></td><td></td><td></td><td></td><td><span><tt>#&nbsp;bugfixes&nbsp;in&nbsp;the&nbsp;general&nbsp;code.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1310"></a><div class='linenum'>1310</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1311"></a><div class='linenum'>1311</div></td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1312"></a><div class='linenum'>1312</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1313"></a><div class='linenum'>1313</div></td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Enumerator(&nbsp;&lt;I>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;an&nbsp;ideal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1314"></a><div class='linenum'>1314</div></td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1315"></a><div class='linenum'>1315</div></td><td></td><td></td><td></td><td><span><tt>EnumeratorOfIdeal&nbsp;:=&nbsp;function(&nbsp;I&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1316"></a><div class='linenum'>1316</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1317"></a><div class='linenum'>1317</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;left,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;we&nbsp;must&nbsp;multiply&nbsp;with&nbsp;ring&nbsp;elements&nbsp;from&nbsp;the&nbsp;left
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1318"></a><div class='linenum'>1318</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;we&nbsp;must&nbsp;multiply&nbsp;with&nbsp;ring&nbsp;elements&nbsp;from&nbsp;the&nbsp;right
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1319"></a><div class='linenum'>1319</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elms,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;elements&nbsp;of&nbsp;&lt;I>,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1320"></a><div class='linenum'>1320</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;set&nbsp;corresponding&nbsp;to&nbsp;&lt;elms>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1321"></a><div class='linenum'>1321</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Igens,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ideal&nbsp;generators&nbsp;of&nbsp;&lt;I>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1322"></a><div class='linenum'>1322</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;acting&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1323"></a><div class='linenum'>1323</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rgens,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ring&nbsp;generators&nbsp;of&nbsp;`R'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1324"></a><div class='linenum'>1324</div></td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;elmsgens,&nbsp;&nbsp;&nbsp;#&nbsp;additive&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1325"></a><div class='linenum'>1325</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elm,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;element&nbsp;of&nbsp;&lt;elms>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1326"></a><div class='linenum'>1326</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;generator&nbsp;of&nbsp;&lt;I>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1327"></a><div class='linenum'>1327</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;product&nbsp;or&nbsp;sum&nbsp;of&nbsp;&lt;elm>&nbsp;and&nbsp;&lt;gen>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1328"></a><div class='linenum'>1328</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1329"></a><div class='linenum'>1329</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;that&nbsp;we&nbsp;can&nbsp;handle&nbsp;this&nbsp;ideal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1330"></a><div class='linenum'>1330</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasIsFinite(&nbsp;I&nbsp;)&nbsp;and&nbsp;not&nbsp;IsFinite(&nbsp;I&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1331"></a><div class='linenum'>1331</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1332"></a><div class='linenum'>1332</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1333"></a><div class='linenum'>1333</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1334"></a><div class='linenum'>1334</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;from&nbsp;what&nbsp;sides&nbsp;we&nbsp;must&nbsp;multiply&nbsp;with&nbsp;ring&nbsp;elements.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1335"></a><div class='linenum'>1335</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;HasGeneratorsOfLeftIdeal(&nbsp;I&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1336"></a><div class='linenum'>1336</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Igens&nbsp;:=&nbsp;GeneratorsOfLeftIdeal(&nbsp;I&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1337"></a><div class='linenum'>1337</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;LeftActingRingOfIdeal(&nbsp;I&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1338"></a><div class='linenum'>1338</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1339"></a><div class='linenum'>1339</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1340"></a><div class='linenum'>1340</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasGeneratorsOfRightIdeal(&nbsp;I&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1341"></a><div class='linenum'>1341</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Igens&nbsp;:=&nbsp;GeneratorsOfRightIdeal(&nbsp;I&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1342"></a><div class='linenum'>1342</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;RightActingRingOfIdeal(&nbsp;I&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1343"></a><div class='linenum'>1343</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1344"></a><div class='linenum'>1344</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1345"></a><div class='linenum'>1345</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasGeneratorsOfTwoSidedIdeal(&nbsp;I&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1346"></a><div class='linenum'>1346</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Igens&nbsp;:=&nbsp;GeneratorsOfTwoSidedIdeal(&nbsp;I&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1347"></a><div class='linenum'>1347</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;LeftActingRingOfIdeal(&nbsp;I&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1348"></a><div class='linenum'>1348</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1349"></a><div class='linenum'>1349</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1350"></a><div class='linenum'>1350</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1351"></a><div class='linenum'>1351</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1352"></a><div class='linenum'>1352</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1353"></a><div class='linenum'>1353</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1354"></a><div class='linenum'>1354</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1355"></a><div class='linenum'>1355</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;ideal&nbsp;are&nbsp;sums&nbsp;of&nbsp;elements&nbsp;of&nbsp;the&nbsp;form&nbsp;r*g*s&nbsp;where
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1356"></a><div class='linenum'>1356</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;g&nbsp;is&nbsp;an&nbsp;ideal&nbsp;generator&nbsp;and&nbsp;r&nbsp;and&nbsp;s&nbsp;are&nbsp;ring&nbsp;elements.&nbsp;Therefore
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1357"></a><div class='linenum'>1357</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;*first*&nbsp;compute&nbsp;the&nbsp;ring&nbsp;multiples&nbsp;of&nbsp;the&nbsp;generators&nbsp;and&nbsp;then&nbsp;form&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1358"></a><div class='linenum'>1358</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;additive&nbsp;closure.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1359"></a><div class='linenum'>1359</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elms&nbsp;:=&nbsp;Set(ShallowCopy(Igens));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1360"></a><div class='linenum'>1360</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;:=&nbsp;ShallowCopy(&nbsp;elms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1361"></a><div class='linenum'>1361</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1362"></a><div class='linenum'>1362</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;closure&nbsp;under&nbsp;the&nbsp;action&nbsp;of&nbsp;the&nbsp;acting&nbsp;ring
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1363"></a><div class='linenum'>1363</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;from&nbsp;the&nbsp;left&nbsp;and&nbsp;from&nbsp;the&nbsp;right.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1364"></a><div class='linenum'>1364</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;this&nbsp;ring&nbsp;is&nbsp;associative&nbsp;then&nbsp;it&nbsp;is&nbsp;sufficient&nbsp;to&nbsp;multiply
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1365"></a><div class='linenum'>1365</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;with&nbsp;generators,&nbsp;otherwise&nbsp;we&nbsp;act&nbsp;with&nbsp;all&nbsp;elements.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1366"></a><div class='linenum'>1366</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasIsAssociative(&nbsp;R&nbsp;)&nbsp;and&nbsp;IsAssociative(&nbsp;R&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1367"></a><div class='linenum'>1367</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rgens:=&nbsp;GeneratorsOfRing(&nbsp;R&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1368"></a><div class='linenum'>1368</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1369"></a><div class='linenum'>1369</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rgens:=&nbsp;Enumerator(&nbsp;R&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1370"></a><div class='linenum'>1370</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1371"></a><div class='linenum'>1371</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;elm&nbsp;&nbsp;in&nbsp;elms&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1372"></a><div class='linenum'>1372</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;&nbsp;in&nbsp;Rgens&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1373"></a><div class='linenum'>1373</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;left&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1374"></a><div class='linenum'>1374</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;:=&nbsp;gen&nbsp;*&nbsp;elm;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1375"></a><div class='linenum'>1375</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;new&nbsp;in&nbsp;set&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1376"></a><div class='linenum'>1376</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;elms,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1377"></a><div class='linenum'>1377</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;set,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1378"></a><div class='linenum'>1378</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1379"></a><div class='linenum'>1379</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1380"></a><div class='linenum'>1380</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;right&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1381"></a><div class='linenum'>1381</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;:=&nbsp;elm&nbsp;*&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1382"></a><div class='linenum'>1382</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;new&nbsp;in&nbsp;set&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1383"></a><div class='linenum'>1383</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;elms,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1384"></a><div class='linenum'>1384</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;set,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1385"></a><div class='linenum'>1385</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1386"></a><div class='linenum'>1386</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1387"></a><div class='linenum'>1387</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1388"></a><div class='linenum'>1388</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1389"></a><div class='linenum'>1389</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1390"></a><div class='linenum'>1390</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elms&nbsp;:=&nbsp;set;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1391"></a><div class='linenum'>1391</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elmsgens:=ShallowCopy(elms);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1392"></a><div class='linenum'>1392</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;:=&nbsp;ShallowCopy(&nbsp;elms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1393"></a><div class='linenum'>1393</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1394"></a><div class='linenum'>1394</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Use&nbsp;an&nbsp;orbit&nbsp;like&nbsp;algorithm.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1395"></a><div class='linenum'>1395</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;additive&nbsp;closure&nbsp;of&nbsp;elms
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1396"></a><div class='linenum'>1396</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;elm&nbsp;&nbsp;in&nbsp;elms&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1397"></a><div class='linenum'>1397</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;&nbsp;in&nbsp;elmsgens&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1398"></a><div class='linenum'>1398</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;:=&nbsp;elm&nbsp;+&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1399"></a><div class='linenum'>1399</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;new&nbsp;in&nbsp;set&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1400"></a><div class='linenum'>1400</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;elms,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1401"></a><div class='linenum'>1401</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;set,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1402"></a><div class='linenum'>1402</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1403"></a><div class='linenum'>1403</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1404"></a><div class='linenum'>1404</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1405"></a><div class='linenum'>1405</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1406"></a><div class='linenum'>1406</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1407"></a><div class='linenum'>1407</div></td><td></td><td></td><td></td><td><span><tt>end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1408"></a><div class='linenum'>1408</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1409"></a><div class='linenum'>1409</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Enumerator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1410"></a><div class='linenum'>1410</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;a&nbsp;left&nbsp;ideal&nbsp;with&nbsp;known&nbsp;generators",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1411"></a><div class='linenum'>1411</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1412"></a><div class='linenum'>1412</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsRing&nbsp;and&nbsp;HasGeneratorsOfLeftIdeal&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1413"></a><div class='linenum'>1413</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;EnumeratorOfIdeal&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1414"></a><div class='linenum'>1414</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1415"></a><div class='linenum'>1415</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Enumerator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1416"></a><div class='linenum'>1416</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;a&nbsp;right&nbsp;ideal&nbsp;with&nbsp;known&nbsp;generators",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1417"></a><div class='linenum'>1417</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1418"></a><div class='linenum'>1418</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsRing&nbsp;and&nbsp;HasGeneratorsOfRightIdeal&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1419"></a><div class='linenum'>1419</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;EnumeratorOfIdeal&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1420"></a><div class='linenum'>1420</div></td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1421"></a><div class='linenum'>1421</div></td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Enumerator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1422"></a><div class='linenum'>1422</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"generic&nbsp;method&nbsp;for&nbsp;a&nbsp;two-sided&nbsp;ideal&nbsp;with&nbsp;known&nbsp;generators",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1423"></a><div class='linenum'>1423</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1424"></a><div class='linenum'>1424</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsRing&nbsp;and&nbsp;HasGeneratorsOfIdeal&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1425"></a><div class='linenum'>1425</div></td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;EnumeratorOfIdeal&nbsp;);
</tt></span></td><td><span></span></td></tr>
</tbody>
</table></body></html>
